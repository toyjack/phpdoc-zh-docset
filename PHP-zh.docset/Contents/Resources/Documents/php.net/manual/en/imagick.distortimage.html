<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Distorts an image using various distortion methods</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imagick.displayimages.html">? Imagick::displayImages</a></li>
      <li style="float: right;"><a href="imagick.drawimage.html">Imagick::drawImage ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.imagick.html">Imagick</a></li>
    <li>Distorts an image using various distortion methods</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imagick.distortimage" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Imagick::distortImage</h1>
  <p class="verinfo">(PECL imagick 2.0.1)</p><p class="refpurpose"><span class="refname">Imagick::distortImage</span> &mdash; <span class="dc-title">Distorts an image using various distortion methods</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-imagick.distortimage-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>Imagick::distortImage</strong></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$method</code></span>
   , <span class="methodparam"><span class="type">array</span> <code class="parameter">$arguments</code></span>
   , <span class="methodparam"><span class="type">bool</span> <code class="parameter">$bestfit</code></span>
   )</div>

  <p class="para rdfs-comment">
   Distorts an image using various distortion methods, by mapping color
   lookups of the source image to a new destination image usually of the same
   size as the source image, unless &#039;bestfit&#039; is set to <strong><code>TRUE</code></strong>.
  </p>
  <p class="para">
   If &#039;bestfit&#039; is enabled, and distortion allows it, the destination image
   is adjusted to ensure the whole source &#039;image&#039; will just fit within the
   final destination image, which will be sized and offset accordingly. Also
   in many cases the virtual offset of the source image will be taken into
   account in the mapping.
  </p>
  <p class="para">
   此方法在Imagick基于ImageMagick 6.3.6以上版本编译时可用。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-imagick.distortimage-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">method</code></dt>

     <dd>

      <p class="para">
       The method of image distortion. See <a href="imagick.constants.html#imagick.constants.distortion" class="link">distortion constants</a>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">arguments</code></dt>

     <dd>

      <p class="para">
       The arguments for this distortion method
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">bestfit</code></dt>

     <dd>

      <p class="para">
       Attempt to resize destination to fit distorted source
      </p>
     </dd>

    
   </dl>

  </p>

 </div>

 <div class="refsect1 returnvalues" id="refsect1-imagick.distortimage-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>。
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-imagick.distortimage-errors">
  <h3 class="title">错误／异常</h3>
  <p class="para">
   错误时抛出 ImagickException。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-imagick.distortimage-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-3306">
    <p><strong>Example #1 Using <span class="function"><strong>Imagick::distortImage()</strong></span>:</strong></p>
    <div class="example-contents"><p>
     Distort an image and display to the browser.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;Create&nbsp;new&nbsp;object&nbsp;*/<br /></span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">Imagick</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">/*&nbsp;Create&nbsp;new&nbsp;checkerboard&nbsp;pattern&nbsp;*/<br /></span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">newPseudoImage</span><span style="color: #007700">(</span><span style="color: #0000BB">100</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"pattern:checkerboard"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Set&nbsp;the&nbsp;image&nbsp;format&nbsp;to&nbsp;png&nbsp;*/<br /></span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setImageFormat</span><span style="color: #007700">(</span><span style="color: #DD0000">'png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Fill&nbsp;new&nbsp;visible&nbsp;areas&nbsp;with&nbsp;transparent&nbsp;*/<br /></span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setImageVirtualPixelMethod</span><span style="color: #007700">(</span><span style="color: #0000BB">Imagick</span><span style="color: #007700">::</span><span style="color: #0000BB">VIRTUALPIXELMETHOD_TRANSPARENT</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Activate&nbsp;matte&nbsp;*/<br /></span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setImageMatte</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Control&nbsp;points&nbsp;for&nbsp;the&nbsp;distortion&nbsp;*/<br /></span><span style="color: #0000BB">$controlPoints&nbsp;</span><span style="color: #007700">=&nbsp;array(&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageHeight</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageHeight</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageWidth</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageWidth</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">,<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageWidth</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageHeight</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageWidth</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getImageHeight</span><span style="color: #007700">()&nbsp;-&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Perform&nbsp;the&nbsp;distortion&nbsp;*/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #0000BB">$im</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">distortImage</span><span style="color: #007700">(</span><span style="color: #0000BB">Imagick</span><span style="color: #007700">::</span><span style="color: #0000BB">DISTORTION_PERSPECTIVE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$controlPoints</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Ouput&nbsp;the&nbsp;image&nbsp;*/<br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-Type:&nbsp;image/png"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$im</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="mediaobject">
     
     <div class="imageobject">
      <img src="images/c0d23d2d6769e53e24a1b3136c064577-distortImage.png" alt="Output of example : Using Imagick::distortImage()" width="111" height="150" />
     </div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-imagick.distortimage-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="imagick.blurimage.html" class="function" rel="rdfs-seeAlso">Imagick::blurImage()</a> - Adds blur filter to image</span></li>
    <li class="member"><span class="function"><a href="imagick.motionblurimage.html" class="function" rel="rdfs-seeAlso">Imagick::motionBlurImage()</a> - Simulates motion blur</span></li>
    <li class="member"><span class="function"><a href="imagick.radialblurimage.html" class="function" rel="rdfs-seeAlso">Imagick::radialBlurImage()</a> - Radial blurs an image</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116416""></a>
  <div class="note">
   <strong class="user">peter dot e dot lind at gmail dot com</strong>
   <a href="#116416" class="date">30-Dec-2014 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is worth nothing that details on distorts as well as arguments can be found at <a href="http://www.imagemagick.org/Usage/distorts/ - the PHP manual doesn" rel="nofollow" target="_blank">http://www.imagemagick.org/Usage/distorts/ - the PHP manual doesn</a>'t give much, if any, detail on arguments.
<br />

<br />
I found this very useful when I had to do a translated rotation on an image - i.e. rotating around a point in the image that was not square in the center. This can be achieved by using distortImage with Imagick::DISTORTION_SCALEROTATETRANSLATE like this:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$imagick </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="string">'/path/to/image'</span><span class="keyword">);
<br />
</span><span class="default">$args </span><span class="keyword">= array(
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">20</span><span class="keyword">, </span><span class="comment"># x point to rotate around
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">20</span><span class="keyword">, </span><span class="comment"># y point to rotate around
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1</span><span class="keyword">, </span><span class="comment"># scaling factor - 1 means no scaling
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">90</span><span class="keyword">, </span><span class="comment"># angle to rotate
<br />
</span><span class="keyword">);
<br />

<br />
</span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_TRANSPARENT</span><span class="keyword">);
<br />
</span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_SCALEROTATETRANSLATE</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Note that this type of distort takes from 1 to 7 arguments, depending on what you want to do exactly - there is a lot of flexibility here.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103403""></a>
  <div class="note">
   <strong class="user">DJ Mike</strong>
   <a href="#103403" class="date">12-Apr-2011 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Affine<br />
<br />
<span class="default">&lt;?php <br />
$image </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">"opossum.jpg" </span><span class="keyword">); <br />
</span><span class="default">$points </span><span class="keyword">= array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">,</span><span class="default">25</span><span class="keyword">,&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">100</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">,</span><span class="default">50 <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setimagebackgroundcolor</span><span class="keyword">(</span><span class="string">"#fad888"</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_BACKGROUND </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">(&nbsp; </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_AFFINE</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">); <br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/jpeg" </span><span class="keyword">); <br />
echo </span><span class="default">$image</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Affine Projection<br />
<br />
<span class="default">&lt;?php <br />
$image </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">"opossum.jpg" </span><span class="keyword">); <br />
</span><span class="default">$points </span><span class="keyword">= array( </span><span class="default">0.9</span><span class="keyword">,</span><span class="default">0.3</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; -</span><span class="default">0.2</span><span class="keyword">,</span><span class="default">0.7</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">20</span><span class="keyword">,</span><span class="default">15 </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setimagebackgroundcolor</span><span class="keyword">(</span><span class="string">"#fad888"</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_BACKGROUND </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">( </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_AFFINEPROJECTION</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">); <br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/jpeg" </span><span class="keyword">); <br />
echo </span><span class="default">$image</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Arc<br />
<br />
<span class="default">&lt;?php <br />
$image </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">"opossum.jpg" </span><span class="keyword">); <br />
</span><span class="default">$draw </span><span class="keyword">= new </span><span class="default">imagickdraw</span><span class="keyword">(); <br />
</span><span class="default">$degrees </span><span class="keyword">= array( </span><span class="default">180 </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setimagebackgroundcolor</span><span class="keyword">(</span><span class="string">"#fad888"</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_BACKGROUND </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">( </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_ARC</span><span class="keyword">, </span><span class="default">$degrees</span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">); <br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/jpeg" </span><span class="keyword">); <br />
echo </span><span class="default">$image</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Rotated Arc<br />
<br />
<span class="default">&lt;?php <br />
$image </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">"opossum.jpg" </span><span class="keyword">); <br />
</span><span class="default">$draw </span><span class="keyword">= new </span><span class="default">imagickdraw</span><span class="keyword">(); <br />
</span><span class="default">$degrees </span><span class="keyword">= array( </span><span class="default">180</span><span class="keyword">, </span><span class="default">45</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, </span><span class="default">20 </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setimagebackgroundcolor</span><span class="keyword">(</span><span class="string">"#fad888"</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_BACKGROUND </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">( </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_ARC</span><span class="keyword">, </span><span class="default">$degrees</span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">); <br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/jpeg" </span><span class="keyword">); <br />
echo </span><span class="default">$image</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Bilinear<br />
<br />
<span class="default">&lt;?php <br />
$image </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">"opossum.jpg" </span><span class="keyword">); <br />
</span><span class="default">$points </span><span class="keyword">= array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">,</span><span class="default">25</span><span class="keyword">, </span><span class="comment"># top left&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">176</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">126</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="comment"># top right<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">,</span><span class="default">135</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,</span><span class="default">105</span><span class="keyword">, </span><span class="comment"># bottom right <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">176</span><span class="keyword">,</span><span class="default">135</span><span class="keyword">, </span><span class="default">176</span><span class="keyword">,</span><span class="default">135 </span><span class="comment"># bottum left<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setimagebackgroundcolor</span><span class="keyword">(</span><span class="string">"#fad888"</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_BACKGROUND </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">( </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_BILINEAR</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">); <br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/jpeg" </span><span class="keyword">); <br />
echo </span><span class="default">$image</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Perspective<br />
<br />
<span class="default">&lt;?php <br />
$image </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">"opossum.jpg" </span><span class="keyword">); <br />
</span><span class="default">$points </span><span class="keyword">= array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">,</span><span class="default">25</span><span class="keyword">, </span><span class="comment"># top left&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">176</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">126</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="comment"># top right<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">,</span><span class="default">135</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,</span><span class="default">105</span><span class="keyword">, </span><span class="comment"># bottom right <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">176</span><span class="keyword">,</span><span class="default">135</span><span class="keyword">, </span><span class="default">176</span><span class="keyword">,</span><span class="default">135 </span><span class="comment"># bottum left<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setimagebackgroundcolor</span><span class="keyword">(</span><span class="string">"#fad888"</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_BACKGROUND </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">( </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_PERSPECTIVE</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">); <br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/jpeg" </span><span class="keyword">); <br />
echo </span><span class="default">$image</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Scale Rotate Translate<br />
<br />
<span class="default">&lt;?php <br />
$image </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">"opossum.jpg" </span><span class="keyword">); <br />
</span><span class="default">$points </span><span class="keyword">= array( <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">1.5</span><span class="keyword">, </span><span class="comment"># scale 150%<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">150 </span><span class="comment"># rotate<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setimagebackgroundcolor</span><span class="keyword">(</span><span class="string">"#fad888"</span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_BACKGROUND </span><span class="keyword">);<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">( </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">DISTORTION_SCALEROTATETRANSLATE</span><span class="keyword">, </span><span class="default">$points</span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">); <br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/jpeg" </span><span class="keyword">); <br />
echo </span><span class="default">$image</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102255""></a>
  <div class="note">
   <strong class="user">ashokmca.g at gmail dot com</strong>
   <a href="#102255" class="date">04-Feb-2011 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Slide image with shadow using distortImage<br />
<br />
<span class="default">&lt;?php<br />
<br />
$slideValue </span><span class="keyword">= </span><span class="default">150</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Create new object <br />
</span><span class="default">$im </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="string">"grnhrs.jpg"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Resize <br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">thumbnailImage</span><span class="keyword">(</span><span class="default">500</span><span class="keyword">,</span><span class="default">400</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Set the image format to png <br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageFormat</span><span class="keyword">(</span><span class="string">'png'</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Clone the current object<br />
</span><span class="default">$shadow </span><span class="keyword">= </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">clone</span><span class="keyword">();<br />
<br />
</span><span class="comment">//Set image background color to black (this is the color of the shadow)<br />
</span><span class="default">$shadow</span><span class="keyword">-&gt;</span><span class="default">setImageBackgroundColor</span><span class="keyword">( new </span><span class="default">ImagickPixel</span><span class="keyword">( </span><span class="string">'black' </span><span class="keyword">) );<br />
&nbsp;<br />
&nbsp;</span><span class="comment">//Create the shadow <br />
</span><span class="default">$shadow</span><span class="keyword">-&gt;</span><span class="default">shadowImage</span><span class="keyword">( </span><span class="default">80</span><span class="keyword">, </span><span class="default">10</span><span class="keyword">, </span><span class="default">5</span><span class="keyword">, </span><span class="default">5 </span><span class="keyword">);<br />
<br />
</span><span class="comment">// Fill background area with transparent for image<br />
//VIRTUALPIXELMETHOD_TRANSPARENT<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageVirtualPixelMethod</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">VIRTUALPIXELMETHOD_ TRANSPARENT</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Activate matte <br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageMatte</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Control points for the distortion <br />
</span><span class="default">$controlPoints </span><span class="keyword">= array( </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$slideValue</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">, </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageHeight</span><span class="keyword">(),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">, </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageHeight</span><span class="keyword">(),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageWidth</span><span class="keyword">(), </span><span class="default">0</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageWidth</span><span class="keyword">(), </span><span class="default">0</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageWidth</span><span class="keyword">(), </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageHeight</span><span class="keyword">(),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageWidth</span><span class="keyword">()-</span><span class="default">$slideValue</span><span class="keyword">, </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">getImageHeight</span><span class="keyword">());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
</span><span class="comment">// Perform the distortion <br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_PERSPECTIVEPROJECTION</span><span class="keyword">, </span><span class="default">$controlPoints</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Perform the distortion in shadow image<br />
</span><span class="default">$shadow</span><span class="keyword">-&gt;</span><span class="default">distortImage</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">DISTORTION_PERSPECTIVEPROJECTION</span><span class="keyword">, </span><span class="default">$controlPoints</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Imagick::shadowImage only creates the shadow.<br />
// That is why the original image is composited over it <br />
</span><span class="default">$shadow</span><span class="keyword">-&gt;</span><span class="default">compositeImage</span><span class="keyword">( </span><span class="default">$im</span><span class="keyword">, </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">COMPOSITE_OVER</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0 </span><span class="keyword">);<br />
<br />
</span><span class="comment">/* Ouput the image */<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Type: image/png"</span><span class="keyword">);<br />
echo </span><span class="default">$shadow</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
