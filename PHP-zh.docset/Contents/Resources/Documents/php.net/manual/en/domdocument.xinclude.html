<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Substitutes XIncludes in a DOMDocument Object</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="domdocument.validate.html">? DOMDocument::validate</a></li>
      <li style="float: right;"><a href="class.domdocumentfragment.html">DOMDocumentFragment ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.domdocument.html">DOMDocument</a></li>
    <li>Substitutes XIncludes in a DOMDocument Object</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="domdocument.xinclude" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">DOMDocument::xinclude</h1>
  <p class="verinfo">(PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">DOMDocument::xinclude</span> &mdash; <span class="dc-title">
   Substitutes XIncludes in a DOMDocument Object
  </span></p>

 </div>
 <div class="refsect1 description" id="refsect1-domdocument.xinclude-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">int</span> <span class="methodname"><strong>DOMDocument::xinclude</strong></span>
    ([ <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   This method substitutes <a href="http://www.w3.org/TR/xinclude/" class="link external" title="Link : http://www.w3.org/TR/xinclude/">&raquo;&nbsp;XIncludes</a> in a DOMDocument object.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    Due to libxml2 automatically resolving entities, this method will produce
    unexpected results if the included XML file have an attached DTD.
   </p>
  </p></blockquote>
 </div>

 <div class="refsect1 parameters" id="refsect1-domdocument.xinclude-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       <a href="libxml.constants.html" class="link">libxml parameters</a>. Available
       since PHP 5.1.0 and Libxml 2.6.7.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-domdocument.xinclude-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns the number of XIncludes in the document, -1 if some processing failed,
   or <strong><code>FALSE</code></strong> if there were no substitutions.
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-domdocument.xinclude-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-5790">
    <p><strong>Example #1 DOMDocument::xinclude() example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$xml&nbsp;</span><span style="color: #007700">=&nbsp;&lt;&lt;&lt;EOD<br /></span><span style="color: #DD0000">&lt;?xml&nbsp;version="1.0"&nbsp;?&gt;<br />&lt;chapter&nbsp;xmlns:xi="http://www.w3.org/2001/XInclude"&gt;<br />&nbsp;&lt;title&gt;Books&nbsp;of&nbsp;the&nbsp;other&nbsp;guy..&lt;/title&gt;<br />&nbsp;&lt;para&gt;<br />&nbsp;&nbsp;&lt;xi:include&nbsp;href="book.xml"&gt;<br />&nbsp;&nbsp;&nbsp;&lt;xi:fallback&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&lt;error&gt;xinclude:&nbsp;book.xml&nbsp;not&nbsp;found&lt;/error&gt;<br />&nbsp;&nbsp;&nbsp;&lt;/xi:fallback&gt;<br />&nbsp;&nbsp;&lt;/xi:include&gt;<br />&nbsp;&lt;/para&gt;<br />&lt;/chapter&gt;<br /></span><span style="color: #007700">EOD;<br /><br /></span><span style="color: #0000BB">$dom&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">DOMDocument</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;let's&nbsp;have&nbsp;a&nbsp;nice&nbsp;output<br /></span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">preserveWhiteSpace&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">formatOutput&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;load&nbsp;the&nbsp;XML&nbsp;string&nbsp;defined&nbsp;above<br /></span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">loadXML</span><span style="color: #007700">(</span><span style="color: #0000BB">$xml</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;substitute&nbsp;xincludes<br /></span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">xinclude</span><span style="color: #007700">();<br /><br />echo&nbsp;</span><span style="color: #0000BB">$dom</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">saveXML</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;chapter xmlns:xi=&quot;http://www.w3.org/2001/XInclude&quot;&gt;
  &lt;title&gt;Books of the other guy..&lt;/title&gt;
  &lt;para&gt;
    &lt;row xml:base=&quot;/home/didou/book.xml&quot;&gt;
       &lt;entry&gt;The Grapes of Wrath&lt;/entry&gt;
       &lt;entry&gt;John Steinbeck&lt;/entry&gt;
       &lt;entry&gt;en&lt;/entry&gt;
       &lt;entry&gt;0140186409&lt;/entry&gt;
      &lt;/row&gt;
    &lt;row xml:base=&quot;/home/didou/book.xml&quot;&gt;
       &lt;entry&gt;The Pearl&lt;/entry&gt;
       &lt;entry&gt;John Steinbeck&lt;/entry&gt;
       &lt;entry&gt;en&lt;/entry&gt;
       &lt;entry&gt;014017737X&lt;/entry&gt;
      &lt;/row&gt;
    &lt;row xml:base=&quot;/home/didou/book.xml&quot;&gt;
       &lt;entry&gt;Samarcande&lt;/entry&gt;
       &lt;entry&gt;Amine Maalouf&lt;/entry&gt;
       &lt;entry&gt;fr&lt;/entry&gt;
       &lt;entry&gt;2253051209&lt;/entry&gt;
      &lt;/row&gt;
  &lt;/para&gt;
&lt;/chapter&gt;
</pre></div>
    </div>
   </div>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="76372""></a>
  <div class="note">
   <strong class="user">nicolas_rainardNOSPAM at yahoo dot fr</strong>
   <a href="#76372" class="date">12-Jul-2007 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use the loadXML() method instead of the load() one (let's say, to process the XML string before loading and parsing it), you will have problems with xinclude(), because the parser will not know where to find the files to include.<br />
Using chdir() before xinclude() will not help.<br />
<br />
The solution is to set the documentURI property of the DOMDocument object accordingly to it's original filename, and everything will work fine !<br />
<br />
<span class="default">&lt;?php<br />
<br />
$xml </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">do_something_with</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
<br />
</span><span class="default">$doc </span><span class="keyword">= new </span><span class="default">DOMDocument</span><span class="keyword">;<br />
</span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">documentURI </span><span class="keyword">= </span><span class="default">$file</span><span class="keyword">;<br />
</span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
</span><span class="default">$doc</span><span class="keyword">-&gt;</span><span class="default">xinclude</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
