<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Composites a set of images</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imagick.clutimage.html">? Imagick::clutImage</a></li>
      <li style="float: right;"><a href="imagick.colorfloodfillimage.html">Imagick::colorFloodfillImage ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.imagick.html">Imagick</a></li>
    <li>Composites a set of images</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imagick.coalesceimages" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Imagick::coalesceImages</h1>
  <p class="verinfo">(PECL imagick 2.0.0)</p><p class="refpurpose"><span class="refname">Imagick::coalesceImages</span> &mdash; <span class="dc-title">Composites a set of images</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-imagick.coalesceimages-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type"><a href="class.imagick.html" class="type Imagick">Imagick</a></span> <span class="methodname"><strong>Imagick::coalesceImages</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para rdfs-comment">
   Composites a set of images while respecting any page offsets
   and disposal methods.  GIF, MIFF, and MNG animation sequences
   typically start with an image background and each subsequent
   image varies in size and offset.  Returns a new Imagick object
   where each image in the sequence is the same size as the first
   and composited with the next image in the sequence.
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-imagick.coalesceimages-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns a new Imagick object on success.
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-imagick.coalesceimages-errors">
  <h3 class="title">错误／异常</h3>
  <p class="para">
   错误时抛出 ImagickException。
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111616""></a>
  <div class="note">
   <strong class="user">dikirill</strong>
   <a href="#111616" class="date">09-Mar-2013 01:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I tried examples below, and couldn't make them work. And found that version of my php-imagick extension is 3.1.0RC1, and looks like it's buggy in function "writeImages", downgrade to 3.0.1 helped me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110393""></a>
  <div class="note">
   <strong class="user">ktr</strong>
   <a href="#110393" class="date">18-Oct-2012 05:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
resize and/or crop an animated GIF
<br />

<br />
<span class="default">&lt;?php
<br />
$image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="default">$file_src</span><span class="keyword">);
<br />

<br />
</span><span class="default">$image </span><span class="keyword">= </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">coalesceImages</span><span class="keyword">();
<br />

<br />
foreach (</span><span class="default">$image </span><span class="keyword">as </span><span class="default">$frame</span><span class="keyword">) {
<br />
&nbsp; </span><span class="default">$frame</span><span class="keyword">-&gt;</span><span class="default">cropImage</span><span class="keyword">(</span><span class="default">$crop_w</span><span class="keyword">, </span><span class="default">$crop_h</span><span class="keyword">, </span><span class="default">$crop_x</span><span class="keyword">, </span><span class="default">$crop_y</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$frame</span><span class="keyword">-&gt;</span><span class="default">thumbnailImage</span><span class="keyword">(</span><span class="default">$size_w</span><span class="keyword">, </span><span class="default">$size_h</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$frame</span><span class="keyword">-&gt;</span><span class="default">setImagePage</span><span class="keyword">(</span><span class="default">$size_w</span><span class="keyword">, </span><span class="default">$size_h</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br />
}
<br />

<br />
</span><span class="default">$image </span><span class="keyword">= </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">deconstructImages</span><span class="keyword">();
<br />
</span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">writeImages</span><span class="keyword">(</span><span class="default">$file_dst</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103751""></a>
  <div class="note">
   <strong class="user">vikomic at gmail dot com</strong>
   <a href="#103751" class="date">02-May-2011 12:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here goes an exaple how to resize GIF-s.<br />
<br />
<span class="default">&lt;?php<br />
$imagick </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">(</span><span class="string">"original.gif"</span><span class="keyword">);<br />
<br />
</span><span class="default">$format </span><span class="keyword">= </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">getImageFormat</span><span class="keyword">();<br />
if (</span><span class="default">$format </span><span class="keyword">== </span><span class="string">'GIF'</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$imagick </span><span class="keyword">= </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">coalesceImages</span><span class="keyword">();<br />
&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">resizeImage</span><span class="keyword">(</span><span class="default">120</span><span class="keyword">, </span><span class="default">120</span><span class="keyword">, </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">FILTER_BOX</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp; } while (</span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">nextImage</span><span class="keyword">());<br />
&nbsp; </span><span class="default">$imagick </span><span class="keyword">= </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">deconstructImages</span><span class="keyword">();<br />
&nbsp; </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">writeImages</span><span class="keyword">(</span><span class="string">'new_120x120.gif'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// can be added some more gifs<br />
&nbsp; </span><span class="default">$imagick </span><span class="keyword">= </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">coalesceImages</span><span class="keyword">();<br />
&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">resizeImage</span><span class="keyword">(</span><span class="default">100</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">, </span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">FILTER_BOX</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp; } while (</span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">nextImage</span><span class="keyword">());<br />
&nbsp; </span><span class="default">$imagick </span><span class="keyword">= </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">deconstructImages</span><span class="keyword">();<br />
&nbsp; </span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">writeImages</span><span class="keyword">(</span><span class="string">'new_100x100.gif'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">clear</span><span class="keyword">();<br />
</span><span class="default">$imagick</span><span class="keyword">-&gt;</span><span class="default">destroy</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
You can use any resize method (resizeImage) with this example.<br />
<br />
This example works fine with *imagick module version 2.2.1-dev*, but doesn't work correctly with *imagick module version 3.0.1*.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
