<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>安装</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="oci8.requirements.html">? 需求</a></li>
      <li style="float: right;"><a href="oci8.test.html">Testing ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="oci8.setup.html">安装／配置</a></li>
    <li>安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="oci8.installation" class="section">
 <h2 class="title">安装</h2>


<div class="section" id="oci8.configure">
<h2 class="title">Configuring PHP with OCI8</h2>
 <p class="para">
  Review the
  previous <a href="oci8.requirements.html" class="link">Requirements</a>
  section before configuring OCI8.
 </p>
 <p class="para">
  To enable the OCI8 extension, configure PHP with the option
  <strong class="option configure">--with-oci8</strong>
.
 </p>
 <p class="para">
  Before starting the web server, OCI8 typically requires several
  Oracle environment variables (see below) to locate libraries, point
  to configuration files, and set some basic properties such as the
  character set used by Oracle libraries.  The variables should be set
  <em class="emphasis">before</em> any PHP process starts.
 </p>
 <p class="para">
  PHP should be run with the same, or more recent, major version of
  Oracle libraries as it was configured with.  For example, if you build
  OCI8 with Oracle 11.2 libraries, then PHP should also be deployed
  and run with Oracle 11.2 libraries.
 </p>
</div>
<div class="section">
 <h2 class="title">Installing OCI8 as a Shared Extension</h2>
 <p class="para">
  The configuration <em>shared</em> option 
  builds OCI8 as a shared library that can be dynamically loaded into
  PHP.  Building a shared extension allows OCI8 to be upgraded easily
  without impacting the rest of PHP.
 </p>
 <p class="para">
  Configure OCI8 using one of the following configure options.
 </p>
 <p class="para">
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     If using Oracle Instant Client, then do:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
./configure --with-oci8=shared,instantclient,/path/to/instant/client/lib
</pre></div>
      </div>
     </div>
    </p>
    <p class="para">
     If Instant Client is installed from ZIP files, make sure to create
     the library symbolic link, for example <em>ln -s
     libclntsh.so.11.1 libclntsh.so</em>.
    </p>
    <p class="para">
     If using an RPM-based installation of Oracle Instant Client, the
     configure line will look like this:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
./configure --with-oci8=shared,instantclient,/usr/lib/oracle/&lt;version&gt;/client/lib
</pre></div>
      </div>
     </div>
    </p>
    <p class="para">
     For example, <strong class="option configure">--with-oci8=shared,instantclient,/usr/lib/oracle/11.2/client/lib</strong>
.
    </p>
    <p class="para">
     Note that Oracle Instant Client support first appeared in PHP
     4.3.11 and 5.0.4 and originally used the option
     <strong class="option configure">--with-oci8-instant-client</strong>
 to
     configure PHP.
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     If using an Oracle database or full Oracle Client installation then do:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
./configure --with-oci8=shared,$ORACLE_HOME
</pre></div>
      </div>
     </div>
    </p>
    <p class="para">
     Make sure the web server user
     (<em>nobody</em>, <em>www</em>) has access to
     the libraries, initialization files
     and <var class="filename">tnsnames.ora</var> (if used) under
     the <em>$ORACLE_HOME</em> directory.  With Oracle
     10gR2, you may need to run
     the <var class="filename">$ORACLE_HOME/install/changePerm.sh</var>
     utility to give directory access.
    </p>
   </li>
  </ul>
 </p>
 <p class="para">
  After configuration, follow the usual PHP building procedure,
  e.g. <em class="emphasis">make install</em>.  The OCI8 shared extension
  <var class="filename">oci8.so</var> library will be created.  It may need
  to be manually moved to the PHP extension directory, specified by
  the <a href="ini.core.html#ini.extension-dir" class="link">extension_dir</a> option in
  your <var class="filename">php.ini</var> file.
 </p>
 <p class="para">
  To complete installation of OCI8, edit <var class="filename">php.ini</var> and add the line:
 </p>
 <p class="para">
  <div class="informalexample">
   <div class="example-contents screen">
<div class="cdata"><pre>
extension=oci8.so
</pre></div>
   </div>
  </div>
 </p>
</div>
<div class="section">
 <h2 class="title">Installing OCI8 as a Statically Compiled Extension</h2>
 <p class="para">
  Configure OCI8 using one of the following configure options.
 </p>
 <p class="para">
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     If using Oracle Instant Client, then do:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
./configure --with-oci8=instantclient,/path/to/instant/client/lib
</pre></div>
      </div>
     </div>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     If using an Oracle database or full Oracle Client installation then do:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
./configure --with-oci8=$ORACLE_HOME
</pre></div>
      </div>
     </div>
    </p>
   </li>
  </ul>
 </p>
 <p class="para">
  After configuration, follow the usual PHP building procedure,
  e.g. <em class="emphasis">make install</em>.  After successful
  compilation, you do not need to add <var class="filename">oci8.so</var> to
  <var class="filename">php.ini</var>.  No additional build steps are required.
 </p>
</div>
<div class="section">
 <h2 class="title">Installing OCI8 from PECL</h2>
 <p class="para">
  The OCI8 extension can be added to an existing PHP installation
  either automatically or manually
  from <a href="http://pecl.php.net/" class="link external" title="Link : http://pecl.php.net/">&raquo;&nbsp;http://pecl.php.net/</a>.

  安装此 PECL 扩展相关的信息可在手册中标题为
<a href="install.pecl.html" class="link">PECL
扩展的安装</a>章节中找到。更多信息如新的发行版本、下载、源文件、
维护人员信息及变更日志等，都在此处：
  <a href="http://pecl.php.net/package/oci8" class="link external" title="Link : http://pecl.php.net/package/oci8">&raquo;&nbsp;http://pecl.php.net/package/oci8</a>.

 </p>
 <p class="para">
  For an automated install follow these steps:
 </p>
 <p class="para">
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     If you are behind a firewall, set PEAR&#039;s proxy, for example:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
pear config-set http_proxy http://my-proxy.example.com:80/
</pre></div>
      </div>
     </div>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     Run
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
pecl install oci8
</pre></div>
      </div>
     </div>
    </p>
    <p class="para">
     When prompted, enter either the value of <em>$ORACLE_HOME</em>, or
     <em>instantclient,/path/to/instant/client/lib</em>.
    </p>
    <p class="para">
      Note: Do not enter the variable <em>$ORACLE_HOME</em>
      because it will not be expanded.  Instead, enter the actual path
      of the Oracle home directory.
    </p>
   </li>
  </ul>
 </p>
 <p class="para">
  For a manual install, download the PECL OCI8 package,
  e.g.  <var class="filename">oci8-1.3.5.tgz</var>.
 </p>
 <p class="para">
  <ul class="itemizedlist">
   <li class="listitem">
    <p class="para">
     Extract the package:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
tar -zxf oci8-1.3.5.tgz
cd oci8-1.3.5
</pre></div>
      </div>
     </div>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     Prepare the package:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
phpize
</pre></div>
      </div>
     </div>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     Configure the package, either
     using <em>$ORACLE_HOME</em> or Instant Client
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
./configure -with-oci8=shared,$ORACLE_HOME
</pre></div>
      </div>
     </div>
    </p>
    <p class="para">
     or
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
./configure -with-oci8=shared,instantclient,/path/to/instant/client/lib
</pre></div>
      </div>
     </div>
    </p>
   </li>
   <li class="listitem">
    <p class="para">
     Install the package:
    </p>
    <p class="para">
     <div class="informalexample">
      <div class="example-contents screen">
<div class="cdata"><pre>
make install
</pre></div>
      </div>
     </div>
    </p>
   </li>
  </ul>
 </p>
 <p class="para">
  After either an automatic or manual install, edit your <var class="filename">php.ini</var>
  file and add the line:
 </p>
 <p class="para">
  <div class="informalexample">
   <div class="example-contents screen">
<div class="cdata"><pre>
extension=oci8.so
</pre></div>
   </div>
  </div>
 </p>
 <p class="para">
  Make sure the <var class="filename">php.ini</var>
  directive <a href="ini.core.html#ini.extension-dir" class="link">extension_dir</a> is
  set to the directory that <var class="filename">oci8.so</var> was installed
  in.
 </p>
</div>
<div class="section">
 <h2 class="title">Installing OCI8 on Windows</h2>
 <p class="para">
  On Windows, uncomment the <var class="filename">php.ini</var>
  line <em>extension=php_oci8.dll</em> when using Oracle
  10gR2 client libraries.  Uncomment
  <em>extension=php_oci8_11g.dll</em> when using Oracle 11g
  client libraries. These two DLLs contain equivalent functionality
  and only one may be enabled at a time.  Make
  sure <a href="ini.core.html#ini.extension-dir" class="link">extension_dir</a> is set
  to the directory containing the PHP extension DLLs.
 </p>
 <p class="para">
  If using Instant Client, set the system <em>PATH</em>
  environment variable to the Oracle library directory.
 </p>
</div>
<div class="section">
 <h2 class="title">Setting the Oracle Environment</h2>
 <p class="para">
  Before using this extension, make sure that the Oracle environment
  variables are properly set for the web daemon user.  If your web
  server is automatically started at boot time then make sure that the
  boot-time environment is also configured correctly.
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   Do not set Oracle environment variables
   using <span class="function"><a href="function.putenv.html" class="function">putenv()</a></span> in a PHP script because Oracle
   libraries may be loaded and initialized before your script
   runs. Variables set with <span class="function"><a href="function.putenv.html" class="function">putenv()</a></span> may then cause
   conflicts, crashes, or unpredictable behavior.  Some functions may
   work but others might give subtle errors. The variables should be
   set up <em class="emphasis">before</em> the web server is started.  
  </p>
 </p></blockquote>
 <p class="para">
  On Red Hat Linux and variants, export variables at the end of
  <var class="filename">/etc/sysconfig/httpd</var>.  Other systems with
  Apache 2 may use an <var class="filename">envvars</var> script in the
  Apache <var class="filename">bin</var> directory.  A third option, the
  Apache <em>SetEnv</em> directive
  in <var class="filename">httpd.conf</var>, may work in some systems but is
  known to be insufficient in others.
 </p>
 <p class="para">
  To check that environment variables are set correctly,
  use <span class="function"><a href="function.phpinfo.html" class="function">phpinfo()</a></span> and check
  the <em class="emphasis">Environment</em> (not the <em class="emphasis">Apache
  Environment</em>) section contains the expected variables.
 </p>
 <p class="para">
  The variables that might be needed are included in the following
  table.  Refer to the Oracle documentation for more information on
  all the variables.
  <table class="doctable table">
   <caption><strong>Common Oracle Environment Variables</strong></caption>
   
    <thead>
     <tr>
      <th>Name</th>
      <th>Purpose</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>ORACLE_HOME</td>
      <td>Contains the directory of the full Oracle Database
      software.  Do not set this when using Oracle Instant Client as
      it is unnecessary and may cause installation problems.</td>
     </tr>

     <tr>
      <td>ORACLE_SID</td>
      <td>Contains the name of the database on the local machine to
      be connected to. There is no need to set this if you using
      Oracle Instant Client, or always pass the connection parameter
      to <span class="function"><a href="function.oci-connect.html" class="function">oci_connect()</a></span>.</td>
     </tr>

     <tr>
      <td>LD_LIBRARY_PATH</td>
      <td>Set this (or its platform equivalent, such
      as <em>DYLD_LIBRARY_PATH</em>, <em>LIBPATH</em>,
      or <em>SHLIB_PATH</em>) to the location of the Oracle
      libraries, for example <var class="filename">$ORACLE_HOME/lib</var>
      or <var class="filename">/usr/lib/oracle/11.1/client/lib</var>. This
      variable is not needed if the libraries are located by a
      different search mechanism, such as
      with <var class="filename">ldconfig</var> or
      with <em>LD_PRELOAD</em>.</td>
     </tr>

     <tr>
      <td>NLS_LANG</td>
      <td>This is the primary variable for setting the character
      set and globalization information used by the Oracle
      libraries.</td>
     </tr>

     <tr>
      <td>ORA_SDTZ</td>
      <td>Sets the Oracle session timezone.</td>
     </tr>

     <tr>
      <td>TNS_ADMIN</td>
      <td>Contains the directory where the Oracle Net Services
      configuration files such as <var class="filename">tnsnames.ora</var>
      and <var class="filename">sqlnet.ora</var> are kept.  Not needed if
      the <span class="function"><a href="function.oci-connect.html" class="function">oci_connect()</a></span> connection string uses the
      Easy Connect naming syntax such
      as <em>localhost/XE</em>.  Not needed if the network
      configuration files are in one of the default locations such
      as <var class="filename">$ORACLE_HOME/network/admin</var>
      or <var class="filename">/etc</var>.</td>
     </tr>

    </tbody>
   
  </table>

   Less frequently used Oracle environment variables include
   <em>TWO_TASK</em>, <em>ORA_TZFILE</em>, and the
   various Oracle globalization settings
   like <em>NLS*</em> and the <em>ORA_NLS_*</em>
   variables.  
 </p>
</div>
<div class="section">
 <h2 class="title">Troubleshooting</h2>
 <p class="para">
  The most common problem with installing OCI8 is not having the
  Oracle environment correctly set.  This typically appears as a
  problem using <span class="function"><a href="function.oci-connect.html" class="function">oci_connect()</a></span>
  or <span class="function"><a href="function.oci-pconnect.html" class="function">oci_pconnect()</a></span>.  The error may be a PHP error
  such as <em class="emphasis">Call to undefined function
  oci_connect()</em>, an Oracle error such as ORA-12705, or even
  an Apache crash.  Check the Apache log files for startup errors and
  see the sections above to resolve this problem.
 </p>
 <p class="para">
  While network errors like ORA-12154 or ORA-12514 indicate an Oracle
  network naming or configuration issue, the root cause may be because
  the PHP environment is incorrectly set up and Oracle libraries are
  unable to locate the <var class="filename">tnsnames.ora</var> configuration
  file.
 </p>
 <p class="para">
  On Windows, having multiple versions of Oracle on the one machine
  can easily cause library clashes unless care is taken to make sure
  PHP only uses the correct version of Oracle.
 </p>
 <p class="para">
  A utility to examine what libraries are being looked for and loaded
  can help resolve missing or clashing library issues, particularly on
  Windows.
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <strong>If the web server doesn&#039;t start or crashes at
  startup</strong><br />
  <p class="para">
   Check that Apache is linked with the pthread library:
  </p>
  <p class="para">
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
# ldd /www/apache/bin/httpd
  libpthread.so.0 =&gt; /lib/libpthread.so.0 (0x4001c000)
  libm.so.6 =&gt; /lib/libm.so.6 (0x4002f000)
  libcrypt.so.1 =&gt; /lib/libcrypt.so.1 (0x4004c000)
  libdl.so.2 =&gt; /lib/libdl.so.2 (0x4007a000)
  libc.so.6 =&gt; /lib/libc.so.6 (0x4007e000)
  /lib/ld-linux.so.2 =&gt; /lib/ld-linux.so.2 (0x40000000)
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   If the libpthread is not listed, then reinstall Apache:
  </p>
  <p class="para">
   <div class="informalexample">
    <div class="example-contents screen">
<div class="cdata"><pre>
# cd /usr/src/apache_1.3.xx
# make clean
# LIBS=-lpthread ./config.status
# make
# make install
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   Please note that on some systems like UnixWare, it is libthread
   instead of libpthread. PHP and Apache have to be configured with
   EXTRA_LIBS=-lthread.
  </p>
 </p></blockquote>
</div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="112608""></a>
  <div class="note">
   <strong class="user">wingjeeplau at gmail dot com</strong>
   <a href="#112608" class="date">04-Jul-2013 08:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In Ubuntu the setting is in file /etc/apache2/envvars</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110226""></a>
  <div class="note">
   <strong class="user">Sergey</strong>
   <a href="#110226" class="date">03-Oct-2012 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Lost a day on trying to make work oci8 &amp; pdo_oci extensions in php-fpm 5.3 on OpenSuSE 12.2 (64bit) with latest oracle instant client 11.2.0.3.0. <br />
Any of two works normally with generic instructions. But both extensions caused crash in oci_connect(). <br />
<br />
Solution was simple add ORACLE_HOME variable BEFORE running php-fpm.<br />
<br />
/etc/profile.d/oracle.sh<br />
#!/bin/bash<br />
ORACLE_HOME=/usr/lib/oracle/11.2/client64<br />
LD_LIBRARY_PATH=$ORACLE_HOME/lib<br />
NLS_LANG=american_america.utf8<br />
export ORACLE_HOME LD_LIBRARY_PATH NLS_LANG<br />
<br />
/etc/init.d/php-fpm<br />
.....<br />
. /etc/rc.status<br />
. /etc/profile.d/oracle.sh # add this after rc.status (note: dot &amp; space)<br />
.....<br />
<br />
After "service php-fpm restart" works normally. Hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109871""></a>
  <div class="note">
   <strong class="user">samantha dot vincent at gmail dot com</strong>
   <a href="#109871" class="date">30-Aug-2012 06:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Windows Server 2008 Standard Edition Service Pack 2 i586 
<br />
PHP Version 5.4.4
<br />
XAMPP 1.8.0
<br />

<br />
This is what finally got it working for me:
<br />

<br />
Downloading win32_11gR2_client.zip from the Oracle website.
<br />

<br />
It was really hard to find, but I got there by choosing Downloads &gt; Oracle Database 11g Release 2 then clicked the "See All" link on the far right of the Microsoft Windows (32-bit) download links under (11.2.0.1.0)
<br />

<br />
On this page the second option down is a link to download just the client libraries. 
<br />

<br />
I unzipped it, and ran setup.exe
<br />

<br />
I chose Runtime, I couldn't get InstantClient to work.
<br />

<br />
I used the defaults for Oracle Base and Oracle Home, make sure to write these down you need them.
<br />
Oracle Base: "D:/app/Administrator"
<br />
Oracle Home:&nbsp; "D:/app/Administrator/product/11.2.0/client_1"
<br />

<br />
I chose just English as the language.
<br />

<br />
Next'd through the rest of the installer... The nice thing about this full install is that it sets the Windows Path variable for you, and it has the required library files.
<br />

<br />
In my php.ini file located in /xampp/php/php.ini
<br />
Remove the semicolon from the front of the line: extension=php_oci8_11g.dll
<br />

<br />
In my apache httpd.conf file in /xampp/apache/conf/httpd.conf
<br />

<br />
Add the following SetEnv lines to the end of the &lt;Directory "C:/xampp/htdocs"&gt; This is where you use the oracle base and home paths you wrote down earlier while installing the oracle client ;) This is what mine looks like without all the comments.
<br />

<br />
&lt;Directory "C:/xampp/htdocs"&gt;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; Options Indexes FollowSymLinks Includes ExecCGI
<br />

<br />
&nbsp;&nbsp;&nbsp; AllowOverride All
<br />

<br />
&nbsp;&nbsp;&nbsp; Order allow,deny
<br />
&nbsp;&nbsp;&nbsp; Allow from all
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; SetEnv ORACLE_BASE "D:/app/Administrator"
<br />
&nbsp;&nbsp;&nbsp; SetEnv ORACLE_HOME "D:/app/Administrator/product/11.2.0/client_1"
<br />
&nbsp;&nbsp;&nbsp; SetEnv ORACLE_SID ""
<br />
&nbsp;&nbsp;&nbsp; SetEnv NLS_LANG "AMERICAN_AMERICA.WE8MSWIN1252"
<br />

<br />
&lt;/Directory&gt;
<br />

<br />
I then created a php file and attempted a connection like this:
<br />

<br />
<span class="default">&lt;?php
<br />
$db </span><span class="keyword">= </span><span class="string">"(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = TCSDB07)(PORT = 1521))) (CONNECT_DATA = (SERVER = DEDICATED)(SERVICE_NAME = IPROD)))"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$conn </span><span class="keyword">= </span><span class="default">oci_connect</span><span class="keyword">(</span><span class="string">'username'</span><span class="keyword">, </span><span class="string">'password'</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">);
<br />
if(!</span><span class="default">$conn</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$e </span><span class="keyword">= </span><span class="default">oci_error</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">htmlentities</span><span class="keyword">(</span><span class="default">$e</span><span class="keyword">[</span><span class="string">'message'</span><span class="keyword">], </span><span class="default">ENT_QUTOES</span><span class="keyword">), </span><span class="default">E_USER_ERROR</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107603""></a>
  <div class="note">
   <strong class="user">Saxon Leung</strong>
   <a href="#107603" class="date">21-Feb-2012 06:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Spending long time in researching how to install this on a freshly installed [Red Hat-based (RHEL, CentOS, Fedora)] Linux, and finally I come to this:
<br />

<br />
1) Download &amp; install 
<br />

<br />
#yum install oracle-instantclient-basic
<br />
#yum install oracle-instantclient-devel
<br />

<br />
or 
<br />

<br />
Download:
<br />
oci8-1.4.7.tgz
<br />
oracle-instantclient11.2-basic-11.2.0.3.0-1.x86_64.rpm
<br />
oracle-instantclient11.2-devel-11.2.0.3.0-1.x86_64.rpm
<br />

<br />
#rpm -i oracle-instantclient11.2-basic-11.2.0.3.0-1.x86_64.rpm
<br />
#rpm -i oracle-instantclient11.2-devel-11.2.0.3.0-1.x86_64.rpm
<br />

<br />
2) Check PHP version:
<br />

<br />
#rpm -qa | grep php
<br />

<br />
It should looks sth like this:
<br />
php-devel-5.3.10-1.w5
<br />
php-pdo-5.3.10-1.w5
<br />
php-ldap-5.3.10-1.w5
<br />
php-cli-5.3.10-1.w5
<br />
php-mysql-5.3.10-1.w5
<br />
php-5.3.10-1.w5
<br />
php-common-5.3.10-1.w5
<br />

<br />
3) Update if needed by:
<br />

<br />
#yum --enablerepo=webtatic update php
<br />

<br />
** Make sure you have php-devel installed before updating to a newer version, or you might have problem to add package back. If it happened, you\\'ll have to reinstall all php packages (sadly I did):
<br />

<br />
#yum remove php-common
<br />
#yum --enablerepo=webtatic install php
<br />

<br />
4) Remember to install a C compiler for installation use:
<br />
#yum install gcc
<br />

<br />
5) Unzip oci8-1.4.7.tgz:
<br />
#tar xvzf oci8-1.4.7
<br />

<br />
6) Run phpize (php-devel required):
<br />
# phpize
<br />

<br />
7) Setup Config:
<br />
# ./configure --with-oci8=shared,instantclient,/usr/lib/oracle/11.2/client64/lib
<br />

<br />
8) Add a sym-link to the SDK header files (Comes with the instantclient-devel)
<br />

<br />
#ln -s /usr/include/oracle/11.2/client64/ /usr/lib/oracle/11.2/client64/lib/include
<br />

<br />
** The installation defaults to use 1 dir path only, so the missing SDK files need to add back to that directory, by adding a sym-link \\"include\\" under the lib folder.
<br />

<br />
9) Compile and install:
<br />
#make all install
<br />

<br />
[Please note that I'm installing on a 64-bit platform so links are pointing at client64 instead of client]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105297""></a>
  <div class="note">
   <strong class="user">P dot D dot Mallinson at liv dot ac dot uk</strong>
   <a href="#105297" class="date">08-Aug-2011 03:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Platform: Solaris 10, Apache 2.2, Oracle 11 client<br />
<br />
It is well known that the Oracle Instant Client 11g libraries conflict with the OpenLDAP ones.&nbsp; <br />
<br />
If features of the 11g client libraries are vital (e.g. needing SQLNET timeouts to work and/or needing to get Oracle service names from directory servers via LDAP - both required in my organisation) then in order to achieve a working oci8 and OpenLDAP setup it is necessary to preload the instant client library in the Apache startup script - e.g.:<br />
<br />
# Setup for Oracle 11 instant client<br />
ORACLE_HOME=/usr/local/oracle/instantclient_11_2<br />
export ORACLE_HOME<br />
#<br />
LD_LIBRARY_PATH=/usr/local/oracle/instantclient_11_2:$LD_LIBRARY_PATH<br />
export LD_LIBRARY_PATH<br />
#<br />
LD_PRELOAD=/usr/local/oracle/instantclient_11_2/libclntsh.so.11.1<br />
export LD_PRELOAD</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104109""></a>
  <div class="note">
   <strong class="user">modir at huanga dot com</strong>
   <a href="#104109" class="date">24-May-2011 12:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you who would like to install this extension on an RedHat/CentOS server. It is actually pretty simple.<br />
<br />
Here is what you have to do:<br />
1) Download the following RPM from Oracle: oracle-instantclient11.2-basiclite-11.2.0.2.0.x86_64.rpm (Version number can be newer and check if you need the 64bit version or not). And then install it on the server.<br />
<br />
2) yum install php-oci8<br />
<br />
3) And as the last step you edit /etc/sysconfig/httpd and write the following line at the end: export LD_LIBRARY_PATH=/usr/lib/oracle/11.2/client64/lib/ (Attention: Path changes depending on the version you have downloaded from the Oracle website.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92683""></a>
  <div class="note">
   <strong class="user">beer at myplace dot now</strong>
   <a href="#92683" class="date">04-Aug-2009 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was experiencing issues with Unicode characters being saved incorrectly to my ORA 10 DB. Issue was tracked to not having a NLS_LANG environment variable specified - set this correctly in the Apache environment and the issue was resolved.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92189""></a>
  <div class="note">
   <strong class="user">benstendahl at hotmail dot com</strong>
   <a href="#92189" class="date">13-Jul-2009 08:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using PHP on an IIS server (Windows Server 2000+):<br />
<br />
After installing the Oracle Instant Client and adding it to the "PATH" Environment Variable, be sure that you also add "Read &amp; Execute" privileges to the Oracle Instant Client directory for the IIS user designated for the site.&nbsp; This is especially necessary if IIS has been hardened using the IIS Lockdown tool (<a href="http://technet.microsoft.com/en-us/library/dd450372(WS.10" rel="nofollow" target="_blank">http://technet.microsoft.com/en-us/library/dd450372(WS.10</a>).aspx) as users must be explicitly granted permissions from the web.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87174""></a>
  <div class="note">
   <strong class="user">nicodenboer (at) yahoo (dot) com</strong>
   <a href="#87174" class="date">22-Nov-2008 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi, I use Oracle Database 10g Express Edition Release
<br />
10.2.0.1.0 on a Linux workstation for dev purposes, along
<br />
with Apache 2 and PHP5. So far I have used it on Kubuntu 8.04.
<br />
To get things working on a recently installed notebook with openSUSE 
<br />
11.0 was a bit more complicated. So I hope someone will be able to 
<br />
benefit from our experiences. Here is our howto:
<br />

<br />
# Use the package manager to install the packages php5-pear and
<br />
php5-dev, if not installed yet.
<br />

<br />
# Download the instantclient_11_1, zip files basic, sdk, sqlplus from the Oracle web site
<br />

<br />
# Switch to user root here, since not all commands to some work sudo
<br />

<br />
# Unzip these files to /opt/oracle/.
<br />
# As a result you will see a dir instantclient_11_1 appearing.
<br />

<br />
ln -s /opt/oracle/instantclient_11_1/libclntsh.so.11.1 \
<br />
&nbsp;&nbsp; /opt/oracle/instantclient_11_1/libclntsh.so&nbsp; 
<br />
ln -s /opt/oracle/instantclient_11_1/libclntsh.so.11.1 \
<br />
&nbsp;&nbsp; /usr/lib/libclntsh.so
<br />
ln -s /opt/oracle/instantclient_11_1/libnnz11.so \
<br />
&nbsp;&nbsp; /usr/lib/libnnz11.so
<br />
ldconfig # to make sure the system will be able to find the libs
<br />

<br />
pecl install oci8 # interactively enter option 1,
<br />
# then instantclient,/opt/oracle/instantclient_11_1,
<br />
# then enter
<br />

<br />
# if needed, add extension=oci8.so to your php.ini
<br />

<br />
/etc/init.d/apache2 reload
<br />

<br />
# finished!
<br />

<br />
Kind regards,
<br />
Nico den Boer</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83747""></a>
  <div class="note">
   <strong class="user">alvaro at demogracia dot com</strong>
   <a href="#83747" class="date">10-Jun-2008 01:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you've followed the instructions and you can't even connect to the DB server, welcome to the Oracle hell. Most of the information you'll find is deprecated, incomplete, not for your platform, unnecessary or just plain wrong.
<br />

<br />
Typically, you won't need at all those complicate setups you'll read about and they'll probably make things harder. I suggest you get Systernal's "Filemon" utility (for Windows, in Unix you may do with strace) and find out what exact config files and DLLs are being tried by php.exe (or httpd.exe if PHP runs as Apache module or...). Pretty often, the issue is that (e.g.) TNSNAMES.ORA does not have the correct line ending or Apache is looking for a DLL that does not even exist in your hard disc; learning that prevents you to waste time adding more and more useless environmental variables.
<br />

<br />
Goog luck.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83323""></a>
  <div class="note">
   <strong class="user">mike at macgirvin.com</strong>
   <a href="#83323" class="date">21-May-2008 03:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some notes to save somebody some grief:
<br />

<br />
Installing the Oracle libraries and access module into an existing PHP5 installation on Debian etch without rebuilding php...
<br />

<br />
First grab the Linux instantclient from oracle.com - you'll also need the client SDK kit. Here I'm using instantclient 11.1
<br />

<br />
create a directory for these such as /home/oracle and unpack both of them to that directory.
<br />

<br />
Go into the oracle directory (and into the instantclient_11_1 directory) and create a symlink:
<br />

<br />
$ ln -s libclntsh.so.11.1 libclntsh.so
<br />

<br />
Grab the oci8 PECL package and unpack it somewhere (~/oci).
<br />

<br />
Make sure you have the following packages (in addition to php5, php5-cli, apache2, etc).
<br />

<br />
&nbsp; php5-dev
<br />

<br />
&nbsp; libaio1
<br />

<br />
&nbsp; php-pear
<br />
&nbsp;
<br />

<br />
Go to the oci8 directory (~/oci/). 
<br />

<br />
You need to run 'pecl build' once to create the configure script. 
<br />

<br />
$pecl build 
<br />

<br />
But the problem is that pecl build will claim the files are installed and they are not. I wasted half a day on this one. Now go into the oci8-1.3.0 directory and build again by hand: 
<br />

<br />
$ cd oci8-1.3.0 
<br />

<br />
$ ./configure --with-oci8=instantclient,/home/oracle/instantclient_11_1 
<br />

<br />
$ make
<br />

<br />
Fix any errors/warnings before continuing
<br />

<br />
Don't make install, which won't work.
<br />

<br />
$ cp ./modules/oci8.so /usr/lib/php5/20060613+lfs
<br />

<br />
Replace 20060613+lfs with whatever module directory has been setup for you in /usr/lib/php5
<br />

<br />
Create /etc/php5/conf.d/oci8.ini:
<br />

<br />
----
<br />

<br />
extension=oci8.so
<br />

<br />
----
<br />

<br />
Now run the php cmdline in verbose mode (php -v) and see if everything loaded. Fix it if it didn't.
<br />

<br />
You may need some env variables setup in your /etc/init.d/apache2 file to make everything work and actually execute queries, but a phpinfo() at this point should show your oci8 extension. See the php.net Oracle pages if you need help with the env variables.
<br />

<br />
Restart the web server
<br />

<br />
$ /etc/init.d/apache2 restart</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79919""></a>
  <div class="note">
   <strong class="user">ashnazg at php dot net</strong>
   <a href="#79919" class="date">19-Dec-2007 07:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do not underestimate the importance of NLS_LANG in your environment.
<br />

<br />
The Oracle error "ORA-03106: fatal two-task communication protocol error" is indicative of not having NLS_LANG set.
<br />

<br />
In my case, I had a successfully processing INSERT statement followed by a failing SELECT statement that was resulting in that ORA-03106 error.&nbsp; The successful INSERT implied that all Oracle environment settings were fine.&nbsp; Ultimately we found that the NLS_LANG was not set, and I have to assume that only the SELECT of data back from the database actually _needed_ it, and therefore it was the SELECT statement that triggered the failure.&nbsp; Though, that is all speculation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74410""></a>
  <div class="note">
   <strong class="user">david dot reynoldsat at ipl dot com</strong>
   <a href="#74410" class="date">10-Apr-2007 04:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a problem loading php_oci8.dll with php 5.2, Apache, and windows XP - a module not loaded error, on every apache restart.
<br />
I eventually found that I had to add the oracle instantclient library path to the %PATH% under SYSTEM and not under USER.&nbsp; Doing that, and then rebooting, fixed the error - as Apache is starting as a service (outside the user setup).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71588""></a>
  <div class="note">
   <strong class="user">jay dot couture at gmail dot com</strong>
   <a href="#71588" class="date">07-Dec-2006 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
# Here's what it took to get it going for me on Red Hat on 
<br />
# x86_32 w/ 10gr2 and php5.1.2
<br />
# I sincerely appreciate all of the other poster's notes. 
<br />
# It was a combination of a few 
<br />
# of them to get mine configured. My note should reflect this:
<br />

<br />
# install the instantclient basic and sdk like this
<br />
# note: the original poster had you install into a lib subdirectory, 
<br />
# but when I tried this it couldn't find the sdk files. So I moved 
<br />
# the files in lib into the parent directory as
<br />
# shown below. Actually I copied them, YMMV
<br />
mkdir -p /usr/lib/oracle/10.2.0.2/client
<br />
unzip -jd /usr/lib/oracle/10.2.0.2/client 
<br />
&nbsp;&nbsp;&nbsp; instantclient-basic-linux-x86-32-10.2.0.2-20060331.zip
<br />
mkdir -p /usr/include/oracle/10.2.0.2/client
<br />
unzip -jd /usr/lib/oracle/10.2.0.2/client 
<br />
&nbsp;&nbsp;&nbsp; instantclient-sdk-linux-x86-32-10.2.0.2-20060331.zip
<br />
ln -s /usr/lib/oracle/10.2.0.2/client/libclntsh.so.10.1 
<br />
&nbsp;&nbsp;&nbsp; /usr/lib/oracle/10.2.0.2/client/libclntsh.so
<br />

<br />
# make the full client use instantclient's files
<br />
cd /app/oracle/product/10.2.0/db_1
<br />
mv lib oldlib
<br />
ln -s /usr/lib/oracle/10.2.0.2/client/lib lib
<br />
ln -s /usr/include/oracle/10.2.0.2/client include
<br />

<br />
#php configure line is: 
<br />
&nbsp;&nbsp;&nbsp; ./configure --with-oci8=instantclient,/usr/lib/oracle/10.2.0.2/client
<br />

<br />
# I had to do this, or the OCI8 would not compile when 
<br />
# I ran make on PHP5.1.2 I did not do this originally when I 
<br />
# had the files in the lib sudirectory (see my note above) so 
<br />
# that may be the true issue.
<br />
export LD_LIBRARY_PATH=/usr/lib/oracle/10.2.0.2/client:$LD_LIBRARY_PATH
<br />

<br />
make
<br />

<br />
make install
<br />

<br />
#In apache2 edit the envvars and add
<br />
LD_LIBRARY_PATH="/usr/local/apache2/lib:
<br />
&nbsp;&nbsp;&nbsp; /usr/lib/oracle/10.2.0.2/client:$LD_LIBRARY_PATH"
<br />
TNS_ADMIN="/usr/lib/oracle/10.2.0.2/client"
<br />
LANG=en_US
<br />
export LD_LIBRARY_PATH LANG TNS_ADMIN
<br />

<br />
#Restart Apache
<br />

<br />
Jay</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66426""></a>
  <div class="note">
   <strong class="user">rainer dot klier at gmx dot at</strong>
   <a href="#66426" class="date">22-May-2006 11:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
estoreic (note from 15-May-2006 10:54) is right.
<br />

<br />
there seems to be a problem with the oci8-api-functions in php 4.4.x.
<br />

<br />
there are error-messages like these in the error_log:
<br />
child pid 22297 exit signal Segmentation fault (11)
<br />
*** glibc detected *** double free or corruption (out): 0x00000000019f4730 ***
<br />
*** glibc detected *** double free or corruption (!prev): 0x0000000001111d90 ***
<br />
*** glibc detected *** corrupted double-linked list: 0x0000000001111d50 ***
<br />

<br />
using php 4.4.x with oracle 10.x is impossible, until you do the following:
<br />
1. download latest oci8-package from <a href="http://pecl.php.net/package/oci8" rel="nofollow" target="_blank">http://pecl.php.net/package/oci8</a>
<br />
2. extract package somewhere
<br />
3. go to php-4.4.x-source directory
<br />
4. rm -rf ext/oci8
<br />
5. cp extraceted oci8-1.2.x directory to/as ext/oci8
<br />
6. make distclean
<br />
7. ./buildconf --force
<br />
8. ./.configure (with the options you need)
<br />
9. make
<br />
10. only for x86_64:
<br />
create pear-install.ini:
<br />
-----------------------------------------------
<br />
[PHP]
<br />

<br />
memory_limit = 128M&nbsp; &nbsp; &nbsp; ; Maximum amount of memory a script may consume (8MB)
<br />
------------------------------------------------
<br />

<br />
11. edit Makefile:
<br />
replace:
<br />
PEAR_INSTALL_FLAGS = -n -dshort_open_tag=0 -dsafe_mode=0
<br />
with:
<br />
PEAR_INSTALL_FLAGS = -cpear-install.ini -dshort_open_tag=0 -dsafe_mode=0
<br />

<br />
12. make install
<br />

<br />
have fun!
<br />
oracle connections will work now!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65361""></a>
  <div class="note">
   <strong class="user">f dot kheiri at ucl dot ac dot uk</strong>
   <a href="#65361" class="date">29-Apr-2006 04:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To compile PHP 4.4.2 with OCI8 / Oracle 9i / AIX 5.2 (64-bit) / GCC
<br />

<br />
PHP will automatically compile against the Oracle 64-bit libraries, which PHP being a 32-bit app, will cause "make" to fail (though it will configure fine). Here's how to avoid this:
<br />

<br />
1. replace your PHP's ext/oci8 directory with the latest ext/oci8 directory downloadable from PECL - then remove the old directory entirely
<br />

<br />
2. rebuild configure by running:
<br />

<br />
./buildconf --force
<br />

<br />
...in PHP's root directory. This will rebuild the configure script.
<br />

<br />
3. using a tool like sed, in your configure file replace all instances of /path/to/oracle/lib with /path/to/oracle/lib32 - note, this may require GNU's autoconf, m4 and gnumake.
<br />

<br />
4. export LD_LIBRARY_PATH=/path/to/oracle/lib32
<br />

<br />
5. ./configure --with-oci-8=/path/to/oracle (and any other options)
<br />

<br />
Then, the usual make and make install.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65165""></a>
  <div class="note">
   
   <a href="#65165" class="date">26-Apr-2006 12:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
# here's what it took to get it going for me on rhel4 on x86_64 w/ 10gr2 and php5.0.5
<br />
# hopefully this will save someone a little grief
<br />
# first you must install the 10.2 full client in /app/oracle/product/10.2.0/db_1
<br />
# follow all the instructions. This part will be a bitch.
<br />

<br />
# install the instantclient basic and sdk like this
<br />
mkdir -p /usr/lib/oracle/10.2.0.2/client/lib
<br />
unzip -jd /usr/lib/oracle/10.2.0.2/client/lib instantclient-basic-linux-x86-64-10.2.0.2-20060228.zip
<br />
mkdir -p /usr/include/oracle/10.2.0.2/client
<br />
unzip -jd /usr/lib/oracle/10.2.0.2/client instantclient-sdk-linux-x86-64-10.2.0.2-20060228.zip
<br />
ln -s /usr/lib/oracle/10.2.0.2/client/lib/libclntsh.so.10.1 /usr/lib/oracle/10.2.0.2/client/lib/libclntsh.so
<br />

<br />
# make the full client use instantclient's files
<br />
cd /app/oracle/product/10.2.0/db_1
<br />
mv lib oldlib
<br />
ln -s /usr/lib/oracle/10.2.0.2/client/lib lib
<br />
ln -s /usr/include/oracle/10.2.0.2/client include
<br />

<br />
php configure line is: --with-oci8=/app/oracle/product/10.2.0/db_1/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62580""></a>
  <div class="note">
   <strong class="user">soef at tjah dot net</strong>
   <a href="#62580" class="date">03-Mar-2006 09:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To install this in gentoo linux you will need to do some weird stuff:
<br />

<br />
-&nbsp; Make sure you have this use flags set: "dba cli pcre xml zlib oci8-instant-client"
<br />
- Unmask PHP (5.1.1) by placing "dev-lang/php ~x86" in /etc/portage/package.keywords
<br />
- Unmask oracle-instantclient-basic (10.2.0.1-r1) by placing "dev-db/oracle-instantclient-basic ~x86"
<br />
- Download oracle files from "<a href="http://otn.oracle.com/software/tech/ oci/instantclient/htdocs/linuxsoft.html" rel="nofollow" target="_blank">http://otn.oracle.com/software/tech/ oci/instantclient/htdocs/linuxsoft.html</a>" (You have to make an account and login, in order to download the packages:
<br />

<br />
&nbsp;&nbsp;&nbsp; * instantclient-basic-linux32-10.2.0.1-20050713.zip
<br />
&nbsp;&nbsp;&nbsp; * instantclient-sdk-linux32-10.2.0.1-20050713.zip
<br />

<br />
- Place the downloaded packages in "/usr/portage/distfiles"
<br />
- "emerge apache dev-lang/php5" (If you done right, the build for the instantclient will be selected automaticly.
<br />
- Configure your "/etc/conf.d/apache2" to make sure you have "-D PHP5" in your "APACHE_OPTS"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58181""></a>
  <div class="note">
   <strong class="user">scoop at subindie dot com</strong>
   <a href="#58181" class="date">26-Oct-2005 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding compiling with the recently updated OCI8 Extension (<a href="http://pecl.php.net/package/oci8" rel="nofollow" target="_blank">http://pecl.php.net/package/oci8</a>).
<br />

<br />
I ran into problems when statically compiling, such as numerous "undefined reference to `zif_oci_***'" errors.&nbsp; Since I likely won't be the only one to run into this problem, here's some helpful hints:
<br />

<br />
If you've previously compiled your php installation, first: make clean
<br />

<br />
Then replace the existing php-x.x.x/ext/oci8 directory with the latest package from: <a href="http://pecl.php.net/package/oci8" rel="nofollow" target="_blank">http://pecl.php.net/package/oci8</a>
<br />

<br />
./buildconf --force
<br />
./config ..
<br />
make</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54508""></a>
  <div class="note">
   <strong class="user">ben at onshop dot co dot uk</strong>
   <a href="#54508" class="date">06-Jul-2005 05:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I spent ages trying work out why I was getting the following message when when using ocilogon() on Windows 2000 using PHP 4 and 5:
<br />

<br />
ORA-03106 Fatal two-task communication protocol error
<br />

<br />
This problem is occurs when PHP cannot find ORACLE client environmental variables.
<br />

<br />
The environmental variables can be set in several ways:
<br />

<br />
1. Within the root 'Directory' directive on Apache httpd.conf:
<br />

<br />
&lt;Directory "d:/path/to/webroot"&gt;
<br />
&nbsp; SetEnv ORACLE_BASE "c:/oracle"
<br />
&nbsp; SetEnv ORACLE_HOME "c:/oracle/ora81"
<br />
&nbsp; SetEnv NLS_LANG "american_america.WE8DEC"
<br />
&nbsp; SetEnv NLS_CHARACTERSET "WE8DEC"
<br />
&nbsp; SetEnv NLS_NCHAR_CHARACTERSET "AL16UTF16"
<br />
&lt;/Directory&gt;
<br />

<br />
or
<br />

<br />
2. Within Windows:
<br />

<br />
Go to the Control Panel&gt;System&gt;Advanced&gt;Environmental Variables
<br />

<br />
Then enter a name value/pair for each of the variables.
<br />

<br />
3. Using putenv() statements in the PHP file prior to using ocilogon(). This is not ideal because the statements are required evertime you wish to connect to Oracle.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53712""></a>
  <div class="note">
   <strong class="user">denis dot delamarre at chu-rennes dot fr</strong>
   <a href="#53712" class="date">10-Jun-2005 07:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
php5 + Apache 2 + solaris 2.10 + oracle9i (64bits)
<br />

<br />
'./configure' '--with-oracle=/prod/dba/oraeve/ora9i' '--with-apxs2=/usr/local/apache2/bin/apxs' '--with-zlib' '--with-gd' '--without-mysql' '--with-oci8=/prod/dba/oraeve/ora9i' 
<br />

<br />
fail with :
<br />
ld: fatal : fichier libclntsh.so : wrong elf class : ELFCLASS64 
<br />

<br />
the solution is between ./configure and make command to edit Makefile and replace /ora9i/lib&nbsp; with&nbsp; /ora9i/lib32
<br />

<br />
all it's ok</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53595""></a>
  <div class="note">
   <strong class="user">MSapp</strong>
   <a href="#53595" class="date">07-Jun-2005 03:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Problems compiling 5.0.4 with Oracle Instant Client 10? (i.e. cannot find -lirc)
<br />

<br />
Remove the "-lirc" from sdk/demo/sysliblist and rerun configure.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52942""></a>
  <div class="note">
   <strong class="user">tof</strong>
   <a href="#52942" class="date">18-May-2005 02:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want the change NLS_LANG (e.g.:&nbsp; NLS_LANG="FRENCH_FRANCE.WE8ISO8859P1") don't forget to also set LC_ALL and LANG (e.g.: LC_ALL=french and LANG=french) else you'll have a ORA-01756 when you try to call ocilogon.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50278""></a>
  <div class="note">
   <strong class="user">kucerar at hhmi dot org</strong>
   <a href="#50278" class="date">23-Feb-2005 05:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Great Solaris patch!&nbsp; Finally built.&nbsp; Here's some tips on connecting:
<br />

<br />
Just made this on solaris8 32bit, actually works.
<br />

<br />
1) put everything in one directory
<br />
2) unsetenv ORACLE_HOME
<br />
3) set the env vars LD_LIBRARY_PATH and SQLPATH and TNS_ADMIN(if you have it) to that directory.
<br />
4) use one of the other easy connection notations here
<br />

<br />
<a href="http://www.oracle.com/technology/" rel="nofollow" target="_blank">http://www.oracle.com/technology/</a>
<br />
docs/tech/sql_plus/10102/readme_ic.htm
<br />

<br />
These env vars worked when put at the top of apachectl script as well.
<br />

<br />
To build you may have to fake it out with an ORACLE_HOME var,&nbsp; but unset it later.&nbsp; You may also have to fake out the build by putting header files where it is looking for them,&nbsp; e.g. in the rdbms/demo directory or some such other place.
<br />

<br />
When running though,&nbsp; make sure you have only the files required in only one directory.
<br />

<br />
Oracle has not put up a link to the 32bit solaris sqlplus--you have to guess it--it's there though:
<br />

<br />
<a href="http://download.oracle.com/otn/solaris/instantclient/" rel="nofollow" target="_blank">http://download.oracle.com/otn/solaris/instantclient/</a>
<br />
instantclient-sqlplus-solaris32-10.1.0.3.zip
<br />
&nbsp; 
<br />
...and don't forget to add ".world" on to the end of your SID. It's very common to have to specify DBNAME.WORLD to connect.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49588""></a>
  <div class="note">
   <strong class="user">buswash at gmail dot com</strong>
   <a href="#49588" class="date">02-Feb-2005 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 5.0.3 + Solaris 9 (UltraSPARC) + Apache 2.0.51 + Oracle 10g Instant Client 10.1.0.3
<br />

<br />
Thanks to Jakob's patch I got this combination working.&nbsp; Here are some things that helped me:
<br />

<br />
1. After getting this:
<br />
ld: fatal: file /opt/oracle/instantclient/libclntsh.so: wrong ELF class: ELFCLASS64
<br />

<br />
I realized that PHP is a 32-bit application and that all 3rd-party libraries need to be 32-bit as well.&nbsp; You need to download the 32-bit version of Instant Client (basic + sdk), even if you are running the 64-bit Solaris OS.
<br />

<br />
2. My patch command syntax was a little different:
<br />
patch -p0 -i php5_ociclient.patch config.m4
<br />

<br />
Thanks again to Jakob for porting the patch over to PHP 5.
<br />

<br />
Marc</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44574""></a>
  <div class="note">
   <strong class="user">Mark at catalyst dot net dot nzed</strong>
   <a href="#44574" class="date">10-Aug-2004 05:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ReCompiling PHP4 to have oracle 8 support (oci8) on Debian Linux, using the Oracle 10g client libraries. Log in as root.
<br />

<br />
PACKAGES REQUIRED:
<br />
php4-dev
<br />
php4 (source files)
<br />
php4 module (might not be required, but it's what i had installed at the time)
<br />

<br />
OTHER PACKAGE REQUIREMENTS:
<br />
Oracle Client Libraries (i used Oracle 10g Server, but you should be able to use, as has been previously said, any set of the oracle client libraries from 8i onwards). 
<br />
* make sure this is installed before recompiling php4.
<br />

<br />
ENVIRONMENT REQUIREMENTS:
<br />
- export ORACLE_HOME=[where u installed the oracle client]
<br />
- export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ORACLE_HOME/lib
<br />
- export LD_PRELOAD=libclntsh.so.10.1 (the version number at the end will correspond to the oracle version you previously installed. in my case, 10g is 10.1).
<br />
- vi /etc/ld.so.conf and add $ORACLE_HOME/lib to the list of paths. 
<br />
then * run ldconfig to reload those changes to the system * (p.s. make sure it's the full path, and not using any environment variables. e.g. /u01/app/oracle/product/10gRDBMS is my ORACLE_HOME).
<br />

<br />
STEPS:
<br />
- cd /usr/src/[PHP4 Version]
<br />
in my case, [PHP4 Version] = php4-4.3.8, so path was
<br />
/usr/src/php4-4.3.8
<br />

<br />
- vi debian/rules
<br />
these are the default compilation rules for php4. Find section labeled COMMON_CONFIG = [...] and add --with-oci8 (it should be near the top of the file).
<br />

<br />
- debchange -i (allows you to edit the change log for the versions of php. btw - you should be in the php4 source code directory). give the version id something obviously unique. don't forget to add a comment.
<br />

<br />
when all is in readyness, then you should be able to go debian/rules binary to build the debian packages required.
<br />
the deb packages are built into the /usr/src directory. and depending on the default compilation options u choose, there should be a few. find the deb package that corresponds to the main php4 module (php4_4.3.8-4.mark.1_i386.deb for me), and run dpkg -i [package name] to install it.
<br />

<br />
- vi /etc/init.d/apache and add exports for $ORACLE_HOME, $LD_PRELOAD and $LD_LIBRARY_PATH
<br />

<br />
* don't forget to restart apache /etc/init.d/apache to reload the php4 module. *
<br />

<br />
IF YOU GET... :
<br />
if you get an error saying something about apache cannot load libclntsh.so.10.1, file not found, check the environment variables, for both the user, and in /etc/init.d/apache and also check ld.so.conf to make sure the $ORACLE_HOME/lib path is in there, and has been reloaded (with ldconfig).
<br />

<br />
editing ld.so.conf was the part that finally got it working for me.
<br />
as you should be able to tell, the steps are pretty much the same as for all oracle versions 8i onwards, and all linux OS's. but with a few debian specific paths and commands thrown in.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44468""></a>
  <div class="note">
   <strong class="user">neogodo at yahoo dot com dot br</strong>
   <a href="#44468" class="date">07-Aug-2004 03:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hey guys!!!!
<br />

<br />
&nbsp;I have all these problems and when are solved a php show this:
<br />

<br />
_oci_server ORA-12159:connection text especified is too long
<br />

<br />
It's simple!!!
<br />

<br />
&nbsp; In the TNSNAMES.ORA remove all space, tab, carriage return on the conection string and, wallah!!! All work fine!!!
<br />

<br />
&nbsp; More info:
<br />

<br />
&nbsp;&nbsp; PHP 5.0.0&nbsp; with Oci8
<br />
&nbsp;&nbsp; Apache 1.3
<br />

<br />
Regards,
<br />
Romolo (neogodo@yahoo.com.br).
<br />
DBA Oracle
<br />
Brazil - SP - Sao Paulo</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43824""></a>
  <div class="note">
   <strong class="user">mark at magpies dot net</strong>
   <a href="#43824" class="date">05-Jul-2004 06:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those trying to use the Oracle Instant Client 10g in a win32 environment, heres a nice easy howto. If you fully read the docs properly and understand what your reading you will be able to set it up, but if like me you want a quick easy fix, heres how I did it.
<br />

<br />
1. Download and install the Oracle Instant Client to where ever (lets say&nbsp; c:\ora\client&nbsp; )
<br />
2. Add your connect info, copy a previously created or provided tnsnames.ora file to the above directory.
<br />
3. Change Path in the Environment Variables area to add this directory to the path. ie.&nbsp; c:\ora\client;%SystemRoot%;&lt;and so on&gt;
<br />
4. Open regedit and add a Key called ORACLE to HKEY_LOCAL_MACHINE\SOFTWARE
<br />
5. To the ORACLE key add a string value called TNS_ADMIN and assign it the directory above (ie. c:\ora\client )&nbsp; So you end up with KEY_LOCAL_MACHINE\SOFTWARE\ORACLE\TNS_ADMIN = c:\ora\client
<br />
6. Set php to use Oci8 extension and bobs your uncle
<br />
7. Reboot.
<br />

<br />
Option 7 was required as the oci8 extension or php wouldn't pick up the path change. Also my problem was how to use other programs like sqlplus without creating extra Environment Variables etc the TNS_ADMIN / tnsnames.ora part makes that simpler and allows you to call things the same as you would before.
<br />

<br />
PS: This should apply to all the Instant Clients. I haven't tried it with any others but 10g though.
<br />

<br />
Hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43737""></a>
  <div class="note">
   <strong class="user">ed000001 at hotmail dot com</strong>
   <a href="#43737" class="date">02-Jul-2004 12:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get your connectivity working with putenv on ORACLE_SID and ORACLE_HOME, but you do not want to use putenv because you want safemode on. You will need to pass these from your environment variables.&nbsp; Somehow setenv in httpd.conf did not do the trick for me... the values are set but the connectivity does not work.&nbsp; Then you will need to set the environment in your /etc/init.d/apachectl or /etc/profile and use a "PassEnv ORACLE_HOME ORACLE_SID" directive in httpd.conf so that these variables are picked up by php.
<br />

<br />
However, when you suexec in Apache 2.0, the server will only allow you to pass a given set of variables which are defined in the apache source code in the file apache-dir/support/suexec.c
<br />

<br />
In order to pass ORACLE_SID and ORACLE_HOME to PHP you need to add these to that file.&nbsp; The relevant changed piece of code where I added "ORACLE_" looks something like this:
<br />

<br />
char *safe_env_lst[] =
<br />
{
<br />
&nbsp;&nbsp;&nbsp; /* variable name starts with */
<br />
&nbsp;&nbsp;&nbsp; "HTTP_",
<br />
&nbsp;&nbsp;&nbsp; "SSL_",
<br />
&nbsp;&nbsp;&nbsp; "ORACLE_",
<br />

<br />
&nbsp;&nbsp;&nbsp; /* variable name is */
<br />
...
<br />

<br />
You will have to do a "make clean", "./configure", "make", "make install".&nbsp; Do not forget to do the "make clean" or the apache changes will not be picked up.
<br />

<br />
Here is a nice php test script :)
<br />

<br />
<span class="default">&lt;?php </span><span class="comment">// test-oracle.php
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">dump_array</span><span class="keyword">(</span><span class="default">$a_value</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$a_value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ( </span><span class="default">$s_str </span><span class="keyword">= </span><span class="string">'' </span><span class="keyword">; list(</span><span class="default">$s_key</span><span class="keyword">, </span><span class="default">$x_value</span><span class="keyword">) = </span><span class="default">each</span><span class="keyword">(</span><span class="default">$a_value</span><span class="keyword">) ;&nbsp; )
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s_str </span><span class="keyword">.= </span><span class="string">"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;"</span><span class="keyword">.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;span style=\"color:green\"&gt;[&lt;/span&gt;</span><span class="default">$s_key</span><span class="string">&lt;span style=\"color:green\"&gt;]&lt;/span&gt; = "</span><span class="keyword">.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"&lt;span style=\"color:red\"&gt;[&lt;/span&gt;</span><span class="default">$x_value</span><span class="string">&lt;span style=\"color:red\"&gt;]&lt;/span&gt;&lt;br /&gt;"</span><span class="keyword">; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$a_value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">$s_str</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
</span><span class="comment">#putenv("ORACLE_SID=ORTD");
<br />
#putenv("ORACLE_HOME=/u01/app/oracle/product/9.2.0.1.0");
<br />
</span><span class="default">$ORACLE_SID </span><span class="keyword">= </span><span class="default">getenv</span><span class="keyword">(</span><span class="string">"ORACLE_SID"</span><span class="keyword">);
<br />
</span><span class="default">$ORACLE_HOME </span><span class="keyword">= </span><span class="default">getenv</span><span class="keyword">(</span><span class="string">"ORACLE_HOME"</span><span class="keyword">);
<br />
echo </span><span class="string">"ORACLE_SID = </span><span class="default">$ORACLE_SID</span><span class="string">&lt;br&gt;"</span><span class="keyword">;
<br />
echo </span><span class="string">"ORACLE_HOME = </span><span class="default">$ORACLE_HOME</span><span class="string">&lt;br&gt;"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cn </span><span class="keyword">= </span><span class="default">ociplogon</span><span class="keyword">(</span><span class="string">'scott'</span><span class="keyword">, </span><span class="string">'tiger'</span><span class="keyword">);
<br />
echo </span><span class="string">"cn = </span><span class="default">$cn</span><span class="string">&lt;br /&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$st </span><span class="keyword">= </span><span class="default">ociparse</span><span class="keyword">(</span><span class="default">$cn</span><span class="keyword">, </span><span class="string">"select tname from tab"</span><span class="keyword">);
<br />
echo </span><span class="string">"st = </span><span class="default">$st</span><span class="string">&lt;br /&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ex </span><span class="keyword">= </span><span class="default">ociexecute</span><span class="keyword">(</span><span class="default">$st</span><span class="keyword">,</span><span class="default">OCI_COMMIT_ON_SUCCESS</span><span class="keyword">);
<br />
echo </span><span class="string">"ex = </span><span class="default">$ex</span><span class="string">&lt;br /&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mr </span><span class="keyword">= </span><span class="default">ocifetchinto</span><span class="keyword">(</span><span class="default">$st</span><span class="keyword">,</span><span class="default">$xx</span><span class="keyword">,</span><span class="default">OCI_ASSOC</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; while ( </span><span class="default">$mr </span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">dump_array</span><span class="keyword">(</span><span class="default">$xx</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mr </span><span class="keyword">= </span><span class="default">ocifetchinto</span><span class="keyword">(</span><span class="default">$st</span><span class="keyword">,</span><span class="default">$xx</span><span class="keyword">,</span><span class="default">OCI_ASSOC</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fr </span><span class="keyword">= </span><span class="default">ocifreestatement</span><span class="keyword">(</span><span class="default">$st</span><span class="keyword">);
<br />
echo </span><span class="string">"fr = </span><span class="default">$fr</span><span class="string">&lt;br /&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ocicommit</span><span class="keyword">(</span><span class="default">$cn</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ocilogoff</span><span class="keyword">(</span><span class="default">$cn</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40178""></a>
  <div class="note">
   <strong class="user">oddbec_no_more_spam_kthx at online dot no</strong>
   <a href="#40178" class="date">24-Feb-2004 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had trouble with norwegian characters using oracle 8.7.1 / php 4something and Apache 2.
<br />

<br />
The only trouble was that '?' appeared instead of the norwegian characters.
<br />

<br />
The solution to it all was to add this to the apachectl script:
<br />

<br />
export NLS_LANG="norwegian_norway.WE8ISO8859P1"
<br />
export ORACLE_BASE="/home/oracle"
<br />
export ORA_NLS33="/home/oracle/ocommon/nls/admin/data"
<br />
export ORACLE_TERM="ansi"
<br />
export ORACLE_HOME="/home/oracle"
<br />
export LANG="no_NO"
<br />

<br />
I'm not sure if all of these are necessary, but I took no change, and it works now :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38349""></a>
  <div class="note">
   <strong class="user">lffranco *at* dco dot pemex dot com</strong>
   <a href="#38349" class="date">17-Dec-2003 09:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This took me a lot of time to solve, so I'm placing it here for my future reference, and for somebody who finds it useful. I don't know if it will work on your environment, this is what I have:
<br />

<br />
* Windoze Advanced Server 2003
<br />
* IIS 6
<br />
* Oracle 8.1.7
<br />

<br />
So how I configured the whole thing? First do whatever the standard PHP configuration says... it won't work, anyway... but it will help. I installed PHP on C:\PHP; Oracle Home is in E:\Oracle\ora817.
<br />

<br />
* Install Oracle 8 client. NOTE: You must use an Oracle 8 client, I used an Oracle 9 client and for some reason (dll binding I guess), it didn't work
<br />

<br />
* Copy $ORACLE_HOME/bin/cli.dll into $WINDOWS/System32
<br />

<br />
* Modify your SQLNET.ORA file and change the line:
<br />
[code]
<br />
SQLNET.AUTHENTICATION_SERVICES= (NTS) 
<br />
[/code]
<br />

<br />
by this one:
<br />

<br />
[code]
<br />
SQLNET.AUTHENTICATION_SERVICES= (NONE) 
<br />
[/code]
<br />

<br />
I dunno WTF NTS is, so if somebody sends me an eMail and explain, I'll be thankful. But if you don't do this you'll get an ORA-12560 error.
<br />

<br />
And that's it for Oracle. Now, the IIS configuration:
<br />

<br />
* Open your IIS Administrator and "Web Service Extensions", add a new extension as follows:
<br />
** Extension Name: PHP
<br />
** Required Files (ADD): C:\php\extensions\php_oci8.dll; c:\php\sapi\php4isapi.dll; c:\WINDOWS\system32\oci.dll
<br />
** Check "Set Extension Status as Allowed"
<br />

<br />
Now you can use your ocli* functions, or better yet, use PEAR::DB functions which was my ultimate goal, with PEAR::DB you can forget about declaring ORACLE_HOME, ORACLE_SID and all that kind of things. Just use:
<br />

<br />
<span class="default">&lt;?php
<br />
$dsn </span><span class="keyword">= </span><span class="string">"oci8://scott:tiger@example"
<br />
</span><span class="default">$db </span><span class="keyword">= </span><span class="default">DB</span><span class="keyword">::</span><span class="default">Connect</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37470""></a>
  <div class="note">
   <strong class="user">aleigh at tessier dot com</strong>
   <a href="#37470" class="date">17-Nov-2003 12:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: ocilogon(): _oci_open_session: OCIHandleAlloc OCI_HTYPE_SVCCTX: OCI_INVALID_HANDLE can also be caused by running the webserver with an ORACLE_HOME of a (radically?) different version than PHP was linked against. 
<br />

<br />
I experienced this when I accidently used an Oracle 8 ORACLE_HOME for a PHP that was linked against Oracle 9.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36808""></a>
  <div class="note">
   <strong class="user">aliquis at die dot spammers dot die dot link-net dot org</strong>
   <a href="#36808" class="date">23-Oct-2003 03:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've had all kinds of errors with RedHat9(yuck), PHP 4.3.4RC1 and Oracle enterprice server 9.2. For some time I thought that --with-oci8 wouldn't work with Oracle9 but that wasn't the case, the solution was many steps.
<br />

<br />
1) install oracle, might require some tricks, on RedHat9 I had to put this in my .bashrc:
<br />
export ORACLE_BASE=/opt/ora9
<br />
export ORACLE_HOME=$ORACLE_BASE/product/9.2
<br />
export PATH=$ORACLE_HOME/bin:$PATH
<br />
export ORACLE_OWNER=oracle
<br />
export ORACLE_SID=netadmdb
<br />
export ORACLE_TERM=vt100
<br />
export LD_ASSUME_KERNEL=2.4.1
<br />
export THREADS_FLAG=native
<br />
export LD_LIBRARY_PATH=$ORACLE_BASE/product/9.2/lib:$LD_LIBRARY_PATH
<br />

<br />
2) compile php, use --with-oci8
<br />

<br />
3) Make an init-script for the oracle9 database server, as default the TNS listener doesn't run so add that on aswell, example:
<br />
#!/bin/bash
<br />
export ORACLE_HOME=/opt/ora9/product/9.2
<br />
export PATH=$ORACLE_HOME/bin:$PATH
<br />
export ORACLE_SID=netadmdb
<br />
export DISPLAY=:0
<br />
oracle_user=oracle
<br />
export oracle_user
<br />
case $1 in
<br />
start)
<br />
su - "$oracle_user"&lt;&lt;EOO
<br />
sqlplus /nolog&lt;&lt;EOS
<br />
connect / as sysdba
<br />
startup
<br />
EOS
<br />
/opt/ora9/product/9.2/bin/lsnrctl start
<br />
EOO
<br />
;;
<br />
stop)
<br />
su - "$oracle_user"&lt;&lt;EOO
<br />
/opt/ora9/product/9.2/bin/lsnrctl stop
<br />
sqlplus /nolog&lt;&lt;EOS
<br />
connect / as sysdba
<br />
shutdown immediate
<br />
EOS
<br />
EOO
<br />
;;
<br />
*)
<br />
echo "Usage: ora9 [start|stop]"
<br />
;;
<br />
esac
<br />

<br />
4) Configure Apache. For some reason it requires some tweaking with environment variables, in the begining I put those in the PHP-script with putenv, later in the httpd.conf with SetEnv and the mod_env module. But I was told to not do that and instead set them in the init script for Apache. So I copied apachectl to /etc/init.d and edited envvars in $APACHE_PATH/bin. First I added all kinds of env variables until I got it to work, and then I removed them one at a time and came to the following minimal configuration:
<br />
LD_LIBRARY_PATH="/usr/local/apache2/lib:$LD_LIBRARY_PATH"
<br />
ORACLE_HOME=/opt/ora9/product/9.2
<br />
LANG=sv_SE
<br />
export LD_LIBRARY_PATH ORACLE_HOME LANG
<br />

<br />
Earlier I had added NLS_LANG and TNS_ADMIN above those mentioned above (point 1), but it seems those aren't needed really. So no need for TWO_TASK or ORACLE_SID, only needed one is ORACLE_HOME and if you get missing/invalid option for your OCILogon set LANG to something else like I did. Someone earlier said it might have to do with UTF8.
<br />

<br />
So if you are sure lsncrtl are started and that you have the correct env-variables set in your $APACHE_PATH/bin/envvars you can just use something like:
<br />

<br />
$iDBConn=OCILogon("user","pass","netadmdb");
<br />

<br />
in your PHP-script and it should work.
<br />
Hope this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="34405""></a>
  <div class="note">
   <strong class="user">lomax at arizona edu</strong>
   <a href="#34405" class="date">26-Jul-2003 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Can't compile php with Oracle 9i and apache on Solaris8?
<br />
Sun 280R
<br />

<br />
Using some of the tips below I had to add this:
<br />
(static build)
<br />

<br />
#!/bin/tcsh
<br />
setenv LDFLAGS -L$ORACLE_HOME/lib32
<br />

<br />
cd php-4.x.x/
<br />
./configure --with-oci8=$ORACLE_HOME --with-apache=/path/to/apache_src ..etc
<br />
make
<br />
make intsall
<br />

<br />
cd apache_src
<br />
(make sure environment variable is still set)
<br />
./configure&nbsp; "--prefix=/usr/apache" "--enable-module=so" \
<br />
"--activate-module=src/modules/php4/libphp4.a"&nbsp; ...etc
<br />
make 
<br />
make install
<br />

<br />
Having the gcc compilier build php against oracle 32 bit libraries was the key, but without setting LDFLAGS the compiler defaults to using the 64-bit oracle libraries which cause the famous 
<br />
"...wrong ELF class: ELFCLASS64.." on startup.
<br />

<br />
The only diffenece here was I didn't have to do play musical directories for it to work. The below post was instrumental in helping me to get this fixed. Thanks to "lore_giver at lycos dot co dot uk"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32410""></a>
  <div class="note">
   <strong class="user">NOSPAMPLZ!esartoni at omniaglobal dot net</strong>
   <a href="#32410" class="date">27-May-2003 12:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a little problem with ocilogon but only with RedHat 8.0. It always returned some kind of error during connection like 'OCISessionBegin - ... invalid character', or 'OCISessionBegin - ... missing or invalid option in ...'
<br />

<br />
I have finally found what is this problem! You have to change your LANG enviroment variable disabling UTF-8. Example: LANG=en_US.UTF-8 should become LANG=en_US.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32212""></a>
  <div class="note">
   <strong class="user">lore_giver at lycos dot co dot uk</strong>
   <a href="#32212" class="date">20-May-2003 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running Oracle 9i on a 
<br />
Solaris 9 (64 bit) platform with a Sun Server E250:
<br />
Apache version 1.3.27
<br />
PHP version 4.3.1
<br />

<br />
I was first getting "...wrong ELF class: ELFCLASS64.."
<br />
while doing a ./configure with the --with-oci8 and --with-oracle parameters.
<br />

<br />
After some unsuccessfull searched I renamed the $ORACLE_HOME/lib to $ORACLE_HOME/lib.org and then renamed the
<br />
$ORACLE_HOME/lib32 to $ORACLE_HOME/lib
<br />

<br />
Thereafter it went passed this config, but now failed on 
<br />
not being able to find a libwtc9.so file which was in the
<br />
$ORACLE_HOME/lib directory&nbsp; (this message was displayed in the debug.log in the php source directory).
<br />

<br />
After setting the Environment variable:
<br />
LD_LIBRARY_PATH=$ORACLE_HOME/lib
<br />
I was able to compile without any errors and 'make' and 'make install' ran smoothly.
<br />

<br />
I only had to add the php type in the httpd.conf (in your apache conf directory eg. /usr/local/apache/conf)..
<br />
AddType application/x-httpd-php .php
<br />
to get the php to work again...
<br />

<br />
I had to then reverse the $ORACLE_HOME/lib swop on top since php was now having problems with the 32 bit version of the library...so switched it back to 64 and my php script worked....
<br />

<br />
Hope this helps some out there with similar problems..
<br />

<br />
Cheers</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27519""></a>
  <div class="note">
   
   <a href="#27519" class="date">09-Dec-2002 10:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Configuring/Compiling PHP as a DSO with Oracle support from source on a Sun Solaris 8 box.&nbsp; We had already installed Oracle 9.2.0 client tools.
<br />

<br />
1. Make sure the following tools are installed
<br />

<br />
&nbsp;&nbsp;&nbsp; autoconf
<br />
&nbsp;&nbsp;&nbsp; automake
<br />
&nbsp;&nbsp;&nbsp; bison
<br />
&nbsp;&nbsp;&nbsp; flex
<br />
&nbsp;&nbsp;&nbsp; gcc
<br />
&nbsp;&nbsp;&nbsp; make
<br />
&nbsp;&nbsp;&nbsp; gzip
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; They can be downloaded from <a href="http://www.sunfreeware.com." rel="nofollow" target="_blank">http://www.sunfreeware.com.</a>
<br />
&nbsp;&nbsp;&nbsp; 
<br />
2.&nbsp; Make sure Apache is installed with DSO support.&nbsp; We ran the Apache configure/compile like so:
<br />

<br />
&nbsp;&nbsp;&nbsp; LIBS=-lpthread ./configure \
<br />
&nbsp;&nbsp;&nbsp; --prefix=/usr/local/apache \
<br />
&nbsp;&nbsp;&nbsp; --enable-module=most \
<br />
&nbsp;&nbsp;&nbsp; --enable-shared=max
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; make
<br />
&nbsp;&nbsp;&nbsp; make install
<br />
&nbsp;&nbsp;&nbsp; 
<br />
3.&nbsp; If you haven't already, install the Oracle client tools.
<br />
4.&nbsp; Make sure the following environment variables are set correctly and are accessible by all users.&nbsp; We set them in /etc/profile.
<br />

<br />
&nbsp;&nbsp;&nbsp; ORACLE_HOME
<br />
&nbsp;&nbsp;&nbsp; ORACLE_BASE
<br />
&nbsp;&nbsp;&nbsp; NLS_LANG
<br />
&nbsp;&nbsp;&nbsp; ORA_NLS33
<br />
&nbsp;&nbsp;&nbsp; ORACLE_TERM
<br />
&nbsp;&nbsp;&nbsp; LD_LIBRARY_PATH
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; (technically, only $ORACLE_HOME is required, but you'll want to set the rest in order to make sure things run smoothly afterward)
<br />
&nbsp;&nbsp;&nbsp; 
<br />
5.&nbsp; Make sure '/usr/ccs/bin' is in your path.&nbsp; If not, add it.
<br />
6.&nbsp; Unpack PHP source (php-4.2.3):
<br />

<br />
&nbsp;&nbsp;&nbsp; gunzip php-4.2.3.tar.gz
<br />
&nbsp;&nbsp;&nbsp; tar xvf php-4.2.3.tar
<br />
&nbsp;&nbsp;&nbsp; cd php-4.2.3
<br />

<br />
&nbsp;&nbsp;&nbsp; 
<br />
7.&nbsp; Run PHP configure like so :
<br />

<br />
&nbsp;&nbsp;&nbsp; CC=gcc ./configure --with-apxs=/usr/local/apache/bin/apxs \
<br />
&nbsp;&nbsp;&nbsp; --with-config-file-path=/etc \
<br />
&nbsp;&nbsp;&nbsp; --with-mysql \
<br />
&nbsp;&nbsp;&nbsp; --enable-ftp \
<br />
&nbsp;&nbsp;&nbsp; --with-oci8=/path/to/ORACLE_HOME \
<br />
&nbsp;&nbsp;&nbsp; --with-oracle=/path/to/ORACLE_HOME \
<br />
&nbsp;&nbsp;&nbsp; --enable-sigchild
<br />
&nbsp;&nbsp;&nbsp; 
<br />
8.&nbsp; Run make:&nbsp; make
<br />
9.&nbsp; Run this as root:&nbsp; make install
<br />
10.&nbsp; Change the LoadModule line in httpd.conf to include the fully qualified path.&nbsp; For us:
<br />

<br />
&nbsp;&nbsp;&nbsp; LoadModule php4_module&nbsp; &nbsp; &nbsp; &nbsp; /usr/local/apache/libexec/libphp4.so
<br />
&nbsp;&nbsp;&nbsp; 
<br />
11.&nbsp; Make sure the PHP files types are recognized in your httpd.conf file:
<br />

<br />
&nbsp;&nbsp;&nbsp; AddType application/x-httpd-php .php
<br />
&nbsp;&nbsp;&nbsp; AddType application/x-httpd-php-source .phps
<br />
&nbsp;&nbsp;&nbsp; 
<br />
12.&nbsp; Test the configuration:
<br />

<br />
&nbsp;&nbsp;&nbsp; /usr/local/apache/bin/apachectl configtest
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; It should return "Syntax OK"
<br />
&nbsp;&nbsp;&nbsp; 
<br />
13.&nbsp; Bounce Apache:
<br />

<br />
&nbsp;&nbsp;&nbsp; /usr/local/apache/bin/apachectl restart
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
14.&nbsp; Here's a simple PHP script to test the setup.&nbsp; If you don't have access to the default tables Oracle provides, change the connections/tablenames/fields to match your setup:
<br />

<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php
<br />

<br />
&nbsp;&nbsp;&nbsp; $db_conn </span><span class="keyword">= </span><span class="default">ocilogon</span><span class="keyword">(</span><span class="string">"scott"</span><span class="keyword">, </span><span class="string">"tiger"</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cmdstr </span><span class="keyword">= </span><span class="string">"select ename, sal from emp"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$parsed </span><span class="keyword">= </span><span class="default">ociparse</span><span class="keyword">(</span><span class="default">$db_conn</span><span class="keyword">, </span><span class="default">$cmdstr</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ociexecute</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nrows </span><span class="keyword">= </span><span class="default">ocifetchstatement</span><span class="keyword">(</span><span class="default">$parsed</span><span class="keyword">, </span><span class="default">$results</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Found: </span><span class="default">$nrows</span><span class="string"> results&lt;br&gt;&lt;br&gt;\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;table border=1 cellspacing='0' width='50%'&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;td&gt;&lt;b&gt;Name&lt;/b&gt;&lt;/td&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;td&gt;&lt;b&gt;Salary&lt;/b&gt;&lt;/td&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;/tr&gt;\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$nrows</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ ) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;tr&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;td&gt;" </span><span class="keyword">. </span><span class="default">$results</span><span class="keyword">[</span><span class="string">"ENAME"</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">] . </span><span class="string">"&lt;/td&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;td&gt;$ " </span><span class="keyword">. </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$results</span><span class="keyword">[</span><span class="string">"SAL"</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">], </span><span class="default">2</span><span class="keyword">). </span><span class="string">"&lt;/td&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;/tr&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;/table&gt;\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27032""></a>
  <div class="note">
   <strong class="user">john at john-warner dot com</strong>
   <a href="#27032" class="date">21-Nov-2002 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In addition to the earlier posts here is a further explaination;
<br />

<br />
Problem: Regular and Remote authentication does not work using Windows 2000 + PHP and Oracle 8i, 9i.
<br />

<br />
Secondary Issue if using Oracle 9.2.0.1
<br />
&nbsp;&nbsp; &nbsp; When using Oracle 9.2.0.1 the Error structure returned by Oracle is different than expected by PHP. As a result there will be no legible error message other than the following;
<br />
&nbsp;&nbsp; &nbsp; Warning: _oci_open_server: in ...
<br />

<br />
Using Oracle 9.0.1.1 the error message returned is any of the following depending on your situation;
<br />
&nbsp;&nbsp; &nbsp; 
<br />
Warning: _oci_open_server: ORA-12638: Credential retrieval failed in ...
<br />
Warning: _oci_open_server: ORA-12154: TNS:could not resolve service name in ...
<br />
Warning: _oci_open_server: ORA-12505: TNS:listener could not resolve SID given in connect descriptor in ...
<br />
&nbsp;&nbsp; &nbsp; 
<br />
Resolution:
<br />
In order to get this to work properly you need to do the following;
<br />
In reference to ORA-12638: Credential retrieval failed in ... 
<br />
you need to edit your sqlnet.ora file and change the 
<br />
SQLNET.AUTHENTICATION_SERVICES = (NTS) to
<br />
SQLNET.AUTHENTICATION_SERVICES = (NONE)
<br />
The reason is that using NTS validation on a Windows 2000 machine essentially means Kerberos.
<br />
Using (NONE) will tell oracle not to expect kerberos "Credentials" as a means of validation. In turn it will use the oracle authentication for a database user.
<br />

<br />
In reference to ORA-12154 and ORA-12505 you need to do the following;
<br />
In your php code you are using to connect you need to copy the section in tnsnames.ora 
<br />
into a variable. 
<br />
For example;
<br />
<span class="default">&lt;?php
<br />
putenv</span><span class="keyword">(</span><span class="string">"ORACLE_SID=TESTDB"</span><span class="keyword">);
<br />
</span><span class="comment">//putenv("ORACLE_HOME=/oracle/ora90");
<br />
//putenv("TNS_ADMIN=/oracle/ora90/network/admin");
<br />
</span><span class="default">$username </span><span class="keyword">= </span><span class="string">"scott"</span><span class="keyword">;
<br />
</span><span class="default">$passwd </span><span class="keyword">= </span><span class="string">"tiger"</span><span class="keyword">;
<br />
</span><span class="default">$db</span><span class="keyword">=</span><span class="string">"(DESCRIPTION=
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (ADDRESS_LIST=
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (ADDRESS=(PROTOCOL=TCP)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (HOST=yourTargetMachine)(PORT=1521)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; )
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (CONNECT_DATA=(SERVICE_NAME=TESTDB))
<br />
&nbsp;&nbsp; &nbsp;&nbsp; )"</span><span class="keyword">;
<br />
</span><span class="default">$conn </span><span class="keyword">= </span><span class="default">OCILogon</span><span class="keyword">(</span><span class="default">$username</span><span class="keyword">,</span><span class="default">$passwd</span><span class="keyword">,</span><span class="default">$db</span><span class="keyword">);
<br />
if (!</span><span class="default">$conn</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Connection failed"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Error Message: [" </span><span class="keyword">. </span><span class="default">OCIError</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">) . </span><span class="string">"]"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; exit;
<br />
}
<br />
else
<br />
{
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Connected!"</span><span class="keyword">;
<br />
}
<br />
...
<br />
</span><span class="default">?&gt;
<br />
</span>I left the ORACLE_HOME and TNS_ADMIN putenv lines commented out and your need for them depends on which web server you are using. If you are using Apache, you may need both.
<br />
If you are using Microsoft IIS you may need ORACLE_HOME. Putting it in can't hurt and it appears PHP may read them if they are there but either way you should be working at this 
<br />
point.
<br />

<br />
Live long and prosper.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25523""></a>
  <div class="note">
   <strong class="user">kakukkfu at mailbox dot hu</strong>
   <a href="#25523" class="date">26-Sep-2002 08:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Better to insert needed variables into apache(!) (or your webserver - respectively) start script. 
<br />

<br />
For example on UNIX systems /etc/init.d/apache would contain following lines before anything else:
<br />

<br />
#!/bin/bash
<br />

<br />
if [ -f ~oracle/.profile ]; then
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; source ~oracle/.profile
<br />
fi
<br />

<br />
The ~oracle/.profile has the appropiate settings to start an Oracle database so it is always up-to-date for PHP, too. (If settings are changed, don't forget to restart your webserver.) This way you just no need to worry what to include or define for PHP.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="21901""></a>
  <div class="note">
   <strong class="user">devolver at iastate dot edu</strong>
   <a href="#21901" class="date">31-May-2002 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I spent several hours tracking down error ORA 24374, which would result from only *SOME* of my select statements.&nbsp; This error would be caused if I made a query that would return any non-numerical value.&nbsp; I am running an Apache 1.3.x webserver and PHP 4.2.1.
<br />

<br />
The fix is to add entries in your httpd.conf file that would export your environment settings.&nbsp; I added these three lines and everything worked like a charm!
<br />
SetEnv ORACLE_HOME&nbsp; /path/to/oracle/home
<br />
SetEnv ORA_NLS33&nbsp; /path/to/oracle/home/ocommon/nls/admin/data
<br />
SetEnv NLS_LANG AMERICAN
<br />

<br />
Obviously, if your NLS_LANG is different, you should set it to whatever your NLS_LANG actually is.&nbsp; Ask your friendly DB admin for this information.
<br />

<br />
Hope this helps someone who treads down the path that I just followed!
<br />

<br />
Trent</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="21473""></a>
  <div class="note">
   <strong class="user">ddc at portalframework.com</strong>
   <a href="#21473" class="date">14-May-2002 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes Oracle doesn't cleanup shadow processes when accessed from PHP. To avoid that, check your 
<br />
$ORACLE_HOME/network/admin/tnsnames.ora file in your Oracle Client directory and remove the (SERVER=DEDICATED) token if is set.
<br />

<br />
To let Oracle delete shadow process on timeouts, add the following line in your $ORACLE_HOME/network/admin/sqlnet.ora
<br />
found in your ORACLE Server directory:
<br />

<br />
SQLNET.EXPIRE_TIME=n
<br />

<br />
Where 'n' is the number of minutes to let connection idle befor shutting them out.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="15793""></a>
  <div class="note">
   <strong class="user">i990712 at dei dot isep dot ipp dot pt</strong>
   <a href="#15793" class="date">03-Oct-2001 02:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you who are having Oracle errors: ORA-12154 or ORA-12505 or ORA-01005 do the folowing:
<br />

<br />
The folowing precedures have been tested when connecting to a HP UX with Oracle 7.x using of couse the OCI8 as the client interface.
<br />

<br />
Add those lines to the web server config files or set and export those ones before the web server starts.
<br />

<br />
On Apache add these lines to httpd.conf:
<br />

<br />
SetEnv ORACLE_HOME /usr/local/oracle
<br />
SetEnv ORACLE_SID &lt;sid&gt;
<br />
SetEnv LD_LIBRARY_PATH /usr/local/oracle/lib
<br />
SetEnv TNS_ADMIN /usr/local/oracle/tnsnames.ora
<br />
SetEnv TWO_TASK /usr/local/oracle/tnsnames.ora
<br />
SetEnv NLS_LANG&nbsp; English_America.WE8ISO8859P1
<br />
SetEnv ORACLE_BASE /usr/local
<br />

<br />
When calling the OCILogon do this:
<br />

<br />
$db = "&nbsp; (DESCRIPTION =
<br />
&nbsp;&nbsp;&nbsp; (ADDRESS = (PROTOCOL = TCP) (HOST =server_ip_or_dns_name)(PORT = 1521))
<br />
&nbsp;&nbsp;&nbsp; (CONNECT_DATA= (SID = _sid_))
<br />
&nbsp;&nbsp;&nbsp; )";
<br />

<br />
The previous definition is a copy of the service definition that is stored in the tnsnames.ora file.
<br />

<br />
Next, call the OCILogon function using the folowing format:
<br />

<br />
OCILogon("user/password","password", $db);
<br />

<br />
To avoid ORA-01005 error, set the NLS_LANG environment variable to English_America.WE8ISO8859P1 ( some other values may work...but we have found that this one works for us )
<br />

<br />
To avoid ORA-12154 and ORA-12505, use the service definition as the OCILogon third parameter.
<br />

<br />
I'd like to thanks to a friend of mine a.k.a Rosa for the user/password tip.
<br />

<br />
Regards
<br />
Miguel Carvalho</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13017""></a>
  <div class="note">
   <strong class="user">fsegtrop at estiem dot org</strong>
   <a href="#13017" class="date">22-May-2001 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using PHP4 in CGI-mode with Windows NT or Windows 2000 with IIS or Apache, make sure that the TNSNAMES.ORA and the SQLNET.ORA do not contain DOS/Windows CR/LF line endings.&lt;br&gt; Instead, they must have UNIX (only LF) endings. Otherwise, you will get an ORA-12154 error (TNS cannot resolve service name) when connecting to a remote database.&lt;br&gt;
<br />
This all does not matter if you use the ISAPI mode.
<br />

<br />
Frank</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="12957""></a>
  <div class="note">
   <strong class="user">Marinne at ilovechocolate dot com</strong>
   <a href="#12957" class="date">17-May-2001 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One simple but useful note:check whether your TNS Listener is running! By default, it's not started automatically when an Oracle instance is started. Login as oracle then type :
<br />

<br />
lsnrctl START
<br />

<br />
After it's started, I can sucessfully run the sample code on this page! I used to got ora-12514 error before doing this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="11757""></a>
  <div class="note">
   <strong class="user">bluei at phpworld dot org</strong>
   <a href="#11757" class="date">06-Mar-2001 11:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
check your tnsnames.ora permission.
<br />

<br />
ex)
<br />
ORACLE_HOME = /home/oracle/oracle
<br />

<br />
chmod 755 /home/oracle/oracle/network/admin -R
<br />

<br />
Yahoo!!!!!! I solved it!!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="8872""></a>
  <div class="note">
   <strong class="user">shmengie_2000 at yahoo dot com</strong>
   <a href="#8872" class="date">03-Oct-2000 12:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
couple of notes about startup/shutdown on linux:&nbsp; (redhat, maybe others)
<br />

<br />
export LD_PRELOAD=/usr/lib/libpthread.so
<br />

<br />
Caused the start/stop script to fail to stop the httpd process.&nbsp; 
<br />
The LD_PRELOAD environment var caused the 'ps' command to core dump.&nbsp; I went bald figuring that out.
<br />

<br />
Easiest fix I could think of was to move all the oracle/php varialble exports so they are only set in the start section of the httpd script.
<br />

<br />
Never thought setting those vars globally in the script would cause problems.&nbsp; That's what I get for thinking...
<br />

<br />
One other note:&nbsp; Make sure the httpd process is shutdown before Oracle.
<br />

<br />
eg: 
<br />
/etc/rc.d/rc0.d/K15httpd
<br />
/etc/rc.d/rc0.d/K25Oracle
<br />

<br />
Lingering connections to oracle may cause shutdown to take forever.
<br />

<br />
gl &amp; hf
<br />

<br />
-Joe</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
