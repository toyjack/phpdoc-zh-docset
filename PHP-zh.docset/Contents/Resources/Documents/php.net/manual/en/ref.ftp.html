<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>FTP 函数</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="ftp.examples-basic.html">? 基本用法</a></li>
      <li style="float: right;"><a href="function.ftp-alloc.html">ftp_alloc ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.ftp.html">FTP</a></li>
    <li>FTP 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.ftp" class="reference">
 <h1 class="title">FTP 函数</h1>

 

















































  
















  























  























  







  







  

























  







  






  






  






  






  
   





  















  















  















  






  















  





<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.ftp-alloc.html">ftp_alloc</a> &mdash; 为要上传的文件分配空间</li><li><a href="function.ftp-cdup.html">ftp_cdup</a> &mdash; 切换到当前目录的父目录</li><li><a href="function.ftp-chdir.html">ftp_chdir</a> &mdash; 在 FTP 服务器上改变当前目录</li><li><a href="function.ftp-chmod.html">ftp_chmod</a> &mdash; 设置 FTP 服务器上的文件权限</li><li><a href="function.ftp-close.html">ftp_close</a> &mdash; 关闭一个 FTP 连接</li><li><a href="function.ftp-connect.html">ftp_connect</a> &mdash; 建立一个新的 FTP 连接</li><li><a href="function.ftp-delete.html">ftp_delete</a> &mdash; 删除 FTP 服务器上的一个文件</li><li><a href="function.ftp-exec.html">ftp_exec</a> &mdash; 请求运行一条 FTP 命令</li><li><a href="function.ftp-fget.html">ftp_fget</a> &mdash; 从 FTP 服务器上下载一个文件并保存到本地一个已经打开的文件中</li><li><a href="function.ftp-fput.html">ftp_fput</a> &mdash; 上传一个已经打开的文件到 FTP 服务器</li><li><a href="function.ftp-get-option.html">ftp_get_option</a> &mdash; 返回当前 FTP 连接的各种不同的选项设置</li><li><a href="function.ftp-get.html">ftp_get</a> &mdash; 从 FTP 服务器上下载一个文件</li><li><a href="function.ftp-login.html">ftp_login</a> &mdash; 登录 FTP 服务器</li><li><a href="function.ftp-mdtm.html">ftp_mdtm</a> &mdash; 返回指定文件的最后修改时间</li><li><a href="function.ftp-mkdir.html">ftp_mkdir</a> &mdash; 建立新目录</li><li><a href="function.ftp-nb-continue.html">ftp_nb_continue</a> &mdash; 连续获取／发送文件（non-blocking）</li><li><a href="function.ftp-nb-fget.html">ftp_nb_fget</a> &mdash; 从 FTP 服务器获取文件并写入到一个打开的文件（非阻塞）</li><li><a href="function.ftp-nb-fput.html">ftp_nb_fput</a> &mdash; 将文件存储到 FTP 服务器 （非阻塞）</li><li><a href="function.ftp-nb-get.html">ftp_nb_get</a> &mdash; 从 FTP 服务器上获取文件并写入本地文件（non-blocking）</li><li><a href="function.ftp-nb-put.html">ftp_nb_put</a> &mdash; 存储一个文件至 FTP 服务器（non-blocking）</li><li><a href="function.ftp-nlist.html">ftp_nlist</a> &mdash; 返回给定目录的文件列表</li><li><a href="function.ftp-pasv.html">ftp_pasv</a> &mdash; 返回当前 FTP 被动模式是否打开</li><li><a href="function.ftp-put.html">ftp_put</a> &mdash; 上传文件到 FTP 服务器</li><li><a href="function.ftp-pwd.html">ftp_pwd</a> &mdash; 返回当前目录名</li><li><a href="function.ftp-quit.html">ftp_quit</a> &mdash; ftp_close 的 别名</li><li><a href="function.ftp-raw.html">ftp_raw</a> &mdash; 向 FTP 服务器发送命令</li><li><a href="function.ftp-rawlist.html">ftp_rawlist</a> &mdash; 返回指定目录下文件的详细列表</li><li><a href="function.ftp-rename.html">ftp_rename</a> &mdash; 更改 FTP 服务器上的文件或目录名</li><li><a href="function.ftp-rmdir.html">ftp_rmdir</a> &mdash; 删除 FTP 服务器上的一个目录</li><li><a href="function.ftp-set-option.html">ftp_set_option</a> &mdash; 设置各种 FTP 运行时选项</li><li><a href="function.ftp-site.html">ftp_site</a> &mdash; 向服务器发送 SITE 命令</li><li><a href="function.ftp-size.html">ftp_size</a> &mdash; 返回指定文件的大小</li><li><a href="function.ftp-ssl-connect.html">ftp_ssl_connect</a> &mdash; 打开 SSL-FTP 连接</li><li><a href="function.ftp-systype.html">ftp_systype</a> &mdash; 返回远程 FTP 服务器的操作系统类型</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="82142""></a>
  <div class="note">
   <strong class="user">spam at kacke dot de</strong>
   <a href="#82142" class="date">28-Mar-2008 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a FTP-abstraction-class which supports the most commands.<br />
<br />
Also it works on TLS, SSLv2 etc. by using stream_crypto_enable()<br />
<br />
<a href="http://kacke.de/php_samples/source.php?f=ftp.cls.php" rel="nofollow" target="_blank">http://kacke.de/php_samples/source.php?f=ftp.cls.php</a><br />
<br />
Many thanks to WEZ at this point after all the years :-)<br />
<br />
Toppi</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77877""></a>
  <div class="note">
   <strong class="user">dot a dot@dot dot com</strong>
   <a href="#77877" class="date">18-Sep-2007 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This took me a few hours to work out. It is based on the code below I've just added a string replace to convert pathname given by Windows to Unix pathname. Hope it saves somebody some time. Enjoy! (Also, delete file function is included:))<br />
<br />
<span class="default">&lt;?php&nbsp; &nbsp; <br />
$myFile </span><span class="keyword">= </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">]; </span><span class="comment">// This will make an array out of the file information that was stored.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$myFile</span><span class="keyword">[</span><span class="string">'tmp_name'</span><span class="keyword">];&nbsp; </span><span class="comment">//Converts the array into a new string containing the path name on the server where your file is.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$myFileName </span><span class="keyword">= </span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'MyFile'</span><span class="keyword">]; </span><span class="comment">//Retrieve file path and file name&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$myfile_replace </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">$myFileName</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">//convert path for use with unix<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$myfile </span><span class="keyword">= </span><span class="default">basename</span><span class="keyword">(</span><span class="default">$myfile_replace</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">//extract file name from path<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$destination_file </span><span class="keyword">= </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$myfile</span><span class="keyword">;&nbsp; </span><span class="comment">//where you want to throw the file on the webserver (relative to your login dir)<br />
&nbsp;&nbsp;&nbsp; // connection settings<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_server </span><span class="keyword">= </span><span class="string">"127.0.0.1"</span><span class="keyword">;&nbsp; </span><span class="comment">//address of ftp server (leave out <a href="ftp://" rel="nofollow" target="_blank">ftp://</a>)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_user_name </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">; </span><span class="comment">// Username<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_user_pass </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// Password<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$conn_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$ftp_server</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// set up basic connection<br />
&nbsp;&nbsp;&nbsp; // login with username and password, or give invalid user message<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$ftp_user_name</span><span class="keyword">, </span><span class="default">$ftp_user_pass</span><span class="keyword">) or die(</span><span class="string">"&lt;h1&gt;You do not have access to this ftp server!&lt;/h1&gt;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$upload </span><span class="keyword">= </span><span class="default">ftp_put</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$destination_file</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">FTP_BINARY</span><span class="keyword">);&nbsp; </span><span class="comment">// upload the file<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$upload</span><span class="keyword">) {&nbsp; </span><span class="comment">// check upload status<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;h2&gt;FTP upload of </span><span class="default">$myFileName</span><span class="string"> has failed!&lt;/h2&gt; &lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp;&nbsp; // try to delete $file<br />
&nbsp;&nbsp;&nbsp; if (ftp_delete($conn_id, $destination_file)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "$destination_file has been deleted!\n";<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "Could not delete $destination_file!\n";<br />
&nbsp;&nbsp;&nbsp; }<br />
*/<br />
</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">); </span><span class="comment">// close the FTP stream<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span>&lt;form name="form" enctype="multipart/form-data" action="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">]; </span><span class="default">?&gt;</span>" method="POST" &gt;<br />
Please choose a file: &lt;input type="file" name="file" accept="text/plain" onChange="MyFile.value=file.value"&gt;<br />
&lt;input name="MyFile" type="hidden" id="MyFile" tabindex="99" size="1" /&gt;<br />
&lt;input type="submit" name="submit" value="upload" style="vertical-align:middle"/&gt;&lt;br/&gt;&lt;br/&gt;<br />
&lt;/form&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72615""></a>
  <div class="note">
   <strong class="user">ras &quot;at&quot; fyn {dot} dk</strong>
   <a href="#72615" class="date">26-Jan-2007 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function to get a remote file and return it's contents, instead of saving to a local file, was missing - here it is:<br />
<br />
function ftp_fetch($ftp_stream, $remote_file) {<br />
&nbsp;&nbsp;&nbsp; ob_end_flush();<br />
&nbsp;&nbsp;&nbsp; ob_start();<br />
&nbsp;&nbsp;&nbsp; $out = fopen('php://output', 'w');<br />
&nbsp;&nbsp;&nbsp; if (!ftp_fget($ftp_stream, $out, $remote_file, FTP_ASCII)) die('Unable to get file: ' . $remote_file);<br />
&nbsp;&nbsp;&nbsp; fclose($out);<br />
&nbsp;&nbsp;&nbsp; $data = ob_get_clean();<br />
&nbsp;&nbsp;&nbsp; return $data;<br />
}<br />
<br />
It works the same as ftp_get(), but instead returns the contents of the remote file - for example:<br />
<br />
$ftp = ftp_connect('my.server.com', 21, 60);<br />
ftp_login($ftp, 'username', 'password');<br />
$data = ftp_fetch($ftp, 'path/to/remote.file');<br />
echo $data;<br />
<br />
Note, I use it to fetch text-files from a server - if you need to fetch binary files, change FTP_ASCII to FTP_BINARY .. but most likely, getting files to memory is only useful for smaller files, e.g. plain text, xml, etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72027""></a>
  <div class="note">
   <strong class="user">breese at pipetech dot tv</strong>
   <a href="#72027" class="date">29-Dec-2006 06:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I fixed the below upload script to work with Windows uploads (and updated some of the syntax). I also added a Javascript "progress indicator" for those of us who don't use PHP 5.2<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(isset(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'start_upload'</span><span class="keyword">]) &amp;&amp; </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'txt_file'</span><span class="keyword">][</span><span class="string">'name'</span><span class="keyword">] != </span><span class="string">""</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$local_file </span><span class="keyword">= </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'txt_file'</span><span class="keyword">][</span><span class="string">'tmp_name'</span><span class="keyword">]; </span><span class="comment">// Defines Name of Local File to be Uploaded<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$destination_file </span><span class="keyword">= </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'txt_file'</span><span class="keyword">][</span><span class="string">'name'</span><span class="keyword">]);&nbsp; </span><span class="comment">// Path for File Upload (relative to your login dir)<br />
<br />
&nbsp;&nbsp;&nbsp; // Global Connection Settings<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_server </span><span class="keyword">= </span><span class="string">"127.0.0.1"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// FTP Server Address (exlucde <a href="ftp://" rel="nofollow" target="_blank">ftp://</a>)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_user_name </span><span class="keyword">= </span><span class="string">"username"</span><span class="keyword">;&nbsp; &nbsp;&nbsp; </span><span class="comment">// FTP Server Username<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftp_user_pass </span><span class="keyword">= </span><span class="string">"password"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Password<br />
<br />
&nbsp;&nbsp;&nbsp; // Connect to FTP Server<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$conn_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$ftp_server</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Login to FTP Server<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$ftp_user_name</span><span class="keyword">, </span><span class="default">$ftp_user_pass</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Verify Log In Status<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if ((!</span><span class="default">$conn_id</span><span class="keyword">) || (!</span><span class="default">$login_result</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"FTP connection has failed! &lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Attempted to connect to </span><span class="default">$ftp_server</span><span class="string"> for user </span><span class="default">$ftp_user_name</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Connected to </span><span class="default">$ftp_server</span><span class="string">, for user </span><span class="default">$ftp_user_name</span><span class="string"> &lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$upload </span><span class="keyword">= </span><span class="default">ftp_put</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$destination_file</span><span class="keyword">, </span><span class="default">$local_file</span><span class="keyword">, </span><span class="default">FTP_BINARY</span><span class="keyword">);&nbsp; </span><span class="comment">// Upload the File<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // Verify Upload Status<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$upload</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;h2&gt;FTP upload of "</span><span class="keyword">.</span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'txt_file'</span><span class="keyword">][</span><span class="string">'name'</span><span class="keyword">].</span><span class="string">" has failed!&lt;/h2&gt;&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Success!&lt;br /&gt;" </span><span class="keyword">. </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'txt_file'</span><span class="keyword">][</span><span class="string">'name'</span><span class="keyword">] . </span><span class="string">" has been uploaded to " </span><span class="keyword">. </span><span class="default">$ftp_server </span><span class="keyword">. </span><span class="default">$destination_file </span><span class="keyword">. </span><span class="string">"!&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">); </span><span class="comment">// Close the FTP Connection<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
&lt;html&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;head&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;script type="text/javascript"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; window.onload = function() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; document.getElementById("progress").style.visibility = "hidden";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; document.getElementById("prog_text").style.visibility = "hidden";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; function dispProgress() {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; document.getElementById("progress").style.visibility = "visible";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; document.getElementById("prog_text").style.visibility = "visible";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/script&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; &lt;/head&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;body&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;form action="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">];</span><span class="default">?&gt;</span>" method="POST" enctype="multipart/form-data"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Please choose a file: &lt;input name="txt_file" type="file" size="35" /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;input type="submit" name="start_upload" value="Upload File" onClick="dispProgress()" /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/form&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;!-- Link to progress file: see <a href="http://www.ajaxload.info/ for animated gifs --&gt;" rel="nofollow" target="_blank">http://www.ajaxload.info/ for animated gifs --&gt;</a><br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;img id="progress" src="<a href="http://www.your.site/images/progress.gif" rel="nofollow" target="_blank">http://www.your.site/images/progress.gif</a>" /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;p id="prog_text" style="display:inline;"&gt; Upload Started!&lt;/p&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; &lt;/body&gt;<br />
&lt;html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70706""></a>
  <div class="note">
   <strong class="user">cgray at premierconsulting dot com (Chris Gray)</strong>
   <a href="#70706" class="date">24-Oct-2006 05:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After looking everywhere for a "FULLY WORKING" ftp uploader script, I finally came up with this, by using a lot of various one's I found on the web. If you find a better way of doing something, please let me know. Thanks, and Enjoy<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">if(isset(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'SubmitFile'</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$myFile </span><span class="keyword">= </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'txt_file'</span><span class="keyword">]; </span><span class="comment">// This will make an array out of the file information that was stored.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$myFile</span><span class="keyword">[</span><span class="string">'tmp_name'</span><span class="keyword">];&nbsp; </span><span class="comment">//Converts the array into a new string containing the path name on the server where your file is.<br />
&nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$myFileName </span><span class="keyword">= </span><span class="default">basename</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'txt_fileName'</span><span class="keyword">]); </span><span class="comment">//Retrieve filename out of file path<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$destination_file </span><span class="keyword">= </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$myFileName</span><span class="keyword">;&nbsp; </span><span class="comment">//where you want to throw the file on the webserver (relative to your login dir)<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; // connection settings<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ftp_server </span><span class="keyword">= </span><span class="string">"127.0.0.1"</span><span class="keyword">;&nbsp; </span><span class="comment">//address of ftp server.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ftp_user_name </span><span class="keyword">= </span><span class="string">"Your UserName"</span><span class="keyword">; </span><span class="comment">// Username<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ftp_user_pass </span><span class="keyword">= </span><span class="string">"Your Password"</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// Password<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$conn_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$ftp_server</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// set up basic connection<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$ftp_user_name</span><span class="keyword">, </span><span class="default">$ftp_user_pass</span><span class="keyword">) or die(</span><span class="string">"&lt;h2&gt;You do not have access to this ftp server!&lt;/h2&gt;"</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">// login with username and password, or give invalid user message<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if ((!</span><span class="default">$conn_id</span><span class="keyword">) || (!</span><span class="default">$login_result</span><span class="keyword">)) {&nbsp; </span><span class="comment">// check connection<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // wont ever hit this, b/c of the die call on ftp_login<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">echo </span><span class="string">"FTP connection has failed! &lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Attempted to connect to </span><span class="default">$ftp_server</span><span class="string"> for user </span><span class="default">$ftp_user_name</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exit;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//&nbsp; &nbsp; echo "Connected to $ftp_server, for user $ftp_user_name &lt;br /&gt;";<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$upload </span><span class="keyword">= </span><span class="default">ftp_put</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$destination_file</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">FTP_BINARY</span><span class="keyword">);&nbsp; </span><span class="comment">// upload the file<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$upload</span><span class="keyword">) {&nbsp; </span><span class="comment">// check upload status<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;h2&gt;FTP upload of </span><span class="default">$myFileName</span><span class="string"> has failed!&lt;/h2&gt; &lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"Uploading </span><span class="default">$myFileName</span><span class="string"> Complete!&lt;br /&gt;&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">); </span><span class="comment">// close the FTP stream<br />
&nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
&lt;html&gt;<br />
&nbsp; &lt;head&gt;<br />
<br />
&nbsp; &lt;/head&gt;<br />
&nbsp; &lt;body&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;form enctype="multipart/form-data" action="<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">];</span><span class="default">?&gt;</span>" method="POST"&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Please choose a file: &lt;input name="txt_file" type="file" id="txt_file" tabindex="1" size="35" onChange="txt_fileName.value=txt_file.value" /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;input name="txt_fileName" type="hidden" id="txt_fileName" tabindex="99" size="1" /&gt;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;input type="submit" name="SubmitFile" value="Upload File" accesskey="ENTER" tabindex="2" /&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; &lt;/form&gt;<br />
&nbsp; &lt;/body&gt;<br />
&lt;html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68915""></a>
  <div class="note">
   <strong class="user">nicklas at programmera dot nu</strong>
   <a href="#68915" class="date">15-Aug-2006 11:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I didn't quite like my FTP program since I had to make all the settings all over when i restarted the client, so I made this script for simple ftp uploading, its running as a CLI app.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//if STDIN isn't defined, define it<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">defined</span><span class="keyword">(</span><span class="string">"STDIN"</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">define</span><span class="keyword">(</span><span class="string">"STDIN"</span><span class="keyword">, </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">"php://stdin"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"FTP file uploader\r\n\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Server: "</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//trim() all the fgets cause it seams to add a \n<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$server </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">STDIN</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Username: "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$username </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">STDIN</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Password: "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$password </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">STDIN</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$connect </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$login </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if ((!</span><span class="default">$connect</span><span class="keyword">) || (!</span><span class="default">$login</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit(</span><span class="string">"Login failed.\r\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Connected\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"PASV (Y/Any key = Off): "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">STDIN</span><span class="keyword">)) == </span><span class="string">"Y"</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//enable passive mode<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ftp_pasv</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"PASV: On\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"PASV: Off\r\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$showContent </span><span class="keyword">= </span><span class="default">ftp_nlist</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Listing Contents:\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$showContent</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"File to upload: "</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">fgets</span><span class="keyword">(</span><span class="default">STDIN</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//escape the uploading process by typing "exit;"<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$file </span><span class="keyword">== </span><span class="string">"exit;"</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//use "$file, $file" since the file shouldn't be renamed, also if its a binary file change the last argument to FTP_BINARY<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$upload </span><span class="keyword">= </span><span class="default">ftp_put</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">FTP_ASCII</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$upload</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit(</span><span class="string">"Upload failed.\r\n"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"The file \"" </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">. </span><span class="string">"\" was successfully uploaded. :)\r\nSize of \"" </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">. </span><span class="string">"\": " </span><span class="keyword">. </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">) / </span><span class="default">1024 </span><span class="keyword">.</span><span class="string">"kb.\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"My work is done, bye.\r\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$connect</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60038""></a>
  <div class="note">
   <strong class="user">magic2lantern at mail dot ru</strong>
   <a href="#60038" class="date">23-Dec-2005 05:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple script writen by me which allows the user<br />
run it in console and get tree from FTP Server.<br />
<br />
<span class="default">&lt;?php<br />
$argv </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"argv"</span><span class="keyword">];<br />
</span><span class="default">$argv </span><span class="keyword">= </span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$argv</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
if (</span><span class="default">getenv</span><span class="keyword">(</span><span class="string">"HTTP_HOST"</span><span class="keyword">)) {exit(</span><span class="string">"For bash execution only!"</span><span class="keyword">);}<br />
if ((empty(</span><span class="default">$argv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">])) || (empty(</span><span class="default">$argv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]))) {exit(</span><span class="string">"Usage: thisscript.php 10.0.0.10 /games/Arcade/<br />
where 10.0.0.10 is the FTP Server and /games/Arcade is the start path on FTP\n"</span><span class="keyword">);}<br />
<br />
</span><span class="comment">// connect to the ftp server<br />
</span><span class="default">$connect_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$argv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
</span><span class="comment">// login on the server<br />
</span><span class="keyword">if (</span><span class="default">$connect_id</span><span class="keyword">) { </span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$connect_id</span><span class="keyword">, </span><span class="string">'anonymous'</span><span class="keyword">, </span><span class="string">'JustForFun'</span><span class="keyword">); }<br />
</span><span class="comment">// check connection<br />
</span><span class="keyword">if ((!</span><span class="default">$connect_id</span><span class="keyword">) || (!</span><span class="default">$login_result</span><span class="keyword">)) {<br />
&nbsp;&nbsp; echo </span><span class="string">"Unable to connect the remote FTP Server!\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; exit;<br />
}<br />
function </span><span class="default">ftp_get_dir </span><span class="keyword">(</span><span class="default">$ftp_dir</span><span class="keyword">) {<br />
global </span><span class="default">$connect_id</span><span class="keyword">;<br />
</span><span class="default">$ftp_contents </span><span class="keyword">= </span><span class="default">ftp_nlist </span><span class="keyword">(</span><span class="default">$connect_id</span><span class="keyword">, </span><span class="default">$ftp_dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$myCounter_for_server_elements </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; !empty (</span><span class="default">$ftp_contents</span><span class="keyword">[</span><span class="default">$myCounter_for_server_elements</span><span class="keyword">]);<br />
</span><span class="default">$myCounter_for_server_elements</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
</span><span class="comment">// get elements list in current dir<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">$argv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] . </span><span class="default">$ftp_dir </span><span class="keyword">. </span><span class="default">$ftp_contents</span><span class="keyword">[</span><span class="default">$myCounter_for_server_elements</span><span class="keyword">] . </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ftp_get_dir </span><span class="keyword">(</span><span class="default">$ftp_dir </span><span class="keyword">. </span><span class="default">$ftp_contents</span><span class="keyword">[</span><span class="default">$myCounter_for_server_elements</span><span class="keyword">] . </span><span class="string">'/'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">ftp_get_dir </span><span class="keyword">(</span><span class="default">$argv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
</span><span class="comment">// close connection<br />
</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$connect_id</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55639""></a>
  <div class="note">
   <strong class="user">leonardo at rol dot com dot ro</strong>
   <a href="#55639" class="date">09-Aug-2005 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example for downloading a remote ftp structure to local server, useful for migrating sites from one server to another, especially when you are upgrading ensim ;)<br />
<br />
<a href="http://leonardo.rol.ro/ftpleech.txt" rel="nofollow" target="_blank">http://leonardo.rol.ro/ftpleech.txt</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52630""></a>
  <div class="note">
   <strong class="user">dickiedyce at uk dot com</strong>
   <a href="#52630" class="date">07-May-2005 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It may seem obvious to others, but it had me stumped for nearly an hour! If you can connect to an ftp site but some functions (list, put, get etc) don't work, then try using ftp_pasv and set passive mode on.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// setup $host and $file variables for your setup before here...<br />
<br />
</span><span class="default">$hostip </span><span class="keyword">= </span><span class="default">gethostbyname</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">);<br />
</span><span class="default">$conn_id </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$hostip</span><span class="keyword">);<br />
<br />
</span><span class="comment">// login with username and password<br />
</span><span class="default">$login_result </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$ftp_user_name</span><span class="keyword">, </span><span class="default">$ftp_user_pass</span><span class="keyword">);<br />
<br />
</span><span class="comment">// IMPORTANT!!! turn passive mode on<br />
</span><span class="default">ftp_pasv </span><span class="keyword">( </span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">true </span><span class="keyword">);<br />
<br />
if ((!</span><span class="default">$conn_id</span><span class="keyword">) || (!</span><span class="default">$login_result</span><span class="keyword">)) {<br />
&nbsp; echo </span><span class="string">"FTP connection has failed!"</span><span class="keyword">;<br />
&nbsp; echo </span><span class="string">"Attempted to connect to </span><span class="default">$host</span><span class="string"> for user </span><span class="default">$ftp_user_name</span><span class="string">"</span><span class="keyword">;<br />
&nbsp; die;<br />
} else {<br />
&nbsp; echo </span><span class="string">"Connected to </span><span class="default">$host</span><span class="string">, for user </span><span class="default">$ftp_user_name</span><span class="string">&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp; echo </span><span class="string">"Host IP is </span><span class="default">$hostip</span><span class="string">&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// upload a file<br />
&nbsp; </span><span class="keyword">if (</span><span class="default">ftp_put</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">, </span><span class="default">$remote_file</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">FTP_ASCII</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"successfully uploaded </span><span class="default">$file</span><span class="string">&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"There was a problem while uploading </span><span class="default">$file</span><span class="string">&lt;br&gt;"</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp; </span><span class="comment">// close the connection<br />
&nbsp; </span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$conn_id</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44110""></a>
  <div class="note">
   <strong class="user">arjen at queek dot nl</strong>
   <a href="#44110" class="date">15-Jul-2004 04:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you prefer a OO-approach to the FTP-functions, you can use this snippet of code (PHP5 only! and does add some overhead). It's just a "start-up", extend/improve as you wish...<br />
You can pass all ftp_* functions to your object and stripping ftp_ of the function name. Plus, you don't have to pass the ftp-resource as the first argument.<br />
<br />
For example:<br />
<span class="default">&lt;?php<br />
ftp_delete</span><span class="keyword">(</span><span class="default">$ftp</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// Where $ftp is your ftp-resource<br />
</span><span class="default">?&gt;<br />
</span><br />
Can become:<br />
<span class="default">&lt;?php<br />
$ftp</span><span class="keyword">-&gt;</span><span class="default">delete</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Where $ftp is your FTP-object<br />
</span><span class="default">?&gt;<br />
</span><br />
Code:<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">FTP </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$ftp</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* public Void __construct(): Constructor */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port </span><span class="keyword">= </span><span class="default">21</span><span class="keyword">, </span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">90</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ftp </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* public Void __destruct(): Destructor */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__destruct</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ftp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* public Mixed __call(): Re-route all function calls to the PHP-functions */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$function</span><span class="keyword">, </span><span class="default">$arguments</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Prepend the ftp resource to the arguments array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">array_unshift</span><span class="keyword">(</span><span class="default">$arguments</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">ftp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Call the PHP function<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="string">'ftp_' </span><span class="keyword">. </span><span class="default">$function</span><span class="keyword">, </span><span class="default">$arguments</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43248""></a>
  <div class="note">
   <strong class="user">Kristy Christie (kristy at isp7 dot net)</strong>
   <a href="#43248" class="date">15-Jun-2004 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a little function that I created to recurse through a local directory and upload the entire contents to a remote FTP server.<br />
<br />
In the example, I'm trying to copy the entire "iwm" directory located at /home/kristy/scripts/iwm to a remote server's /public_html/test/ via FTP.<br />
<br />
The only trouble is that for the line "if (!ftp_chdir($ftpc,$ftproot.$srcrela))", which I use to check if the directory already exists on the remote server, spits out a warning about being unable to change to that directory if it doesn't exist.<br />
<br />
But an error handler should take care of it.<br />
<br />
My thanks to the person who posted the snippet on retrieving the list of files in a directory.<br />
<br />
For the version of the script that echo's it's progress as it recurses &amp; uploads, go to: <a href="http://pastebin.com/73784" rel="nofollow" target="_blank">http://pastebin.com/73784</a><br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// --------------------------------------------------------------------<br />
// THE TRIGGER<br />
// --------------------------------------------------------------------<br />
<br />
&nbsp;&nbsp;&nbsp; // set the various variables<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftproot </span><span class="keyword">= </span><span class="string">"/public_html/test/"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$srcroot </span><span class="keyword">= </span><span class="string">"/home/kristy/scripts/"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$srcrela </span><span class="keyword">= </span><span class="string">"iwm/"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// connect to the destination FTP &amp; enter appropriate directories both locally and remotely<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftpc </span><span class="keyword">= </span><span class="default">ftp_connect</span><span class="keyword">(</span><span class="string">"ftp.mydomain.com"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ftpr </span><span class="keyword">= </span><span class="default">ftp_login</span><span class="keyword">(</span><span class="default">$ftpc</span><span class="keyword">,</span><span class="string">"username"</span><span class="keyword">,</span><span class="string">"password"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if ((!</span><span class="default">$ftpc</span><span class="keyword">) || (!</span><span class="default">$ftpr</span><span class="keyword">)) { echo </span><span class="string">"FTP connection not established!"</span><span class="keyword">; die(); }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">chdir</span><span class="keyword">(</span><span class="default">$srcroot</span><span class="keyword">)) { echo </span><span class="string">"Could not enter local source root directory."</span><span class="keyword">; die(); }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">ftp_chdir</span><span class="keyword">(</span><span class="default">$ftpc</span><span class="keyword">,</span><span class="default">$ftproot</span><span class="keyword">)) { echo </span><span class="string">"Could not enter FTP root directory."</span><span class="keyword">; die(); }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// start ftp'ing over the directory recursively<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ftpRec </span><span class="keyword">(</span><span class="default">$srcrela</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// close the FTP connection<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ftp_close</span><span class="keyword">(</span><span class="default">$ftpc</span><span class="keyword">);<br />
<br />
</span><span class="comment">// --------------------------------------------------------------------<br />
// THE ACTUAL FUNCTION<br />
// --------------------------------------------------------------------<br />
</span><span class="keyword">function </span><span class="default">ftpRec </span><span class="keyword">(</span><span class="default">$srcrela</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$srcroot</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$ftproot</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$ftpc</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$ftpr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// enter the local directory to be recursed through<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">chdir</span><span class="keyword">(</span><span class="default">$srcroot</span><span class="keyword">.</span><span class="default">$srcrela</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// check if the directory exists &amp; change to it on the destination<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">ftp_chdir</span><span class="keyword">(</span><span class="default">$ftpc</span><span class="keyword">,</span><span class="default">$ftproot</span><span class="keyword">.</span><span class="default">$srcrela</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// remote directory doesn't exist so create &amp; enter it<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">ftp_mkdir&nbsp; &nbsp; </span><span class="keyword">(</span><span class="default">$ftpc</span><span class="keyword">,</span><span class="default">$ftproot</span><span class="keyword">.</span><span class="default">$srcrela</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">ftp_chdir&nbsp; &nbsp; </span><span class="keyword">(</span><span class="default">$ftpc</span><span class="keyword">,</span><span class="default">$ftproot</span><span class="keyword">.</span><span class="default">$srcrela</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$fil </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)))<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$fil </span><span class="keyword">!= </span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$fil </span><span class="keyword">!= </span><span class="string">".."</span><span class="keyword">)&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// check if it's a file or directory<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$fil</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// it's a file so upload it<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">ftp_put</span><span class="keyword">(</span><span class="default">$ftpc</span><span class="keyword">, </span><span class="default">$ftproot</span><span class="keyword">.</span><span class="default">$srcrela</span><span class="keyword">.</span><span class="default">$fil</span><span class="keyword">, </span><span class="default">$fil</span><span class="keyword">, </span><span class="default">FTP_BINARY</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// it's a directory so recurse through it<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$fil </span><span class="keyword">== </span><span class="string">"templates"</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// I want the script to ignore any directories named "templates"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // and therefore, not recurse through them and upload their contents<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">ftpRec </span><span class="keyword">(</span><span class="default">$srcrela</span><span class="keyword">.</span><span class="default">$fil</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chdir </span><span class="keyword">(</span><span class="string">"../"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39318""></a>
  <div class="note">
   <strong class="user">postmaster at alishomepage dot com</strong>
   <a href="#39318" class="date">24-Jan-2004 12:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have written an OpenSource ZIP2FTP interface, which actually takes a given ZIP file and decompresses it in the folder on an FTP server you specify...<br />
<br />
Therefore it may be quite interesting for you people interested in FTP, its adress is <a href="http://zip2ftp.alishomepage.com ; those who directly want the source may visit http://zip2ftp.alishomepage.com/?do=getSource" rel="nofollow" target="_blank">http://zip2ftp.alishomepage.com ; those who directly want the source may visit http://zip2ftp.alishomepage.com/?do=getSource</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37421""></a>
  <div class="note">
   <strong class="user">Vikrant Korde &lt;vakorde at hotmail dot com&gt;</strong>
   <a href="#37421" class="date">14-Nov-2003 02:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
&lt;?<br />
<br />
//If you want to move or replicate the folder hierarchy from your current server to another remote server. Then this will be helpful as this will browse the current server's directory and at the same time it will copy that file in the remote server in the same directory. <br />
<br />
//This script will copy all the files from this directory and subdirectory to another remote server via FTP<br />
<br />
function rec_copy ($source_path, $destination_path, $con)<br />
{<br />
&nbsp;&nbsp;&nbsp; ftp_mkdir($con, $destination_path);<br />
&nbsp;&nbsp;&nbsp; ftp_site($con, 'CHMOD 0777 '.$destination_path);<br />
&nbsp;&nbsp;&nbsp; ftp_chdir($con,$destination_path);<br />
<br />
&nbsp;&nbsp;&nbsp; if (is_dir($source_path)) <br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chdir($source_path);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $handle=opendir('.');<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (($file = readdir($handle))!==false) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (($file != ".") &amp;&amp; ($file != "..")) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_dir($file))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // here i am restricting the folder name 'propertyimages' from being copied to remote server. -- VK<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if($file != "propertyimages")<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; rec_copy ($source_path."/".$file, $file, $con);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; chdir($source_path);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ftp_cdup($con);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_file($file))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $fp = fopen($file,"r");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // this will convert spaces to '_' so that it will not throw error.&nbsp; -- VK<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ftp_fput ($con, str_replace(" ", "_", $file), $fp,FTP_BINARY);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ftp_site($con, 'CHMOD 0755 '.str_replace(" ", "_", $file));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; closedir($handle); <br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
// make a FTP connection --VK<br />
$con = ftp_connect("69.18.213.131",21);<br />
$login_result = ftp_login($con,"username","password");&nbsp; &nbsp; <br />
<br />
// this is the root path for the remote server-- VK<br />
$rootpath = "mainwebsite_html";&nbsp; &nbsp; <br />
<br />
// this is the physical path of the source directory. actually u can also use the relative path. -- VK<br />
$sourcepath = realpath("../")."/resdesk";<br />
<br />
// this directory name will only change the top most directory and not the inner one -- VK<br />
$destination_dir_name = "resdesk_".$account_id."/";<br />
<br />
rec_copy ($sourcepath, $destination_dir_name, $con);<br />
if (function_exists("ftp_close")) <br />
{<br />
&nbsp;&nbsp;&nbsp; ftp_close($con);<br />
}<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36838""></a>
  <div class="note">
   <strong class="user">postmaster at alishomepage dot com</strong>
   <a href="#36838" class="date">24-Oct-2003 01:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's another FTP interface over PHP (also uses MySQL)<br />
<br />
<a href="http://myftp.alishomepage.com" rel="nofollow" target="_blank">http://myftp.alishomepage.com</a><br />
<br />
PS: this script will ALSO allow you to download its source... So it becomes interesting for YOU PROGRAMMERS as well :D</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25330""></a>
  <div class="note">
   <strong class="user">NOSPAMkent at ioflux dot NOSPAM dot com</strong>
   <a href="#25330" class="date">20-Sep-2002 02:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think what some other posts were trying to say which may need clarification is that in PHP 4.2.3, ftp_connect("myhost.com") was failing most of the time, except it would work like every few minutes.<br />
<br />
The fix is that ftp_connect seems to have a bug resolving addresses. If you do:<br />
<br />
$hostip = gethostbyname($host);<br />
$conn_id = ftp_connect($hostip);<br />
<br />
It seems to solve the problem.<br />
(Other users referred to an ftpbuf() error... not sure what that is, but this should fix it.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19020""></a>
  <div class="note">
   <strong class="user">sven at cartell-network dot de</strong>
   <a href="#19020" class="date">13-Feb-2002 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
connection to a ftp server across proxy<br />
<br />
$ftp_server = "proxy"; f.e. 123.456.789.10<br />
$ftp_user_name = "username@ftpserver"; f.e. exampleuk@www.example.uk<br />
$ftp_user_pass = "password";<br />
<br />
$conn_id = ftp_connect($ftp_server, 2121);<br />
$login_result = ftp_login( $conn_id, $ftp_user_name, $ftp_user_pass );</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
