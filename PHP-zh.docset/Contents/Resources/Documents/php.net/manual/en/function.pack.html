<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Pack data into binary string</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.ignore-user-abort.html">? ignore_user_abort</a></li>
      <li style="float: right;"><a href="function.php-check-syntax.html">php_check_syntax ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.misc.html">杂项 函数</a></li>
    <li>Pack data into binary string</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.pack" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">pack</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">pack</span> &mdash; <span class="dc-title">Pack data into binary string</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.pack-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>pack</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$format</code></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$args</code></span>
   [, <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$...</code></span>
  ]] )</div>

  <p class="para rdfs-comment">
   Pack given arguments into a binary string according to
   <code class="parameter">format</code>. 
  </p>
  <p class="para">
   The idea for this function was taken from Perl and all formatting codes
   work the same as in Perl. However, there are some formatting codes that are
   missing such as Perl&#039;s &quot;u&quot; format code.
  </p>
  <p class="para">
   Note that the distinction between signed and unsigned values only
   affects the function <span class="function"><a href="function.unpack.html" class="function">unpack()</a></span>, where as
   function <span class="function"><strong>pack()</strong></span> gives the same result for
   signed and unsigned format codes.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.pack-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">format</code></dt>

     <dd>

      <p class="para">
       The <code class="parameter">format</code> string consists of format codes
       followed by an optional repeater argument. The repeater argument can
       be either an integer value or <em>*</em> for repeating to
       the end of the input data. For a, A, h, H the repeat count specifies
       how many characters of one data argument are taken, for @ it is the
       absolute position where to put the next data, for everything else the
       repeat count specifies how many data arguments are consumed and packed
       into the resulting binary string.
      </p>
      <p class="para">
       Currently implemented formats are:
       <table class="doctable table">
        <caption><strong><span class="function"><strong>pack()</strong></span> format characters</strong></caption>
        
         <thead>
          <tr>
           <th>Code</th>
           <th>Description</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td>a</td>
           <td>NUL-padded string</td>
          </tr>

          <tr>
           <td>A</td>
           <td>SPACE-padded string</td></tr>

          <tr>
           <td>h</td>
           <td>Hex string, low nibble first</td></tr>

          <tr>
           <td>H</td>
           <td>Hex string, high nibble first</td></tr>

          <tr><td>c</td><td>signed char</td></tr>

          <tr>
           <td>C</td>
           <td>unsigned char</td></tr>

          <tr>
           <td>s</td>
           <td>signed short (always 16 bit, machine byte order)</td>
          </tr>

          <tr>
           <td>S</td>
           <td>unsigned short (always 16 bit, machine byte order)</td>
          </tr>

          <tr>
           <td>n</td>
           <td>unsigned short (always 16 bit, big endian byte order)</td>
          </tr>

          <tr>
           <td>v</td>
           <td>unsigned short (always 16 bit, little endian byte order)</td>
          </tr>

          <tr>
           <td>i</td>
           <td>signed integer (machine dependent size and byte order)</td>
          </tr>

          <tr>
           <td>I</td>
           <td>unsigned integer (machine dependent size and byte order)</td>
          </tr>

          <tr>
           <td>l</td>
           <td>signed long (always 32 bit, machine byte order)</td>
          </tr>

          <tr>
           <td>L</td>
           <td>unsigned long (always 32 bit, machine byte order)</td>
          </tr>

          <tr>
           <td>N</td>
           <td>unsigned long (always 32 bit, big endian byte order)</td>
          </tr>

          <tr>
           <td>V</td>
           <td>unsigned long (always 32 bit, little endian byte order)</td>
          </tr>

          <tr>
           <td>q</td>
           <td>signed long long (always 64 bit, machine byte order)</td>
          </tr>

          <tr>
           <td>Q</td>
           <td>unsigned long long (always 64 bit, machine byte order)</td>
          </tr>

          <tr>
           <td>J</td>
           <td>unsigned long long (always 64 bit, big endian byte order)</td>
          </tr>

          <tr>
           <td>P</td>
           <td>unsigned long long (always 64 bit, little endian byte order)</td>
          </tr>

          <tr>
           <td>f</td>
           <td>float (machine dependent size and representation)</td>
          </tr>

          <tr>
           <td>d</td>
           <td>double (machine dependent size and representation)</td>
          </tr>

          <tr>
           <td>x</td>
           <td>NUL byte</td>
          </tr>

          <tr>
           <td>X</td>
           <td>Back up one byte</td>
          </tr>

          <tr>
           <td>Z</td>
           <td>NUL-padded string (new in PHP 5.5)</td>
          </tr>

          <tr>
           <td>@</td>
           <td>NUL-fill to absolute position</td>
          </tr>

         </tbody>
        
       </table>

      </p>
     </dd>

    
    
     <dt>
<code class="parameter">args</code></dt>

     <dd>

      <p class="para">
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.pack-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns a binary string containing data.
  </p>
 </div>

 
 <div class="refsect1 changelog" id="refsect1-function.pack-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.6.3</td>
       <td>
        The &quot;q&quot;, &quot;Q&quot;, &quot;J&quot; and &quot;P&quot; codes were added to enable working with 64-bit numbers.
       </td>
      </tr>

      <tr>
       <td>5.5.0</td>
       <td>
        The &quot;Z&quot; code was added with equivalent functionality to &quot;a&quot; for Perl
        compatibility.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.pack-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-4220">
    <p><strong>Example #1 <span class="function"><strong>pack()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$binarydata&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pack</span><span style="color: #007700">(</span><span style="color: #DD0000">"nvc*"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0x1234</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0x5678</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">65</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">66</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>
     The resulting binary string will be 6 bytes long and contain
     the byte sequence 0x12, 0x34, 0x78, 0x56, 0x41, 0x42.
    </p></div>
   </div>
  </p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.pack-notes">
  <h3 class="title">注释</h3>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">Note that PHP internally stores <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> values as
    signed values of a machine-dependent size (C type <em>long</em>).   
    Integer literals and operations that yield numbers outside the bounds of the  
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> type will be stored as <span class="type"><a href="language.types.float.html" class="type float">float</a></span>.
    When packing these floats as integers, they are first cast into the integer   
    type. This may or may not result in the desired byte pattern.
   </p>
   <p class="para">The most relevant case is when packing unsigned numbers that would
    be representable with the <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> type if it were unsigned.
    In systems where the <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> type has a 32-bit size, the cast
    usually results in the same byte pattern as if the <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> were
    unsigned (although this relies on implementation-defined unsigned to signed
    conversions, as per the C standard). In systems where the
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> type has 64-bit size, the <span class="type"><a href="language.types.float.html" class="type float">float</a></span> most
    likely does not have a mantissa large enough to hold the value without
    loss of precision. If those systems also have a native 64-bit C
    <em>int</em> type (most UNIX-like systems don&#039;t), the only way to  
    use the <em>I</em> pack format in the upper range is to create
    <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> negative values with the same byte representation
    as the desired unsigned value.
   </p>
  </div>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.pack-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.unpack.html" class="function" rel="rdfs-seeAlso">unpack()</a> - Unpack data from binary string</span></li>
   </ul>
  </p>
 </div>

 
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119402""></a>
  <div class="note">
   <strong class="user">stanislav dot eckert at vizson dot de</strong>
   <a href="#119402" class="date">29-May-2016 12:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A helper class to convert integer to binary strings and vice versa. Useful for writing and reading integers to / from files or sockets.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">class </span><span class="default">int_helper<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">int8</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"c"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">) : </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"c"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">uInt8</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"C"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">) : </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"C"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">int16</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"s"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">) : </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"s"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">uInt16</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">, </span><span class="default">$endianness</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="string">"pack" </span><span class="keyword">: </span><span class="string">"unpack"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {&nbsp; </span><span class="comment">// big-endian<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {&nbsp; </span><span class="comment">// little-endian<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"v"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {&nbsp; </span><span class="comment">// machine byte order<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"S"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">$i</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] : </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">int32</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"l"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">) : </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"l"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">uInt32</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">, </span><span class="default">$endianness</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="string">"pack" </span><span class="keyword">: </span><span class="string">"unpack"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {&nbsp; </span><span class="comment">// big-endian<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"N"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {&nbsp; </span><span class="comment">// little-endian<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"V"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {&nbsp; </span><span class="comment">// machine byte order<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"L"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">$i</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] : </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">int64</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"q"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">) : </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"q"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public static function </span><span class="default">uInt64</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">, </span><span class="default">$endianness</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">is_int</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="string">"pack" </span><span class="keyword">: </span><span class="string">"unpack"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">true</span><span class="keyword">) {&nbsp; </span><span class="comment">// big-endian<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"J"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {&nbsp; </span><span class="comment">// little-endian<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"P"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (</span><span class="default">$endianness </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {&nbsp; </span><span class="comment">// machine byte order<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$f</span><span class="keyword">(</span><span class="string">"Q"</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">) ? </span><span class="default">$i</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] : </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Usage example:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; Header</span><span class="keyword">(</span><span class="string">"Content-Type: text/plain"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; include(</span><span class="string">"int_helper.php"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt8</span><span class="keyword">(</span><span class="default">0x6b</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// k<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt8</span><span class="keyword">(</span><span class="default">107</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// k<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt8</span><span class="keyword">(</span><span class="string">"\x6b"</span><span class="keyword">) . </span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// 107<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt16</span><span class="keyword">(</span><span class="default">4101</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// \x05\x10<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt16</span><span class="keyword">(</span><span class="string">"\x05\x10"</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// 4101<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt16</span><span class="keyword">(</span><span class="string">"\x05\x10"</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) . </span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// 1296<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt32</span><span class="keyword">(</span><span class="default">2147483647</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// \xff\xff\xff\x7f<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt32</span><span class="keyword">(</span><span class="string">"\xff\xff\xff\x7f"</span><span class="keyword">) . </span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// 2147483647<br />
<br />
&nbsp;&nbsp;&nbsp; // Note: Test this with 64-bit build of PHP<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt64</span><span class="keyword">(</span><span class="default">9223372036854775807</span><span class="keyword">) . </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// \xff\xff\xff\xff\xff\xff\xff\x7f<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">int_helper</span><span class="keyword">::</span><span class="default">uInt64</span><span class="keyword">(</span><span class="string">"\xff\xff\xff\xff\xff\xff\xff\x7f"</span><span class="keyword">) . </span><span class="default">PHP_EOL </span><span class="keyword">. </span><span class="default">PHP_EOL</span><span class="keyword">;&nbsp; </span><span class="comment">// 9223372036854775807<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114431""></a>
  <div class="note">
   <strong class="user">jrm456 at speed dot 1s dot fr</strong>
   <a href="#114431" class="date">20-Feb-2014 01:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How to convert an integer to raw data, specifying the amount of bytes to convert to (will be padded with 0's):<br />
<br />
&nbsp;&nbsp;&nbsp; public function toRaw($int, $bytes = 4)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $hex = dechex($int);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (strlen($hex) % 2 != 0)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $hex = '0'. $hex;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $arr = str_split($hex, 2);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (count($arr) &lt; $bytes)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; array_unshift($arr, 0);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $arr = array_map('hexdec', $arr);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $arr = array_map('chr', $arr);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return join('', array_reverse($arr));<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109328""></a>
  <div class="note">
   <strong class="user">petepostma at gmail dot spam dot com</strong>
   <a href="#109328" class="date">07-Jul-2012 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Even though in a 64-bit architecure intval(6123456789) = 6123456789, and sprintf('%b', 5000000000) = 100101010000001011111001000000000
<br />
pack will not treat anything passed to it as 64-bit.&nbsp; If you want to pack a 64-bit integer:
<br />

<br />
<span class="default">&lt;?php
<br />
$big </span><span class="keyword">= </span><span class="default">5000000000</span><span class="keyword">;
<br />

<br />
</span><span class="default">$left </span><span class="keyword">= </span><span class="default">0xffffffff00000000</span><span class="keyword">;
<br />
</span><span class="default">$right </span><span class="keyword">= </span><span class="default">0x00000000ffffffff</span><span class="keyword">;
<br />

<br />
</span><span class="default">$l </span><span class="keyword">= (</span><span class="default">$big </span><span class="keyword">&amp; </span><span class="default">$left</span><span class="keyword">) &gt;&gt;</span><span class="default">32</span><span class="keyword">;
<br />
</span><span class="default">$r </span><span class="keyword">= </span><span class="default">$big </span><span class="keyword">&amp; </span><span class="default">$right</span><span class="keyword">;
<br />

<br />
</span><span class="default">$good </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'NN'</span><span class="keyword">, </span><span class="default">$l</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">);
<br />

<br />
</span><span class="default">$urlsafe </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">), array(</span><span class="string">'-'</span><span class="keyword">,</span><span class="string">'_'</span><span class="keyword">), </span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$good</span><span class="keyword">));
<br />

<br />
</span><span class="comment">//done!
<br />

<br />
//rebuild:
<br />
</span><span class="default">$unurl </span><span class="keyword">=&nbsp; </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'-'</span><span class="keyword">,</span><span class="string">'_'</span><span class="keyword">), array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">), </span><span class="default">$urlsafe</span><span class="keyword">);
<br />
</span><span class="default">$binary </span><span class="keyword">= </span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$unurl</span><span class="keyword">);
<br />

<br />
</span><span class="default">$set </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'N2'</span><span class="keyword">, </span><span class="default">$tmp</span><span class="keyword">);
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$set</span><span class="keyword">);
<br />

<br />
</span><span class="default">$original </span><span class="keyword">= </span><span class="default">$set</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] &lt;&lt; </span><span class="default">32 </span><span class="keyword">| </span><span class="default">$set</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];
<br />
echo </span><span class="default">$original</span><span class="keyword">, </span><span class="string">"\\r\\n"</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
results in:
<br />
Array
<br />
(
<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; 1
<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; 705032704
<br />
)
<br />
5000000000
<br />

<br />
but ONLY on a 64-bit enabled machine and PHP distro.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107649""></a>
  <div class="note">
   <strong class="user">chadm at codeangel dot org</strong>
   <a href="#107649" class="date">24-Feb-2012 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you'd like to understand pack/unpack. There is a tutorial here in perl, that works equally well in understanding it for php:<br />
<br />
<a href="http://perldoc.perl.org/perlpacktut.html" rel="nofollow" target="_blank">http://perldoc.perl.org/perlpacktut.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104151""></a>
  <div class="note">
   <strong class="user">Gerjoo at gmail dot com</strong>
   <a href="#104151" class="date">26-May-2011 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use pack to strip the byte order mark (BOM) from a file. <br />
<br />
For example, strip the UTF-8 BOM:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Strips the UTF-8 mark: (hex value: EF BB BF)<br />
</span><span class="keyword">function </span><span class="default">trimUTF8BOM</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">){ <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">) == </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'CCC'</span><span class="keyword">, </span><span class="default">239</span><span class="keyword">, </span><span class="default">187</span><span class="keyword">, </span><span class="default">191</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This function could be easily adjusted to match any byte order mark. Have a look at wikipedia for a full list of hex codes for each specific encoding.<br />
<br />
- Gerard</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100518""></a>
  <div class="note">
   <strong class="user">FrozenFire</strong>
   <a href="#100518" class="date">21-Oct-2010 06:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need to unpack a signed short from big-endian or little-endian specifically, instead of machine-byte-order, you need only unpack it as the unsigned form, and then if the result is &gt;= 2^15, subtract 2^16 from it.
<br />

<br />
And example would be:
<br />

<br />
<span class="default">&lt;?php
<br />
$foo </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"n"</span><span class="keyword">, </span><span class="default">$signedbigendianshort</span><span class="keyword">);
<br />
</span><span class="default">$foo </span><span class="keyword">= </span><span class="default">$foo</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];
<br />
if(</span><span class="default">$foo </span><span class="keyword">&gt;= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">)) </span><span class="default">$foo </span><span class="keyword">-= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98528""></a>
  <div class="note">
   <strong class="user">Ammar Hameed</strong>
   <a href="#98528" class="date">21-Jun-2010 01:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using pack to write Arabic char(s) to a file.<br />
<br />
<span class="default">&lt;?php<br />
$text </span><span class="keyword">= </span><span class="string">"&amp;#13574;&amp;#13830;&amp;#13830;"</span><span class="keyword">;<br />
<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="string">"UCS-2BE"</span><span class="keyword">, </span><span class="string">"HTML-ENTITIES"</span><span class="keyword">);<br />
<br />
</span><span class="default">$len </span><span class="keyword">=&nbsp; </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">);<br />
<br />
</span><span class="default">$bom </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="string">"&amp;#65534;"</span><span class="keyword">, </span><span class="string">"unicode"</span><span class="keyword">, </span><span class="string">"HTML-ENTITIES"</span><span class="keyword">);<br />
<br />
</span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'text.txt'</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">);<br />
<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'a2'</span><span class="keyword">, </span><span class="default">$bom</span><span class="keyword">));&nbsp; <br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"a</span><span class="keyword">{</span><span class="default">$len</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">));<br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'a2'</span><span class="keyword">, </span><span class="default">$bom</span><span class="keyword">)); <br />
</span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'a2'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">));<br />
<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96214""></a>
  <div class="note">
   <strong class="user">SixThreeOh</strong>
   <a href="#96214" class="date">15-Feb-2010 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're bugged by <a href="http://bugs.php.net/bug.php?id=5889 then you can try this:" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=5889 then you can try this:</a><br />
<br />
Use igbinary-serialize if you don't mind a little overhead.<br />
<br />
Or intarray (by the same person) if you don't mind using a slightly experimental package which may have problems sharing data between differently byte/bit ordered architectures.<br />
<br />
I don't believe it would be too difficult to shove a serialize function and unserialize function in there if you rip out the code from igbinary for storing numeric arrays with the correct endianess. Looking at `igbinary_serialize32` and `igbinary_unserialize32` in igbinary.c it should be very easy to copy that functionality to intarray.c.<br />
<br />
Take away the "&lt;&lt;0" though, that's just stupid :P<br />
<br />
Ref: <a href="http://opensource.dynamoid.com/" rel="nofollow" target="_blank">http://opensource.dynamoid.com/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93085""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#93085" class="date">22-Aug-2009 05:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Coder's example is basically an explanation of bindec() and decbin(), not pack() and unpack().<br />
<br />
Here's some code to convert a string binary expression into its binary-string equivalent and vice versa.<br />
<br />
(Would be even simpler if pack/unpack offered a 'b' format code....)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">bin2bstr</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)<br />
</span><span class="comment">// Convert a binary expression (e.g., "100111") into a binary-string<br />
</span><span class="keyword">{<br />
&nbsp; if (!</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)) return </span><span class="default">null</span><span class="keyword">; </span><span class="comment">// Sanity check<br />
<br />
&nbsp; // Pack into a string<br />
&nbsp; </span><span class="keyword">return </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">, </span><span class="default">base_convert</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">));<br />
}<br />
<br />
function </span><span class="default">bstr2bin</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)<br />
</span><span class="comment">// Binary representation of a binary-string<br />
</span><span class="keyword">{<br />
&nbsp; if (!</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)) return </span><span class="default">null</span><span class="keyword">; </span><span class="comment">// Sanity check<br />
<br />
&nbsp; // Unpack as a hexadecimal string<br />
&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'H*'</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">);<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// Output binary representation<br />
&nbsp; </span><span class="keyword">return </span><span class="default">base_convert</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">16</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// Returns string(3) "ABC"<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">bin2bstr</span><span class="keyword">(</span><span class="string">'01000001 01000010 01000011'</span><span class="keyword">));<br />
<br />
</span><span class="comment">// Returns string(24) "010000010100001001000011"<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">bstr2bin</span><span class="keyword">(</span><span class="string">'ABC'</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90142""></a>
  <div class="note">
   <strong class="user">Coder</strong>
   <a href="#90142" class="date">08-Apr-2009 01:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
These two functions allow conversion between binary string and signed integer with possibility to give the bit length.
<br />

<br />
Usage:
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">echo </span><span class="default">si2bin</span><span class="keyword">(-</span><span class="default">10</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);
<br />
</span><span class="default">11111111111111111111111111110110
<br />
</span><span class="keyword">echo </span><span class="default">si2bin</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);
<br />
</span><span class="default">00000000000000000000000000001010
<br />
</span><span class="keyword">echo </span><span class="default">bin2si</span><span class="keyword">(</span><span class="string">"11111111111111111111111111110110"</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);
<br />
-</span><span class="default">10
<br />
</span><span class="keyword">echo </span><span class="default">bin2si</span><span class="keyword">(</span><span class="string">"00000000000000000000000000001010"</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);
<br />
</span><span class="default">10
<br />

<br />
</span><span class="comment">// signed integer to binary
<br />
</span><span class="keyword">function </span><span class="default">si2bin</span><span class="keyword">(</span><span class="default">$si</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">=</span><span class="default">32</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$si </span><span class="keyword">&gt;= -</span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">) and </span><span class="default">$si </span><span class="keyword">&lt;= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">) )
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$si </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">) </span><span class="comment">// positive or zero
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">base_convert</span><span class="keyword">(</span><span class="default">$si</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// pad to $bits bit
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bin_length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$bin_length </span><span class="keyword">&lt; </span><span class="default">$bits</span><span class="keyword">) </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">str_repeat </span><span class="keyword">( </span><span class="string">"0"</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">-</span><span class="default">$bin_length</span><span class="keyword">).</span><span class="default">$bin</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="comment">// negative
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$si </span><span class="keyword">= -</span><span class="default">$si</span><span class="keyword">-</span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">base_convert</span><span class="keyword">(</span><span class="default">$si</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bin_length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$bin_length </span><span class="keyword">&gt; </span><span class="default">$bits</span><span class="keyword">) </span><span class="default">$bin </span><span class="keyword">= </span><span class="default">str_repeat </span><span class="keyword">( </span><span class="string">"1"</span><span class="keyword">, </span><span class="default">$bits</span><span class="keyword">-</span><span class="default">$bin_length</span><span class="keyword">).</span><span class="default">$bin</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$bin</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
</span><span class="comment">// binary to signed integer
<br />
</span><span class="keyword">function </span><span class="default">bin2si</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">=</span><span class="default">32</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">)==</span><span class="default">$bits</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">) </span><span class="comment">// positive or zero
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$si </span><span class="keyword">= </span><span class="default">base_convert</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="comment">// negative
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$si </span><span class="keyword">= </span><span class="default">base_convert</span><span class="keyword">(</span><span class="default">$bin</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$si </span><span class="keyword">= -(</span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">$bits</span><span class="keyword">)-</span><span class="default">$si</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$si</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84258""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#84258" class="date">06-Jul-2008 01:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Array pack:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">pack_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">) {<br />
&nbsp;return </span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="default">pack</span><span class="keyword">,</span><span class="default">array_merge</span><span class="keyword">(array(</span><span class="default">$v</span><span class="keyword">),(array)</span><span class="default">$a</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83059""></a>
  <div class="note">
   <strong class="user">php at nagler-ihlein dot de</strong>
   <a href="#83059" class="date">08-May-2008 04:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware of format code H always padding the 0 for byte-alignment to the right (for odd count of nibbles).<br />
<br />
So pack("H", "7") results in 0x70 (ASCII character 'p') and not in 0x07 (BELL character)<br />
as well as pack("H*", "347") results in 0x34 ('4') and 0x70 ('p') and not 0x03 and 0x47.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80621""></a>
  <div class="note">
   <strong class="user">Quis AT spam.to.my.devnull.quis.cx</strong>
   <a href="#80621" class="date">25-Jan-2008 03:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?PHP<br />
</span><span class="keyword">function </span><span class="default">ntohs</span><span class="keyword">(</span><span class="default">$port</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$b</span><span class="keyword">=</span><span class="default">pack</span><span class="keyword">(</span><span class="string">"N"</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
I've spent a number of hours (n&gt;=2) finding how to do this,<br />
it works like the c function 'ntohs', used for eg the socks5 proxy protocol.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77618""></a>
  <div class="note">
   <strong class="user">dylan at pow7 dot com</strong>
   <a href="#77618" class="date">06-Sep-2007 01:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is how I used pack to convert base2 to base64 since base_convert doesn't support base64<br />
The base conversions don't work for long strings, which is why I convert 1 byte at a time<br />
Hope this helps someone<br />
<br />
function base2to64($base2) {<br />
&nbsp;&nbsp;&nbsp; if ($remainbits = strlen($base2)%8) $base2 .= str_repeat('0',8-$remainbits);<br />
&nbsp;&nbsp;&nbsp; $base64 = NULL;<br />
&nbsp;&nbsp;&nbsp; for ($i=0;$i&lt;strlen($base2);$i+=8) $base16 .= sprintf('%02x',bindec(sprintf('%08d',substr($base2,$i,8))));<br />
&nbsp;&nbsp;&nbsp; return base64_encode(pack('H*',$base16));<br />
}<br />
function base64to2($base64) {<br />
&nbsp;&nbsp;&nbsp; list($base16) = unpack('H*0',base64_decode($base64));<br />
&nbsp;&nbsp;&nbsp; $base2 = NULL;<br />
&nbsp;&nbsp;&nbsp; for ($i=0;$i&lt;strlen($base16);$i++) $base2 .= sprintf('%04d',base_convert(substr($base16,$i,1),16,2));<br />
&nbsp;&nbsp;&nbsp; return $base2;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63501""></a>
  <div class="note">
   <strong class="user">Newdawn.dk</strong>
   <a href="#63501" class="date">23-Mar-2006 01:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When trying to create a ZIP file using the pack function - I experienced trouble with the "a" code - It converted all chars correct from the std. ASCII charset but not more language specific like ???.<br />
It seems that ZIP files do not use the same HEX for these as everything else does. <br />
The fix was a quick workaround but you'll probably get the picture:<br />
function UniHex($str) {<br />
&nbsp;&nbsp;&nbsp; // ? ? ? ? ? ? <br />
&nbsp;&nbsp;&nbsp; //These are simply one HEX code being replaced by another to correct the issue<br />
&nbsp;&nbsp;&nbsp; $except = array("E6"=&gt;"91","F8"=&gt;"9B","E5"=&gt;"86","C6"=&gt;"92","D8"=&gt;"9D",&nbsp; &nbsp; "C5"=&gt;"8F");<br />
&nbsp;&nbsp;&nbsp; for($i = 0; $i &lt; strlen($str); $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $hex = bin2hex(substr($str, $i, 1));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($except[strtoupper($hex)])<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $hex = $except[strtoupper($hex)];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $return .= $hex;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $return;<br />
}<br />
And then i replaced an "a100" code with "H".strlen(uniHex($mystring))<br />
<br />
This is like i said a quick workaround, but if you find the real reason for this i'd be happy to see it</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63105""></a>
  <div class="note">
   <strong class="user">j.s.hoekstra</strong>
   <a href="#63105" class="date">13-Mar-2006 05:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
/* Convert float from HostOrder to Network Order */<br />
function FToN( $val )<br />
{<br />
&nbsp;&nbsp;&nbsp; $a = unpack("I",pack( "f",$val ));<br />
&nbsp;&nbsp;&nbsp; return pack("N",$a[1] );<br />
}<br />
&nbsp;&nbsp;&nbsp; <br />
/* Convert float from Network Order to HostOrder */<br />
function NToF($val )<br />
{<br />
&nbsp;&nbsp;&nbsp; $a = unpack("N",$val);<br />
&nbsp;&nbsp;&nbsp; $b = unpack("f",pack( "I",$a[1]));<br />
&nbsp;&nbsp;&nbsp; return $b[1];<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57697""></a>
  <div class="note">
   <strong class="user">Patrik Fimml</strong>
   <a href="#57697" class="date">11-Oct-2005 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You will get the same effect with<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">_readInt</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; return </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'V'</span><span class="keyword">, </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
or unpack('N', ...) for big-endianness.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45326""></a>
  <div class="note">
   <strong class="user">zilinex at yahoo dot com</strong>
   <a href="#45326" class="date">02-Sep-2004 08:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a cool function to converrt numbers to Persian numbers(utf-8) <br />
origin: <a href="http://www.farsiweb.info/jalali/jalali.phps" rel="nofollow" target="_blank">http://www.farsiweb.info/jalali/jalali.phps</a><br />
<br />
function farsinum($str)<br />
{<br />
&nbsp; $ret = "";<br />
&nbsp; for ($i = 0; $i &lt; strlen($str); ++$i) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $c = $str[$i];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( $c &gt;= '0' &amp;&amp; $c &lt;= '9' )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $out .= pack("C*", 0xDB, 0xB0 + $c);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ret .= $c;<br />
&nbsp; }<br />
&nbsp; return $ret;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7653""></a>
  <div class="note">
   <strong class="user">plutus at gmx dot de</strong>
   <a href="#7653" class="date">10-Aug-2000 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the the upper command in perl looks like this:
<br />

<br />
$binarydata = pack ("n v c*", 0x1234, 0x5678, 65, 66);
<br />
In PHP it seems that no whitespaces are allowed in the first parameter. So if you want to convert your pack command from perl -&gt; PHP, don't forget to remove the whitespaces!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
