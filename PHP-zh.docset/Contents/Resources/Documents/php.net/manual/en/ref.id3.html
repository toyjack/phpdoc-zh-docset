<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>ID3 º¯Êý</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="id3.constants.html">? Predefined Constants</a></li>
      <li style="float: right;"><a href="function.id3-get-frame-long-name.html">id3_get_frame_long_name ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.id3.html">ID3</a></li>
    <li>ID3 º¯Êý</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.id3" class="reference">
 <h1 class="title">ID3 º¯Êý</h1>

 























































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.id3-get-frame-long-name.html">id3_get_frame_long_name</a> &mdash; Get the long name of an ID3v2 frame</li><li><a href="function.id3-get-frame-short-name.html">id3_get_frame_short_name</a> &mdash; Get the short name of an ID3v2 frame</li><li><a href="function.id3-get-genre-id.html">id3_get_genre_id</a> &mdash; Get the id for a genre</li><li><a href="function.id3-get-genre-list.html">id3_get_genre_list</a> &mdash; Get all possible genre values</li><li><a href="function.id3-get-genre-name.html">id3_get_genre_name</a> &mdash; Get the name for a genre id</li><li><a href="function.id3-get-tag.html">id3_get_tag</a> &mdash; Get all information stored in an ID3 tag</li><li><a href="function.id3-get-version.html">id3_get_version</a> &mdash; Get version of an ID3 tag</li><li><a href="function.id3-remove-tag.html">id3_remove_tag</a> &mdash; Remove an existing ID3 tag</li><li><a href="function.id3-set-tag.html">id3_set_tag</a> &mdash; Update information stored in an ID3 tag</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="72024""></a>
  <div class="note">
   <strong class="user">regindk at gmail dot com</strong>
   <a href="#72024" class="date">29-Dec-2006 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using the ID3 extension you might be interested in some more functionality for working with MP3-files that is missing in the PHP C-modules.<br />
<br />
Such as extracting for instance the first 10 seconds of a song, merging MP3 files, calculating the exact length of the MP3 file.<br />
<br />
The following class in pure PHP is available for that:<br />
<a href="http://www.sourcerally.net/Scripts/20-PHP-MP3-Class" rel="nofollow" target="_blank">http://www.sourcerally.net/Scripts/20-PHP-MP3-Class</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71191""></a>
  <div class="note">
   <strong class="user">jbwalker at telus dot net</strong>
   <a href="#71191" class="date">15-Nov-2006 08:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Windows XP users may be having trouble with routines provided here and may (as above) only have access to "read" classes. The following very simplified "write" can be used for replacing Windows Media Player file tags, and with care and adjustments, can be used more generally.
<br />

<br />
<span class="default">&lt;?php 
<br />
&nbsp;define</span><span class="keyword">(</span><span class="default">_Title</span><span class="keyword">,</span><span class="string">"TIT2"</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">define</span><span class="keyword">(</span><span class="default">_Artist</span><span class="keyword">,</span><span class="string">"TPE1"</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">define</span><span class="keyword">(</span><span class="default">_Group</span><span class="keyword">,</span><span class="string">"TPE2"</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">define</span><span class="keyword">(</span><span class="default">_Album</span><span class="keyword">,</span><span class="string">"TALB"</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">define</span><span class="keyword">(</span><span class="default">_Genre</span><span class="keyword">,</span><span class="string">"TCON"</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">define</span><span class="keyword">(</span><span class="default">_TrackNo</span><span class="keyword">,</span><span class="string">"TRCK"</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">define</span><span class="keyword">(</span><span class="default">_Year</span><span class="keyword">,</span><span class="string">"TYER"</span><span class="keyword">);
<br />
&nbsp;</span><span class="default">$frames </span><span class="keyword">= array(</span><span class="default">_Album</span><span class="keyword">=&gt;</span><span class="string">"The Ultimate Experience"</span><span class="keyword">,
<br />
&nbsp; </span><span class="default">_TrackNo</span><span class="keyword">=&gt;</span><span class="string">"1"</span><span class="keyword">,
<br />
&nbsp; </span><span class="default">_Title</span><span class="keyword">=&gt;</span><span class="string">"All along the watchtower"</span><span class="keyword">,
<br />
&nbsp; </span><span class="default">_Artist</span><span class="keyword">=&gt;</span><span class="string">"Jimi Hendrix"</span><span class="keyword">,
<br />
&nbsp; </span><span class="default">_Group</span><span class="keyword">=&gt;</span><span class="string">""</span><span class="keyword">,
<br />
&nbsp; </span><span class="default">_Year</span><span class="keyword">=&gt;</span><span class="string">"19xx"</span><span class="keyword">,
<br />
&nbsp; </span><span class="default">_Genre</span><span class="keyword">=&gt;</span><span class="string">"Rock"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">#..........................................
<br />
#&nbsp; &nbsp; &nbsp;&nbsp; WRITE ID3 TAGS (Write MP3 [v1, v2] 
<br />
#..........................................
<br />
</span><span class="keyword">function </span><span class="default">writeTags</span><span class="keyword">(</span><span class="default">$mp3</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fl </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$mp3</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Header </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fl</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tagLen </span><span class="keyword">= </span><span class="default">calcDecTagLen</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Header</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">),</span><span class="default">$tagLen</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$music </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$fl</span><span class="keyword">,</span><span class="default">$tagLen</span><span class="keyword">+</span><span class="default">10</span><span class="keyword">,-</span><span class="default">128</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment"># Can use input Header for output but you may 
<br />
&nbsp;&nbsp;&nbsp; # wish to change the output filename for testing
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tagLen </span><span class="keyword">= </span><span class="default">1024</span><span class="keyword">; </span><span class="comment"># or whatever you like &gt;your actual
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Header </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$Header</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">).</span><span class="default">setHexTagLen</span><span class="keyword">(</span><span class="default">$tagLen</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$mp3</span><span class="keyword">,</span><span class="default">mkV2Tag</span><span class="keyword">(</span><span class="default">$Header</span><span class="keyword">,</span><span class="default">$tagLen</span><span class="keyword">).</span><span class="default">$music</span><span class="keyword">.</span><span class="default">mkV1Tag</span><span class="keyword">());
<br />
}
<br />
</span><span class="comment">#&nbsp;&nbsp; Create the V2 tag
<br />
</span><span class="keyword">function </span><span class="default">mkV2Tag</span><span class="keyword">(</span><span class="default">$Hdr</span><span class="keyword">,</span><span class="default">$tagLen</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; Global </span><span class="default">$frames</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$null </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nl3 </span><span class="keyword">= </span><span class="default">$null</span><span class="keyword">.</span><span class="default">$null</span><span class="keyword">.</span><span class="default">$null</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># 0 bytes for flags and encoding
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$out </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$frames </span><span class="keyword">as </span><span class="default">$ky</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">.= </span><span class="default">$ky</span><span class="keyword">.</span><span class="default">mkFrmLen</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">).</span><span class="default">$nl3</span><span class="keyword">.</span><span class="default">$val</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$Hdr</span><span class="keyword">.</span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">,</span><span class="default">$tagLen</span><span class="keyword">,</span><span class="default">$null</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="comment">#&nbsp; &nbsp; Calculate Tag Length from bytes 6-10 of existing header
<br />
</span><span class="keyword">function </span><span class="default">calcDecTagLen</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$int </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&gt;-</span><span class="default">1</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">--) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$int </span><span class="keyword">+=</span><span class="default">$m</span><span class="keyword">*</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m</span><span class="keyword">=</span><span class="default">$m</span><span class="keyword">*</span><span class="default">128</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$int</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="comment">#&nbsp; &nbsp; Make the 4 byte frame length value for the V2tag
<br />
</span><span class="keyword">function </span><span class="default">mkFrmLen</span><span class="keyword">(</span><span class="default">$int</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hx </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$int</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">$int </span><span class="keyword">% </span><span class="default">256</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hx </span><span class="keyword">= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">).</span><span class="default">$hx</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$int</span><span class="keyword">=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$int</span><span class="keyword">/</span><span class="default">256</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$hx</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">),</span><span class="default">STR_PAD_LEFT</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="comment">#&nbsp; &nbsp; Create the 128 byte V1 tag
<br />
</span><span class="keyword">function </span><span class="default">mkV1Tag</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; Global </span><span class="default">$frames</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tagOut </span><span class="keyword">= </span><span class="string">"TAG"</span><span class="keyword">.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">adj</span><span class="keyword">(</span><span class="default">$frames</span><span class="keyword">[</span><span class="default">_Title</span><span class="keyword">]).
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">adj</span><span class="keyword">(</span><span class="default">$frames</span><span class="keyword">[</span><span class="default">_Artist</span><span class="keyword">]).
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">adj</span><span class="keyword">(</span><span class="default">$frames</span><span class="keyword">[</span><span class="default">_Album</span><span class="keyword">]).
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$frames</span><span class="keyword">[</span><span class="default">_Year</span><span class="keyword">],</span><span class="default">4</span><span class="keyword">).
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">str_pad</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">29</span><span class="keyword">,</span><span class="string">" "</span><span class="keyword">).
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$frames</span><span class="keyword">[</span><span class="default">_TrackNo</span><span class="keyword">]).
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$tagOut</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="comment">#&nbsp; &nbsp; Pad the header to 30 characters
<br />
</span><span class="keyword">function </span><span class="default">adj</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="default">30</span><span class="keyword">,</span><span class="default">chr</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)),</span><span class="default">0</span><span class="keyword">,</span><span class="default">30</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
</span><span class="comment">#&nbsp; &nbsp;&nbsp; This is a simple example for an mp3 in current folder&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">writeTags</span><span class="keyword">(</span><span class="string">"01-Cognac Blues.mp3"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The setHexTagLen can be figured out from the calcDecTagLen but here's some sample code.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">setHexTagLen</span><span class="keyword">(</span><span class="default">$int</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">128</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$intVar </span><span class="keyword">= </span><span class="default">$int</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">4</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$intVar</span><span class="keyword">/</span><span class="default">$n</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$intVar </span><span class="keyword">= </span><span class="default">$intVar </span><span class="keyword">% </span><span class="default">$n</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">=</span><span class="default">$n</span><span class="keyword">/</span><span class="default">128</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$m</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43978""></a>
  <div class="note">
   <strong class="user">wmd at wazee dot org</strong>
   <a href="#43978" class="date">11-Jul-2004 11:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There are several highly developed id3 reader classes written in php that include id3v2 support, and support for other file formats (not just mpeg &amp; id3). I recommend <a href="http://getid3.sourceforge.net/ as well as the id3 reader class integrated in the Zina is not Andromeda project (http://pancake.org/zina.html" rel="nofollow" target="_blank">http://getid3.sourceforge.net/ as well as the id3 reader class integrated in the Zina is not Andromeda project (http://pancake.org/zina.html</a>)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
