<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>错误处理 函数</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="errorfunc.examples.html">? 范例</a></li>
      <li style="float: right;"><a href="function.debug-backtrace.html">debug_backtrace ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.errorfunc.html">错误处理</a></li>
    <li>错误处理 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.errorfunc" class="reference">
 <h1 class="title">错误处理 函数</h1>
 <div class="partintro">
  <h1 class="title">参见</h1>
   <p class="para">
    参见 <span class="function"><a href="function.syslog.html" class="function">syslog()</a></span>.
   </p>
 </div>

 













  





























































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.debug-backtrace.html">debug_backtrace</a> &mdash; 产生一条回溯跟踪(backtrace)</li><li><a href="function.debug-print-backtrace.html">debug_print_backtrace</a> &mdash; 打印一条回溯。</li><li><a href="function.error-clear-last.html">error_clear_last</a> &mdash; Clear the most recent error</li><li><a href="function.error-get-last.html">error_get_last</a> &mdash; 获取最后发生的错误</li><li><a href="function.error-log.html">error_log</a> &mdash; 发送错误信息到某个地方</li><li><a href="function.error-reporting.html">error_reporting</a> &mdash; 设置应该报告何种 PHP 错误</li><li><a href="function.restore-error-handler.html">restore_error_handler</a> &mdash; 还原之前的错误处理函数</li><li><a href="function.restore-exception-handler.html">restore_exception_handler</a> &mdash; 恢复之前定义过的异常处理函数。</li><li><a href="function.set-error-handler.html">set_error_handler</a> &mdash; 设置一个用户定义的错误处理函数</li><li><a href="function.set-exception-handler.html">set_exception_handler</a> &mdash; 设置一个用户定义的异常处理函数。</li><li><a href="function.trigger-error.html">trigger_error</a> &mdash; 产生一个用户级别的 error/warning/notice 信息</li><li><a href="function.user-error.html">user_error</a> &mdash; trigger_error 的别名</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="79199""></a>
  <div class="note">
   <strong class="user">jbq at caraldi dot com</strong>
   <a href="#79199" class="date">15-Nov-2007 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Precision about error_log when configured with syslog: the syslog() call is done with severity NOTICE.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72445""></a>
  <div class="note">
   <strong class="user">Stephen</strong>
   <a href="#72445" class="date">19-Jan-2007 12:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using PHP as an Apache module, your default behavior may be to write PHP error messages to Apache's error log. This is because the error_log .ini directive may be set equal to "error_log" which is also the name of Apache's error log. I think this is intentional.<br />
<br />
However, you can separate Apache errors from PHP errors if you wish by simply setting a different value for error_log. I write mine in the /var/log folder.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72375""></a>
  <div class="note">
   <strong class="user">petrov dot michael () gmail com</strong>
   <a href="#72375" class="date">16-Jan-2007 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have found that on servers that enforce display_errors to be off it is very inconvenient to debug syntax errors since they cause fatal startup errors. I have used the following method to bypass this limitation:<br />
<br />
The syntax error is inside the file "syntax.php", therefore I create a file "syntax.debug.php" with the following code:<br />
<br />
<span class="default">&lt;?php<br />
error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'display_errors'</span><span class="keyword">,</span><span class="string">'On'</span><span class="keyword">);<br />
<br />
include(</span><span class="string">'syntax.php'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The 5 line file is guaranteed to be free of errors, allowing PHP to execute the directives within it before including the file which previously caused fatal startup errors. Now those fatal startup errors become run time fatal errors.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72238""></a>
  <div class="note">
   <strong class="user">mortonda at dgrmm dot net</strong>
   <a href="#72238" class="date">09-Jan-2007 02:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note the example code listed here calls date() every time this is called.&nbsp;&nbsp; If you have a complex source base which calls the custom error handler often, it can end up taking quite a bit of time.&nbsp; I ran a profiler on som code and discovered that 50% of the time was spent in the date function in this error handler.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68642""></a>
  <div class="note">
   <strong class="user">theotek AT nowhere DOT org</strong>
   <a href="#68642" class="date">04-Aug-2006 05:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is totally possible to use debug_backtrace() inside an error handling function. Here, take a look:<br />
<br />
<span class="default">&lt;?php<br />
set_error_handler</span><span class="keyword">(</span><span class="string">'errorHandler'</span><span class="keyword">);<br />
<br />
function </span><span class="default">errorHandler</span><span class="keyword">( </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">$errfile</span><span class="keyword">, </span><span class="default">$errline</span><span class="keyword">, </span><span class="default">$errcontext</span><span class="keyword">)<br />
{<br />
&nbsp; echo </span><span class="string">'Into '</span><span class="keyword">.</span><span class="default">__FUNCTION__</span><span class="keyword">.</span><span class="string">'() at line '</span><span class="keyword">.</span><span class="default">__LINE__</span><span class="keyword">.<br />
&nbsp; </span><span class="string">"\n\n---ERRNO---\n"</span><span class="keyword">. </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$errno</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">).<br />
&nbsp; </span><span class="string">"\n\n---ERRSTR---\n"</span><span class="keyword">. </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$errstr</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">).<br />
&nbsp; </span><span class="string">"\n\n---ERRFILE---\n"</span><span class="keyword">. </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$errfile</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">).<br />
&nbsp; </span><span class="string">"\n\n---ERRLINE---\n"</span><span class="keyword">. </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$errline</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">).<br />
&nbsp; </span><span class="string">"\n\n---ERRCONTEXT---\n"</span><span class="keyword">.</span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$errcontext</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">).<br />
&nbsp; </span><span class="string">"\n\nBacktrace of errorHandler()\n"</span><span class="keyword">.<br />
&nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">debug_backtrace</span><span class="keyword">(), </span><span class="default">true</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">a</span><span class="keyword">( )<br />
{<br />
&nbsp; </span><span class="comment">//echo "a()'s backtrace\n".print_r( debug_backtrace(), true);<br />
&nbsp; </span><span class="default">asdfasdf</span><span class="keyword">; </span><span class="comment">// oops<br />
</span><span class="keyword">}<br />
<br />
function </span><span class="default">b</span><span class="keyword">()<br />
{<br />
&nbsp; </span><span class="comment">//echo "b()'s backtrace\n".print_r( debug_backtrace(), true);<br />
&nbsp; </span><span class="default">a</span><span class="keyword">();<br />
}<br />
<br />
</span><span class="default">b</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs:<br />
<br />
&lt;raw&gt;<br />
<br />
Into errorhandler() at line 9<br />
<br />
---ERRNO---<br />
8<br />
<br />
---ERRSTR---<br />
Use of undefined constant asdfasdf - assumed 'asdfasdf'<br />
<br />
---ERRFILE---<br />
/home/theotek/test-1.php<br />
<br />
---ERRLINE---<br />
23<br />
<br />
---ERRCONTEXT---<br />
Array<br />
(<br />
)<br />
<br />
Backtrace of errorHandler()<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [function] =&gt; errorhandler<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [args] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; 8<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1] =&gt; Use of undefined constant asdfasdf - assumed 'asdfasdf'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [2] =&gt; /home/theotek/test-1.php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [3] =&gt; 23<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [4] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [file] =&gt; /home/theotek/test-1.php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [line] =&gt; 23<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [function] =&gt; a<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [file] =&gt; /home/theotek/test-1.php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [line] =&gt; 30<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [function] =&gt; a<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [args] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [file] =&gt; /home/theotek/test-1.php<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [line] =&gt; 33<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [function] =&gt; b<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [args] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
)<br />
<br />
&lt;/raw&gt;<br />
<br />
So, the first member of the backtrace's array is not really surprising, except from the missing "file" and "line" members. <br />
<br />
The second member of the backtrace seem the be a hook inside the zend engine that is used to trigger the error. <br />
<br />
Other members are the normal backtrace.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62122""></a>
  <div class="note">
   <strong class="user">email_php_28429 at wg-karlsruhe dot de</strong>
   <a href="#62122" class="date">20-Feb-2006 08:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you cannot use php 5+ and if you do not know, when your administrator/provider will update to a newer php-version, this could be interesting. otherwise it surely is not. ;-)<br />
<br />
if you use the example above "example 1: using error handling in a script" with a php version prior to php 5, the part<br />
<br />
<span class="default">&lt;?php<br />
$errortype </span><span class="keyword">= array(<br />
&nbsp; </span><span class="comment">// ...<br />
&nbsp; </span><span class="default">E_STRICT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">"Runtime Notice"</span><span class="keyword">);</span><span class="default">?&gt;<br />
</span><br />
will throw a notice like<br />
"Use of undefined constant E_STRICT - assumed 'E_STRICT'".<br />
<br />
of course one could avoid this problem, with<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'E_STRICT'</span><span class="keyword">)) </span><span class="default">define</span><span class="keyword">(</span><span class="string">'E_STRICT'</span><span class="keyword">, </span><span class="default">2048</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>.<br />
<br />
but this _could_ generate problems in future versions of php, if E_STRICT is set to 42 or something else.<br />
<br />
for this reason i suggest<br />
<br />
<span class="default">&lt;?php<br />
$errortype </span><span class="keyword">= array(<br />
&nbsp; </span><span class="default">E_ERROR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">'error'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_WARNING&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">'warning'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_PARSE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">'parsing error'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_NOTICE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">'notice'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_CORE_ERROR&nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">'core error'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_CORE_WARNING&nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">'core warning'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_COMPILE_ERROR&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">'compile error'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_COMPILE_WARNING </span><span class="keyword">=&gt; </span><span class="string">'compile warning'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_USER_ERROR&nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">'user error'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_USER_WARNING&nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">'user warning'</span><span class="keyword">,<br />
&nbsp; </span><span class="default">E_USER_NOTICE&nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="string">'user notice'</span><span class="keyword">);<br />
if(</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'E_STRICT'</span><span class="keyword">))<br />
&nbsp; </span><span class="default">$errortype</span><span class="keyword">[</span><span class="default">E_STRICT</span><span class="keyword">] = </span><span class="string">'runtime notice'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// and instead of <br />
// error_reporting(E_ALL | E_STRICT);<br />
// one can use<br />
</span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">E_ALL </span><span class="keyword">| (</span><span class="default">defined</span><span class="keyword">(</span><span class="string">'E_STRICT'</span><span class="keyword">)? </span><span class="default">E_STRICT </span><span class="keyword">: </span><span class="default">0</span><span class="keyword">));<br />
</span><span class="comment">// to avoid that notice.<br />
</span><span class="default">?&gt;<br />
</span><br />
prosit<br />
seth</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59192""></a>
  <div class="note">
   <strong class="user">tracerdx at tracerdx dot com</strong>
   <a href="#59192" class="date">29-Nov-2005 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I keep seeing qualification lists for error types/error-nums as arrays; In user notes and in the manual itself. For example, in this manual entry's example, when trying to seperate behavior for the variable trace in the error report:<br />
<br />
<span class="default">&lt;?php </span><span class="comment">//...<br />
<br />
// set of errors for which a var trace will be saved<br />
</span><span class="default">$user_errors </span><span class="keyword">= array(</span><span class="default">E_USER_ERROR</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">, </span><span class="default">E_USER_NOTICE</span><span class="keyword">);<br />
<br />
</span><span class="comment">//and later...<br />
<br />
</span><span class="keyword">if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$errno</span><span class="keyword">, </span><span class="default">$user_errors</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//...whatever<br />
</span><span class="keyword">}<br />
<br />
</span><span class="comment">//... </span><span class="default">?&gt;<br />
</span><br />
I was under the impression that PHP error code values where bitwise flag values. Wouldn't bitwise masking be better? So I propose a slightly better way:<br />
<span class="default">&lt;?php </span><span class="comment">//...<br />
<br />
</span><span class="default">$user_errors </span><span class="keyword">= </span><span class="default">E_USER_ERROR </span><span class="keyword">| </span><span class="default">E_USER_WARNING </span><span class="keyword">| </span><span class="default">E_USER_NOTICE</span><span class="keyword">;<br />
<br />
</span><span class="comment">//...blah...<br />
<br />
</span><span class="keyword">if (</span><span class="default">$errno </span><span class="keyword">&amp; </span><span class="default">$user_errors</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//...whatever<br />
</span><span class="keyword">}<br />
<br />
</span><span class="comment">//... </span><span class="default">?&gt;<br />
</span>Or for those of you who don't like the idea of using an integer as the condition in an if statement:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if ((</span><span class="default">$errno </span><span class="keyword">&amp; </span><span class="default">$user_errors</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//...whatever<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
I think that's much more efficient than using _yet another_ array() constuct and an in_array().<br />
<br />
If I am wrong, and the E_* constants aren't supposed to be used in this fashion (ie, the constans aren't guaranteed to be bitwise, which would be odd since that's how they're setup in the php.ini file), then delete me. I just don't see why one should be using arrays when bitwise comparisons will work, considering the bitwise method should be MUCH more efficient.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53025""></a>
  <div class="note">
   
   <a href="#53025" class="date">21-May-2005 01:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When configuring your error log file in php.ini, you can use an absolute path or a relative path.&nbsp; A relative path will be resolved based on the location of the generating script, and you'll get a log file in each directory you have scripts in.&nbsp; If you want all your error messages to go to the same file, use an absolute path to the file.<br />
<br />
In some application development methodologies, there is the concept of an application root directory, indicated by "/" (even on Windows).&nbsp; However, PHP does not seem to have this concept, and using a "/" as the initial character in a log file path produces weird behavior on Windows.<br />
<br />
If you are running on Windows and have set, in php.ini:<br />
<br />
&nbsp; error_log = "/php_error.log"<br />
<br />
You will get some, but not all, error messages.&nbsp; The file will appear at<br />
<br />
&nbsp; c:\php_error.log<br />
<br />
and contain internally generated error messages, making it appear that error logging is working.&nbsp; However, log messages requested by error_log() do NOT appear here, or anywhere else, making it appear that the code containing them did not get processed.<br />
<br />
Apparently on Windows the internally generated errors will interpret "/" as "C:\" (or possibly a different drive if you have Windows installed elsewhere - I haven't tested this).&nbsp; However, the error_log process apparently can't find "/" - understandably enough - and the message is dropped silently.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49438""></a>
  <div class="note">
   <strong class="user">shawing at gmail dot com</strong>
   <a href="#49438" class="date">27-Jan-2005 11:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Although the root user writes to the files 'error_log' and 'access_log', the Apache user has to own the file referenced by 'error_log = filename' or no log entries will be written.<br />
<br />
; From php.ini<br />
; Log errors to specified file.<br />
error_log = /usr/local/apache/logs/php.errors<br />
<br />
[root@www logs]$ ls -l /usr/local/apache/logs/php.errors<br />
-rw-r--r--&nbsp; &nbsp; 1 nobody&nbsp;&nbsp; root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 27K Jan 27 16:58 php.errors</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45535""></a>
  <div class="note">
   <strong class="user">ptah at se dot linux dot org</strong>
   <a href="#45535" class="date">10-Sep-2004 02:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP5 only (only tested with php5.0).<br />
<br />
If you, for some reason, prefer exceptions over errors and have your custom error handler (set_error_handler) wrap the error into an exception you have to be careful with your script.<br />
<br />
Because if you, instead of just calling the exception handler, throws the exception, and having a custom exception handler (set_exception_handler). And an error is being triggered inside that exception handler, you will get a weird error:<br />
"Fatal error: Exception thrown without a stack frame in Unknown on line 0"<br />
<br />
This error is not particulary informative, is it? :)<br />
<br />
This example below will cause this error.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">PHPErrorException </span><span class="keyword">extends </span><span class="default">Exception<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$context </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">(</span><span class="default">$code</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">$context </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$message</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">file </span><span class="keyword">= </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">line </span><span class="keyword">= </span><span class="default">$line</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">context </span><span class="keyword">= </span><span class="default">$context</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
};<br />
<br />
function </span><span class="default">error_handler</span><span class="keyword">(</span><span class="default">$code</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; throw new </span><span class="default">PHPErrorException</span><span class="keyword">(</span><span class="default">$code</span><span class="keyword">, </span><span class="default">$message</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">exception_handler</span><span class="keyword">(</span><span class="default">Exception $e</span><span class="keyword">)<br />
{&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$errors </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">E_USER_ERROR&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">"User Error"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">E_USER_WARNING&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">"User Warning"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">E_USER_NOTICE&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="string">"User Notice"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$errors</span><span class="keyword">[</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getCode</span><span class="keyword">()].</span><span class="string">': '</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">().</span><span class="string">' in '</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getFile</span><span class="keyword">().<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">' on line '</span><span class="keyword">.</span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getLine</span><span class="keyword">().</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">();<br />
}<br />
<br />
</span><span class="default">set_error_handler</span><span class="keyword">(</span><span class="string">'error_handler'</span><span class="keyword">);<br />
</span><span class="default">set_exception_handler</span><span class="keyword">(</span><span class="string">'exception_handler'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Throw exception with an /unkown/ error code.<br />
</span><span class="keyword">throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
There are however, easy fix for this as it's only cause is sloppy code.<br />
Like one, directly call exception_handler from error_handler instead of throwing an exception. Not only does it remedy this problem, but it's also faster. Though this will cause a `regular` unhandled exception being printed and if only "designed" error messages are intended, this is not the ultimate solution.<br />
<br />
So, what is there to do? Make sure the code in exception_handlers doesn't cause any errors! In this case a simple isset() would have solved it.<br />
<br />
regards, C-A B.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
