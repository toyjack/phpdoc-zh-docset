<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>删除文件</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.umask.html">? umask</a></li>
      <li style="float: right;"><a href="book.inotify.html">Inotify ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">Filesystem 函数</a></li>
    <li>删除文件</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.unlink" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">unlink</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">unlink</span> &mdash; <span class="dc-title">删除文件</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.unlink-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>unlink</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   [, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$context</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   删除 <code class="parameter">filename</code>。和 Unix C 的
   unlink() 函数相似。
   发生错误时会产生一个 <strong><code>E_WARNING</code></strong> 级别的错误。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.unlink-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       文件的路径。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">context</code></dt>

     <dd>

      <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">在 PHP 5.0.0
中增加了对上下文（Context）的支持。有关<em>上下文（Context）</em>的说明参见
<a href="book.stream.html" class="xref">Streams</a>。</span></p></blockquote>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.unlink-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>， 或者在失败时返回 <strong><code>FALSE</code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.unlink-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.0.0</td>
       <td>
         自 PHP 5.0.0 起
    <span class="function"><strong>unlink()</strong></span> 也可以用于<em class="emphasis">某些</em>
    URL 封装协议。参考<a href="wrappers.html" class="xref">支持的协议和封装协议</a> 中的列表看哪些封装协议支持
    <span class="function"><strong>unlink()</strong></span>。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.unlink-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2453">
    <p><strong>Example #1 基本的 <span class="function"><strong>unlink()</strong></span> 用法</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$fh&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.html'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'a'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fh</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'&lt;h1&gt;Hello&nbsp;world!&lt;/h1&gt;'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fh</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">unlink</span><span style="color: #007700">(</span><span style="color: #DD0000">'test.html'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.unlink-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.rmdir.html" class="function" rel="rdfs-seeAlso">rmdir()</a> - 删除目录</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116013""></a>
  <div class="note">
   <strong class="user">softontherocks at gmail dot com</strong>
   <a href="#116013" class="date">30-Oct-2014 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here you have a function to delete a directory and subdirectories recursively:<br />
<br />
function deleteDirectory($dir){<br />
&nbsp;&nbsp;&nbsp; $result = false;<br />
&nbsp;&nbsp;&nbsp; if ($handle = opendir("$dir")){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result = true;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while ((($file=readdir($handle))!==false) &amp;&amp; ($result)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($file!='.' &amp;&amp; $file!='..'){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (is_dir("$dir/$file")){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = deleteDirectory("$dir/$file");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = unlink("$dir/$fich");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; closedir($handle);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($result){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = rmdir($dir);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $result;<br />
}<br />
<br />
The source is found in <a href="http://softontherocks.blogspot.com/2014/09/eliminar-un-directorio-completo-con-php.html" rel="nofollow" target="_blank">http://softontherocks.blogspot.com/2014/09/eliminar-un-directorio-completo-con-php.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115537""></a>
  <div class="note">
   <strong class="user">Eric</strong>
   <a href="#115537" class="date">11-Aug-2014 11:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might seem obvious, but I was tearing my hair out with this problem - make sure the file you're trying to delete isn't currently being used. I had a script that was parsing a text file and was supposed to delete it after completing, but kept getting a permission denied error because I hadn't explicitly closed the file, hence it was technically still being "used" even though the parsing was complete.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114778""></a>
  <div class="note">
   <strong class="user">Set</strong>
   <a href="#114778" class="date">05-Apr-2014 12:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">// for deleting in other directory<br />
<br />
</span><span class="default">unlink</span><span class="keyword">(</span><span class="string">"dir/" </span><span class="keyword">.</span><span class="default">$file </span><span class="keyword">); </span><span class="comment">//or<br />
</span><span class="default">unlink</span><span class="keyword">(</span><span class="string">"<a href="http://www.localhost/dir/" rel="nofollow" target="_blank">http://www.localhost/dir/</a>" </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113854""></a>
  <div class="note">
   <strong class="user">deen804 at gmail dot com</strong>
   <a href="#113854" class="date">10-Dec-2013 03:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
unlink($fileName); failed for me .<br />
Then i tried using the realpath($fileName)&nbsp; function as <br />
unlink(realpath($fileName)); it worked <br />
<br />
just posting it , in case if any one finds it useful .</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113522""></a>
  <div class="note">
   <strong class="user">james at dunmore dot me dot uk</strong>
   <a href="#113522" class="date">24-Oct-2013 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I know it is obvious, but.... if you have nested symlinks (for example, we archive into yyyy-mm for backups, and symbolic link to make our directory structure look flat - don't ask), unlink will only delete the top level symlink (as expected). <br />
<br />
If you want to delete the actual file, you'll need to use readlink. If you want to delete all of the files and the symlinks, you'll need to recurse up and down to achieve that.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112532""></a>
  <div class="note">
   <strong class="user">Alex, the Marrch Ca&amp;#39;at</strong>
   <a href="#112532" class="date">27-Jun-2013 01:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The best way to delete files by mask is as follows:<br />
<span class="default">&lt;?php<br />
array_walk</span><span class="keyword">(</span><span class="default">glob</span><span class="keyword">(</span><span class="string">'/etc/*'</span><span class="keyword">), </span><span class="string">'unlink'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Do not use array_map mentioned below - it's purpose is to process values in a given array AND COLLECT data returned by the callback function. So, array_map is slower and uses additional memory compared to array_walk.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109971""></a>
  <div class="note">
   <strong class="user">anagai at yahoo dot com</strong>
   <a href="#109971" class="date">07-Sep-2012 04:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This will delete all files in a directory matching a pattern in one line of code.
<br />

<br />
<span class="default">&lt;?php array_map</span><span class="keyword">(</span><span class="string">'unlink'</span><span class="keyword">, </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"some/dir/*.txt"</span><span class="keyword">)); </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108940""></a>
  <div class="note">
   <strong class="user">to dot want at in dot com</strong>
   <a href="#108940" class="date">07-Jun-2012 03:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
remove directory with all content<br />
<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">= </span><span class="string">"boss"</span><span class="keyword">; </span><span class="comment">// directory name<br />
</span><span class="default">?&gt;<br />
</span><br />
<span class="default">&lt;?php<br />
</span><span class="keyword">foreach (</span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) as </span><span class="default">$item</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$item </span><span class="keyword">== </span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$item </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">) continue;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">.</span><span class="default">$item</span><span class="keyword">);<br />
}<br />
</span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108504""></a>
  <div class="note">
   <strong class="user">bitman3 at rambler dot ru</strong>
   <a href="#108504" class="date">02-May-2012 06:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This code deletes all files from directory, but there's a secret :)<br />
I killed a lot of time before I realized my mistake.<br />
I used jquery to create event in frame.<br />
@ - it`s a secret :)<br />
<br />
$dir = '../upload_tmp/';<br />
if($dh = opendir($dir)){<br />
&nbsp;&nbsp;&nbsp; while(($file = readdir($dh))!== false){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(file_exists($dir.$file)) @unlink($dir.$file);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; closedir($dh);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101637""></a>
  <div class="note">
   <strong class="user">dexen dot devries at gmail dot com</strong>
   <a href="#101637" class="date">31-Dec-2010 10:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Deleted a large file but seeing no increase in free space or decrease of disk usage? Using UNIX or other POSIX OS?<br />
<br />
The unlink() is not about removing file, it's about removing a file name. The manpage says: ``unlink - delete a name and possibly the file it refers to''.<br />
<br />
Most of the time a file has just one name -- removing it will also remove (free, deallocate) the `body' of file (with one caveat, see below). That's the simple, usual case.<br />
<br />
However, it's perfectly fine for a file to have several names (see the link() function), in the same or different directories. All the names will refer to the file body and `keep it alive', so to say. Only when all the names are removed, the body of file actually is freed.<br />
<br />
The caveat:<br />
A file's body may *also* be `kept alive' (still using diskspace) by a process holding the file open. The body will not be deallocated (will not free disk space) as long as the process holds it open. In fact, there's a fancy way of resurrecting a file removed by a mistake but still held open by a process...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101261""></a>
  <div class="note">
   <strong class="user">federico at poisonfx dot com</strong>
   <a href="#101261" class="date">06-Dec-2010 11:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here the simplest way to delete files with mask<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $mask </span><span class="keyword">= </span><span class="string">"*.jpg"<br />
&nbsp;&nbsp; </span><span class="default">array_map</span><span class="keyword">( </span><span class="string">"unlink"</span><span class="keyword">, </span><span class="default">glob</span><span class="keyword">( </span><span class="default">$mask </span><span class="keyword">) );<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100580""></a>
  <div class="note">
   <strong class="user">lpatrick</strong>
   <a href="#100580" class="date">25-Oct-2010 11:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
unlink can fail after using ODBC commands on the file (on Windows).<br />
<br />
Neither <span class="default">&lt;?php odbc_free_result</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">); </span><span class="default">?&gt;</span> nor <span class="default">&lt;?php odbc_close</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">); unset(</span><span class="default">$conn</span><span class="keyword">); </span><span class="default">?&gt;</span> did the trick.<br />
<br />
Only <span class="default">&lt;?php odbc_close_all</span><span class="keyword">(); </span><span class="default">?&gt;</span> released the file such that it could be deleted afterwards ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100092""></a>
  <div class="note">
   <strong class="user">zibi at nora dot pl</strong>
   <a href="#100092" class="date">24-Sep-2010 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Shorter'n'faster version of Eddys "The shortest recursive delete possible"<br />
<br />
function rrmdir($path)<br />
{<br />
&nbsp; return is_file($path)?<br />
&nbsp;&nbsp;&nbsp; @unlink($path):<br />
&nbsp;&nbsp;&nbsp; array_map('rrmdir',glob($path.'/*'))==@rmdir($path)<br />
&nbsp; ;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94766""></a>
  <div class="note">
   <strong class="user">Eddy Vlad</strong>
   <a href="#94766" class="date">24-Nov-2009 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The shortest recursive delete possible.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Delete a file or recursively delete a directory<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param string $str Path to file or directory<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">recursiveDelete</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return @</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$scan </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">'/'</span><span class="keyword">).</span><span class="string">'/*'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$scan </span><span class="keyword">as </span><span class="default">$index</span><span class="keyword">=&gt;</span><span class="default">$path</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">recursiveDelete</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return @</span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87045""></a>
  <div class="note">
   <strong class="user">Jon Hassall</strong>
   <a href="#87045" class="date">16-Nov-2008 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is the recursive delete method made a little more readable:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* Recursively delete a directory
<br />
&nbsp;*
<br />
&nbsp;* @param string $dir Directory name
<br />
&nbsp;* @param boolean $deleteRootToo Delete specified top-level directory as well
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">unlinkRecursive</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$deleteRootToo</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$dh </span><span class="keyword">= @</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)))
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$obj </span><span class="keyword">== </span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$obj </span><span class="keyword">== </span><span class="string">'..'</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!@</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/' </span><span class="keyword">. </span><span class="default">$obj</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">unlinkRecursive</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$deleteRootToo</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86734""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#86734" class="date">01-Nov-2008 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To unlink, the web server user must have write permissions to the directory.<br />
<br />
Conversely, if a user has write permissions to a directory, it may delete files from that directory regardless of who owns them...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86302""></a>
  <div class="note">
   <strong class="user">hi at hi dot hi</strong>
   <a href="#86302" class="date">12-Oct-2008 05:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
using this function with windows will generate an error, make sure to use is_file</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86062""></a>
  <div class="note">
   <strong class="user">http://www.paladinux.net</strong>
   <a href="#86062" class="date">01-Oct-2008 05:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under Windows System and Apache, denied access to file is an usual error to unlink file.
<br />
To delete file you must to change file's owern.
<br />
An example:
<br />

<br />
<span class="default">&lt;?php
<br />
chown</span><span class="keyword">(</span><span class="default">$TempDirectory</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$FileName</span><span class="keyword">,</span><span class="default">666</span><span class="keyword">); </span><span class="comment">//Insert an Invalid UserId to set to Nobody Owern; 666 is my standard for "Nobody"
<br />
</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$TempDirectory</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$FileName</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85938""></a>
  <div class="note">
   <strong class="user">gotdalife at gmail dot com</strong>
   <a href="#85938" class="date">25-Sep-2008 04:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To anyone who's had a problem with the permissions denied error, it's sometimes caused when you try to delete a file that's in a folder higher in the hierarchy to your working directory (i.e. when trying to delete a path that starts with "../").<br />
<br />
So to work around this problem, you can use chdir() to change the working directory to the folder where the file you want to unlink is located.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $old </span><span class="keyword">= </span><span class="default">getcwd</span><span class="keyword">(); </span><span class="comment">// Save the current directory<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">chdir</span><span class="keyword">(</span><span class="default">$path_to_file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">chdir</span><span class="keyword">(</span><span class="default">$old</span><span class="keyword">); </span><span class="comment">// Restore the old working directory&nbsp; &nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85443""></a>
  <div class="note">
   <strong class="user">southsentry at yahoo dot com</strong>
   <a href="#85443" class="date">31-Aug-2008 07:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is in response to alvaro at demogracia dot com<br />
<br />
Yes, I found that out and have had to wrap it with is_file:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(</span><span class="default">is_file</span><span class="keyword">(</span><span class="string">"</span><span class="default">$file</span><span class="string">"</span><span class="keyword">)) {<br />
</span><span class="default">unlink</span><span class="keyword">(</span><span class="string">"</span><span class="default">$file</span><span class="string">"</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84928""></a>
  <div class="note">
   <strong class="user">PD</strong>
   <a href="#84928" class="date">06-Aug-2008 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have been working on some little tryout where a backup file was created before modifying the main textfile. Then when an error is thrown, the main file will be deleted (unlinked) and the backup file is returned instead.<br />
<br />
Though, I have been breaking my head for about an hour on why I couldn't get my persmissions right to unlink the main file.<br />
<br />
Finally I knew what was wrong: because I was working on the file and hadn't yet closed the file, it was still in use and ofcourse couldn't be deleted :)<br />
<br />
So I thought of mentoining this here, to avoid others of making the same mistake:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// First close the file<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Then unlink :)<br />
</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$somefile</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79940""></a>
  <div class="note">
   <strong class="user">ayor ATTTTT ayor.biz</strong>
   <a href="#79940" class="date">20-Dec-2007 03:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ggarciaa's post above has already one small error, closedir has to be used even if $DeleteMe is false<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// ggarciaa at gmail dot com (04-July-2007 01:57)<br />
// I needed to empty a directory, but keeping it<br />
// so I slightly modified the contribution from<br />
// stefano at takys dot it (28-Dec-2005 11:57)<br />
// A short but powerfull recursive function<br />
// that works also if the dirs contain hidden files<br />
//<br />
// $dir = the target directory<br />
// $DeleteMe = if true delete also $dir, if false leave it alone<br />
<br />
</span><span class="keyword">function </span><span class="default">SureRemoveDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$DeleteMe</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$dh </span><span class="keyword">= @</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) return;<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$obj</span><span class="keyword">==</span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$obj</span><span class="keyword">==</span><span class="string">'..'</span><span class="keyword">) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!@</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">)) </span><span class="default">SureRemoveDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$DeleteMe</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">//SureRemoveDir('EmptyMe', false);<br />
//SureRemoveDir('RemoveMe', true);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76875""></a>
  <div class="note">
   <strong class="user">rahulnvaidya at gmail dot com</strong>
   <a href="#76875" class="date">03-Aug-2007 11:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
ggarciaa's post above has one small error, it will ignore file and directory strings that are evaluated as false (ie. "0")<br />
<br />
Fixed code is below (false !==)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// ggarciaa at gmail dot com (04-July-2007 01:57)<br />
// I needed to empty a directory, but keeping it<br />
// so I slightly modified the contribution from<br />
// stefano at takys dot it (28-Dec-2005 11:57)<br />
// A short but powerfull recursive function<br />
// that works also if the dirs contain hidden files<br />
//<br />
// $dir = the target directory<br />
// $DeleteMe = if true delete also $dir, if false leave it alone<br />
<br />
</span><span class="keyword">function </span><span class="default">SureRemoveDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$DeleteMe</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$dh </span><span class="keyword">= @</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) return;<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$obj</span><span class="keyword">==</span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$obj</span><span class="keyword">==</span><span class="string">'..'</span><span class="keyword">) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!@</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">)) </span><span class="default">SureRemoveDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$DeleteMe</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">//SureRemoveDir('EmptyMe', false);<br />
//SureRemoveDir('RemoveMe', true);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76186""></a>
  <div class="note">
   <strong class="user">ggarciaa at gmail dot com</strong>
   <a href="#76186" class="date">04-Jul-2007 08:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">// ggarciaa at gmail dot com (04-July-2007 01:57)<br />
// I needed to empty a directory, but keeping it<br />
// so I slightly modified the contribution from<br />
// stefano at takys dot it (28-Dec-2005 11:57)<br />
// A short but powerfull recursive function<br />
// that works also if the dirs contain hidden files<br />
//<br />
// $dir = the target directory<br />
// $DeleteMe = if true delete also $dir, if false leave it alone<br />
<br />
</span><span class="keyword">function </span><span class="default">SureRemoveDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">, </span><span class="default">$DeleteMe</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$dh </span><span class="keyword">= @</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)) return;<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$obj</span><span class="keyword">==</span><span class="string">'.' </span><span class="keyword">|| </span><span class="default">$obj</span><span class="keyword">==</span><span class="string">'..'</span><span class="keyword">) continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!@</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">)) </span><span class="default">SureRemoveDir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$obj</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$DeleteMe</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">//SureRemoveDir('EmptyMe', false);<br />
//SureRemoveDir('RemoveMe', true);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71328""></a>
  <div class="note">
   <strong class="user">torch at torchsdomain dot com</strong>
   <a href="#71328" class="date">22-Nov-2006 09:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is simple function that will find and remove all files (except "." ones) that match the expression ($match, "*" as wildcard) under starting directory ($path) and all other directories under it.<br />
<br />
function rfr($path,$match){<br />
&nbsp;&nbsp; static $deld = 0, $dsize = 0;<br />
&nbsp;&nbsp; $dirs = glob($path."*");<br />
&nbsp;&nbsp; $files = glob($path.$match);<br />
&nbsp;&nbsp; foreach($files as $file){<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(is_file($file)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $dsize += filesize($file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; unlink($file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $deld++;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; foreach($dirs as $dir){<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(is_dir($dir)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $dir = basename($dir) . "/";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; rfr($path.$dir,$match);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return "$deld files deleted with a total size of $dsize bytes";<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70037""></a>
  <div class="note">
   <strong class="user">bmcouto at hotmail dot com</strong>
   <a href="#70037" class="date">30-Sep-2006 10:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
$myFile </span><span class="keyword">= </span><span class="string">"testFile.txt"</span><span class="keyword">;
<br />
</span><span class="default">$fh </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$myFile</span><span class="keyword">, </span><span class="string">'w'</span><span class="keyword">) or die(</span><span class="string">"can't open file"</span><span class="keyword">);
<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fh</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Now to delete testFile.txt we simply run a PHP script that is located in the same directory. Unlink just needs to know the name of the file to start working its destructive magic.
<br />

<br />
<span class="default">&lt;?php
<br />
$myFile </span><span class="keyword">= </span><span class="string">"testFile.txt"</span><span class="keyword">;
<br />
</span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$myFile</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The testFile.txt should now be removed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53549""></a>
  <div class="note">
   <strong class="user">bishop</strong>
   <a href="#53549" class="date">05-Jun-2005 09:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* rm() -- Vigorously erase files and directories.<br />
&nbsp;* <br />
&nbsp;* @param $fileglob mixed If string, must be a file name (foo.txt), glob pattern (*.txt), or directory name.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If array, must be an array of file names, glob patterns, or directories.<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">rm</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ok </span><span class="keyword">= </span><span class="default">rm</span><span class="keyword">(</span><span class="string">"</span><span class="default">$fileglob</span><span class="string">/*"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (! </span><span class="default">$ok</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$matching </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$matching </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'No files match supplied glob %s'</span><span class="keyword">, </span><span class="default">$fileglob</span><span class="keyword">), </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rcs </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'rm'</span><span class="keyword">, </span><span class="default">$matching</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">, </span><span class="default">$rcs</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; } else if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$fileglob</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rcs </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'rm'</span><span class="keyword">, </span><span class="default">$fileglob</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">, </span><span class="default">$rcs</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'Param #1 must be filename or glob pattern, or array of filenames or glob patterns'</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53027""></a>
  <div class="note">
   <strong class="user">jchase at solidmark dot com</strong>
   <a href="#53027" class="date">21-May-2005 07:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editor's note: A suggestion for a work-around was submitted by argistof at gmail dot com: You can use the recursive option (see man chmod) when chmodding, for instance 'chmod 777 directory/ -R'. Be aware though, this will change the permissions of all files and folders in the diectory.]
<br />

<br />
Just a note which you probably all know, but I didn't, and it might save another poor sap some unnecessary time:
<br />

<br />
I was doing unlink() and fopen() on a file and got a permission denied error, even after chmoding the file to 0777.&nbsp; 
<br />

<br />
The folder that contains the file must ALSO have write permission.&nbsp; Took a headache to find this out.&nbsp; 
<br />

<br />
Hope this helps someone :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51517""></a>
  <div class="note">
   <strong class="user">ashley at semantic dot org</strong>
   <a href="#51517" class="date">02-Apr-2005 11:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Actually you should use "@unlink" rather than testing with file_exists. The former is atomic, whereas the latter can break if you can't guarantee only one process will try to delete a given file at a time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49728""></a>
  <div class="note">
   <strong class="user">dagski_AT_gmail_DOT_com</strong>
   <a href="#49728" class="date">07-Feb-2005 07:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
before you could unlink a file created which uses a handle e.g., <br />
<br />
$handle = sqlite('temp.db'); <br />
<br />
unset($handle); first befofe<br />
unlink($handle);<br />
<br />
to avoide permission denied error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45665""></a>
  <div class="note">
   <strong class="user">chris at vibenewmedia dot com</strong>
   <a href="#45665" class="date">14-Sep-2004 07:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To delete all files of a particular extension, or infact, delete all with wildcard, a much simplar way is to use the glob function.&nbsp; Say I wanted to delete all jpgs .........<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="string">"*.jpg"</span><span class="keyword">) as </span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$filename</span><span class="string"> size " </span><span class="keyword">. </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45470""></a>
  <div class="note">
   <strong class="user">pc AT newagelab DOT com DOT ua</strong>
   <a href="#45470" class="date">08-Sep-2004 05:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To delete files using wildcards:
<br />

<br />
&lt;?
<br />
function delfile($str)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; foreach(glob($str) as $fn) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unlink($fn);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
