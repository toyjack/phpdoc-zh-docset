<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>取得 GMT 日期的 UNIX 时间戳</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.gmdate.html">? gmdate</a></li>
      <li style="float: right;"><a href="function.gmstrftime.html">gmstrftime ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.datetime.html">Date/Time 函数</a></li>
    <li>取得 GMT 日期的 UNIX 时间戳</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.gmmktime" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">gmmktime</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">gmmktime</span> &mdash; <span class="dc-title">取得 GMT 日期的 UNIX 时间戳</span></p>

 </div>
 <div class="refsect1 unknown-unknown-exampleu" id="refsect1-function.gmmktime-unknown-unknown-exampleu">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">int</span> <span class="methodname"><strong>gmmktime</strong></span>
    ([ <span class="methodparam"><span class="type">int</span> <code class="parameter">$hour</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$minute</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$second</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$month</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$day</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$year</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$is_dst</code></span>
  ]]]]]]] )</div>

  <p class="para rdfs-comment">
   和 <span class="function"><a href="function.mktime.html" class="function">mktime()</a></span> 完全一样，只除了返回值是格林威治标准时的时间戳。
  </p>
  <p class="para">
   参数总是表示 GMT 日期，因此 <code class="parameter">is_dst</code>
   对结果没有影响。
  </p>
  <p class="para">
   和 <span class="function"><a href="function.mktime.html" class="function">mktime()</a></span>
   一样，参数可以从右到左依次空着，空着的参数会被设为相应的当前 GMT 值。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    自 5.1.0 起，<code class="parameter">is_dst</code> 参数被废弃。因此应该用新的时区处理特性。
   </p>
  </p></blockquote>
  <p class="para">
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <span class="simpara">
     <span class="function"><strong>gmmktime()</strong></span> 内部使用了
     <span class="function"><a href="function.mktime.html" class="function">mktime()</a></span>，因此只有转换成本地时间也合法的时间才能用在其中。
     so only times valid in derived local time can be used.
    </span>
   </p></blockquote>
   <div class="example" id="example-2470">
    <p><strong>Example #1 <span class="function"><strong>gmmktime()</strong></span> 在 Windows 中的边界</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />gmmktime</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1970</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;在&nbsp;GMT&nbsp;和西方合法，在东方不合法<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   参见 <span class="function"><a href="function.mktime.html" class="function">mktime()</a></span>，<span class="function"><a href="function.date.html" class="function">date()</a></span>
   和 <span class="function"><a href="function.time.html" class="function">time()</a></span>。
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="90714""></a>
  <div class="note">
   <strong class="user">babonk at irc dot freenode dot net</strong>
   <a href="#90714" class="date">05-May-2009 10:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
GMT time is useful for avoiding the daylight's savings issue.&nbsp; I had to use it to get a working date difference function:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">dateDiff</span><span class="keyword">(</span><span class="default">$date1</span><span class="keyword">, </span><span class="default">$date2</span><span class="keyword">) </span><span class="comment">//returns the difference, in days, between two dates.&nbsp; avoids the daylight's savings issue by using GMT
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$date1 </span><span class="keyword">= </span><span class="default">date_parse</span><span class="keyword">(</span><span class="default">$date1</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$date2 </span><span class="keyword">= </span><span class="default">date_parse</span><span class="keyword">(</span><span class="default">$date2</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return ((</span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$date1</span><span class="keyword">[</span><span class="string">'month'</span><span class="keyword">], </span><span class="default">$date1</span><span class="keyword">[</span><span class="string">'day'</span><span class="keyword">], </span><span class="default">$date1</span><span class="keyword">[</span><span class="string">'year'</span><span class="keyword">]) - </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$date2</span><span class="keyword">[</span><span class="string">'month'</span><span class="keyword">], </span><span class="default">$date2</span><span class="keyword">[</span><span class="string">'day'</span><span class="keyword">], </span><span class="default">$date2</span><span class="keyword">[</span><span class="string">'year'</span><span class="keyword">]))/</span><span class="default">3600</span><span class="keyword">/</span><span class="default">24</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83227""></a>
  <div class="note">
   <strong class="user">ben at sixg dot com</strong>
   <a href="#83227" class="date">16-May-2008 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As an addendum to my previous note (php.net said it was too long and I had to split this part off), I'll leave you with one more fun tidbit. :)<br />
<br />
(See the note below this one for a full explanation of timezones versus unix timestamps.)<br />
<br />
3 AM PST == 11 AM GMT, right?&nbsp; 11 AM _GMT_ &gt; 3 AM _GMT_ (same timezone) right?&nbsp; So, logically, 3 AM PST &gt; 3 AM GMT.&nbsp; (Makes sense right, it is 3 AM in California 8 hours after it is 3 AM in Greenwich.)&nbsp; Now, because timestamps are timezone-independent (or, always GMT/UTC), you get a strange situation.&nbsp; mktime(3) &gt; gmmktime(3).&nbsp; Even though PST is GMT-8, so PST is less than GMT, mktime(3) is _greater_ than gmmktime(3).&nbsp; At first glance you'd probably expect mktime(3) to be less than gmmktime(3), but because of everything I described before, about how timestamps are always GMT/UTC (or, in some senses, no timezone at all), it ends up being "backwards."&nbsp; (Run a few examples yourself if you don't believe me.)&nbsp; Yet another reason not to try to deal with timezones at the timestamp level!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83226""></a>
  <div class="note">
   <strong class="user">ben at sixg dot com</strong>
   <a href="#83226" class="date">16-May-2008 01:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The interaction of timezones with unix timestamps is a bit tricky so I thought I'd clarify so that people aren't led too far astray by Greg's and Glen's comments. :)<br />
<br />
In the POSIX standard, "unix time" does not have a specified timezone.&nbsp; It is universal.&nbsp; For most intents and purposes you can think of them as always being GMT/UTC.&nbsp; (And you can derive the UTC time from a "timestamp" by dividing it by 86400 and looking at the modulus.)&nbsp; Do not ever try to adjust a timestamp by a timezone offset (specifically, do not ever use the code at the end of Glen's note).&nbsp; Timezones are basically used only when "rendering" a timestamp from "unix time" into a "civil time" date/time string.<br />
<br />
Let's take an example.&nbsp; PST is GMT-8, and EST is GMT-5.&nbsp; So when it is 3 AM in PST, it is 6 AM in EST.&nbsp; At that exact moment in time, the _timestamp_ is identical in both time zones.&nbsp; If I am sitting at my computer in PST, and you are at yours in EST, and I call you up and read you the current unix timestamp on my computer, it will match yours (assuming our clocks are both set accurately for our timezone).<br />
<br />
So, time() always will return the same thing at the same actual moment, anywhere in the world.&nbsp; gmmktime() and mktime(), when given specific time parameters, convert those time parameters FROM the appropriate timezone (GMT for gmmktime(), local time for mktime()), before computing the appropriate timestamp.&nbsp; Again, for most intents and purposes you can imagine that mktime() first converts your input parameters to GMT and then calls gmmktime() which produces a GMT timestamp.&nbsp; (For the purposes of this explanation, please ignore the fact that the PHP documentation says that internally gmmktime() calls mktime().)<br />
<br />
HOWEVER, when called with no arguments, gmmktime() uses the current GMT time, and mktime() uses the current local time.&nbsp; So, if you imagine the above conversion taking place where mktime() converts the (current) local time to GMT, it ends up essentially calling gmmktime() with the _current_ GMT time, just like gmmktime() does all by itself.<br />
<br />
This is why time(), gmmktime(), and mktime() all return the same exact timestamp, _when called with no arguments_.&nbsp; This is why Glen saw them all produce the same thing.<br />
<br />
Greg wrote that gmmktime() will return something different if you are not sitting in the GMT timezone, but this is only true if you have given it arguments from which to construct a timestamp.<br />
<br />
So let's look at that situation again.&nbsp; Say I am in PST and it's 3 AM PST.&nbsp; (And therefore it is 11 AM GMT.)&nbsp; mktime() lets me override one field at at time, and the first argument is, conveniently, the hour field.&nbsp; So if I call mktime(3), I get the same answer as mktime().&nbsp; Makes sense, right?&nbsp; I just told it to give me the timestamp corresponding to 3 AM local time.&nbsp; If I call gmmktime(11), I get the same answer as gmmktime(), since it is currently 11 AM GMT.&nbsp; mktime(3) and gmmktime(11) refer to the same exact point in time, because PST is 8 hours behind GMT.&nbsp; So it makes sense that mktime(3) == gmmktime(11).&nbsp; And sine mktime() == mktime(3) (at this moment), and gmmktime() == gmmktime(11) (at this moment), it makes sense that gmmktime() == mktime().<br />
<br />
Now, back to Greg's note about gmmktime() being different.&nbsp; With identical arguments, their output will be different, e.g. mktime(3) != gmmktime(3).&nbsp; This makes sense because 3 AM PST != 3 AM GMT.<br />
<br />
Okay, that should be all you need to know to deal with the interaction between timestamps and timezones.&nbsp; Don't ever try to convert timezones by adding or subtracting to the timestamp.&nbsp; Timestamps don't really have timezones, it is apples and oranges, and you'll either get the wrong answer in some situations or end up with code that no one can maintain.&nbsp; Leave it up to the higher-level PHP functions to do the conversion.&nbsp; (If you want to hack things, strtotime is handy and it can work with timezones; let it do the hard work for you.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82604""></a>
  <div class="note">
   <strong class="user">Greg</strong>
   <a href="#82604" class="date">17-Apr-2008 11:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In addition to GLEN's post on DEC 5th 2007<br />
<br />
(Just a note for others)<br />
<br />
The results for the three time types Glen listed under "returns" all returned the exact same timestamp<br />
&nbsp;- 1196812966<br />
<br />
Using those three functions will only make the exact same timestamp if the server the code is executed on IS in GMT timezone.<br />
<br />
'mktime()' and 'time()' will both return the timestamp for your server time, and will both be the same as eachother.<br />
gmmktime will return a GMT timestamp.<br />
<br />
So if run on a server that is NOT in the GMT timezone then gmmktime will return a different timestamp to the other two.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77641""></a>
  <div class="note">
   <strong class="user">PHPcoder at freemail dot ig3 dot net</strong>
   <a href="#77641" class="date">06-Sep-2007 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
gmmktime() should ONLY be used to create a timestamp when specifying a specific GMT date and time.<br />
<br />
If you want to make a valid time stamp for the current date &amp; time, use mktime() instead.<br />
<br />
UNIX timestamps, by definition, store the GMT time relative to the UNIX epoch.<br />
<br />
gmmktime() (without any parameters specified) will effectively use the computer's LOCAL time values just the same as if they were explicit parameters, and the resulting time stamp will be incorrect.&nbsp; (The resulting timestamp will actually be offset in the OPPOSITE direction of the local timezone offset from GMT!)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75735""></a>
  <div class="note">
   <strong class="user">moshe dot ortov at gmail dot com</strong>
   <a href="#75735" class="date">13-Jun-2007 09:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware that despite the documentation which states is_dst is ignored, with PHP 5.2 at least, it is not actually ignored and will cause a 1 hour offset on the UTC time returned.
<br />

<br />
This caused some interesting bugs, especially with the tzdelta function shown from previous posts below - you need to make the final parameter a 0 instead of $ar[8] otherwise you get an off-by-1-hour as a result.
<br />

<br />
As a result, I now use :
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">tzdelta </span><span class="keyword">( </span><span class="default">$iTime </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">0 </span><span class="keyword">== </span><span class="default">$iTime </span><span class="keyword">) { </span><span class="default">$iTime </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">(); }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ar </span><span class="keyword">= </span><span class="default">localtime </span><span class="keyword">( </span><span class="default">$iTime </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">] += </span><span class="default">1900</span><span class="keyword">; </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">]++;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$iTztime </span><span class="keyword">= </span><span class="default">gmmktime </span><span class="keyword">( </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">], </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">], </span><span class="default">$ar</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$iTztime </span><span class="keyword">- </span><span class="default">$iTime </span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58319""></a>
  <div class="note">
   <strong class="user">mirko at example dot com</strong>
   <a href="#58319" class="date">31-Oct-2005 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Check if given time is during Europen Summer Time<br />
&nbsp;*<br />
&nbsp;* @link <a href="http://en.wikipedia.org/wiki/European_Summer_Time" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/European_Summer_Time</a><br />
&nbsp;* @param int $time UTC timestamp (GMT)<br />
&nbsp;* @return boolean true if it is EST else false<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">is_est</span><span class="keyword">(</span><span class="default">$time</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// get year<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$Y </span><span class="keyword">= </span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">$time</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// calc start / end dates and time for that year<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$begin_date </span><span class="keyword">= (</span><span class="default">31 </span><span class="keyword">- (</span><span class="default">5</span><span class="keyword">*</span><span class="default">$Y</span><span class="keyword">/</span><span class="default">4 </span><span class="keyword">+ </span><span class="default">4</span><span class="keyword">) % </span><span class="default">7</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$end_date </span><span class="keyword">= (</span><span class="default">31 </span><span class="keyword">- (</span><span class="default">5</span><span class="keyword">*</span><span class="default">$Y</span><span class="keyword">/</span><span class="default">4 </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">) % </span><span class="default">7</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$begin_time </span><span class="keyword">= </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,&nbsp; </span><span class="default">3</span><span class="keyword">,</span><span class="default">$begin_date</span><span class="keyword">,</span><span class="default">$Y</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$end_time </span><span class="keyword">= </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,&nbsp; </span><span class="default">10</span><span class="keyword">,</span><span class="default">$end_date</span><span class="keyword">,</span><span class="default">$Y</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if it's in that period<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$is_dst </span><span class="keyword">= </span><span class="default">$time </span><span class="keyword">&gt;= </span><span class="default">$begin_time </span><span class="keyword">&amp;&amp; </span><span class="default">$time </span><span class="keyword">&lt; </span><span class="default">$end_time</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$is_dst</span><span class="keyword">; <br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56841""></a>
  <div class="note">
   <strong class="user">ranjeet at magnet-i dot com</strong>
   <a href="#56841" class="date">16-Sep-2005 02:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getTimeRemaining</span><span class="keyword">(</span><span class="default">$timeZonePass</span><span class="keyword">,<br />
</span><span class="default">$dateTimeUser</span><span class="keyword">,</span><span class="default">$ID</span><span class="keyword">,</span><span class="default">$table</span><span class="keyword">,</span><span class="default">$coloumnName</span><span class="keyword">)<br />
{<br />
global </span><span class="default">$configVars</span><span class="keyword">;<br />
<br />
</span><span class="default">$timeZoneDefault</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"_"</span><span class="keyword">,</span><span class="default">$timeZonePass</span><span class="keyword">);<br />
<br />
</span><span class="default">$timeZone</span><span class="keyword">=(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">1</span><span class="keyword">))*(</span><span class="default">60</span><span class="keyword">) ;<br />
<br />
if((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"+"</span><span class="keyword">)<br />
&nbsp;&nbsp; </span><span class="default">$defaultSeconds</span><span class="keyword">=</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y-m-d-H-i-s"</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()+<br />
&nbsp;&nbsp; </span><span class="default">$timeZone</span><span class="keyword">);<br />
elseif((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"-"</span><span class="keyword">)<br />
&nbsp;&nbsp; </span><span class="default">$defaultSeconds</span><span class="keyword">=</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y-m-d-H-i-s"</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()-<br />
&nbsp;&nbsp; </span><span class="default">$timeZone</span><span class="keyword">);<br />
else<br />
&nbsp;&nbsp; </span><span class="default">$defaultSeconds</span><span class="keyword">=</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y-m-d-H-i-s"</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">());<br />
<br />
</span><span class="default">$defaultSecondsExp</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">,</span><span class="default">$defaultSeconds</span><span class="keyword">);<br />
<br />
</span><span class="default">$defaultGmktime</span><span class="keyword">=</span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">],<br />
</span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">], </span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">],<br />
</span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
<br />
</span><span class="default">$dateArray</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">,</span><span class="default">$dateTimeUser</span><span class="keyword">);<br />
<br />
</span><span class="default">$slectedGmktime</span><span class="keyword">=</span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">23</span><span class="keyword">,</span><span class="default">59</span><span class="keyword">,</span><span class="default">59</span><span class="keyword">,</span><span class="default">$dateArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$dateArray</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">],</span><span class="default">$dateArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
<br />
if((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"+"</span><span class="keyword">)<br />
&nbsp;&nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">=(</span><span class="default">$slectedGmktime</span><span class="keyword">)+<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="default">$timeZone</span><span class="keyword">);<br />
elseif((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"-"</span><span class="keyword">)<br />
&nbsp;&nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">=(</span><span class="default">$slectedGmktime</span><span class="keyword">)+<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (</span><span class="default">$timeZone</span><span class="keyword">);<br />
else<br />
&nbsp;&nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">=(</span><span class="default">$slectedGmktime</span><span class="keyword">);<br />
<br />
</span><span class="comment">//$slectedGmDate=gmdate("Y-m-d-H-i-s",<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">);<br />
<br />
</span><span class="default">$timeMinus</span><span class="keyword">=</span><span class="default">$slectedGmktimeAdded </span><span class="keyword">-<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$defaultGmktime</span><span class="keyword">;<br />
<br />
</span><span class="default">$secondsInDay</span><span class="keyword">= </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">;<br />
<br />
if (</span><span class="default">$secondsInDay </span><span class="keyword">&lt;= </span><span class="default">$timeMinus</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; </span><span class="default">$daysRemaining </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$timeMinus</span><span class="keyword">/<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$secondsInDay</span><span class="keyword">);<br />
&nbsp;&nbsp; if(</span><span class="default">$daysRemaining </span><span class="keyword">&gt;</span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$daysRemaining </span><span class="keyword">.</span><span class="string">"&amp;nbsp;Days&amp;nbsp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$daysRemaining </span><span class="keyword">.</span><span class="string">"&amp;nbsp;Day&amp;nbsp;"</span><span class="keyword">;<br />
}<br />
<br />
if(empty(</span><span class="default">$daysRemaining</span><span class="keyword">))<br />
{&nbsp;&nbsp; <br />
&nbsp;&nbsp; </span><span class="default">$secondsInHour</span><span class="keyword">= </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">;<br />
&nbsp;&nbsp; if (</span><span class="default">$secondsInHour </span><span class="keyword">&lt;= </span><span class="default">$timeMinus</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$hoursRemaining </span><span class="keyword">=</span><span class="default">floor </span><span class="keyword">(</span><span class="default">$timeMinus</span><span class="keyword">/<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$secondsInHour</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(</span><span class="default">$hoursRemaining </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$hoursRemaining </span><span class="keyword">.</span><span class="string">"&amp;nbsp;Hours&amp;nbsp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$hoursRemaining </span><span class="keyword">.</span><span class="string">"&amp;nbsp;Hour&amp;nbsp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
if(empty(</span><span class="default">$hoursRemaining</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp; </span><span class="comment">//$secondsRemaining = $timeMinus. "&amp;nbsp;Seconds";<br />
&nbsp;&nbsp; </span><span class="default">$secondsInMinute </span><span class="keyword">= </span><span class="default">60</span><span class="keyword">;<br />
&nbsp;&nbsp; if (</span><span class="default">$secondsInMinute </span><span class="keyword">&lt;= </span><span class="default">$timeMinus</span><span class="keyword">)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$mintuesRemaining </span><span class="keyword">=</span><span class="default">floor </span><span class="keyword">(</span><span class="default">$timeMinus</span><span class="keyword">/<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$secondsInMinute</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(</span><span class="default">$mintuesRemaining </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$mintuesRemaining </span><span class="keyword">.</span><span class="string">"&amp;nbsp;Minutes&amp;nbsp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">$mintuesRemaining </span><span class="keyword">.</span><span class="string">"&amp;nbsp;Minute&amp;nbsp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
if(empty(</span><span class="default">$mintuesRemaining</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp; </span><span class="default">$secondsRemaining </span><span class="keyword">= </span><span class="default">$timeMinus</span><span class="keyword">;<br />
&nbsp;&nbsp; if(</span><span class="default">$secondsRemaining </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; {&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">timedOutSale</span><span class="keyword">(</span><span class="default">$ID</span><span class="keyword">,</span><span class="default">$table</span><span class="keyword">,</span><span class="default">$coloumnName</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="string">"Time out"</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; elseif(</span><span class="default">$secondsRemaining </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$secondsRemaining </span><span class="keyword">. </span><span class="string">"&amp;nbsp;Seconds"</span><span class="keyword">;<br />
&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$secondsRemaining </span><span class="keyword">. </span><span class="string">"&amp;nbsp;Second"</span><span class="keyword">;<br />
}<br />
}<br />
<br />
function </span><span class="default">timedOutSale</span><span class="keyword">(</span><span class="default">$ID</span><span class="keyword">,</span><span class="default">$table</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; GLOBAL </span><span class="default">$configVars</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">,</span><span class="default">$tableNames</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">=&nbsp; </span><span class="string">"UPDATE " </span><span class="keyword">. </span><span class="default">$table<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">" SET status = 'T'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WHERE </span><span class="default">$coloumnName</span><span class="string"> = '" </span><span class="keyword">. </span><span class="default">$ID </span><span class="keyword">.</span><span class="string">"'"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />
&nbsp;&nbsp; return;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56805""></a>
  <div class="note">
   
   <a href="#56805" class="date">15-Sep-2005 06:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">getTimeRemaining</span><span class="keyword">(</span><span class="default">$timeZonePass</span><span class="keyword">,</span><span class="default">$dateTimeUser</span><span class="keyword">,</span><span class="default">$ID</span><span class="keyword">,</span><span class="default">$table</span><span class="keyword">,</span><span class="default">$coloumnName</span><span class="keyword">)
<br />
{
<br />
global </span><span class="default">$configVars</span><span class="keyword">;
<br />

<br />
</span><span class="default">$timeZoneDefault</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"_"</span><span class="keyword">,</span><span class="default">$timeZonePass</span><span class="keyword">);
<br />

<br />
</span><span class="default">$timeZone</span><span class="keyword">=(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">1</span><span class="keyword">))*(</span><span class="default">60</span><span class="keyword">) ;
<br />

<br />
if((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"+"</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$defaultSeconds</span><span class="keyword">=</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y-m-d-H-i-s"</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()+
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$timeZone</span><span class="keyword">);
<br />
elseif((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"-"</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$defaultSeconds</span><span class="keyword">=</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y-m-d-H-i-s"</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">()-
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$timeZone</span><span class="keyword">);
<br />
else
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$defaultSeconds</span><span class="keyword">=</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y-m-d-H-i-s"</span><span class="keyword">,</span><span class="default">time</span><span class="keyword">());
<br />

<br />
</span><span class="default">$defaultSecondsExp</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">,</span><span class="default">$defaultSeconds</span><span class="keyword">);
<br />

<br />
</span><span class="default">$defaultGmktime</span><span class="keyword">=</span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">],
<br />
</span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">], </span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">],
<br />
</span><span class="default">$defaultSecondsExp</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);
<br />

<br />
</span><span class="default">$dateArray</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">,</span><span class="default">$dateTimeUser</span><span class="keyword">);
<br />

<br />
</span><span class="default">$slectedGmktime</span><span class="keyword">=</span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">23</span><span class="keyword">,</span><span class="default">59</span><span class="keyword">,</span><span class="default">59</span><span class="keyword">,</span><span class="default">$dateArray</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dateArray</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">],</span><span class="default">$dateArray</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);
<br />

<br />
if((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"+"</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">=(</span><span class="default">$slectedGmktime</span><span class="keyword">)+
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">$timeZone</span><span class="keyword">);
<br />
elseif((</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$timeZoneDefault</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)) ==</span><span class="string">"-"</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">=(</span><span class="default">$slectedGmktime</span><span class="keyword">)+
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">$timeZone</span><span class="keyword">);
<br />
else
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">=(</span><span class="default">$slectedGmktime</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//$slectedGmDate=gmdate("Y-m-d-H-i-s",
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$slectedGmktimeAdded</span><span class="keyword">);
<br />

<br />
</span><span class="default">$timeMinus</span><span class="keyword">=</span><span class="default">$slectedGmktimeAdded </span><span class="keyword">- 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$defaultGmktime</span><span class="keyword">;
<br />

<br />
</span><span class="default">$secondsInDay</span><span class="keyword">= </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">*</span><span class="default">24</span><span class="keyword">;
<br />

<br />
if (</span><span class="default">$secondsInDay </span><span class="keyword">&lt;= </span><span class="default">$timeMinus</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$daysRemaining </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$timeMinus</span><span class="keyword">/
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$secondsInDay</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$daysRemaining </span><span class="keyword">&gt;</span><span class="default">1 </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$daysRemaining </span><span class="keyword">.</span><span class="string">"&nbsp;Days&nbsp;"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$daysRemaining </span><span class="keyword">.</span><span class="string">"&nbsp;Day&nbsp;"</span><span class="keyword">;
<br />
}
<br />

<br />
if(empty(</span><span class="default">$daysRemaining</span><span class="keyword">))
<br />
{&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$secondsInHour</span><span class="keyword">= </span><span class="default">60</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$secondsInHour </span><span class="keyword">&lt;= </span><span class="default">$timeMinus</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hoursRemaining </span><span class="keyword">=</span><span class="default">floor </span><span class="keyword">(</span><span class="default">$timeMinus</span><span class="keyword">/
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$secondsInHour</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$hoursRemaining </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$hoursRemaining </span><span class="keyword">.</span><span class="string">"&nbsp;Hours&nbsp;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$hoursRemaining </span><span class="keyword">.</span><span class="string">"&nbsp;Hour&nbsp;"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
if(empty(</span><span class="default">$hoursRemaining</span><span class="keyword">))
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//$secondsRemaining = $timeMinus. "&nbsp;Seconds";
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$secondsInMinute </span><span class="keyword">= </span><span class="default">60</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$secondsInMinute </span><span class="keyword">&lt;= </span><span class="default">$timeMinus</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mintuesRemaining </span><span class="keyword">=</span><span class="default">floor </span><span class="keyword">(</span><span class="default">$timeMinus</span><span class="keyword">/
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$secondsInMinute</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$mintuesRemaining </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$mintuesRemaining </span><span class="keyword">.</span><span class="string">"&nbsp;Minutes&nbsp;"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$mintuesRemaining </span><span class="keyword">.</span><span class="string">"&nbsp;Minute&nbsp;"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
if(empty(</span><span class="default">$mintuesRemaining</span><span class="keyword">))
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$secondsRemaining </span><span class="keyword">= </span><span class="default">$timeMinus</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$secondsRemaining </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">timedOutSale</span><span class="keyword">(</span><span class="default">$ID</span><span class="keyword">,</span><span class="default">$table</span><span class="keyword">,</span><span class="default">$coloumnName</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">"Time out"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; elseif(</span><span class="default">$secondsRemaining </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$secondsRemaining </span><span class="keyword">. </span><span class="string">"&nbsp;Seconds"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$secondsRemaining </span><span class="keyword">. </span><span class="string">"&nbsp;Second"</span><span class="keyword">;
<br />
}
<br />
}
<br />

<br />
function </span><span class="default">timedOutSale</span><span class="keyword">(</span><span class="default">$ID</span><span class="keyword">,</span><span class="default">$table</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; GLOBAL </span><span class="default">$configVars</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">,</span><span class="default">$tableNames</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$query </span><span class="keyword">=&nbsp; </span><span class="string">"UPDATE " </span><span class="keyword">. </span><span class="default">$table
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="string">" SET status = 'T'
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; WHERE </span><span class="default">$coloumnName</span><span class="string"> = '" </span><span class="keyword">. </span><span class="default">$ID </span><span class="keyword">.</span><span class="string">"'"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49954""></a>
  <div class="note">
   <strong class="user">jbr (AT) ya-right.com</strong>
   <a href="#49954" class="date">13-Feb-2005 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have seen many different hacked versions of this function for people using Windows that want to support dates before Jan 1, 1970. Here is yet another one that is different than others you may have seen! It does not use loops like all the others I have seen! 
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="comment">// usage...
<br />

<br />
</span><span class="keyword">echo </span><span class="default">win_gmmktime </span><span class="keyword">( </span><span class="default">12</span><span class="keyword">, </span><span class="default">43</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">, </span><span class="default">07</span><span class="keyword">, </span><span class="default">23</span><span class="keyword">, </span><span class="default">1946 </span><span class="keyword">);
<br />

<br />
function </span><span class="default">win_gmmktime </span><span class="keyword">( </span><span class="default">$hour</span><span class="keyword">, </span><span class="default">$minute</span><span class="keyword">, </span><span class="default">$second</span><span class="keyword">, </span><span class="default">$month</span><span class="keyword">, </span><span class="default">$day</span><span class="keyword">, </span><span class="default">$year </span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$year </span><span class="keyword">&gt; </span><span class="default">1969 </span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">gmmktime </span><span class="keyword">( </span><span class="default">$hour</span><span class="keyword">, </span><span class="default">$minute</span><span class="keyword">, </span><span class="default">$second</span><span class="keyword">, </span><span class="default">$month</span><span class="keyword">, </span><span class="default">$day</span><span class="keyword">, </span><span class="default">$year </span><span class="keyword">) );
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ds </span><span class="keyword">= </span><span class="default">86400</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hs </span><span class="keyword">= </span><span class="default">3600</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dy </span><span class="keyword">= </span><span class="default">365</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ms </span><span class="keyword">= </span><span class="default">60</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$months </span><span class="keyword">= array ( </span><span class="default">31</span><span class="keyword">, </span><span class="default">28</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31</span><span class="keyword">, </span><span class="default">30</span><span class="keyword">, </span><span class="default">31 </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$leap_year </span><span class="keyword">= </span><span class="default">$year </span><span class="keyword">% </span><span class="default">4 </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">&amp;&amp; ( </span><span class="default">$year </span><span class="keyword">% </span><span class="default">100 </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">|| </span><span class="default">$year </span><span class="keyword">% </span><span class="default">400 </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) ? </span><span class="default">true </span><span class="keyword">: </span><span class="default">false</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$year </span><span class="keyword">&lt; </span><span class="default">1969 </span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">1969 </span><span class="keyword">- </span><span class="default">$year</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">-= ( </span><span class="default">$y </span><span class="keyword">* </span><span class="default">$dy </span><span class="keyword">) * </span><span class="default">$ds</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">ceil </span><span class="keyword">( </span><span class="default">$y </span><span class="keyword">/ </span><span class="default">4 </span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$leap_year </span><span class="keyword">&amp;&amp; </span><span class="default">$month </span><span class="keyword">&gt; </span><span class="default">2 </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">-= </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">-= </span><span class="default">$x </span><span class="keyword">* </span><span class="default">$ds</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$month </span><span class="keyword">!= </span><span class="default">12 </span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tm </span><span class="keyword">= </span><span class="default">$months</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tm </span><span class="keyword">= </span><span class="default">array_slice </span><span class="keyword">( </span><span class="default">$tm</span><span class="keyword">, </span><span class="default">$month </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">-= </span><span class="default">array_sum </span><span class="keyword">( </span><span class="default">$tm </span><span class="keyword">) * </span><span class="default">$ds</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset ( </span><span class="default">$tm </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nh </span><span class="keyword">= ( ( </span><span class="default">$month </span><span class="keyword">== </span><span class="default">2 </span><span class="keyword">&amp;&amp; </span><span class="default">$leap_year </span><span class="keyword">? </span><span class="default">29 </span><span class="keyword">: </span><span class="default">$months</span><span class="keyword">[</span><span class="default">$month</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">] ) - </span><span class="default">$day </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">-= </span><span class="default">$nh </span><span class="keyword">!= </span><span class="default">0 </span><span class="keyword">? </span><span class="default">$nh </span><span class="keyword">* </span><span class="default">$ds </span><span class="keyword">: </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nh </span><span class="keyword">= </span><span class="default">23 </span><span class="keyword">- </span><span class="default">$hour</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">-= </span><span class="default">$nh </span><span class="keyword">!= </span><span class="default">0 </span><span class="keyword">? </span><span class="default">$nh </span><span class="keyword">* </span><span class="default">$hs </span><span class="keyword">: </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nh </span><span class="keyword">= </span><span class="default">59 </span><span class="keyword">- </span><span class="default">$minute</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">-= </span><span class="default">$nh </span><span class="keyword">!= </span><span class="default">0 </span><span class="keyword">? </span><span class="default">$nh </span><span class="keyword">* </span><span class="default">$ms </span><span class="keyword">: </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nh </span><span class="keyword">= </span><span class="default">59 </span><span class="keyword">- </span><span class="default">$second</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">-= </span><span class="default">$nh </span><span class="keyword">!= </span><span class="default">0 </span><span class="keyword">? </span><span class="default">$nh </span><span class="keyword">+ </span><span class="default">1 </span><span class="keyword">: </span><span class="default">0</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; return ( </span><span class="default">$t </span><span class="keyword">);
<br />
}
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49603""></a>
  <div class="note">
   <strong class="user">welch at advomatic dot com</strong>
   <a href="#49603" class="date">02-Feb-2005 09:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a handy routine for counting down to the minute, hour, and day to a timestamp
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $minutesleft </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">((</span><span class="default">$timestamp </span><span class="keyword">- </span><span class="default">gmtime</span><span class="keyword">()) / </span><span class="default">60</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$minutesleft </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$timeleft </span><span class="keyword">= </span><span class="string">'NOW'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$minutesleft </span><span class="keyword">&lt; </span><span class="default">60</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$timeleft </span><span class="keyword">= (</span><span class="default">$minutesleft</span><span class="keyword">==</span><span class="default">1 </span><span class="keyword">? </span><span class="string">'1 minute' </span><span class="keyword">: </span><span class="default">$minutesleft</span><span class="keyword">.</span><span class="string">' minutes'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$minutesleft </span><span class="keyword">&gt;= </span><span class="default">60 </span><span class="keyword">&amp;&amp; </span><span class="default">$minutesleft </span><span class="keyword">&lt; (</span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$timeleft </span><span class="keyword">= (</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$minutesleft</span><span class="keyword">/</span><span class="default">60</span><span class="keyword">) == </span><span class="default">1 </span><span class="keyword">? </span><span class="string">'1 hour' </span><span class="keyword">: </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$minutesleft</span><span class="keyword">/</span><span class="default">60</span><span class="keyword">).</span><span class="string">' hours'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp;&nbsp; else if (</span><span class="default">$minutesleft </span><span class="keyword">&gt;= (</span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$days </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$minutesleft </span><span class="keyword">/ (</span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// hours remainder
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hours </span><span class="keyword">= (</span><span class="default">$minutesleft </span><span class="keyword">% (</span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">)) / </span><span class="default">60</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// hours left in the day
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hours_left </span><span class="keyword">= ((</span><span class="default">time</span><span class="keyword">() / </span><span class="default">60</span><span class="keyword">) % (</span><span class="default">24</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">)) / </span><span class="default">60</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// see if the remainder of hours is greater than the hours left in today, if so increase the days by one so that the days remaining mimics the date rather than how many 24 hour periods there are between now and then.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$hours </span><span class="keyword">&gt; </span><span class="default">$hours_left</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$days</span><span class="keyword">++;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$timeleft </span><span class="keyword">= (</span><span class="default">$days </span><span class="keyword">== </span><span class="default">1 </span><span class="keyword">? </span><span class="string">'1 day' </span><span class="keyword">: </span><span class="default">$days</span><span class="keyword">.</span><span class="string">' days'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="default">$timeleft</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49061""></a>
  <div class="note">
   <strong class="user">imoore76 at yahoo dot com</strong>
   <a href="#49061" class="date">15-Jan-2005 10:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Why not just do:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// assuming $start and $end are timestamps<br />
<br />
</span><span class="default">$day_diff </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$start </span><span class="keyword">- </span><span class="default">$end</span><span class="keyword">) / </span><span class="default">86400</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48697""></a>
  <div class="note">
   <strong class="user">justin at booleangate dot org</strong>
   <a href="#48697" class="date">05-Jan-2005 09:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a play on turgut85's countDays function.&nbsp; I've found it to be more efficient and it accepts unix timestamps rather than arrays.&nbsp; Thanks for the ideas.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">count_days</span><span class="keyword">(</span><span class="default">$start</span><span class="keyword">, </span><span class="default">$end</span><span class="keyword">) {
<br />
&nbsp; </span><span class="comment">// Count the days between $start and $end where both $start and $end
<br />
&nbsp; //&nbsp; are UNIX timestamps
<br />
&nbsp; 
<br />
&nbsp; // Swap the two values if end is greater than start (to avoid the
<br />
&nbsp; //&nbsp; loop of death).
<br />
&nbsp; </span><span class="keyword">if (</span><span class="default">$start </span><span class="keyword">&lt; </span><span class="default">$end</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">= </span><span class="default">$start</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$start </span><span class="keyword">= </span><span class="default">$end</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">$t</span><span class="keyword">;
<br />
&nbsp; }
<br />
&nbsp; 
<br />
&nbsp; </span><span class="comment">// Increment the start time by one day until it is equal to the
<br />
&nbsp; //&nbsp; end time
<br />
&nbsp; 
<br />
&nbsp; </span><span class="default">$days </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp; while ( </span><span class="default">$start </span><span class="keyword">&lt; </span><span class="default">$end </span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$start </span><span class="keyword">= </span><span class="default">strtotime</span><span class="keyword">(</span><span class="string">"+1 days"</span><span class="keyword">, </span><span class="default">$start</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$days</span><span class="keyword">++;
<br />
&nbsp; }
<br />
&nbsp; 
<br />
&nbsp; return </span><span class="default">$days</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47955""></a>
  <div class="note">
   <strong class="user">turgut85 at hotmail dot com</strong>
   <a href="#47955" class="date">07-Dec-2004 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// THIS ROUTINE COUNT DAYS BEETWEEN TWO DATE //<br />
// BEGIN DATE COULD BE IN THE PAST OR IN THE FUTURE //<br />
<br />
</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'YEAR'</span><span class="keyword">]=</span><span class="default">2004</span><span class="keyword">;<br />
</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'MONTH'</span><span class="keyword">]=</span><span class="default">10</span><span class="keyword">;<br />
</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'DAY'</span><span class="keyword">]=</span><span class="default">1</span><span class="keyword">;<br />
<br />
</span><span class="default">$end</span><span class="keyword">[</span><span class="string">'YEAR'</span><span class="keyword">]=</span><span class="default">2004</span><span class="keyword">;<br />
</span><span class="default">$end</span><span class="keyword">[</span><span class="string">'MONTH'</span><span class="keyword">]=</span><span class="default">10</span><span class="keyword">;<br />
</span><span class="default">$end</span><span class="keyword">[</span><span class="string">'DAY'</span><span class="keyword">]=</span><span class="default">3</span><span class="keyword">;<br />
<br />
function </span><span class="default">countDays </span><span class="keyword">(</span><span class="default">$beg</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">$start </span><span class="keyword">= </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'MONTH'</span><span class="keyword">],</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'DAY'</span><span class="keyword">],</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'YEAR'</span><span class="keyword">]);<br />
</span><span class="default">$endin </span><span class="keyword">= </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">[</span><span class="string">'MONTH'</span><span class="keyword">],</span><span class="default">$end</span><span class="keyword">[</span><span class="string">'DAY'</span><span class="keyword">],</span><span class="default">$end</span><span class="keyword">[</span><span class="string">'YEAR'</span><span class="keyword">]);<br />
<br />
</span><span class="comment">// echo $start."\n";<br />
// echo $endin."\n";<br />
<br />
</span><span class="default">$day </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
if (</span><span class="default">$start </span><span class="keyword">&lt; </span><span class="default">$endin</span><span class="keyword">) {<br />
</span><span class="default">$toward </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
} else&nbsp; {<br />
</span><span class="default">$toward </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$mover </span><span class="keyword">= </span><span class="default">$start</span><span class="keyword">;<br />
<br />
if (</span><span class="default">$start </span><span class="keyword">!= </span><span class="default">$endin</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
do {<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">$day</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$toward</span><span class="keyword">)&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mover </span><span class="keyword">= </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'MONTH'</span><span class="keyword">],(</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'DAY'</span><span class="keyword">]+</span><span class="default">$day</span><span class="keyword">),</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'YEAR'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mover </span><span class="keyword">= </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'MONTH'</span><span class="keyword">],(</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'DAY'</span><span class="keyword">]-</span><span class="default">$day</span><span class="keyword">),</span><span class="default">$beg</span><span class="keyword">[</span><span class="string">'YEAR'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; <br />
} while (</span><span class="default">$mover </span><span class="keyword">!= </span><span class="default">$endin</span><span class="keyword">);<br />
<br />
}<br />
<br />
echo </span><span class="default">$day</span><span class="keyword">;<br />
<br />
return </span><span class="default">$day</span><span class="keyword">;<br />
}<br />
<br />
echo </span><span class="default">countDays </span><span class="keyword">(</span><span class="default">$beg</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">). </span><span class="string">" days. "</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Turgut Z. YESILYURT<br />
turgut85@hotmail.com<br />
System and Application Developer<br />
New Jersey, USA</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47605""></a>
  <div class="note">
   <strong class="user">mwwaygoo AT hotmail DOT com</strong>
   <a href="#47605" class="date">22-Nov-2004 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
REF: <a href="http://www.dti.gov.uk/er/sumtimetb.htm" rel="nofollow" target="_blank">http://www.dti.gov.uk/er/sumtimetb.htm</a><br />
<br />
Since 1981 EC Directives have prescribed the start and end dates of summer time in all Member States.&nbsp; There have to date been eight Directives which have set summer-time arrangements for fixed periods. The Summer Time Act 1972 sets the appropriate dates in the UK and summer-time orders have been made as necessary to implement the European Directives. The 9th EC Directive prescribes the start and end dates of summer time as the last Sundays in March and October respectively. These dates are in line with those already operating in the United Kingdom. The 9th Directive provides that these start and end dates should apply indefinitely.<br />
---<br />
9th EC Directive - 19 January 2001<br />
<br />
Article 1<br />
For the purposes of this Directive "summer-time period" shall mean the period of the year during which clocks are put forward by 60 minutes compared with the rest of the year.<br />
<br />
Article 2<br />
From 2002 onwards, the summer-time period shall begin, in every Member State, at 1.00 a.m., Greenwich Mean Time, on the last Sunday in March.<br />
<br />
Article 3<br />
From 2002 onwards, the summer-time period shall end, in every Member State, at 1.00 a.m., Greenwich Mean Time, on the last Sunday in October.<br />
<br />
You stand corrected ;-)&nbsp; (well up until 2007 anyway)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46654""></a>
  <div class="note">
   <strong class="user">Andy</strong>
   <a href="#46654" class="date">19-Oct-2004 04:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mwwaygoo's code isn't quite right. My understanding is that the relevant dates for changing between daylight saving time in the UK is the third sunday of march and october - not the last sunday!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45626""></a>
  <div class="note">
   <strong class="user">mwwaygoo AT hotmail DOT com</strong>
   <a href="#45626" class="date">13-Sep-2004 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a problem with hosting a UK site on a US server, the times didnt match (obviously) and also didnt account for daylight savings time. The daylight savings dates and times of change differ worldwide, so detecting if the server was in dst wouldnt work (see <a href="http://webexhibits.org/daylightsaving/" rel="nofollow" target="_blank">http://webexhibits.org/daylightsaving/</a>).<br />
<br />
Here is a function for creating a timestamp which can be used by date() to create all the parameters required to display the local time (site not server). I have used GMT time to create the timestamp as there is no offset for UK time (+00).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">UKdst_time</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// created by Matthew Waygood (www.waygoodstuff.co.uk)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$timestamp </span><span class="keyword">= </span><span class="default">mktime</span><span class="keyword">(</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"H, i, s, m, d, Y"</span><span class="keyword">)); </span><span class="comment">// UTC time<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this_year</span><span class="keyword">=</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">$timestamp</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// last sunday in march at 1am UTC<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$last_day_of_march</span><span class="keyword">=</span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">,</span><span class="default">31</span><span class="keyword">,</span><span class="default">$this_year</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$last_sunday_of_march</span><span class="keyword">=</span><span class="default">strtotime</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"w"</span><span class="keyword">, </span><span class="default">$last_day_of_march</span><span class="keyword">).</span><span class="string">" day"</span><span class="keyword">, </span><span class="default">$last_day_of_march</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// last sunday in october at 1am UTC<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$last_day_of_october</span><span class="keyword">=</span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">,</span><span class="default">31</span><span class="keyword">,</span><span class="default">$this_year</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$last_sunday_of_october</span><span class="keyword">=</span><span class="default">strtotime</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"w"</span><span class="keyword">, </span><span class="default">$last_day_of_october</span><span class="keyword">).</span><span class="string">" day"</span><span class="keyword">, </span><span class="default">$last_day_of_october</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if( (</span><span class="default">$timestamp </span><span class="keyword">&gt; </span><span class="default">$last_sunday_of_march</span><span class="keyword">) &amp;&amp; (</span><span class="default">$timestamp </span><span class="keyword">&lt; </span><span class="default">$last_sunday_of_october</span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$timestamp</span><span class="keyword">=</span><span class="default">$timestamp</span><span class="keyword">+</span><span class="default">3600</span><span class="keyword">; </span><span class="comment">// foward one hour<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$timestamp</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41072""></a>
  <div class="note">
   <strong class="user">Dave</strong>
   <a href="#41072" class="date">29-Mar-2004 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There appears to be a discrepency between PHP and C timestamps.&nbsp; The C time() and gettimeofday() functions are documented to return based on UTC time, but the value obtained doesn't match the PHP gmmktime() function.&nbsp; Instead, it matches the PHP mktime() function, which is supposed to be local time.<br />
&nbsp;&nbsp; <br />
It seems that C always uses a UTC timestamp and adjusts to local time through different handling functions (gmtime() vs localtime()).&nbsp; PHP appears to use differing UTC/local timestamps, but single handling functions.<br />
<br />
The exception to this rule is the PHP time() function, which appears to behave in the same was as the C version.<br />
<br />
In short, if your PHP is working with timestamps created in C (or vice versa) make sure you are comparing apples to apples.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39878""></a>
  <div class="note">
   <strong class="user">zhong311 at collegeclub dot com</strong>
   <a href="#39878" class="date">14-Feb-2004 12:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When attempting to use HTTP's If-Modified-Since features for caching I ran into the problem of being able to compare the GMT date the browser was sending to my own Last-Modified date (stored in a database field). I saw many examples of how to create a GMT date from a unix timestamp, but little on how to actually get a GMT date into a unix timestamp. Perhaps someone has a better way, here's my solution:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">gmstrtotime</span><span class="keyword">(</span><span class="default">$sgm</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$months </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Jan'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Feb'</span><span class="keyword">=&gt;</span><span class="default">2</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Mar'</span><span class="keyword">=&gt;</span><span class="default">3</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Apr'</span><span class="keyword">=&gt;</span><span class="default">4</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'May'</span><span class="keyword">=&gt;</span><span class="default">5</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Jun'</span><span class="keyword">=&gt;</span><span class="default">6</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Jul'</span><span class="keyword">=&gt;</span><span class="default">7</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Aug'</span><span class="keyword">=&gt;</span><span class="default">8</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Sep'</span><span class="keyword">=&gt;</span><span class="default">9</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Oct'</span><span class="keyword">=&gt;</span><span class="default">10</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Nov'</span><span class="keyword">=&gt;</span><span class="default">11</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="string">'Dec'</span><span class="keyword">=&gt;</span><span class="default">12<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; list(</span><span class="default">$D</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">, </span><span class="default">$M</span><span class="keyword">, </span><span class="default">$Y</span><span class="keyword">, </span><span class="default">$H</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">) = </span><span class="default">sscanf</span><span class="keyword">(</span><span class="default">$sgm</span><span class="keyword">, </span><span class="string">"%3s, %2d %3s %4d %2d:%2d:%2d GMT"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">$H</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">, </span><span class="default">$months</span><span class="keyword">[</span><span class="default">$M</span><span class="keyword">], </span><span class="default">$d</span><span class="keyword">, </span><span class="default">$Y</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// test: after all is said and done<br />
// $time should be the same as $gmtime<br />
<br />
</span><span class="default">$time </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();<br />
</span><span class="default">$us </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"m/d/Y H:i:s"</span><span class="keyword">,</span><span class="default">$time</span><span class="keyword">);<br />
</span><span class="default">$sgm </span><span class="keyword">= </span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">"D, d M Y H:i:s"</span><span class="keyword">,</span><span class="default">$time</span><span class="keyword">) . </span><span class="string">" GMT"</span><span class="keyword">;<br />
<br />
</span><span class="default">$gmtime </span><span class="keyword">= </span><span class="default">gmstrtotime</span><span class="keyword">(</span><span class="default">$sgm</span><span class="keyword">);<br />
<br />
echo </span><span class="default">$us </span><span class="keyword">. </span><span class="string">"&lt;BR&gt;"</span><span class="keyword">;<br />
echo </span><span class="default">$sgm </span><span class="keyword">. </span><span class="string">"&lt;BR&gt;"</span><span class="keyword">;<br />
echo </span><span class="default">$time </span><span class="keyword">. </span><span class="string">"&lt;BR&gt;"</span><span class="keyword">;<br />
echo </span><span class="default">$gmtime </span><span class="keyword">. </span><span class="string">"&lt;BR&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
My results:<br />
<br />
02/13/2004 10:45:42<br />
Fri, 13 Feb 2004 20:45:42 GMT<br />
1076705142<br />
1076705142<br />
<br />
Credit to kyle at frozenonline dot com for his strtotime example</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
