<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>为一个配置选项设置值</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.ini-restore.html">? ini_restore</a></li>
      <li style="float: right;"><a href="function.magic-quotes-runtime.html">magic_quotes_runtime ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.info.html">PHP 选项/信息 函数</a></li>
    <li>为一个配置选项设置值</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.ini-set" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ini_set</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">ini_set</span> &mdash; <span class="dc-title">为一个配置选项设置值</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.ini-set-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>ini_set</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$varname</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$newvalue</code></span>
   )</div>

  <p class="para rdfs-comment">
   设置指定配置选项的值。这个选项会在脚本运行时保持新的值，并在脚本结束时恢复。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.ini-set-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">varname</code></dt>

     <dd>

      <p class="para">
      </p>
      <p class="para">
       不是所有有效的选项都能够用 <span class="function"><strong>ini_set()</strong></span> 来改变的。
       这里有个有效选项的清单<a href="ini.list.html" class="link">附录</a>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">newvalue</code></dt>

     <dd>

      <p class="para">
       选项新的值。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.ini-set-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回旧的值，失败时返回 <strong><code>FALSE</code></strong>。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.ini-set-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-532">
    <p><strong>Example #1 设置一个 ini 选项</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'display_errors'</span><span style="color: #007700">);<br /><br />if&nbsp;(!</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'display_errors'</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(</span><span style="color: #DD0000">'display_errors'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'1'</span><span style="color: #007700">);<br />}<br /><br />echo&nbsp;</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">'display_errors'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.ini-set-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.get-cfg-var.html" class="function" rel="rdfs-seeAlso">get_cfg_var()</a> - 获取 PHP 配置选项的值</span></li>
    <li class="member"><span class="function"><a href="function.ini-get.html" class="function" rel="rdfs-seeAlso">ini_get()</a> - 获取一个配置选项的值</span></li>
    <li class="member"><span class="function"><a href="function.ini-get-all.html" class="function" rel="rdfs-seeAlso">ini_get_all()</a> - 获取所有配置选项</span></li>
    <li class="member"><span class="function"><a href="function.ini-restore.html" class="function" rel="rdfs-seeAlso">ini_restore()</a> - 恢复配置选项的值</span></li>
    <li class="member">
     <a href="configuration.changes.html" class="link">如何改变配置选项</a>
    </li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="118305""></a>
  <div class="note">
   <strong class="user">Er.ellison</strong>
   <a href="#118305" class="date">13-Nov-2015 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if u receive&nbsp; an Error with generic like&nbsp; :<br />
Maximum execution time of 30 seconds exceeded <br />
<br />
if u set ini_set(max_execution_time, 300);<br />
your problem will be solved <br />
pls note that the 300 , is 300 seconds , which means 5 minute&nbsp; you can set another value !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117232""></a>
  <div class="note">
   <strong class="user">w3dk</strong>
   <a href="#117232" class="date">07-May-2015 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Whilst most boolean settings can be disabled by passing '0', 'Off' or `No' (in fact anything that is not '1', 'On' or 'Yes' - not case-sentive) to ini_set(), it should be noted that ini_get() returns the literal string as set. So if you later want to check this setting by calling ini_get() and it's been set to 'Off' (a non-empty string that evaluates to True), then you'll have to specifically check for this in a (case-insensitive) string comparison, rather than the simpler:<br />
<br />
if (ini_get('config_setting')) { /* ... */ }<br />
<br />
So, if you need to disable boolean settings I think it's preferable to set them to '0' (which simply evaluates to False).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115747""></a>
  <div class="note">
   <strong class="user">nl-x</strong>
   <a href="#115747" class="date">17-Sep-2014 08:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have experienced on some systems that ini_set() will fail and return a false, when trying to set a setting that was set inside php.ini inside a per-host setting. Beware of this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115528""></a>
  <div class="note">
   <strong class="user">anonymous</strong>
   <a href="#115528" class="date">10-Aug-2014 01:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this function only works with PHP_INI_ALL options!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114091""></a>
  <div class="note">
   <strong class="user">williamprogphp at yahoo dot com dot br</strong>
   <a href="#114091" class="date">10-Jan-2014 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I figured out why php dont output errors such as an expected ';' on code and output a 500 error. Some server are configured to omit php errors on pages using the directive display_errors=Off;<br />
<br />
In most cases, the server will output a 500 Internal Server Error instead of php error because of it. <br />
<br />
To prevent this default you must set this directive directly in the php.ini file and the server will show you the php error properly. Setting ini_set('display_errors', true) on-the-fly wont work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113748""></a>
  <div class="note">
   <strong class="user">Nik</strong>
   <a href="#113748" class="date">26-Nov-2013 02:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How to get xdebug var_dump to show full object/array regardless to php,ini settings:<br />
<br />
ini_set("xdebug.var_display_max_depth", -1);<br />
ini_set("xdebug.var_display_max_children", -1);<br />
ini_set("xdebug.var_display_max_data", -1);<br />
var_dump($test);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106430""></a>
  <div class="note">
   <strong class="user">Nathan</strong>
   <a href="#106430" class="date">09-Nov-2011 05:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Careful - in some cases, when setting zlib.output_compression to "On" via ini_set, PHP won't send the Content-type header and browsers will garble the output. Set it to the desired buffer size instead, which sends the correct header:<br />
<br />
<span class="default">&lt;?php<br />
ini_set</span><span class="keyword">(</span><span class="string">"zlib.output_compression"</span><span class="keyword">, </span><span class="default">4096</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92877""></a>
  <div class="note">
   <strong class="user">MadJoker</strong>
   <a href="#92877" class="date">12-Aug-2009 10:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use gz_handler you might want to switch over to 
<br />
zlib.output_compression
<br />

<br />
This can be controlled via the ini_set control.
<br />

<br />
<span class="default">&lt;?php ini_set</span><span class="keyword">(</span><span class="string">'zlib.output_compression'</span><span class="keyword">, </span><span class="string">'Off'</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
or
<br />

<br />
<span class="default">&lt;?php ini_set</span><span class="keyword">(</span><span class="string">'zlib.output_compression'</span><span class="keyword">, </span><span class="string">'On'</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70835""></a>
  <div class="note">
   <strong class="user">daevid at daevid dot com</strong>
   <a href="#70835" class="date">31-Oct-2006 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful with setting an output_handler, as you can't use ini_set() to change it. *sigh*<br />
<br />
In my php.ini I have this for my web pages (and I want it): <br />
<br />
&nbsp; output_handler = ob_gzhandler<br />
<br />
But this causes my command line scripts to not show output until the very end.<br />
<br />
#!/usr/bin/php -q<br />
<span class="default">&lt;?php<br />
ini_set</span><span class="keyword">(</span><span class="string">'output_handler'</span><span class="keyword">, </span><span class="string">'mb_output_handler'</span><span class="keyword">);<br />
echo </span><span class="string">"\noutput_handler =&gt; " </span><span class="keyword">. </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'output_handler'</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
root@# ./myscript.php<br />
output_handler =&gt; ob_gzhandler<br />
<br />
Apparently (acording to Richard Lynch):<br />
<br />
&gt; TOO LATE!<br />
&gt; The ob_start() has already kicked in by this point.<br />
&gt; ob_flush() until there are no more buffers.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63822""></a>
  <div class="note">
   <strong class="user">RebootConcepts.com</strong>
   <a href="#63822" class="date">31-Mar-2006 10:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
set PHP_INI_PERDIR settings in a .htaccess file with 'php_flag' like this:<br />
<br />
php_flag register_globals off<br />
php_flag magic_quotes_gpc on</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60542""></a>
  <div class="note">
   <strong class="user">Ron Ludwig</strong>
   <a href="#60542" class="date">10-Jan-2006 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When your ISP does not allow you to add the default include directories - it might be useful to extend the 'include_path' variable:
<br />

<br />
<span class="default">&lt;?php ini_set</span><span class="keyword">(</span><span class="string">'include_path'</span><span class="keyword">,</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'include_path'</span><span class="keyword">).</span><span class="string">':../includes:'</span><span class="keyword">);&nbsp; </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45402""></a>
  <div class="note">
   <strong class="user">brainiac5 dot php at aimail dot de</strong>
   <a href="#45402" class="date">05-Sep-2004 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To find the apache php settings try something like this.<br />
&gt; cd /etc/apache2<br />
&gt; grep -r -n -i&nbsp; safe_mode_exec_dir *.conf<br />
or<br />
&gt; grep -r -n -i safe_mode.*On *.conf<br />
<br />
If you find a gererated file, obviously you need to find the source template for it, to change what's needed there.<br />
<br />
I just wasted a sunny Sunday on searching for where the heck safe_mode_exec_dir was changed.<br />
<br />
And yes, Local Value in phpinfo does mean 'changed between the php.ini file and here', as you would think.<br />
<br />
If you have an automated virtual host configuration, such as confixx, php ini values can be spread across very many files.<br />
<br />
They can be changed in apache config files, that can have any name, but usually will end on .conf, besides in .htaccess files.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45401""></a>
  <div class="note">
   <strong class="user">klw at gmx dot at</strong>
   <a href="#45401" class="date">05-Sep-2004 03:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To change settings from .htaccess files, it is also required that the directory permissions configured in Apache allow this.<br />
<br />
The &lt;Directory /foo/bar&gt; entry in httpd.conf MUST contain "AllowOverride All" or at least "AllowOverride Options" to read PHP settings from the .htaccess file.<br />
<br />
E.g. in Fedora Core 2, the default settings for /var/www/html/ are "AllowOverride None", so changing PHP settings via .htaccess for applications installed below /var/www/html/ will not work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44717""></a>
  <div class="note">
   <strong class="user">sean at php dot net</strong>
   <a href="#44717" class="date">14-Aug-2004 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While this doesn't belong in the manual, it should be useful for people looking on this page for zend_optimizer.* ini options, which are commonly installed:
<br />

<br />
Information on the "zend_optimizer.optimization_level" and "zend_optimizer.enable_loader" options is available at:
<br />

<br />
<a href="http://www.zend.com/support/user_docs/ZendOptimizer/PDF/ZendOptimizer_UserGuide.pdf" rel="nofollow" target="_blank">http://www.zend.com/support/user_docs/ZendOptimizer/PDF/ZendOptimizer_UserGuide.pdf</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30424""></a>
  <div class="note">
   <strong class="user">davey at its-explosive dot net</strong>
   <a href="#30424" class="date">18-Mar-2003 03:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you set something using php_admin_value in httpd.conf it is then not possible to be set the value at runtime, even if it's NOT PHP_INI_SYSTEM. <br />
<br />
Just an interesting note for Server admins this might come in handy to disable setting of certain things... like allow_url_fopen.<br />
<br />
- Davey</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25601""></a>
  <div class="note">
   <strong class="user">miroslav AT simunic DOT de</strong>
   <a href="#25601" class="date">30-Sep-2002 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If it's not your server and therefore you want to hide the data in your session variables from other users, it?s very useful to set the session.save_handler in your scripts to shared memory with:
<br />

<br />
<span class="default">&lt;?php ini_set</span><span class="keyword">(</span><span class="string">'session.save_handler'</span><span class="keyword">,</span><span class="string">'mm'</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
Remember: You have to set it in every script that uses the session variables BEFORE "session_start()" or php won't find them.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22264""></a>
  <div class="note">
   <strong class="user">Tr909 at com dot nospam dot bigfoot</strong>
   <a href="#22264" class="date">12-Jun-2002 07:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[[[Editors note: Yes, this is very true.&nbsp; Same with 
<br />
register_globals, magic_quotes_gpc and others.
<br />
]]]
<br />

<br />
Many settings, although they do get set, have no influence in your script.... like upload_max_filesize will get set but uploaded files are already passed to your PHP script before the settings are changed.
<br />

<br />
Also other settings, set by ini_set(), may be to late because of this (post_max_size etc.).
<br />
beware, try settings thru php.ini or .htaccess.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19874""></a>
  <div class="note">
   <strong class="user">johnzoet at netscape dot com</strong>
   <a href="#19874" class="date">14-Mar-2002 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[[[Editors note: Just because you're able to set something 
<br />
doesn't mean it will work as expected.&nbsp; Depends on the 
<br />
setting.&nbsp; For example. setting register_globals at 
<br />
runtime will be of little use as its job has already 
<br />
been completed by the time it reaches your script.
<br />
]]]
<br />

<br />
When a setting can not be changed in a user script, the return value of ini_set is "empty", not "false" as you may expect.
<br />
If you check in your script for return value is "false" the script will continue processing, although the setting has not been set.
<br />
The boolean return value is used for settings that can be changed in a script. Otherwise the empty value is returned.
<br />
To test for both error conditions use:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">if (empty(</span><span class="default">$blnResult</span><span class="keyword">) or (!</span><span class="default">$blnResult</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; echo </span><span class="string">"setting cannot be set"</span><span class="keyword">;
<br />
&nbsp;&nbsp; exit;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
