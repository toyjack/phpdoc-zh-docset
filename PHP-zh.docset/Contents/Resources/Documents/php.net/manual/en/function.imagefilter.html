<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>对图像使用过滤器</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imagefilltoborder.html">? imagefilltoborder</a></li>
      <li style="float: right;"><a href="function.imageflip.html">imageflip ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.image.html">GD 和图像处理 函数</a></li>
    <li>对图像使用过滤器</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imagefilter" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imagefilter</h1>
  <p class="verinfo">(PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">imagefilter</span> &mdash; <span class="dc-title">对图像使用过滤器</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imagefilter-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>imagefilter</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$src_im</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$filtertype</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$arg1</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$arg2</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$arg3</code></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>imagefilter()</strong></span> 把过滤器
   <code class="parameter">filtertype</code> 应用到图像上，在需要时使用
   <code class="parameter">arg1</code>，<code class="parameter">arg2</code> 和
   <code class="parameter">arg3</code>。
  </p>
  <p class="para">
   <code class="parameter">filtertype</code> 可以是下列中的一个：
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_NEGATE</code>：将图像中所有颜色反转。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_GRAYSCALE</code>：将图像转换为灰度的。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_BRIGHTNESS</code>：改变图像的亮度。用
      <code class="parameter">arg1</code> 设定亮度级别。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_CONTRAST</code>：改变图像的对比度。用
      <code class="parameter">arg1</code> 设定对比度级别。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_COLORIZE</code>：与
      <code class="parameter">IMG_FILTER_GRAYSCALE</code> 类似，不过可以指定颜色。用
      <code class="parameter">arg1</code>，<code class="parameter">arg2</code> 和
      <code class="parameter">arg3</code> 分别指定
      <code class="parameter">red</code>，<code class="parameter">blue</code> 和
      <code class="parameter">green</code>。每种颜色范围是 0 到 255。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_EDGEDETECT</code>：用边缘检测来突出图像的边缘。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_EMBOSS</code>：使图像浮雕化。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_GAUSSIAN_BLUR</code>：用高斯算法模糊图像。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_SELECTIVE_BLUR</code>：模糊图像。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_MEAN_REMOVAL</code>：用平均移除法来达到轮廓效果。
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      <code class="parameter">IMG_FILTER_SMOOTH</code>：使图像更柔滑。用
      <code class="parameter">arg1</code> 设定柔滑级别。
     </span>
    </li>
   </ul>
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数仅在与 GD 库捆绑编译的 PHP 版本中可用。</span></p></blockquote>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>， 或者在失败时返回 <strong><code>FALSE</code></strong>。
  </p>
  <p class="para">
   <div class="example" id="example-3443">
    <p><strong>Example #1 <span class="function"><strong>imagefilter()</strong></span> 灰度例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'dave.png'</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_GRAYSCALE</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;converted&nbsp;to&nbsp;grayscale.'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'dave.png'</span><span style="color: #007700">);<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Conversion&nbsp;to&nbsp;grayscale&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3444">
    <p><strong>Example #2 <span class="function"><strong>imagefilter()</strong></span> 亮度例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'sean.png'</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_BRIGHTNESS</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;brightness&nbsp;changed.'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sean.png'</span><span style="color: #007700">);<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;brightness&nbsp;change&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3445">
    <p><strong>Example #3 <span class="function"><strong>imagefilter()</strong></span> 上彩例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'philip.png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;R,&nbsp;G,&nbsp;B,&nbsp;so&nbsp;0,&nbsp;255,&nbsp;0&nbsp;is&nbsp;green&nbsp;*/<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_COLORIZE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;successfully&nbsp;shaded&nbsp;green.'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'philip.png'</span><span style="color: #007700">);<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Green&nbsp;shading&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imagefilter-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">image</code></dt>

<dd>
<p class="para">由图象创建函数(例如<span class="function"><a href="function.imagecreatetruecolor.html" class="function">imagecreatetruecolor()</a></span>)返回的图象资源。</p></dd>

    
     <dt>
<code class="parameter">filtertype</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">filtertype</code> can be one of the following:
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_NEGATE</code></strong>: Reverses all colors of
          the image.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_GRAYSCALE</code></strong>: Converts the image into
          grayscale.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_BRIGHTNESS</code></strong>: Changes the brightness
          of the image. Use <code class="parameter">arg1</code> to set the level of
          brightness.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_CONTRAST</code></strong>: Changes the contrast of
          the image. Use <code class="parameter">arg1</code> to set the level of
          contrast.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: Like
          <strong><code>IMG_FILTER_GRAYSCALE</code></strong>, except you can specify the
          color. Use <code class="parameter">arg1</code>, <code class="parameter">arg2</code> and
          <code class="parameter">arg3</code> in the form of
          <code class="parameter">red</code>, <code class="parameter">blue</code>,
          <code class="parameter">green</code> and <code class="parameter">arg4</code> for the
          <code class="parameter">alpha</code> channel. The range for each color is 0 to 255.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_EDGEDETECT</code></strong>: Uses edge detection to
          highlight the edges in the image.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_EMBOSS</code></strong>: Embosses the image.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_GAUSSIAN_BLUR</code></strong>: Blurs the image using
          the Gaussian method.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_SELECTIVE_BLUR</code></strong>: Blurs the image.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_MEAN_REMOVAL</code></strong>: Uses mean removal to
          achieve a &quot;sketchy&quot; effect.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_SMOOTH</code></strong>: Makes the image smoother.
          Use <code class="parameter">arg1</code> to set the level of smoothness.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_PIXELATE</code></strong>: Applies pixelation effect 
          to the image, use <code class="parameter">arg1</code> to set the block size 
          and <code class="parameter">arg2</code> to set the pixelation effect mode.
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">arg1</code></dt>

     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_BRIGHTNESS</code></strong>: Brightness level.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_CONTRAST</code></strong>: Contrast level.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: 红色成分的值。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_SMOOTH</code></strong>: Smoothness level.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_PIXELATE</code></strong>: Block size in pixels.
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">arg2</code></dt>

     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: 绿色成分的值。
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_PIXELATE</code></strong>: Whether to use advanced pixelation 
          effect or not (defaults to <strong><code>FALSE</code></strong>).
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">arg3</code></dt>

     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: 蓝色成分的值。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">arg4</code></dt>

     <dd>

      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>IMG_FILTER_COLORIZE</code></strong>: Alpha channel, A value 
          between 0 and 127. 0 indicates completely opaque while 127 indicates 
          completely transparent.
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imagefilter-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>， 或者在失败时返回 <strong><code>FALSE</code></strong>。
  </p>
 </div>

 <div class="refsect1 changelog" id="refsect1-function.imagefilter-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
        Pixelation support (<strong><code>IMG_FILTER_PIXELATE</code></strong>) was added.
       </td>
      </tr>

      <tr>
       <td>5.2.5</td>
       <td>
        Alpha support for <strong><code>IMG_FILTER_COLORIZE</code></strong> was added.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.imagefilter-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-3446">
    <p><strong>Example #4 <span class="function"><strong>imagefilter()</strong></span> grayscale example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'dave.png'</span><span style="color: #007700">);<br /><br />if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_GRAYSCALE</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;converted&nbsp;to&nbsp;grayscale.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'dave.png'</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Conversion&nbsp;to&nbsp;grayscale&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3447">
    <p><strong>Example #5 <span class="function"><strong>imagefilter()</strong></span> brightness example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'sean.png'</span><span style="color: #007700">);<br /><br />if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_BRIGHTNESS</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;brightness&nbsp;changed.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'sean.png'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;brightness&nbsp;change&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3448">
    <p><strong>Example #6 <span class="function"><strong>imagefilter()</strong></span> colorize example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'philip.png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;R,&nbsp;G,&nbsp;B,&nbsp;so&nbsp;0,&nbsp;255,&nbsp;0&nbsp;is&nbsp;green&nbsp;*/<br /></span><span style="color: #007700">if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_COLORIZE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;successfully&nbsp;shaded&nbsp;green.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'philip.png'</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Green&nbsp;shading&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3449">
    <p><strong>Example #7 <span class="function"><strong>imagefilter()</strong></span> negate example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Define&nbsp;our&nbsp;negate&nbsp;function&nbsp;so&nbsp;its&nbsp;portable&nbsp;for&nbsp;<br />//&nbsp;php&nbsp;versions&nbsp;without&nbsp;imagefilter()<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">negate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;if(</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">'imagefilter'</span><span style="color: #007700">))<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_NEGATE</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$x&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);&nbsp;++</span><span style="color: #0000BB">$x</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$y&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);&nbsp;++</span><span style="color: #0000BB">$y</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$index&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorat</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rgb&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorsforindex</span><span style="color: #007700">(</span><span style="color: #0000BB">$index</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$color&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$rgb</span><span style="color: #007700">[</span><span style="color: #DD0000">'red'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">255&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$rgb</span><span style="color: #007700">[</span><span style="color: #DD0000">'green'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">255&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$rgb</span><span style="color: #007700">[</span><span style="color: #DD0000">'blue'</span><span style="color: #007700">]);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagesetpixel</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$y</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$color</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;return(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefromjpeg</span><span style="color: #007700">(</span><span style="color: #DD0000">'kalle.jpg'</span><span style="color: #007700">);<br /><br />if(</span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">negate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">))<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Image&nbsp;successfully&nbsp;converted&nbsp;to&nbsp;negative&nbsp;colors.'</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagejpeg</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'kalle.jpg'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">100</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Converting&nbsp;to&nbsp;negative&nbsp;colors&nbsp;failed.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3450">
    <p><strong>Example #8 <span class="function"><strong>imagefilter()</strong></span> pixelate example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;Load&nbsp;the&nbsp;PHP&nbsp;logo,&nbsp;we&nbsp;need&nbsp;to&nbsp;create&nbsp;two&nbsp;instances&nbsp;<br />//&nbsp;to&nbsp;show&nbsp;the&nbsp;differences<br /></span><span style="color: #0000BB">$logo1&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'./php.png'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$logo2&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatefrompng</span><span style="color: #007700">(</span><span style="color: #DD0000">'./php.png'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Create&nbsp;the&nbsp;image&nbsp;instance&nbsp;we&nbsp;want&nbsp;to&nbsp;show&nbsp;the&nbsp;<br />//&nbsp;differences&nbsp;on<br /></span><span style="color: #0000BB">$output&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">)&nbsp;*&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">));<br /><br /></span><span style="color: #FF8000">//&nbsp;Apply&nbsp;pixelation&nbsp;to&nbsp;each&nbsp;instance,&nbsp;with&nbsp;a&nbsp;block&nbsp;<br />//&nbsp;size&nbsp;of&nbsp;3<br /></span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_PIXELATE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagefilter</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">IMG_FILTER_PIXELATE</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Merge&nbsp;the&nbsp;differences&nbsp;onto&nbsp;the&nbsp;output&nbsp;image<br /></span><span style="color: #0000BB">imagecopy</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagecopy</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">),&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesx</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">imagesy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$logo2</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Output&nbsp;the&nbsp;differences<br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Type:&nbsp;image/png'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$output</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="mediaobject">
     
     <div class="imageobject">
      <img src="images/21009b70229598c6a80eef8b45bf282b-imagefilterpixelate.png" alt="Output of example : imagefilter() pixelate" width="190" height="51" />
     </div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.imagefilter-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数仅在与 GD 库捆绑编译的 PHP 版本中可用。</span></p></blockquote>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imagefilter-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imageconvolution.html" class="function" rel="rdfs-seeAlso">imageconvolution()</a> - 用系数 div 和 offset 申请一个 3x3 的卷积矩阵</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119025""></a>
  <div class="note">
   <strong class="user">shahilahmed4242 at gmail dot com</strong>
   <a href="#119025" class="date">18-Mar-2016 07:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP Sepia Effect<br />
<br />
&nbsp; $myImage = imagecreatefromjpeg($f);<br />
&nbsp; imagefilter($myImage,IMG_FILTER_GRAYSCALE);<br />
&nbsp; imagefilter($myImage,IMG_FILTER_BRIGHTNESS,-30);<br />
&nbsp; imagefilter($myImage,IMG_FILTER_COLORIZE, 90, 55, 30);&nbsp; <br />
&nbsp; header("Content-type: image/jpeg");<br />
&nbsp; imagejpeg($myImage );<br />
&nbsp; imagejpeg($myImage,$f);<br />
&nbsp; imagedestroy( $myImage );</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114750""></a>
  <div class="note">
   <strong class="user">martijn at martijnfrazer dot nl</strong>
   <a href="#114750" class="date">02-Apr-2014 02:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed an especially strong blur effect today and had a hard time achieving adequate results with the built-in IMG_FILTER_GAUSSIAN_BLUR filter. In order to achieve the strength of the blur I required I had to repeat the filter up to&nbsp; 100 times, which took way too long to be acceptable.<br />
<br />
After a bit of searching, I found this answer to be quite a good solution to this problem: <a href="http://stackoverflow.com/a/20264482" rel="nofollow" target="_blank">http://stackoverflow.com/a/20264482</a><br />
<br />
Based on that technique, I wrote the following generic function to achieve a very strong blur in a reasonable amount of processing:<br />
<br />
<span class="default">&lt;?php <br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Strong Blur<br />
&nbsp;*<br />
&nbsp;* @param resource $gdImageResource <br />
&nbsp;* @param int $blurFactor optional <br />
&nbsp;*&nbsp; This is the strength of the blur<br />
&nbsp;*&nbsp; 0 = no blur, 3 = default, anything over 5 is extremely blurred<br />
&nbsp;* @return GD image resource<br />
&nbsp;* @author Martijn Frazer, idea based on <a href="http://stackoverflow.com/a/20264482" rel="nofollow" target="_blank">http://stackoverflow.com/a/20264482</a><br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">blur</span><span class="keyword">(</span><span class="default">$gdImageResource</span><span class="keyword">, </span><span class="default">$blurFactor </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="comment">// blurFactor has to be an integer<br />
&nbsp; </span><span class="default">$blurFactor </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$blurFactor</span><span class="keyword">);<br />
&nbsp; <br />
&nbsp; </span><span class="default">$originalWidth </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$gdImageResource</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$originalHeight </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$gdImageResource</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">$smallestWidth </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$originalWidth </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">0.5</span><span class="keyword">, </span><span class="default">$blurFactor</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$smallestHeight </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$originalHeight </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">0.5</span><span class="keyword">, </span><span class="default">$blurFactor</span><span class="keyword">));<br />
<br />
&nbsp; </span><span class="comment">// for the first run, the previous image is the original input<br />
&nbsp; </span><span class="default">$prevImage </span><span class="keyword">= </span><span class="default">$gdImageResource</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$prevWidth </span><span class="keyword">= </span><span class="default">$originalWidth</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$prevHeight </span><span class="keyword">= </span><span class="default">$originalHeight</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">// scale way down and gradually scale back up, blurring all the way<br />
&nbsp; </span><span class="keyword">for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$blurFactor</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">)<br />
&nbsp; {&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// determine dimensions of next image<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nextWidth </span><span class="keyword">= </span><span class="default">$smallestWidth </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nextHeight </span><span class="keyword">= </span><span class="default">$smallestHeight </span><span class="keyword">* </span><span class="default">pow</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// resize previous image to next size<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nextImage </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$nextWidth</span><span class="keyword">, </span><span class="default">$nextHeight</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagecopyresized</span><span class="keyword">(</span><span class="default">$nextImage</span><span class="keyword">, </span><span class="default">$prevImage</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nextWidth</span><span class="keyword">, </span><span class="default">$nextHeight</span><span class="keyword">, </span><span class="default">$prevWidth</span><span class="keyword">, </span><span class="default">$prevHeight</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// apply blur filter<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$nextImage</span><span class="keyword">, </span><span class="default">IMG_FILTER_GAUSSIAN_BLUR</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// now the new image becomes the previous image for the next step<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$prevImage </span><span class="keyword">= </span><span class="default">$nextImage</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$prevWidth </span><span class="keyword">= </span><span class="default">$nextWidth</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$prevHeight </span><span class="keyword">= </span><span class="default">$nextHeight</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="comment">// scale back to original size and blur one more time<br />
&nbsp; </span><span class="default">imagecopyresized</span><span class="keyword">(</span><span class="default">$gdImageResource</span><span class="keyword">, </span><span class="default">$nextImage</span><span class="keyword">, <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$originalWidth</span><span class="keyword">, </span><span class="default">$originalHeight</span><span class="keyword">, </span><span class="default">$nextWidth</span><span class="keyword">, </span><span class="default">$nextHeight</span><span class="keyword">);<br />
&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$gdImageResource</span><span class="keyword">, </span><span class="default">IMG_FILTER_GAUSSIAN_BLUR</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// clean up<br />
&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$prevImage</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">// return result<br />
&nbsp; </span><span class="keyword">return </span><span class="default">$gdImageResource</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114277""></a>
  <div class="note">
   <strong class="user">Manolo at msalsas dot com</strong>
   <a href="#114277" class="date">01-Feb-2014 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
filtertype is an integer. So if you want to use it as a variable and need to use, e.g. preg_match function you can do it in this way:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $filter </span><span class="keyword">= </span><span class="default">IMG_FILTER_BRIGHTNESS</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">preg_match</span><span class="keyword">( </span><span class="string">'/^[0-9]{1,2}$/'</span><span class="keyword">, </span><span class="default">$filter </span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Do something<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
The order of the filtertypes in this manual determines the number of each filter, from 0 to 11. E.g. IMG_FILTER_NEGATE=0.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113049""></a>
  <div class="note">
   <strong class="user">yoann at yoone dot eu</strong>
   <a href="#113049" class="date">22-Aug-2013 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an alternative to IMG_FILTER_COLORIZE filter, but taking the alpha parameter of each pixel in account.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">rgba_colorize</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img_x </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img_y </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$img_x</span><span class="keyword">; ++</span><span class="default">$x</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$img_y</span><span class="keyword">; ++</span><span class="default">$y</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgba </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color_alpha </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$rgba</span><span class="keyword">[</span><span class="string">'alpha'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$color_alpha</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolordeallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$color_alpha</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110793""></a>
  <div class="note">
   <strong class="user">Padde</strong>
   <a href="#110793" class="date">09-Dec-2012 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I played with IMG_FILTER_SMOOTH and tried some negative<br />
values.<br />
<br />
-1 to -7: looks like a mix of smoothness and edgedetect<br />
<br />
-8: image seems to be completely broken<br />
<br />
-9 and lower: kind of sharpening effect (-9 sharper than -10)<br />
<br />
I think the sharpening effect in particular could be useful.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110391""></a>
  <div class="note">
   <strong class="user">martijn(97+1) at gmail dot com (solve math)</strong>
   <a href="#110391" class="date">18-Oct-2012 02:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple pixelate function, just in case you are &lt; 5.3<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">pixelate</span><span class="keyword">(&amp;</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$pixelsize</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$maxX </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$maxY </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rad</span><span class="keyword">=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$pixelsize</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">$rad</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$maxX</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">+=</span><span class="default">$pixelsize</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">$rad</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$maxY</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">+=</span><span class="default">$pixelsize</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilledrectangle </span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">-</span><span class="default">$rad</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">-</span><span class="default">$rad</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">+</span><span class="default">$pixelsize</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">+</span><span class="default">$pixelsize</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109809""></a>
  <div class="note">
   <strong class="user">cookie at backbone dot sk</strong>
   <a href="#109809" class="date">23-Aug-2012 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a function to create nice vignette effect:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">vignette</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">effect</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, &amp;</span><span class="default">$rgb</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; global </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sharp </span><span class="keyword">= </span><span class="default">0.4</span><span class="keyword">; </span><span class="comment">// 0 - 10 small is sharpnes,&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$level </span><span class="keyword">= </span><span class="default">0.7</span><span class="keyword">; </span><span class="comment">// 0 - 1 small is brighter<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">sin</span><span class="keyword">(</span><span class="default">M_PI </span><span class="keyword">/ </span><span class="default">$width </span><span class="keyword">* </span><span class="default">$x</span><span class="keyword">) * </span><span class="default">sin</span><span class="keyword">(</span><span class="default">M_PI </span><span class="keyword">/ </span><span class="default">$height </span><span class="keyword">* </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">pow</span><span class="keyword">(</span><span class="default">$l</span><span class="keyword">, </span><span class="default">$sharp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$l </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">- </span><span class="default">$level </span><span class="keyword">* (</span><span class="default">1 </span><span class="keyword">- </span><span class="default">$l</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">] *= </span><span class="default">$l</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">] *= </span><span class="default">$l</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">] *= </span><span class="default">$l</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">); ++</span><span class="default">$x</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">); ++</span><span class="default">$y</span><span class="keyword">){&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$index </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$index</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">effect</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$rgb</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">], </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">);&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">true</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">'cars7_134.jpg'</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$im </span><span class="keyword">and </span><span class="default">vignette</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: image/jpeg'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
}else{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Vignette failed.'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106344""></a>
  <div class="note">
   <strong class="user">mail at pedrocandeias dot com</strong>
   <a href="#106344" class="date">29-Oct-2011 04:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// With transparent PNG file you can colorize the "positive" items and stand the transparent has it is - Beta code<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">'Content-Type: image/png'</span><span class="keyword">);<br />
<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'image.png'</span><span class="keyword">);<br />
</span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">$imn </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
</span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">false</span><span class="keyword">);<br />
</span><span class="default">$col</span><span class="keyword">=</span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">127</span><span class="keyword">);<br />
</span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">,</span><span class="default">$col</span><span class="keyword">);<br />
</span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">imagecopy</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">, </span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
</span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">, </span><span class="default">IMG_FILTER_NEGATE</span><span class="keyword">);<br />
<br />
</span><span class="comment">// FOR A TRANSPARENT PNG FILE WITH SOMETHING INSIDE, YOU CAN CHANGE THE COLOR HERE: I HAVE RGB: 0, 255, 0<br />
</span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$imn</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104528""></a>
  <div class="note">
   <strong class="user">hadrien dot jouet at grownseed dot net</strong>
   <a href="#104528" class="date">21-Jun-2011 03:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For people looking to apply a 'multiply' effect on images like the one in Photoshop (generally b&amp;w ones), you can achieve it with the IMG_FILTER_COLORIZE filter.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">multiplyColor</span><span class="keyword">(&amp;</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$color </span><span class="keyword">= array(</span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp; </span><span class="comment">//get opposite color<br />
&nbsp;&nbsp; </span><span class="default">$opposite </span><span class="keyword">= array(</span><span class="default">255 </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">255 </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">255 </span><span class="keyword">- </span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp; </span><span class="comment">//now we subtract the opposite color from the image<br />
&nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, -</span><span class="default">$opposite</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], -</span><span class="default">$opposite</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], -</span><span class="default">$opposite</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102966""></a>
  <div class="note">
   <strong class="user">bushmakin stas (bushstas at mail dot ru)</strong>
   <a href="#102966" class="date">17-Mar-2011 09:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a function to make all colors gray except the only one
<br />
i made it myself so the code is note so beautiful )
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">imagecolorfilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$width</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$height</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">ImageColorAt</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$g </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">$rgb </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">=(</span><span class="default">$r</span><span class="keyword">+</span><span class="default">$g</span><span class="keyword">+</span><span class="default">$b</span><span class="keyword">)/</span><span class="default">3</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="comment">//if($g&lt;$r || $g&lt;$b+20){$r=$c;$g=$c; $b=$c;}//leaves only green 
<br />
//if($b&lt;$r || $b&lt;$g){$r=$c;$g=$c; $b=$c;}//only blue
<br />
</span><span class="keyword">if(</span><span class="default">$r</span><span class="keyword">&lt;</span><span class="default">$g</span><span class="keyword">+</span><span class="default">30 </span><span class="keyword">|| </span><span class="default">$r</span><span class="keyword">&lt;</span><span class="default">$b</span><span class="keyword">){</span><span class="default">$r</span><span class="keyword">=</span><span class="default">$c</span><span class="keyword">;</span><span class="default">$g</span><span class="keyword">=</span><span class="default">$c</span><span class="keyword">; </span><span class="default">$b</span><span class="keyword">=</span><span class="default">$c</span><span class="keyword">;}</span><span class="comment">//only red
<br />
//if($r&lt;$g-1 || $r&gt;$g+60 || $b&gt;$g-50){$r=$c;$g=$c; $b=$c;}//only yellow
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
</span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">,</span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">,</span><span class="default">$g</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
</span><span class="default">header </span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);
<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">"image.jpg"</span><span class="keyword">);
<br />
</span><span class="default">imagecolorfilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);
<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101159""></a>
  <div class="note">
   <strong class="user">jonathan dot gotti  at gmail dot com</strong>
   <a href="#101159" class="date">30-Nov-2010 03:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IMG_FILTER_COLORIZE doesn't seem to work on palette image, here's a way to achieve same result with palette image:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//$color is an array containing rvb infos (ie: array(255,80,0))<br />
</span><span class="keyword">function </span><span class="default">paletteColorize</span><span class="keyword">(</span><span class="default">$imgResource</span><span class="keyword">,array </span><span class="default">$color</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nbColors </span><span class="keyword">= </span><span class="default">imagecolorstotal</span><span class="keyword">(</span><span class="default">$imgResource</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nbColors</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">3</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">] = </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">min</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">]+</span><span class="default">$color</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">]));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolorset</span><span class="keyword">(</span><span class="default">$imgResource</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Here's also a function that work on both truecolor and palette images that try to do something similar to greyscale with a given color<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">colorScale</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,array </span><span class="default">$color</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,</span><span class="default">IMG_FILTER_GRAYSCALE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">_read_color</span><span class="keyword">(</span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$luminance</span><span class="keyword">=(</span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]+</span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]+</span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])/</span><span class="default">3</span><span class="keyword">; </span><span class="comment">// average luminance added by the color<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$brightnessCorrection </span><span class="keyword">= </span><span class="default">$luminance</span><span class="keyword">/</span><span class="default">3</span><span class="keyword">; </span><span class="comment">// quantity of brightness to correct for each channel<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">$luminance </span><span class="keyword">&lt; </span><span class="default">127 </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$brightnessCorrection </span><span class="keyword">-= </span><span class="default">127</span><span class="keyword">/</span><span class="default">3</span><span class="keyword">; </span><span class="comment">// color is dark so we have to negate the brightness correction <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(! </span><span class="default">imageistruecolor</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">) ){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nbColors </span><span class="keyword">= </span><span class="default">imagecolorstotal</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$nbColors</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">imgagecolorsforindex</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">3</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">] = </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">min</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">] + (</span><span class="default">$color</span><span class="keyword">[</span><span class="default">$y</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">) + </span><span class="default">$brightnessCorrection</span><span class="keyword">) ); </span><span class="comment">// parentheses just for better comprehension<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolorset</span><span class="keyword">(</span><span class="default">$omgRes</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">],</span><span class="default">$c</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{ </span><span class="comment">// much easier with truecolor<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]-</span><span class="default">$luminance</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$imgRes</span><span class="keyword">, </span><span class="default">IMG_FILTER_BRIGHTNESS</span><span class="keyword">, </span><span class="default">$brightnessCorrection</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
with hope that someone will find this useful</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91796""></a>
  <div class="note">
   <strong class="user">mail at kavisiegel dot com</strong>
   <a href="#91796" class="date">25-Jun-2009 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Searching for a way to easily change the color of the image, I tried IMG_FILTER_COLORIZE. I was unable to get the quality results I wanted. It turns out PHP's Colorize is the equivalent of Photoshop's "Linear Dodge" layer filter. <br />
<br />
Hue adjustments have always worked well for me, so I figured I could try with PHP.<br />
This function is kind of slow on larger images, but on small images like what I'm using it for, the difference is trivial.<br />
<br />
The script calculates the ratio or red, to green, to blue in the color provided, then scales the image appropriately... unfortunately, it does it pixel by pixel.<br />
<br />
Here's a demo and comparison of this function, to photoshop's hue function, to PHP's colorize. <a href="http://img146.imageshack.us/img146/3167/imagefilterhuedemo.png" rel="nofollow" target="_blank">http://img146.imageshack.us/img146/3167/imagefilterhuedemo.png</a><br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagefilterhue</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">,</span><span class="default">$g</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">+</span><span class="default">$g</span><span class="keyword">+</span><span class="default">$b</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$col </span><span class="keyword">= array(</span><span class="default">$r</span><span class="keyword">/</span><span class="default">$rgb</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">/</span><span class="default">$rgb</span><span class="keyword">,</span><span class="default">$g</span><span class="keyword">/</span><span class="default">$rgb</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">&lt;</span><span class="default">$width</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">&lt;</span><span class="default">$height</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">ImageColorAt</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$g </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">$rgb </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newR </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] + </span><span class="default">$g</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] + </span><span class="default">$b</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newG </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] + </span><span class="default">$g</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] + </span><span class="default">$b</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newB </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] + </span><span class="default">$g</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] + </span><span class="default">$b</span><span class="keyword">*</span><span class="default">$col</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">,</span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$newR</span><span class="keyword">, </span><span class="default">$newG</span><span class="keyword">, </span><span class="default">$newB</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">header </span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">"test.jpg"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Usage: Just as imagefilter(), except with no filtertype.<br />
// imagefilterhue(resource $image, int $red, int $green , int $blue)<br />
</span><span class="default">imagefilterhue</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">70</span><span class="keyword">,</span><span class="default">188</span><span class="keyword">);<br />
<br />
</span><span class="comment">// The equivalent with colorize, as tested in demo image: imagefilter($im, IMG_FILTER_COLORIZE, 2, 70, 188);<br />
<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82162""></a>
  <div class="note">
   <strong class="user">aiden dot mail at freemail dot hu</strong>
   <a href="#82162" class="date">29-Mar-2008 09:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Function to change the transparency of a png image on the fly. Works only with PNG, and with a browser supporting alpha channel.<br />
The function stretches the opacity-range of the image, so that the most opaque pixel(s) will be set to the given opacity. (Other opacity values in pixels are modified accordingly.)<br />
Returns success or failure.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">filter_opacity</span><span class="keyword">( &amp;</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$opacity </span><span class="keyword">) </span><span class="comment">//params: image resource id, opacity in percentage (eg. 80)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !isset( </span><span class="default">$opacity </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { return </span><span class="default">false</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$opacity </span><span class="keyword">/= </span><span class="default">100</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//get image width and height<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">( </span><span class="default">$img </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$h </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">( </span><span class="default">$img </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//turn alpha blending off<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagealphablending</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">false </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//find the most opaque pixel in the image (the one with the smallest alpha value)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$minalpha </span><span class="keyword">= </span><span class="default">127</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for( </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$w</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for( </span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$h</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$alpha </span><span class="keyword">= ( </span><span class="default">imagecolorat</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y </span><span class="keyword">) &gt;&gt; </span><span class="default">24 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$alpha </span><span class="keyword">&lt; </span><span class="default">$minalpha </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { </span><span class="default">$minalpha </span><span class="keyword">= </span><span class="default">$alpha</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//loop through image pixels and modify alpha for each<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for( </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$w</span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for( </span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$h</span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//get current alpha value (represents the TANSPARENCY!)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$colorxy </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$alpha </span><span class="keyword">= ( </span><span class="default">$colorxy </span><span class="keyword">&gt;&gt; </span><span class="default">24 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//calculate new alpha<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">$minalpha </span><span class="keyword">!== </span><span class="default">127 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { </span><span class="default">$alpha </span><span class="keyword">= </span><span class="default">127 </span><span class="keyword">+ </span><span class="default">127 </span><span class="keyword">* </span><span class="default">$opacity </span><span class="keyword">* ( </span><span class="default">$alpha </span><span class="keyword">- </span><span class="default">127 </span><span class="keyword">) / ( </span><span class="default">127 </span><span class="keyword">- </span><span class="default">$minalpha </span><span class="keyword">); }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { </span><span class="default">$alpha </span><span class="keyword">+= </span><span class="default">127 </span><span class="keyword">* </span><span class="default">$opacity</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//get the color index with new alpha<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$alphacolorxy </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, ( </span><span class="default">$colorxy </span><span class="keyword">&gt;&gt; </span><span class="default">16 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">, ( </span><span class="default">$colorxy </span><span class="keyword">&gt;&gt; </span><span class="default">8 </span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">, </span><span class="default">$colorxy </span><span class="keyword">&amp; </span><span class="default">0xFF</span><span class="keyword">, </span><span class="default">$alpha </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//set pixel with the new color + opacity<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( !</span><span class="default">imagesetpixel</span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$alphacolorxy </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; { return </span><span class="default">false</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Example for use:<br />
<br />
&nbsp;<span class="default">&lt;?php<br />
&nbsp; $image </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">( </span><span class="string">"img.png" </span><span class="keyword">);<br />
&nbsp; </span><span class="default">filter_opacity</span><span class="keyword">( </span><span class="default">$image</span><span class="keyword">, </span><span class="default">75 </span><span class="keyword">);<br />
&nbsp; </span><span class="default">header</span><span class="keyword">( </span><span class="string">"content-type: image/png" </span><span class="keyword">);<br />
&nbsp; </span><span class="default">imagepng</span><span class="keyword">( </span><span class="default">$image </span><span class="keyword">);<br />
&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">( </span><span class="default">$image </span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79337""></a>
  <div class="note">
   <strong class="user">michaeln no at spam associationsplus ca</strong>
   <a href="#79337" class="date">21-Nov-2007 05:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: applying IMG_FILTER_EMBOSS to text and using in a customization to the CAPTCHA image script in phpBB or a project of your own is a very good way to stop OCR-ing bots from getting through. Embossed serif fonts are fairly easy for the human eye to understand but to an OCR script it is extremely difficult because it seems to give it the illusion of 3D. <br />
<br />
If you only allocate 2 or 3 colours in the image, it uses the background colour alot in the embossed text, which greatly contributes to this.<br />
<br />
I made my own custom CAPTCHA script to stop phpBB post spam for a client site I was developing and I have gone from getting 2-3 new spam users created every day to zero.<br />
<br />
Anything with the source code freely available out there right now is possible to be defeated by spammers once one of them stars sharing code with the other spammers, but if you run something at least someone custom, their bots will pass you over.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79133""></a>
  <div class="note">
   <strong class="user">ssttoo at gmail dot com</strong>
   <a href="#79133" class="date">13-Nov-2007 09:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a page that shows the different filters in action<br />
<a href="http://www.phpied.com/image-fun-with-php-part-2/" rel="nofollow" target="_blank">http://www.phpied.com/image-fun-with-php-part-2/</a><br />
Also shows some quick ways to do sepia.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75003""></a>
  <div class="note">
   <strong class="user">webmaster at designsbykosi dot info</strong>
   <a href="#75003" class="date">08-May-2007 09:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This will only work if you have php5. For php4, you'll have to use the sepia function set webmaster at qudi dot de suggested.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73944""></a>
  <div class="note">
   <strong class="user">fananf at nerdshack dot com</strong>
   <a href="#73944" class="date">16-Mar-2007 06:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're looking for fast sepia effect that can be used for on-the-fly thumbnails generation you can't use sophisticated functions. The faster and much better way than described by webmaster at qudi dot de in the note from 31-Jan-2006 is applying colorize filter AFTER grayscale.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">(...)<br />
<br />
</span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$yourimage</span><span class="keyword">, </span><span class="default">IMG_FILTER_GRAYSCALE</span><span class="keyword">); </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$yourimage</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">90</span><span class="keyword">, </span><span class="default">60</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">); <br />
<br />
(...)<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I used (90,60,40) for my sepia after couple of tests, however, if you need darker or lighter just check what suits you best.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73253""></a>
  <div class="note">
   <strong class="user">trucex email over at gmail</strong>
   <a href="#73253" class="date">14-Feb-2007 09:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that imagefilter doesn't play nice with apha. If you run an imagefilter on a transparent image it'll return a black image...similar to a lot of Photoshop plugins do.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72329""></a>
  <div class="note">
   <strong class="user">PanuWorld</strong>
   <a href="#72329" class="date">14-Jan-2007 03:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The documentation misses the exact meaning and valid ranges of the arguments for ImageFilter(). According to the 5.2.0 sources the arguments are:<br />
IMG_FILTER_BRIGHTNESS<br />
-255 = min brightness, 0 = no change, +255 = max brightness<br />
<br />
IMG_FILTER_CONTRAST<br />
-100 = max contrast, 0 = no change, +100 = min contrast (note the direction!)<br />
<br />
IMG_FILTER_COLORIZE<br />
Adds (subtracts) specified RGB values to each pixel. The valid range for each color is -255...+255, not 0...255. The correct order is red, green, blue.<br />
-255 = min, 0 = no change, +255 = max<br />
This has not much to do with IMG_FILTER_GRAYSCALE.<br />
<br />
IMG_FILTER_SMOOTH<br />
Applies a 9-cell convolution matrix where center pixel has the weight arg1 and others weight of 1.0. The result is normalized by dividing the sum with arg1 + 8.0 (sum of the matrix).<br />
any float is accepted, large value (in practice: 2048 or more) = no change<br />
<br />
ImageFilter seem to return false if the argument(s) are out of range for the chosen filter.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68626""></a>
  <div class="note">
   <strong class="user">nancy at hypertextdigital dot com</strong>
   <a href="#68626" class="date">03-Aug-2006 11:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This routine was just what I was looking for, I wanted web admin users to be able to recolour their uploaded photos (to go with a news item) either a blue tint or sepia to match the appearance of other colours used on the website. <br />
<br />
Using a form with a select box containing the RGB values, I can give them the option of either of the two tints or no colourization at all, plus resize their images to the viewing size and a thumbnail image on the fly without having to use any other image editing software.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62395""></a>
  <div class="note">
   <strong class="user">santibari at fibertel dot com</strong>
   <a href="#62395" class="date">27-Feb-2006 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A colorize algorithm wich preserves color luminosity (i.e black <br />
will output black, and white will output white).<br />
This works in PHP4 and is great for customizing interfaces <br />
dinamically.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">colorize</span><span class="keyword">(</span><span class="default">$img_src</span><span class="keyword">,</span><span class="default">$img_dest</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$g</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) <br />
{<br />
if(!</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatefromgif</span><span class="keyword">(</span><span class="default">$img_src</span><span class="keyword">))<br />
&nbsp; return </span><span class="string">"Could not use image </span><span class="default">$img_src</span><span class="string">"</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="comment">//We will create a monochromatic palette based on<br />
//the input color<br />
//which will go from black to white<br />
//Input color luminosity: this is equivalent to the <br />
//position of the input color in the monochromatic<br />
//palette<br />
</span><span class="default">$lum_inp</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">*(</span><span class="default">$r</span><span class="keyword">+</span><span class="default">$g</span><span class="keyword">+</span><span class="default">$b</span><span class="keyword">)/</span><span class="default">765</span><span class="keyword">); </span><span class="comment">//765=255*3<br />
<br />
//We fill the palette entry with the input color at its <br />
//corresponding position<br />
<br />
</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_inp</span><span class="keyword">][</span><span class="string">'r'</span><span class="keyword">]=</span><span class="default">$r</span><span class="keyword">;<br />
</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_inp</span><span class="keyword">][</span><span class="string">'g'</span><span class="keyword">]=</span><span class="default">$g</span><span class="keyword">;<br />
</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_inp</span><span class="keyword">][</span><span class="string">'b'</span><span class="keyword">]=</span><span class="default">$b</span><span class="keyword">;<br />
<br />
</span><span class="comment">//Now we complete the palette, first we'll do it to<br />
//the black,and then to the white.<br />
<br />
//FROM input to black<br />
//===================<br />
//how many colors between black and input<br />
</span><span class="default">$steps_to_black</span><span class="keyword">=</span><span class="default">$lum_inp</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; <br />
<br />
</span><span class="comment">//The step size for each component<br />
</span><span class="keyword">if(</span><span class="default">$steps_to_black</span><span class="keyword">)<br />
&nbsp;{<br />
&nbsp;</span><span class="default">$step_size_red</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">/</span><span class="default">$steps_to_black</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;</span><span class="default">$step_size_green</span><span class="keyword">=</span><span class="default">$g</span><span class="keyword">/</span><span class="default">$steps_to_black</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;</span><span class="default">$step_size_blue</span><span class="keyword">=</span><span class="default">$b</span><span class="keyword">/</span><span class="default">$steps_to_black</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp;}<br />
<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$steps_to_black</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">--)<br />
&nbsp;{<br />
&nbsp;</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$steps_to_black</span><span class="keyword">-</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'r'</span><span class="keyword">]=</span><span class="default">$r</span><span class="keyword">-</span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_red</span><span class="keyword">*</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$steps_to_black</span><span class="keyword">-</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'g'</span><span class="keyword">]=</span><span class="default">$g</span><span class="keyword">-</span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_green</span><span class="keyword">*</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$steps_to_black</span><span class="keyword">-</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'b'</span><span class="keyword">]=</span><span class="default">$b</span><span class="keyword">-</span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_blue</span><span class="keyword">*</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;}<br />
<br />
</span><span class="comment">//From input to white:<br />
//===================<br />
//how many colors between input and white<br />
</span><span class="default">$steps_to_white</span><span class="keyword">=</span><span class="default">255</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">;<br />
<br />
if(</span><span class="default">$steps_to_white</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp; </span><span class="default">$step_size_red</span><span class="keyword">=(</span><span class="default">255</span><span class="keyword">-</span><span class="default">$r</span><span class="keyword">)/</span><span class="default">$steps_to_white</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp; </span><span class="default">$step_size_green</span><span class="keyword">=(</span><span class="default">255</span><span class="keyword">-</span><span class="default">$g</span><span class="keyword">)/</span><span class="default">$steps_to_white</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp; </span><span class="default">$step_size_blue</span><span class="keyword">=(</span><span class="default">255</span><span class="keyword">-</span><span class="default">$b</span><span class="keyword">)/</span><span class="default">$steps_to_white</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp; }<br />
&nbsp;else<br />
&nbsp; </span><span class="default">$step_size_red</span><span class="keyword">=</span><span class="default">$step_size_green</span><span class="keyword">=</span><span class="default">$step_size_blue</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;</span><span class="comment">//The step size for each component<br />
&nbsp;</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=(</span><span class="default">$lum_inp</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">255</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp; {<br />
&nbsp; </span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'r'</span><span class="keyword">]=</span><span class="default">$r </span><span class="keyword">+ </span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_red</span><span class="keyword">*(</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'g'</span><span class="keyword">]=</span><span class="default">$g </span><span class="keyword">+ </span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_green</span><span class="keyword">*(</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">));<br />
&nbsp; </span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="string">'b'</span><span class="keyword">]=</span><span class="default">$b </span><span class="keyword">+ </span><span class="default">round</span><span class="keyword">(</span><span class="default">$step_size_blue</span><span class="keyword">*(</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$lum_inp</span><span class="keyword">));<br />
&nbsp; }<br />
</span><span class="comment">//--- End of palette creation<br />
<br />
//Now,let's change the original palette into the one we<br />
//created<br />
</span><span class="keyword">for(</span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">$palette_size</span><span class="keyword">; </span><span class="default">$c</span><span class="keyword">++)<br />
&nbsp;{ <br />
&nbsp;</span><span class="default">$col </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;</span><span class="default">$lum_src</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">*(</span><span class="default">$col</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">]+</span><span class="default">$col</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; +</span><span class="default">$col</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">])/</span><span class="default">765</span><span class="keyword">);<br />
&nbsp;</span><span class="default">$col_out</span><span class="keyword">=</span><span class="default">$pal</span><span class="keyword">[</span><span class="default">$lum_src</span><span class="keyword">];<br />
&nbsp;</span><span class="default">imagecolorset</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$c</span><span class="keyword">, </span><span class="default">$col_out</span><span class="keyword">[</span><span class="string">'r'</span><span class="keyword">], <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col_out</span><span class="keyword">[</span><span class="string">'g'</span><span class="keyword">],<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col_out</span><span class="keyword">[</span><span class="string">'b'</span><span class="keyword">]);<br />
&nbsp;}<br />
<br />
&nbsp;</span><span class="comment">//save the image file<br />
&nbsp;</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">,</span><span class="default">$img_dest</span><span class="keyword">);<br />
&nbsp;</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
}</span><span class="comment">//end function colorize<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61317""></a>
  <div class="note">
   <strong class="user">webmaster at qudi dot de</strong>
   <a href="#61317" class="date">31-Jan-2006 03:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for a quick, ok-looking, sepia-effect (also in php4) I just use this little fellow, since a real implementation of sepia was just way too slow.<br />
<br />
function pseudosepia(&amp;$im,$percent){<br />
&nbsp;&nbsp; &nbsp;&nbsp; $sx=imagesx($im);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $sy=imagesy($im);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $filter=imagecreatetruecolor($sx,$sy);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $c=imagecolorallocate($filter,100,50,50);<br />
&nbsp;&nbsp; &nbsp;&nbsp; imagefilledrectangle($filter,0,0,$sx,$sy,$c);<br />
&nbsp;&nbsp; &nbsp;&nbsp; imagecopymerge($im,$filter,0,0,0,0,$sx,$sy,$percent);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59944""></a>
  <div class="note">
   <strong class="user">a php user  at  nowhere dot com</strong>
   <a href="#59944" class="date">20-Dec-2005 09:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<a href="http://www.hudzilla.org/phpbook/read.php/11_2_15" rel="nofollow" target="_blank">http://www.hudzilla.org/phpbook/read.php/11_2_15</a><br />
for more detailed info, and some &lt;i&gt;arg&lt;/i&gt; guidelines.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45391""></a>
  <div class="note">
   <strong class="user">vdepizzol at hotmail dot com</strong>
   <a href="#45391" class="date">04-Sep-2004 10:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Examples using imagefilter():<br />
<br />
<span class="default">&lt;?php<br />
$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'dave.png'</span><span class="keyword">);<br />
if (</span><span class="default">$im </span><span class="keyword">&amp;&amp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_GRAYSCALE</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image converted to grayscale.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="string">'dave.png'</span><span class="keyword">);<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Conversion to grayscale failed.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
/////////////////////////////<br />
<br />
<span class="default">&lt;?php<br />
$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'sean.png'</span><span class="keyword">);<br />
if (</span><span class="default">$im </span><span class="keyword">&amp;&amp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_BRIGHTNESS</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image brightness changed.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="string">'sean.png'</span><span class="keyword">);<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image brightness change failed.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
/////////////////////////////<br />
<br />
<span class="default">&lt;?php<br />
$im </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="string">'philip.png'</span><span class="keyword">);<br />
<br />
</span><span class="comment">/* R, G, B, so 0, 255, 0 is green */<br />
</span><span class="keyword">if (</span><span class="default">$im </span><span class="keyword">&amp;&amp; </span><span class="default">imagefilter</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">IMG_FILTER_COLORIZE</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Image successfully shaded green.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="string">'philip.png'</span><span class="keyword">);<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Green shading failed.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44316""></a>
  <div class="note">
   <strong class="user">kees at tweakers dot net</strong>
   <a href="#44316" class="date">21-Jul-2004 03:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
From what i have been able to find from this function, it accepts the following arguments:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_NEGATE<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_GRAYSCALE<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_EDGEDETECT<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_GAUSSIAN_BLUR<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_SELECTIVE_BLUR<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_EMBOSS<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_MEAN_REMOVAL<br />
<br />
The following arguments need one or more arguments.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_SMOOTH, -1924.124<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_COLORIZE, -127.12, -127.98, 127<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_CONTRAST, -90<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; IMG_FILTER_BRIGHTNESS, 98<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
I haven't tested them all, the names speak for themselves.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
