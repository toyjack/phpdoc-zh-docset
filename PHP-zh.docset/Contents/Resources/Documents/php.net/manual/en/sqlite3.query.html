<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Executes an SQL query</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="sqlite3.prepare.html">? SQLite3::prepare</a></li>
      <li style="float: right;"><a href="sqlite3.querysingle.html">SQLite3::querySingle ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.sqlite3.html">SQLite3</a></li>
    <li>Executes an SQL query</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="sqlite3.query" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">SQLite3::query</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.3.0, PHP 7)</p><p class="refpurpose"><span class="refname">SQLite3::query</span> &mdash; <span class="dc-title">Executes an SQL query</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-sqlite3.query-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type"><a href="class.sqlite3result.html" class="type SQLite3Result">SQLite3Result</a></span> <span class="methodname"><strong>SQLite3::query</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$query</code></span>
   )</div>

  <p class="para rdfs-comment">
   Executes an SQL query, returning an <a href="class.sqlite3result.html" class="classname">SQLite3Result</a> object if the query
   returns results.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-sqlite3.query-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">query</code></dt>

     <dd>

      <p class="para">
       The SQL query to execute.
      </p>
     </dd>

    
   </dl>

  </p>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-sqlite3.query-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an <a href="class.sqlite3result.html" class="classname">SQLite3Result</a> object if the query returns results. Otherwise,
   returns <strong><code>TRUE</code></strong> if the query succeeded, <strong><code>FALSE</code></strong> on failure.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-sqlite3.query-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2314">
    <p><strong>Example #1 <span class="function"><strong>SQLite3::query()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$db&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">SQLite3</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysqlitedb.db'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$results&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #DD0000">'SELECT&nbsp;bar&nbsp;FROM&nbsp;foo'</span><span style="color: #007700">);<br />while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$results</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchArray</span><span style="color: #007700">())&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$row</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111658""></a>
  <div class="note">
   <strong class="user">bohwaz</strong>
   <a href="#111658" class="date">13-Mar-2013 08:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The recommended way to do a SQLite3 query is to use a statement. For a table creation, a query might be fine (and easier) but for an insert, update or select, you should really use a statement, it's really easier and safer as SQLite will escape your parameters according to their type. SQLite will also use less memory than if you created the whole query by yourself. Example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$db </span><span class="keyword">= new </span><span class="default">SQLite3</span><span class="keyword">;<br />
</span><span class="default">$statement </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">prepare</span><span class="keyword">(</span><span class="string">'SELECT * FROM table WHERE id = :id;'</span><span class="keyword">);<br />
</span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">bindValue</span><span class="keyword">(</span><span class="string">':id'</span><span class="keyword">, </span><span class="default">$id</span><span class="keyword">);<br />
<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$statement</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
You can also re-use a statement and change its parameters, just do $statement-&gt;reset(). Finally don't forget to close a statement when you don't need it anymore as it will free some memory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101827""></a>
  <div class="note">
   <strong class="user">pgarvin76 at gmail dot com</strong>
   <a href="#101827" class="date">13-Jan-2011 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The notes for the return value is a little misleading to me. It states that if the query does not "return results" TRUE or FALSE is returned instead. If there is a return value for this method in your PHP code this method always returns an SQLite3Result object, even if you accidentally run an INSERT, UPDATE, DELETE, CREATE TABLE, etc query through it. The only time it returns a TRUE or FALSE is if there is no return value.<br />
<br />
<span class="default">&lt;?php<br />
$result </span><span class="keyword">= </span><span class="default">$dbh</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">'CREATE TABLE ...'</span><span class="keyword">);<br />
if (!(</span><span class="default">$result </span><span class="keyword">instanceof </span><span class="default">Sqlite3Result</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Query successful."</span><span class="keyword">; </span><span class="comment">// This will never echo.<br />
</span><span class="keyword">} else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetchArray</span><span class="keyword">(); </span><span class="comment">// This will throw an error.<br />
</span><span class="keyword">}<br />
<br />
if (</span><span class="default">$dbh</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">'CREATE TABLE ...'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Query successful."</span><span class="keyword">; </span><span class="comment">// Works<br />
</span><span class="keyword">} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Query failed."</span><span class="keyword">; </span><span class="comment">// Will also work<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span>Use exec() if you are not executing a SELECT query.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
