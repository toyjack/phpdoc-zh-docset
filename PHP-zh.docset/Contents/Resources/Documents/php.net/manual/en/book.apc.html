<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Alternative PHP Cache(可选PHP缓存)</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="refs.basic.php.html">? 影响 PHP 行为的扩展</a></li>
      <li style="float: right;"><a href="intro.apc.html">简介 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="refs.basic.php.html">影响 PHP 行为的扩展</a></li>
    <li>Alternative PHP Cache(可选PHP缓存)</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="book.apc" class="book">
 <h1 class="title">Alternative PHP Cache(可选PHP缓存)</h1>
 

 

 







 






 









 







<ul class="chunklist chunklist_book"><li><a href="intro.apc.html">简介</a></li><li><a href="apc.setup.html">安装／配置</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="apc.requirements.html">需求</a></li><li><a href="apc.installation.html">安装</a></li><li><a href="apc.configuration.html">运行时配置</a></li><li><a href="apc.resources.html">资源类型</a></li></ul></li><li><a href="apc.constants.html">预定义常量</a></li><li><a href="ref.apc.html">APC 函数</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.apc-add.html">apc_add</a> &mdash; 缓存一个变量到数据存储</li><li><a href="function.apc-bin-dump.html">apc_bin_dump</a> &mdash; Get a binary dump of the given files and user variables</li><li><a href="function.apc-bin-dumpfile.html">apc_bin_dumpfile</a> &mdash; Output a binary dump of cached files and user variables to a file</li><li><a href="function.apc-bin-load.html">apc_bin_load</a> &mdash; Load a binary dump into the APC file/user cache</li><li><a href="function.apc-bin-loadfile.html">apc_bin_loadfile</a> &mdash; Load a binary dump from a file into the APC file/user cache</li><li><a href="function.apc-cache-info.html">apc_cache_info</a> &mdash; Retrieves cached information from APC's data store</li><li><a href="function.apc-cas.html">apc_cas</a> &mdash; 用新值更新旧值</li><li><a href="function.apc-clear-cache.html">apc_clear_cache</a> &mdash; 清除APC缓存</li><li><a href="function.apc-compile-file.html">apc_compile_file</a> &mdash; Stores a file in the bytecode cache, bypassing all filters.</li><li><a href="function.apc-dec.html">apc_dec</a> &mdash; Decrease a stored number</li><li><a href="function.apc-define-constants.html">apc_define_constants</a> &mdash; Defines a set of constants for retrieval and mass-definition</li><li><a href="function.apc-delete-file.html">apc_delete_file</a> &mdash; Deletes files from the opcode cache</li><li><a href="function.apc-delete.html">apc_delete</a> &mdash; 从用户缓存中删除某个变量</li><li><a href="function.apc-exists.html">apc_exists</a> &mdash; 检查APC中是否存在某个或者某些key</li><li><a href="function.apc-fetch.html">apc_fetch</a> &mdash; 从缓存中取出存储的变量</li><li><a href="function.apc-inc.html">apc_inc</a> &mdash; 递增一个储存的数字</li><li><a href="function.apc-load-constants.html">apc_load_constants</a> &mdash; Loads a set of constants from the cache</li><li><a href="function.apc-sma-info.html">apc_sma_info</a> &mdash; Retrieves APC's Shared Memory Allocation information</li><li><a href="function.apc-store.html">apc_store</a> &mdash; Cache a variable in the data store</li></ul></li><li><a href="class.apciterator.html">APCIterator</a> &mdash; The APCIterator class<ul class="chunklist chunklist_book chunklist_children"><li><a href="apciterator.construct.html">APCIterator::__construct</a> &mdash; 构造一个 APCIterator 迭代器对象</li><li><a href="apciterator.current.html">APCIterator::current</a> &mdash; 获取当前项</li><li><a href="apciterator.gettotalcount.html">APCIterator::getTotalCount</a> &mdash; 获取总数</li><li><a href="apciterator.gettotalhits.html">APCIterator::getTotalHits</a> &mdash; 获取缓存命中数</li><li><a href="apciterator.gettotalsize.html">APCIterator::getTotalSize</a> &mdash; 获取所有缓存的尺寸大小</li><li><a href="apciterator.key.html">APCIterator::key</a> &mdash; Get iterator key获取迭代器的键</li><li><a href="apciterator.next.html">APCIterator::next</a> &mdash; 移到下一项</li><li><a href="apciterator.rewind.html">APCIterator::rewind</a> &mdash; 倒退迭代器</li><li><a href="apciterator.valid.html">APCIterator::valid</a> &mdash; 检查当前位置是否有效</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="107387""></a>
  <div class="note">
   <strong class="user">mike at eastghost dot com</strong>
   <a href="#107387" class="date">06-Feb-2012 01:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Was using Memcache and Memcached extensions, painfully bouncing between faults, failures and shortcomings of each.&nbsp; My two cents: Neither of these old drivers has been a smash hit, repressing and slowly dooming of the true potential and full use of unix memcached.<br />
<br />
The pain finally drove to me to try APC's apc_store and apc_fetch.&nbsp; The results?&nbsp; Instant success, no more errors, an order of magnitude (at least) speed boost, plus one less thing (memcached) to run.&nbsp; Nice.&nbsp; Never going back again.&nbsp; Thank y'all.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105926""></a>
  <div class="note">
   <strong class="user">umut dot kirgoz at gmail dot com</strong>
   <a href="#105926" class="date">26-Sep-2011 09:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since APC 3.1.3, there is a bug (<a href="http://pecl.php.net/bugs/bug.php?id=16814" rel="nofollow" target="_blank">http://pecl.php.net/bugs/bug.php?id=16814</a>) which produces warnings like "Potential Cache Slam Averted for Key" when slam defense is on and you're trying to write a key that already exists. <br />
<br />
These is not a fix right now for this, but you can change the APC settings from php.ini file like below if possible:<br />
<br />
apc.write_lock = 1<br />
apc.slam_defense = 0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91541""></a>
  <div class="note">
   <strong class="user">hello at haroonahmad dot co dot uk</strong>
   <a href="#91541" class="date">16-Jun-2009 12:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Disclaimer: i do not guarantee it will work for you so you better use it at your own risk. It works for me.<br />
<br />
* I am using # symbol for all shell commands<br />
<br />
I am posting a quick step-by-step guide to install APC on servers (dedicated or VPS) with cpanel/whm working.<br />
<br />
First login as a root to your server/vps and make a directory to work with this plugin,<br />
<br />
#mkdir /home/APC-php<br />
<br />
#cd /home/APC-php<br />
<br />
now here we will first download the APC with following command<br />
<br />
#wget <a href="http://pecl.php.net/get/APC-3.0.14.tgz " rel="nofollow" target="_blank">http://pecl.php.net/get/APC-3.0.14.tgz </a><br />
<br />
you can check for the latest version<br />
<br />
now you can use gzip and tar separately or tar -xzvf to unzip this file<br />
<br />
#tar -xzvf APC-3.0.14.tgz<br />
<br />
now you will have a APC-3.0.14 folder. <br />
<br />
#cd APC-3.0.14<br />
<br />
now you have to make php configuration files by following command<br />
<br />
#phpize<br />
<br />
after this use following three commands<br />
<br />
# ./configure --enable-apc --enable-apc-mmap --with-apxs --with-php-config=/usr/bin/php-config<br />
<br />
*if you do not know the php path then execute ( which php ) command it will display the path. on a typical cpanel vps it could be /usr/bin/php-config or /usr/local/bin/php-config but you better check it before executing the above command)<br />
<br />
#make<br />
<br />
#make test<br />
<br />
#make install<br />
<br />
NOTE: if you are using suPHP then skip --with-apxs <br />
<br />
*one more thing, if you use <br />
<br />
#make test<br />
<br />
command it shows 3 tests failed then do not worry, it showed at least to me but worked with the final steps. <br />
<br />
the (make install) command will return the apc.so module path, note down that with you as you will have to feed it in the php.ini file in the next step.<br />
<br />
check your php.ini location by<br />
<br />
#php -i | grep php.ini<br />
<br />
then open it with your favorite editor. mine was at<br />
<br />
#vi /usr/local/lib/php.ini<br />
<br />
and go to the last line and paste the following<br />
<br />
extension="apc.so"<br />
<br />
now there is a catch in it, if you have other modules installed and their extension directory is different than the one MAKE INSTALL showed for APC so you have to move your apc.so to that directory so that all modules are in the same directory. in my case my APC directory was<br />
<br />
/usr/lib/php/extensions/no-debug-non-zts-20060613/<br />
<br />
but i moved apc.so from this location to my other location where my other extensions.so files were. <br />
<br />
you can check that path in php.ini sectiion of<br />
<br />
extension_dir = ""<br />
<br />
after this restart your apache, for different servers it may vary mine worked with <br />
<br />
#service httpd restart<br />
<br />
if everything works fine it will restart apache without showing any error. in case of any error, roll back your php.ini changes and restart apache and discuss your problem in some forum or email me at hello@haroonahmad.co.uk<br />
<br />
now check the phpinfo() output in your browser and it will display APC version information etc. for command line you might do<br />
<br />
php -i | grep apc <br />
<br />
I hope it helps.<br />
<br />
Haroon Ahmad</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
