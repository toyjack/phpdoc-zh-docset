<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>舍去法取整</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.expm1.html">? expm1</a></li>
      <li style="float: right;"><a href="function.fmod.html">fmod ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.math.html">Math 函数</a></li>
    <li>舍去法取整</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.floor" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">floor</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">floor</span> &mdash; <span class="dc-title">舍去法取整</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.floor-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">float</span> <span class="methodname"><strong>floor</strong></span>
    ( <span class="methodparam"><span class="type">float</span> <code class="parameter">$value</code></span>
   )</div>

  <p class="simpara">
   返回不大于
     <code class="parameter">value</code> 的最接近的整数，舍去小数部分取整。
  </p>
   </div>

   <div class="refsect1 parameters" id="refsect1-function.floor-parameters">
    <h3 class="title">参数</h3>
    <p class="para">
     <dl>

      
       <dt>
<code class="parameter">value</code></dt>

       <dd>

        <p class="para">
         要取整的数字
        </p>
       </dd>

      
     </dl>

    </p>
   </div>

   <div class="refsect1 returnvalues" id="refsect1-function.floor-returnvalues">
    <h3 class="title">返回值</h3>
    <p class="para">
     返回不大于
     <code class="parameter">value</code> 的最接近的整数，将
   <code class="parameter">value</code>
   的小数部分舍去取整。<span class="function"><strong>floor()</strong></span> 返回的类型仍然是
   <span class="type"><a href="language.types.float.html" class="type float">float</a></span>，因为 <span class="type"><a href="language.types.float.html" class="type float">float</a></span> 值的范围通常比 <span class="type"><a href="language.types.integer.html" class="type integer">integer</a></span> 要大。
  </p>
   </div>

   <div class="refsect1 examples" id="refsect1-function.floor-examples">
    <h3 class="title">范例</h3>
    <p class="para">
     <div class="example" id="example-3845">
      <p><strong>Example #1 <span class="function"><strong>floor()</strong></span> 例子</strong></p>
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">floor</span><span style="color: #007700">(</span><span style="color: #0000BB">4.3</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;4<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">floor</span><span style="color: #007700">(</span><span style="color: #0000BB">9.999</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;9<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">floor</span><span style="color: #007700">(-</span><span style="color: #0000BB">3.14</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;-4<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
   </div>

   <div class="refsect1 seealso" id="refsect1-function.floor-seealso">
    <h3 class="title">参见</h3>
    <p class="para">
     <ul class="simplelist">
      <li class="member"><span class="function"><a href="function.ceil.html" class="function" rel="rdfs-seeAlso">ceil()</a> - 进一法取整</span></li>
      <li class="member"><span class="function"><a href="function.round.html" class="function" rel="rdfs-seeAlso">round()</a> - 对浮点数进行四舍五入</span></li>
     </ul>
    </p>
   </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="118555""></a>
  <div class="note">
   <strong class="user">Leon Grdic</strong>
   <a href="#118555" class="date">28-Dec-2015 06:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: do not use Seppili's function to floor with decimals. It will lead you to a lot of trouble because of float number precision.<br />
<br />
For example floordec(0.29, 2) will result in 0.28.<br />
<br />
Here's a little fix that will help you get around some problems:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">floordec</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">,</span><span class="default">$decimals</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">){&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">*</span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">$decimals</span><span class="keyword">)+</span><span class="default">0.5</span><span class="keyword">)/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">$decimals</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115007""></a>
  <div class="note">
   <strong class="user">josoort at home dot nl</strong>
   <a href="#115007" class="date">12-May-2014 04:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can simply make a floor with decimals function by using the round() function and subtract 0.05 to the value if the value must have 1 decimal accuracy, or 0.005 for 2 decimals accuracy, or 0.0005 for 3 decimals etc.<br />
<br />
Example :<br />
<br />
function floorDec($input, $decimals)<br />
{<br />
&nbsp;&nbsp;&nbsp; return round($input - (5 / pow(10, $decimals + 1)), $decimals);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114204""></a>
  <div class="note">
   <strong class="user">till at tonda dot de</strong>
   <a href="#114204" class="date">24-Jan-2014 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the use of floor may (intended or not) uncover false integers:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$arrRoots</span><span class="keyword">=array();<br />
</span><span class="default">$arrRoots</span><span class="keyword">[]=</span><span class="default">pow</span><span class="keyword">(</span><span class="default">27</span><span class="keyword">,(</span><span class="default">1</span><span class="keyword">/</span><span class="default">3</span><span class="keyword">));&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// pow(3,3)=27<br />
</span><span class="default">$arrRoots</span><span class="keyword">[]=</span><span class="default">pow</span><span class="keyword">(</span><span class="default">64</span><span class="keyword">,(</span><span class="default">1</span><span class="keyword">/</span><span class="default">3</span><span class="keyword">));&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// pow(4,3)=64<br />
<br />
</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$arrRoots</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++)<br />
{<br />
if(</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]!=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]))<br />
&nbsp; echo </span><span class="string">'&lt;div style="background-color:#ffff99"&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'Unfloored value: '</span><span class="keyword">.</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">' (Format float? '</span><span class="keyword">.</span><span class="default">is_float</span><span class="keyword">(</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]).</span><span class="string">')&lt;br /&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'Floored value: '</span><span class="keyword">.</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]).</span><span class="string">' (Format float? '</span><span class="keyword">.</span><span class="default">is_float</span><span class="keyword">(</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])).</span><span class="string">')'</span><span class="keyword">;<br />
if(</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]!=</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$arrRoots</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]))<br />
&nbsp; echo </span><span class="string">'&lt;/div&gt;'</span><span class="keyword">;<br />
echo </span><span class="string">'&lt;br /&gt;&lt;br /&gt;'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The directly retrieved cubic root of 64 (by pow with a fraction exp) equals 4; an outcome any maths teacher will reckon correct.<br />
<br />
Yet bringing the same number - the cubic root of 64 retrieved in the very same manner - to the floor will result in a value of 3 only. This behaviour is in no way exceptional.<br />
<br />
It is pivotal to check whether you are dealing with genuine integers or floats in disguise. floor should be used carefully.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114195""></a>
  <div class="note">
   <strong class="user">maikl</strong>
   <a href="#114195" class="date">23-Jan-2014 05:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A correction to the funcion floor_dec from the user "php is the best".<br />
If the number is 0.05999 it returns 0.59 because the zero at left position is deleted.<br />
I just added a '1' and after the floor or ceil call remove with a substr.<br />
Hope it helps.<br />
<br />
function floor_dec($number,$precision = 2,$separator = '.') {<br />
&nbsp; $numberpart=explode($separator,$number);<br />
&nbsp; $numberpart[1]=substr_replace($numberpart[1],$separator,$precision,0);<br />
&nbsp; if($numberpart[0]&gt;=0) {<br />
&nbsp;&nbsp;&nbsp; $numberpart[1]=substr(floor('1'.$numberpart[1]),1);<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; $numberpart[1]=substr(ceil('1'.$numberpart[1]),1);<br />
&nbsp; }<br />
&nbsp; $ceil_number= array($numberpart[0],$numberpart[1]);<br />
&nbsp; return implode($separator,$ceil_number);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108371""></a>
  <div class="note">
   <strong class="user">php is the best</strong>
   <a href="#108371" class="date">20-Apr-2012 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Floor decimal numebrs with precision:<br />
<br />
function floor_dec($number,$precision,$separator)<br />
{<br />
&nbsp;&nbsp;&nbsp; $numberpart=explode($separator,$number);<br />
&nbsp;&nbsp;&nbsp; $numberpart[1]=substr_replace($numberpart[1],$separator,$precision,0);<br />
&nbsp;&nbsp;&nbsp; if($numberpart[0]&gt;=0)<br />
&nbsp;&nbsp;&nbsp; {$numberpart[1]=floor($numberpart[1]);}<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {$numberpart[1]=ceil($numberpart[1]);}<br />
<br />
&nbsp;&nbsp; &nbsp; $ceil_number= array($numberpart[0],$numberpart[1]);<br />
&nbsp;&nbsp;&nbsp; return implode($separator,$ceil_number);<br />
}<br />
<br />
echo floor_dec(1.125,2,"."); //1.12<br />
echo floor_dec(-1.3436,3,"."); //-1.344<br />
echo floor_dec(102938.1,4,"."); //102938.1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96568""></a>
  <div class="note">
   <strong class="user">seppili_ at gmx dot de</strong>
   <a href="#96568" class="date">05-Mar-2010 05:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use this function to floor with decimals:<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">floordec</span><span class="keyword">(</span><span class="default">$zahl</span><span class="keyword">,</span><span class="default">$decimals</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">){&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$zahl</span><span class="keyword">*</span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">$decimals</span><span class="keyword">))/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">$decimals</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89195""></a>
  <div class="note">
   <strong class="user">lewis at lewishenshall dot co dot uk</strong>
   <a href="#89195" class="date">26-Feb-2009 08:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're wanting to round down to the nearest hundred:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">rounddowntohundred</span><span class="keyword">(</span><span class="default">$theNumber</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$theNumber</span><span class="keyword">)&lt;</span><span class="default">3</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$theNumber</span><span class="keyword">=</span><span class="default">$theNumber</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$theNumber</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$theNumber</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$theNumber</span><span class="keyword">)-</span><span class="default">2</span><span class="keyword">) . </span><span class="string">"00"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$theNumber</span><span class="keyword">;<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88197""></a>
  <div class="note">
   <strong class="user">fragov at gmail dot com</strong>
   <a href="#88197" class="date">15-Jan-2009 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Have solved a "price problem":
<br />

<br />
<span class="default">&lt;?php
<br />
$peny </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">price</span><span class="keyword">*</span><span class="default">1000</span><span class="keyword">) - </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">price</span><span class="keyword">)*</span><span class="default">1000</span><span class="keyword">)/</span><span class="default">10</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83784""></a>
  <div class="note">
   <strong class="user">benrr101 at gmail dot com</strong>
   <a href="#83784" class="date">11-Jun-2008 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
But, if you want the number closest to zero, you could use this:<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">if(</span><span class="default">$foo </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">);<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$foo</span><span class="keyword">);<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
-benrr101</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83478""></a>
  <div class="note">
   <strong class="user">greene dot mc at removethispart dot gmail dot com</strong>
   <a href="#83478" class="date">27-May-2008 10:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I believe this behavior of the floor function was intended.&nbsp; Note that it says "the next lowest integer".&nbsp; -1 is "higher" than -1.6.&nbsp; As in, -1 is logically greater than -1.6.&nbsp; To go lower the floor function would go to -2 which is logically less than -1.6.<br />
<br />
Floor isn't trying to give you the number closest to zero, it's giving you the lowest bounding integer of a float.<br />
<br />
In reply to Glen who commented:<br />
&nbsp;Glen<br />
01-Dec-2007 04:22<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">floor</span><span class="keyword">(</span><span class="default">1.6</span><span class="keyword">);&nbsp; </span><span class="comment">// will output "1"<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">floor</span><span class="keyword">(-</span><span class="default">1.6</span><span class="keyword">); </span><span class="comment">// will output "-2"<br />
</span><span class="default">?&gt;<br />
</span><br />
instead use intval (seems to work v5.1.6):<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">intval</span><span class="keyword">(</span><span class="default">1.6</span><span class="keyword">);&nbsp; </span><span class="comment">// will output "1"<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">intval</span><span class="keyword">(-</span><span class="default">1.6</span><span class="keyword">); </span><span class="comment">// will output "-1"<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82042""></a>
  <div class="note">
   <strong class="user">jay at w3prodigy dot com</strong>
   <a href="#82042" class="date">25-Mar-2008 09:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note:
<br />

<br />
<span class="default">&lt;?php
<br />
$int </span><span class="keyword">= </span><span class="default">0.99999999999999999</span><span class="keyword">;
<br />
echo </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$int</span><span class="keyword">); </span><span class="comment">// returns 1
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
and
<br />

<br />
<span class="default">&lt;?php
<br />
$int </span><span class="keyword">= </span><span class="default">0.9999999999999999</span><span class="keyword">;
<br />
echo </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$int</span><span class="keyword">); </span><span class="comment">// returns 0
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79515""></a>
  <div class="note">
   <strong class="user">Glen</strong>
   <a href="#79515" class="date">01-Dec-2007 10:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">floor</span><span class="keyword">(</span><span class="default">1.6</span><span class="keyword">);&nbsp; </span><span class="comment">// will output "1"<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">floor</span><span class="keyword">(-</span><span class="default">1.6</span><span class="keyword">); </span><span class="comment">// will output "-2"<br />
</span><span class="default">?&gt;<br />
</span><br />
instead use intval (seems to work v5.1.6):<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">intval</span><span class="keyword">(</span><span class="default">1.6</span><span class="keyword">);&nbsp; </span><span class="comment">// will output "1"<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">intval</span><span class="keyword">(-</span><span class="default">1.6</span><span class="keyword">); </span><span class="comment">// will output "-1"<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44595""></a>
  <div class="note">
   <strong class="user">jolyon at mways dot co dot uk</strong>
   <a href="#44595" class="date">10-Aug-2004 06:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware of FLOAT weirdness!
<br />

<br />
Floats have a mind of their own, and what may look like an integer stored in a float isn't.
<br />

<br />
Here's a baffling example of how floor can be tripped up by this:
<br />

<br />
<span class="default">&lt;?php
<br />
$price </span><span class="keyword">= </span><span class="default">79.99</span><span class="keyword">;
<br />

<br />
print </span><span class="default">$price</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;&nbsp; &nbsp;&nbsp; </span><span class="comment">// correct result, 79.99 shown
<br />

<br />
</span><span class="default">$price </span><span class="keyword">= </span><span class="default">$price </span><span class="keyword">* </span><span class="default">100</span><span class="keyword">;
<br />

<br />
print </span><span class="default">$price</span><span class="keyword">.</span><span class="string">"\r\n"</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">// correct result, 7999 shown
<br />

<br />
</span><span class="keyword">print </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$price</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// 7998 shown! what's going on?
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The thing to remember here is that the way a float stores a value makes it very easy for these kind of things to happen. When the 79.99 was multiplied by 100, the actual value stored in the float was probably something like 7998.9999999999999999999999999999999999, PHP would print out 7999 when the value is displayed but floor would therefore round this down to 7998.
<br />

<br />
THe moral of this story - never use float for anything that needs to be accurate! If you're doing prices for products or a shopping cart, then always use an integer and store prices as a number of pence, you'll thank me for this later :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42345""></a>
  <div class="note">
   <strong class="user">illyena at musefish dot net</strong>
   <a href="#42345" class="date">13-May-2004 12:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For calculating the number of days, hours, minutes and seconds to an event.
<br />

<br />
<span class="default">&lt;?php
<br />
$then </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="default">mktime</span><span class="keyword">(</span><span class="default">8</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">,</span><span class="default">25</span><span class="keyword">,</span><span class="default">2004</span><span class="keyword">)); </span><span class="comment">//remember that mktime is hour,min,sec,month,day,year
<br />
</span><span class="default">$now </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"U"</span><span class="keyword">); </span><span class="comment">// "U" is the number of seconds since the epoch, equivilant to using "YmdHis"
<br />

<br />
</span><span class="default">$time </span><span class="keyword">= </span><span class="default">$then </span><span class="keyword">- </span><span class="default">$now</span><span class="keyword">; </span><span class="comment">//gets the number of seconds between now and the event
<br />
</span><span class="default">$days </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$time</span><span class="keyword">/</span><span class="default">86400</span><span class="keyword">); </span><span class="comment">//rounds down to the whole number, in this case # of days
<br />
</span><span class="keyword">echo </span><span class="default">$days</span><span class="keyword">.</span><span class="string">" Days"</span><span class="keyword">;
<br />
</span><span class="default">$time </span><span class="keyword">= </span><span class="default">$time </span><span class="keyword">- (</span><span class="default">$days</span><span class="keyword">*</span><span class="default">86400</span><span class="keyword">); </span><span class="comment">//leaves you with the amount of time ramaining after subtracting the days
<br />
</span><span class="default">$hours </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$time</span><span class="keyword">/</span><span class="default">3600</span><span class="keyword">); </span><span class="comment">//rounds down to the whole number, in this case # of hours
<br />
</span><span class="keyword">echo </span><span class="default">$hours</span><span class="keyword">.</span><span class="string">" Hours"</span><span class="keyword">;
<br />
</span><span class="default">$time </span><span class="keyword">= </span><span class="default">$time </span><span class="keyword">- (</span><span class="default">$hours</span><span class="keyword">*</span><span class="default">3600</span><span class="keyword">); </span><span class="comment">//leaves you with the amount of time ramaining after subtracting the hours
<br />
</span><span class="default">$min </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$time</span><span class="keyword">/</span><span class="default">60</span><span class="keyword">); </span><span class="comment">//rounds down to the whole number, in this case # of minutes
<br />
</span><span class="keyword">echo </span><span class="default">$min</span><span class="keyword">.</span><span class="string">" Minutes"</span><span class="keyword">;
<br />
</span><span class="default">$sec </span><span class="keyword">= </span><span class="default">$time </span><span class="keyword">- (</span><span class="default">$min</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">); </span><span class="comment">//leaves you with the amount of time ramaining after subtracting the minutes which is equivilant to the remainins seconds
<br />
</span><span class="keyword">echo </span><span class="default">$sec</span><span class="keyword">.</span><span class="string">" Seconds"</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38423""></a>
  <div class="note">
   <strong class="user">PHP Helper</strong>
   <a href="#38423" class="date">20-Dec-2003 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
floor basically truncates, or chops off everything to the right of a decimal. For instance, if you have a length of 5.1234, but just wanted the whole number, you could use the following code:<br />
<br />
<span class="default">&lt;?php<br />
$length </span><span class="keyword">= </span><span class="default">5.1234</span><span class="keyword">; </span><span class="comment">//this is our original length<br />
</span><span class="default">$length </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">); </span><span class="comment">//length is truncated, original variable name is kept<br />
</span><span class="keyword">print </span><span class="string">"</span><span class="default">$length</span><span class="string">"</span><span class="keyword">; </span><span class="comment">//this prints our result<br />
</span><span class="default">?&gt;<br />
</span><br />
This code would print the following: 5<br />
<br />
Now, although there is a specific function in PHP for rounding, rounding can also be performed with the floor function. Let's say we wanted to round the length to the hundredths place.<br />
<br />
<span class="default">&lt;?php<br />
$length </span><span class="keyword">= </span><span class="default">5.1234</span><span class="keyword">;<br />
</span><span class="default">$length </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">((</span><span class="default">$length</span><span class="keyword">) * </span><span class="default">100 </span><span class="keyword">+ </span><span class="default">.5</span><span class="keyword">) * </span><span class="default">.01</span><span class="keyword">;<br />
print </span><span class="string">"</span><span class="default">$length</span><span class="string">"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The result is: 5.12<br />
<br />
This works because, first, the length is multiplied by 100, which moves the decimal point to the right two places, giving us the value of 512.34. Next .5 is added to the length, which gives us a value of 512.84. Then the floor function truncates the value, leaving us with 512. Lastly, to compensate for multiplying by 100 earlier, now we must divide by 100, or in this case, multiply by .01. This moves the decimal point back 2 places to it's original place and gives us the rounded value of 5.12.<br />
<br />
We can also round to other values, such as the thousandths, by adjusting the code as follows:<br />
<br />
<span class="default">&lt;?php<br />
$length </span><span class="keyword">= </span><span class="default">5.1234</span><span class="keyword">;<br />
</span><span class="default">$length </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">((</span><span class="default">$length</span><span class="keyword">) * </span><span class="default">1000 </span><span class="keyword">+ </span><span class="default">.5</span><span class="keyword">) * </span><span class="default">.001</span><span class="keyword">;<br />
print </span><span class="string">"</span><span class="default">$length</span><span class="string">"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Result: 5.123</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25079""></a>
  <div class="note">
   
   <a href="#25079" class="date">10-Sep-2002 12:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mathematical functions lack a floating point version of the modulo operation, which returns the difference between the floor() of the argument and the argument itself:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">fmod</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) {
<br />
&nbsp; return </span><span class="default">$value </span><span class="keyword">- </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Very useful with trigonometric functions to reduce the angle argument to a circle that includes angle 0.
<br />

<br />
Useful also to reduce an arbitrarily large floating point value into an entropy source, by first transforming this value into a pair using logarithm functions with distinct bases (add 1 if the function can return 0, to avoid floating point errors with logarithms!):
<br />

<br />
<span class="default">&lt;?php
<br />
$f </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">+ @</span><span class="default">disk_free_space</span><span class="keyword">(</span><span class="string">"/tmp"</span><span class="keyword">);
<br />
</span><span class="default">$r </span><span class="keyword">= (int)(</span><span class="default">fmod</span><span class="keyword">(</span><span class="default">Log</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">)) * </span><span class="default">0x7FFFFFFF</span><span class="keyword">)
<br />
^ (int)(</span><span class="default">fmod</span><span class="keyword">(</span><span class="default">Log10</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">)) * </span><span class="default">0x7FFFFFFF</span><span class="keyword">)
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Then $r can be used as a good entropy source, if the free space in your temporary folder used by PHP is constantly evolving within a large range of values.
<br />

<br />
You can combine this value by xoring it with other values such as time(), (int)microtime(), ip2long($_SERVER['REMOTE_ADDR'], $_SERVER['REMOTE_PORT'], getmypid(), ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
