<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Open an IMAP stream to a mailbox</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imap-num-recent.html">? imap_num_recent</a></li>
      <li style="float: right;"><a href="function.imap-ping.html">imap_ping ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.imap.html">IMAP 函数</a></li>
    <li>Open an IMAP stream to a mailbox</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imap-open" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imap_open</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">imap_open</span> &mdash; <span class="dc-title">Open an <acronym title="Internet Message Access Protocol">IMAP</acronym> stream to a mailbox</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imap-open-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">resource</span> <span class="methodname"><strong>imap_open</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$mailbox</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$username</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$n_retries</code><span class="initializer"> = 0</span></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$params</code><span class="initializer"> = <strong><code>NULL</code></strong></span></span>
  ]]] )</div>

  <p class="para rdfs-comment">
   Opens an <acronym title="Internet Message Access Protocol">IMAP</acronym> stream to a <code class="parameter">mailbox</code>.
  </p>
  <p class="para">
   This function can also be used to open streams to <acronym title="Post Office Protocol version 3">POP3</acronym> and
   <acronym title="Network News Transfer Protocol">NNTP</acronym> servers, but some functions and features are only
   available on <acronym title="Internet Message Access Protocol">IMAP</acronym> servers.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imap-open-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">mailbox</code></dt>

     <dd>

      <p class="para">
       A mailbox name consists of a server and a mailbox path on this server.
       The special name <em>INBOX</em> stands for the current users
       personal mailbox. Mailbox names that contain international characters
       besides those in the printable ASCII space have to be encoded width
       <span class="function"><a href="function.imap-utf7-encode.html" class="function">imap_utf7_encode()</a></span>.
      </p>
      <p class="para">
       The server part, which is enclosed in &#039;{&#039; and &#039;}&#039;, consists of the servers
       name or ip address, an optional port (prefixed by &#039;:&#039;), and an optional
       protocol specification (prefixed by &#039;/&#039;). 
      </p>
      <p class="para">
       The server part is mandatory in all mailbox
       parameters. 
      </p>
      <p class="para">
       All names which start with <em>{</em> are remote names, and are
       in the form <em>&quot;{&quot; remote_system_name [&quot;:&quot; port] [flags] &quot;}&quot;
       [mailbox_name]</em> where:
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <em>remote_system_name</em> - Internet domain name or
          bracketed IP address of server.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <em>port</em> - optional TCP port number, default is the
          default port for that service
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <em>flags</em> - optional flags, see following table.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <em>mailbox_name</em> - remote mailbox name, default is INBOX
         </span>
        </li>
       </ul>
      </p>
      <p class="para">
       <table class="doctable table">
        <caption><strong>Optional flags for names</strong></caption>
        
         <thead>
          <tr>
           <th>Flag</th>
           <th>Description</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td><em>/service=</em><em class="emphasis">service</em></td>
           <td>mailbox access service, default is &quot;imap&quot;</td>
          </tr>

          <tr>
           <td><em>/user=</em><em class="emphasis">user</em></td>
           <td>remote user name for login on the server</td>
          </tr>

          <tr>
           <td><em>/authuser=</em><em class="emphasis">user</em></td>
           <td>remote authentication user; if specified this is the user name
            whose password is used (e.g. administrator)</td>
          </tr>

          <tr>
           <td><em>/anonymous</em></td>
           <td>remote access as anonymous user</td>
          </tr>

          <tr>
           <td><em>/debug</em></td>
           <td>record protocol telemetry in application&#039;s debug log</td>
          </tr>

          <tr>
           <td><em>/secure</em></td>
           <td>do not transmit a plaintext password over the network</td>
          </tr>

          <tr>
           <td><em>/imap</em>, <em>/imap2</em>,
            <em>/imap2bis</em>, <em>/imap4</em>,
            <em>/imap4rev1</em></td>
           <td>equivalent to <em>/service=imap</em></td>
          </tr>

          <tr>
           <td><em>/pop3</em></td>
           <td>equivalent to <em>/service=pop3</em></td>
          </tr>

          <tr>
           <td><em>/nntp</em></td>
           <td>equivalent to <em>/service=nntp</em></td>
          </tr>

          <tr>
           <td><em>/norsh</em></td>
           <td>do not use rsh or ssh to establish a preauthenticated IMAP
            session</td>
          </tr>

          <tr>
           <td><em>/ssl</em></td>
           <td>use the <em>Secure Socket Layer</em> to encrypt the session</td>
          </tr>

          <tr>
           <td><em>/validate-cert</em></td>
           <td>validate certificates from TLS/SSL server (this is the default
            behavior)</td>
          </tr>

          <tr>
           <td><em>/novalidate-cert</em></td>
           <td>do not validate certificates from TLS/SSL server, needed if
            server uses self-signed certificates</td>
          </tr>

          <tr>
           <td><em>/tls</em></td>
           <td>force use of <em>start-TLS</em> to encrypt the session, and reject
            connection to servers that do not support it</td>
          </tr>

          <tr>
           <td><em>/notls</em></td>
           <td>do not do <em>start-TLS</em> to encrypt the session, even with servers
            that support it</td>
          </tr>

          <tr>
           <td><em>/readonly</em></td>
           <td>request read-only mailbox open (IMAP only; ignored on NNTP, and
            an error with SMTP and POP3)</td>
          </tr>

         </tbody>
        
       </table>

      </p>
     </dd>

    
    
     <dt>
<code class="parameter">username</code></dt>

     <dd>

      <p class="para">
       The user name
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">password</code></dt>

     <dd>

      <p class="para">
       The password associated with the <code class="parameter">username</code>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">options</code></dt>

     <dd>

      <p class="para">
       The <code class="parameter">options</code> are a bit mask with one or more of
       the following:
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_READONLY</code></strong> - Open mailbox read-only
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_ANONYMOUS</code></strong> - Don&#039;t use or update a
          <var class="filename">.newsrc</var> for news (NNTP only)
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_HALFOPEN</code></strong> - For <acronym title="Internet Message Access Protocol">IMAP</acronym>
          and <acronym title="Network News Transfer Protocol">NNTP</acronym> names, open a connection but
          don&#039;t open a mailbox.
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>CL_EXPUNGE</code></strong> - Expunge mailbox automatically upon mailbox close
          (see also <span class="function"><a href="function.imap-delete.html" class="function">imap_delete()</a></span> and
          <span class="function"><a href="function.imap-expunge.html" class="function">imap_expunge()</a></span>)
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_DEBUG</code></strong> - Debug protocol negotiations
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_SHORTCACHE</code></strong> - Short (<em>elt</em>-only) caching
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_SILENT</code></strong> - Don&#039;t pass up events (internal use)
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_PROTOTYPE</code></strong> - Return driver prototype
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>OP_SECURE</code></strong> - Don&#039;t do non-secure authentication
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">n_retries</code></dt>

     <dd>

      <p class="para">
       Number of maximum connect attempts
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">params</code></dt>

     <dd>

      <p class="para">
       Connection parameters, the following (string) keys maybe used 
       to set one or more connection parameters:
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <em>DISABLE_AUTHENTICATOR</em> - Disable authentication properties
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imap-open-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an IMAP stream on success or <strong><code>FALSE</code></strong> on error.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.imap-open-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.2</td>
       <td><code class="parameter">params</code> added</td>
      </tr>

      <tr>
       <td>5.2.0</td>
       <td><code class="parameter">n_retries</code> added</td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.imap-open-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-3748">
    <p><strong>Example #1 Different use of <span class="function"><strong>imap_open()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;connect&nbsp;to&nbsp;an&nbsp;IMAP&nbsp;server&nbsp;running&nbsp;on&nbsp;port&nbsp;143&nbsp;on&nbsp;the&nbsp;local&nbsp;machine,<br />//&nbsp;do&nbsp;the&nbsp;following:<br /></span><span style="color: #0000BB">$mbox&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_open</span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:143}INBOX"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;connect&nbsp;to&nbsp;a&nbsp;POP3&nbsp;server&nbsp;on&nbsp;port&nbsp;110&nbsp;on&nbsp;the&nbsp;local&nbsp;server,&nbsp;use:<br /></span><span style="color: #0000BB">$mbox&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_open&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:110/pop3}INBOX"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;connect&nbsp;to&nbsp;an&nbsp;SSL&nbsp;IMAP&nbsp;or&nbsp;POP3&nbsp;server,&nbsp;add&nbsp;/ssl&nbsp;after&nbsp;the&nbsp;protocol<br />//&nbsp;specification:<br /></span><span style="color: #0000BB">$mbox&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_open&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:993/imap/ssl}INBOX"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;connect&nbsp;to&nbsp;an&nbsp;SSL&nbsp;IMAP&nbsp;or&nbsp;POP3&nbsp;server&nbsp;with&nbsp;a&nbsp;self-signed&nbsp;certificate,<br />//&nbsp;add&nbsp;/ssl/novalidate-cert&nbsp;after&nbsp;the&nbsp;protocol&nbsp;specification:<br /></span><span style="color: #0000BB">$mbox&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_open&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:995/pop3/ssl/novalidate-cert}"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user_id"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;connect&nbsp;to&nbsp;an&nbsp;NNTP&nbsp;server&nbsp;on&nbsp;port&nbsp;119&nbsp;on&nbsp;the&nbsp;local&nbsp;server,&nbsp;use:<br /></span><span style="color: #0000BB">$nntp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_open&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">"{localhost:119/nntp}comp.test"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;To&nbsp;connect&nbsp;to&nbsp;a&nbsp;remote&nbsp;server&nbsp;replace&nbsp;"localhost"&nbsp;with&nbsp;the&nbsp;name&nbsp;or&nbsp;the<br />//&nbsp;IP&nbsp;address&nbsp;of&nbsp;the&nbsp;server&nbsp;you&nbsp;want&nbsp;to&nbsp;connect&nbsp;to.<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-3749">
    <p><strong>Example #2 <span class="function"><strong>imap_open()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mbox&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_open</span><span style="color: #007700">(</span><span style="color: #DD0000">"{imap.example.org:143}"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"username"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /><br />echo&nbsp;</span><span style="color: #DD0000">"&lt;h1&gt;Mailboxes&lt;/h1&gt;\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$folders&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_listmailbox</span><span style="color: #007700">(</span><span style="color: #0000BB">$mbox</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"{imap.example.org:143}"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"*"</span><span style="color: #007700">);<br /><br />if&nbsp;(</span><span style="color: #0000BB">$folders&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Call&nbsp;failed&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$folders&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />echo&nbsp;</span><span style="color: #DD0000">"&lt;h1&gt;Headers&nbsp;in&nbsp;INBOX&lt;/h1&gt;\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imap_headers</span><span style="color: #007700">(</span><span style="color: #0000BB">$mbox</span><span style="color: #007700">);<br /><br />if&nbsp;(</span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Call&nbsp;failed&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$headers&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$val</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$val&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br&nbsp;/&gt;\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #0000BB">imap_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$mbox</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imap-open-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imap-close.html" class="function" rel="rdfs-seeAlso">imap_close()</a> - Close an IMAP stream</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119028""></a>
  <div class="note">
   <strong class="user">Valerio Pulese</strong>
   <a href="#119028" class="date">19-Mar-2016 12:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get slow imap4/pop3 authentication step <br />
i.e. 5-10 sec just for response, maybe you are connecting to an imap server which is advertising GSSAPI auth mechanism.<br />
Martin Eckardt note could help to speed it up.<br />
<span class="default">&lt;?php<br />
$mbox </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{imap server with GSSAPI :993/imap/ssl}"</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, array(</span><span class="string">'DISABLE_AUTHENTICATOR' </span><span class="keyword">=&gt; </span><span class="string">'GSSAPI'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
Disable GSSAPI if you dont use it.<br />
If your imap/pop server is Dovecot<br />
/etc/dovecot/conf.d/10-auth.conf<br />
...<br />
auth_mechanisms = plain login gssapi<br />
-&gt; auth_mechanisms = plain login</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118119""></a>
  <div class="note">
   <strong class="user">Ap.Muthu</strong>
   <a href="#118119" class="date">07-Oct-2015 06:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An old archived 2006 PHP script to retrieve IMAP POP3 email into a MySQL database and as files is at:<br />
<a href="http://web.archive.org/web/20060411020022/http://www.sellchain.com/phPOP3/phPOP3.txt" rel="nofollow" target="_blank">http://web.archive.org/web/20060411020022/http://www.sellchain.com/phPOP3/phPOP3.txt</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116973""></a>
  <div class="note">
   <strong class="user">Tim</strong>
   <a href="#116973" class="date">30-Mar-2015 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi<br />
<br />
I was struggling with the Gmail Imap/pop connection. It keeps saying too many failed login connections were made.<br />
<br />
Thing I did:<br />
&nbsp;https://www.google.com/settings/security/lesssecureapps<br />
Clicked "Turn on"<br />
&gt; worked!<br />
<br />
So last step could be used but remember your account will be at a certain security risk. Anyway it comes in handy to develop...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116466""></a>
  <div class="note">
   <strong class="user">Lisboa</strong>
   <a href="#116466" class="date">07-Jan-2015 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The error: Unknown: Mailbox is empty (errflg=1) in Unknown on line 0<br />
appears when:<br />
<br />
1)&nbsp; use imap_open to connect <br />
2) then use imap_search ALL to retrieve emails<br />
<br />
but there are no messages available. To avoid this error, check first the number of messages in a mailbox using imap_status. Only if there are messages available then you can use the imap_search.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115637""></a>
  <div class="note">
   <strong class="user">hashampel at yahoo dot de</strong>
   <a href="#115637" class="date">29-Aug-2014 05:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Subfolders of INBOX have to be seperate by dot like this: 'INBOX.test'<br />
$mailbox = '{example.example.com:143/imap/novalidate-cert}INBOX.test'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115130""></a>
  <div class="note">
   <strong class="user">me at achronos dot ca</strong>
   <a href="#115130" class="date">01-Jun-2014 11:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Do not bother using "/debug" flag in $mailbox or OP_DEBUG in $options. They do not do anything.<br />
<br />
When you set either one, the underlying IMAP c-client library will gather protocol debugging data and pass it back to PHP.<br />
However, the debug handler defined by PHP is an empty function, it doesn't do anything.<br />
<br />
So unless you're using a customized version of the IMAP extension that does something with that handler (mm_dlog), there is no point using "/debug" or OP_DEBUG.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115070""></a>
  <div class="note">
   <strong class="user">Brian Law</strong>
   <a href="#115070" class="date">22-May-2014 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
imap_open()<br />
&nbsp;validate SSL certificate does not support Subject Alternative Name (SAN) certificate. It only validate against the Subject/Common name.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114895""></a>
  <div class="note">
   <strong class="user">dejan</strong>
   <a href="#114895" class="date">22-Apr-2014 10:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your opening and closing of connection is too slow, the issue might be with DNS servers. You should add the IP addresses of IMAP servers to your hosts file.<br />
<br />
It's explained here in more details <a href="http://www.dejanstosic.com/php-imap_open-too-slow-here-is-the-solution/" rel="nofollow" target="_blank">http://www.dejanstosic.com/php-imap_open-too-slow-here-is-the-solution/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114099""></a>
  <div class="note">
   <strong class="user">jeff at newscloud dot com</strong>
   <a href="#114099" class="date">11-Jan-2014 03:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One of the issues with gmail IMAP SSL authentication is related to Google's account security.<br />
<br />
Once you get the login error once, sign out of all your google accounts. Then, visit this link:<br />
<a href="http://www.google.com/accounts/DisplayUnlockCaptcha" rel="nofollow" target="_blank">http://www.google.com/accounts/DisplayUnlockCaptcha</a><br />
<br />
Log in with the account you're attempting to access via imap.<br />
<br />
Follow the steps and you'll then be able to login in to gmail with php imap.<br />
<br />
It's visually shown here:<br />
<a href="http://jeffreifman.com/filtered-open-source-imap-mail-filtering-software-for-php/configuring-gmail/" rel="nofollow" target="_blank">http://jeffreifman.com/filtered-open-source-imap-mail-filtering-software-for-php/configuring-gmail/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107414""></a>
  <div class="note">
   <strong class="user">phpnote at cardiothink dot com</strong>
   <a href="#107414" class="date">07-Feb-2012 11:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thank you for this completely non-obvious tip, which solved the problem for me. To help search engines find this tip: the resulting error is "PHP Warning:&nbsp; imap_open(): Couldn't open stream /home/your-directory/the-file-name in the-script-name on line XX"<br />
<br />
If you include:&nbsp; $str = imap_errors();&nbsp; echo("imap_errors():\n");&nbsp; print_r($str);<br />
you will see:<br />
&nbsp; imap_errors():<br />
&nbsp; Array<br />
&nbsp; (<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Can't open mailbox /home/your-directory/the-file-name: no such mailbox<br />
&nbsp; )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106853""></a>
  <div class="note">
   <strong class="user">phpnet at danepowell dot com</strong>
   <a href="#106853" class="date">12-Dec-2011 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are accessing a local mailbox file, i.e. imap_open('/var/mail/www-data', '', ''), you may be restricted in what files you can access.<br />
<br />
If PHP IMAP was compiled with the restrictBox option (which I believe most packages are these days), you can only access files relative to $HOME. Paths starting with '/' or '../' will be rejected.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104701""></a>
  <div class="note">
   <strong class="user">Martin Eckardt</strong>
   <a href="#104701" class="date">01-Jul-2011 03:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since Version 5.3.2 there's a 6th parameter available to disable authentication with GSSAPI or NTLM:<br />
<br />
Example:<br />
<span class="default">&lt;?php<br />
$mbox </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{w2010ExchangeServer:993/imap/ssl}"</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, array(</span><span class="string">'DISABLE_AUTHENTICATOR' </span><span class="keyword">=&gt; </span><span class="string">'GSSAPI'</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
This solves the problem with Exchange 2010 for me. As a reference see https://bugs.php.net/bug.php?id=33500</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104394""></a>
  <div class="note">
   <strong class="user">jeff1326</strong>
   <a href="#104394" class="date">13-Jun-2011 04:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your connection is too slow, try it with port and without domain.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">//Normal connection
<br />
</span><span class="default">$mailbox </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{SERVER}INBOX"</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//Faster connection
<br />
</span><span class="default">$mailbox </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{SERVER:143}INBOX"</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//Very slow connection
<br />
</span><span class="default">$mailbox </span><span class="keyword">= </span><span class="default">imap_open </span><span class="keyword">(</span><span class="string">"{SERVER.DOMAIN}INBOX"</span><span class="keyword">, </span><span class="string">"DOMAIN/"</span><span class="keyword">.</span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103902""></a>
  <div class="note">
   <strong class="user">david at brayworth dot com dot au</strong>
   <a href="#103902" class="date">10-May-2011 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I managed to use this function against Exchange 2010 without recompiling to disable kerberos<br />
<br />
It's important to me that php installs per the standard package (yum install php)<br />
<br />
Exchange 2010 triggers kerberos in php, and you require the kinit thing (search around google for "imap_open kinit exchange 2010" and you will find this)<br />
<br />
To get it working I had to:<br />
1. setup the krb5.conf file correctly<br />
2. do a kinit username@DOMAIN.DOM with a valid username / password<br />
3. rename the ticket file to reflect the user id of apache (usually 48)<br />
&nbsp;&nbsp; /tmp/krb5cc_48<br />
4. fix ownership<br />
&nbsp;&nbsp; chown apache.apache /tmp/krb5cc_48<br />
<br />
but the exchange server will use the kerberos ticket and not the username password - unless you use ssl<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; $imap_user </span><span class="keyword">= </span><span class="string">"username"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$imap_pass </span><span class="keyword">= </span><span class="string">"password"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$imap_server </span><span class="keyword">= </span><span class="string">"{w2010kExchangeServer:993/novalidate-cert/ssl}"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mbox </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"</span><span class="keyword">{</span><span class="default">$imap_server</span><span class="keyword">}</span><span class="string">INBOX"</span><span class="keyword">, </span><span class="default">$imap_user</span><span class="keyword">, </span><span class="default">$imap_pass</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sorted_mbox </span><span class="keyword">= </span><span class="default">imap_sort</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">, </span><span class="default">SORTDATE</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$totalrows </span><span class="keyword">= </span><span class="default">imap_num_msg</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"</span><span class="default">$imap_server</span><span class="string">\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$startvalue </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$startvalue </span><span class="keyword">&lt; </span><span class="default">$totalrows</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= </span><span class="default">imap_fetchheader</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">, </span><span class="default">$sorted_mbox</span><span class="keyword">[ </span><span class="default">$startvalue </span><span class="keyword">] );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subject </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/^Subject: (.*)/m'</span><span class="keyword">, </span><span class="default">$headers</span><span class="keyword">, </span><span class="default">$subject</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="default">$subject</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] . </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startvalue</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>&nbsp; &nbsp; <br />
One small step for php / exchange, one Giant leap for David&nbsp; ....</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103762""></a>
  <div class="note">
   <strong class="user">ph at hotmail dot fr</strong>
   <a href="#103762" class="date">02-May-2011 10:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those having issues with Gmail (my problem was : "too many login failures" on a webserver, but no problem on localhost..), instead of opening with :<br />
<br />
$inbox = imap_open($hostname,$username,$password,NULL,1) or die('Cannot connect to Gmail: ' . imap_last_error());<br />
<br />
Use :<br />
<br />
$inbox = imap_open($hostname,$username,$password,NULL,1) or die('Cannot connect to Gmail: ' . print_r(imap_errors()));<br />
<br />
You will be able to see the full list of errors that happened, and hopefully it will guide you to an answer.<br />
In my case, Google wanted me to unlock my account by typing in a captcha. But this error wasn't clearly shown through imap_last_error().<br />
<br />
Cheers,<br />
PH</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100827""></a>
  <div class="note">
   <strong class="user">guilherme dot geronimo at gmail dot com</strong>
   <a href="#100827" class="date">10-Nov-2010 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using: 
<br />
<span class="default">&lt;?php
<br />
imap_open</span><span class="keyword">( </span><span class="string">"{server.example.com:143}INBOX" </span><span class="keyword">, </span><span class="string">'login' </span><span class="keyword">, </span><span class="string">'password' </span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Got this error:
<br />
"Couldn't open stream {server.example.com:143}INBOX" 
<br />

<br />
Solved by adding the flag "novalidate-cert":
<br />
<span class="default">&lt;?php
<br />
imap_open</span><span class="keyword">( </span><span class="string">"{server.example.com:143/novalidate-cert}INBOX" </span><span class="keyword">, </span><span class="string">'login' </span><span class="keyword">, </span><span class="string">'password' </span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
=D</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99798""></a>
  <div class="note">
   <strong class="user">egoman69 at hotmail</strong>
   <a href="#99798" class="date">07-Sep-2010 09:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"Couldn't open stream {127.0.0.1:143/imap/notls}INBOX" <br />
<br />
Solved by only replacing 127.0.0.1 with localhost, php and IMAP server both in same machine, not through Proxy or anything. Weird!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99603""></a>
  <div class="note">
   <strong class="user">Nohado</strong>
   <a href="#99603" class="date">26-Aug-2010 08:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if u ever get something like this:<br />
<br />
Notice: Unknown: IMAP protocol error: Invalid system flag in Store command (errflg=2) in Unknown on line 0<br />
<br />
Notice: Unknown: Invalid system flag in Store command (errflg=2) in Unknown on line 0<br />
<br />
This Error occurs if u want to set a flag 2 times. Just check ur manually flag Settings.<br />
<br />
Cheers,<br />
Nohado</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99596""></a>
  <div class="note">
   <strong class="user">anthony2009 at ns dot sympatico dot ca</strong>
   <a href="#99596" class="date">25-Aug-2010 09:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment">// You can break out the variables for $mailserver, $port, $user and
<br />
// $pass without passing brackets into functions this way. Be sure to use
<br />
// the dots to append connection strings, ie "stuff". $variable ."STUFF"
<br />
// otherwise will go to imap_open with wrong variable type. :)
<br />

<br />
</span><span class="default">$mailserver</span><span class="keyword">=</span><span class="string">"mail.example.com"</span><span class="keyword">;
<br />
</span><span class="default">$port</span><span class="keyword">=</span><span class="string">"110/pop3"</span><span class="keyword">;
<br />
</span><span class="default">$user</span><span class="keyword">=</span><span class="string">"aj"</span><span class="keyword">;
<br />
</span><span class="default">$pass</span><span class="keyword">=</span><span class="string">"remax01"</span><span class="keyword">;
<br />
&nbsp; 
<br />
if (</span><span class="default">$mbox</span><span class="keyword">=</span><span class="default">imap_open</span><span class="keyword">( </span><span class="string">"{" </span><span class="keyword">. </span><span class="default">$mailserver </span><span class="keyword">. </span><span class="string">":" </span><span class="keyword">. </span><span class="default">$port </span><span class="keyword">. </span><span class="string">"}INBOX"</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass </span><span class="keyword">))
<br />
&nbsp;{&nbsp; echo </span><span class="string">"Connected\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$check </span><span class="keyword">= </span><span class="default">imap_mailboxmsginfo</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Date: "&nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="default">$check</span><span class="keyword">-&gt;</span><span class="default">Date&nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;\n" </span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Driver: "&nbsp;&nbsp; </span><span class="keyword">. </span><span class="default">$check</span><span class="keyword">-&gt;</span><span class="default">Driver&nbsp; </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;\n" </span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Unread: "&nbsp;&nbsp; </span><span class="keyword">. </span><span class="default">$check</span><span class="keyword">-&gt;</span><span class="default">Unread&nbsp; </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;\n" </span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Size: "&nbsp; &nbsp;&nbsp; </span><span class="keyword">. </span><span class="default">$check</span><span class="keyword">-&gt;</span><span class="default">Size&nbsp; &nbsp; </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;\n" </span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">);
<br />
&nbsp;} else { exit (</span><span class="string">"Can't connect: " </span><span class="keyword">. </span><span class="default">imap_last_error</span><span class="keyword">() .</span><span class="string">"\n"</span><span class="keyword">);&nbsp; echo </span><span class="string">"FAIL!\n"</span><span class="keyword">;&nbsp; };
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96509""></a>
  <div class="note">
   <strong class="user">oz49erfan</strong>
   <a href="#96509" class="date">03-Mar-2010 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Make sure your PHP is enabled with imap via the phpinfo() function<br />
<br />
'--with-imap-dir=/opt/lampp' '--with-imap-ssl' '--with-imap=/opt/lampp'<br />
<br />
and <br />
<br />
IMAP c-Client Version 2007e<br />
SSL Support Yes<br />
<br />
I noticed that my apache script was working but my cli script was not. Turns out my php cli executable didn't have imap setup so I had to use another php cli executable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95959""></a>
  <div class="note">
   <strong class="user">kay at rrr dot de</strong>
   <a href="#95959" class="date">31-Jan-2010 05:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
imap_open is very simple to use, but struggles a litte bit on setups with ssl and tls.<br />
<br />
this are tested examples for different hosts and protocols.<br />
<br />
uncomment the host/protocol line and fill in correct username and password.<br />
<br />
Kay<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">#######<br />
# localhost pop3 with and without ssl<br />
# $authhost="{localhost:995/pop3/ssl/novalidate-cert}";<br />
# $authhost="{localhost:110/pop3/notls}";<br />
<br />
# localhost imap with and without ssl<br />
# $authhost="{localhost:993/imap/ssl/novalidate-cert}";<br />
# $authhost="{localhost:143/imap/notls}";<br />
# $user="localuser";<br />
<br />
# localhost nntp with and without ssl<br />
# you have to specify an existing group, control.cancel should exist<br />
# $authhost="{localhost:563/nntp/ssl/novalidate-cert}control.cancel";<br />
# $authhost="{localhost:119/nntp/notls}control.cancel";<br />
<br />
######<br />
# web.de pop3 without ssl<br />
# $authhost="{pop3.web.de:110/pop3/notls}";<br />
# $user="kay.marquardt@web.de";<br />
<br />
#########<br />
# goggle with pop3 or imap<br />
# $authhost="{pop.gmail.com:995/pop3/ssl/novalidate-cert}";<br />
# $authhost="{imap.gmail.com:993/imap/ssl/novalidate-cert}";<br />
# $user="username@gmail.com";<br />
<br />
</span><span class="default">$user</span><span class="keyword">=</span><span class="string">"username like above"</span><span class="keyword">;<br />
</span><span class="default">$pass</span><span class="keyword">=</span><span class="string">"yourpass"</span><span class="keyword">;<br />
<br />
if (</span><span class="default">$mbox</span><span class="keyword">=</span><span class="default">imap_open</span><span class="keyword">( </span><span class="default">$authhost</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass </span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"&lt;h1&gt;Connected&lt;/h1&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$mbox</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; echo </span><span class="string">"&lt;h1&gt;FAIL!&lt;/h1&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91996""></a>
  <div class="note">
   <strong class="user">mightycpa</strong>
   <a href="#91996" class="date">04-Jul-2009 07:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My script kept on timing out, even though the syntax was spot on... ultimately, I figured out that the port was blocked by my webhost, where I ran this on a shared server...<br />
<br />
I post this just in case you miss this obvious, like I did.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82789""></a>
  <div class="note">
   <strong class="user">Jason Pires</strong>
   <a href="#82789" class="date">25-Apr-2008 07:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Dears.<br />
In my case, e-mail host was the IMAP enabled.<br />
So, just use the imap_open as the very simple form like:<br />
<br />
$mailbox = "{mail.myhost.com:143/notls}INBOX";<br />
$user = "me@myhost.com"; <br />
$pass = "mypassword"; <br />
<br />
$connection = imap_open($mailbox,$user,$pass) or die(imap_last_error()."&lt;br&gt;Connection Faliure!");<br />
<br />
thanks!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82466""></a>
  <div class="note">
   <strong class="user">Binit</strong>
   <a href="#82466" class="date">11-Apr-2008 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was trying imap_open() function but I was continuously getting this error:<br />
<br />
Array ( [0] =&gt; [CLOSED] IMAP connection broken (server response) )<br />
<br />
I was finally able to solve this problem (which is a very common problem as I saw it on the net but could not find any solution to it) so I'm posting my solution here which I hope will be useful to others.<br />
<br />
I used stunnel program (<a href="http://www.stunnel.org/" rel="nofollow" target="_blank">http://www.stunnel.org/</a>) and made changes in the stunnel.conf file as follows:<br />
<br />
I added these lines:<br />
[imapsClient]<br />
accept = localhost:143<br />
connect&nbsp; = imapserver:993<br />
client = yes<br />
sslVersion = TLSv1<br />
<br />
This will map insecure imap connection from localhost:143 to imapserver:993 (IMAP with SSL).<br />
<br />
After this I tried this code and it worked fine:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$user</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br />
</span><span class="default">$pass</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br />
</span><span class="default">$imap </span><span class="keyword">= @</span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">"{localhost:143}INBOX"</span><span class="keyword">, </span><span class="default">$user</span><span class="keyword">, </span><span class="default">$pass</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
and I was able to do away with the errors.<br />
<br />
A more detailed post about it can be found here:<br />
<a href="http://www.phpfreaks.com/forums/index.php/topic,190628.0.html" rel="nofollow" target="_blank">http://www.phpfreaks.com/forums/index.php/topic,190628.0.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78889""></a>
  <div class="note">
   <strong class="user">itstooloud</strong>
   <a href="#78889" class="date">31-Oct-2007 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Works with Gmail's new IMAP function for personal and for Google Apps.<br />
<br />
$mbox = imap_open ("{imap.gmail.com:993/imap/ssl}INBOX", "username@gmail.com", "password")<br />
&nbsp;&nbsp; &nbsp; or die("can't connect: " . imap_last_error());</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78097""></a>
  <div class="note">
   <strong class="user">askalski at synacor dot com</strong>
   <a href="#78097" class="date">27-Sep-2007 05:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
By default, imap_open() will retry an incorrect password 3 times before giving up.&nbsp; This is a feature built into the c-client library intended for interactive mail clients (which can prompt the end user for a new username/password combo.)<br />
<br />
The new optional parameter "$n_retries" allows PHP to override the default retry limit.&nbsp; There is absolutely no reason to leave this at default, or to set it to any value other than 1.&nbsp; This is especially important if the mail server you're using locks users out after too many login failures.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77685""></a>
  <div class="note">
   <strong class="user">bow+php dot net at virtual-habitat dot net</strong>
   <a href="#77685" class="date">08-Sep-2007 05:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Setting a mailbox name (eg INBOX) at the end of the connection string does not work when using imap_open() with OP_HALFOPEN. You may use imap_reopen() then.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/* this will fail : */<br />
</span><span class="default">$connection </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">'{mx.example.net}INBOX'</span><span class="keyword">, </span><span class="string">'foo'</span><span class="keyword">, </span><span class="string">'secret'</span><span class="keyword">, </span><span class="default">OP_HALFOPEN</span><span class="keyword">.);<br />
</span><span class="default">$num_mgs </span><span class="keyword">= </span><span class="default">imap_num_msg</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">);<br />
</span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">);<br />
<br />
</span><span class="comment">/* this will do : */<br />
</span><span class="default">$connection </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="string">'{mx.example.net}INBOX'</span><span class="keyword">, </span><span class="string">'foo'</span><span class="keyword">, </span><span class="string">'secret'</span><span class="keyword">, </span><span class="default">OP_HALFOPEN</span><span class="keyword">.);<br />
</span><span class="default">imap_reopen</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">, </span><span class="string">'{mx.example.net}INBOX'</span><span class="keyword">);<br />
</span><span class="default">$num_mgs </span><span class="keyword">= </span><span class="default">imap_num_msg</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">);<br />
</span><span class="default">imap_close</span><span class="keyword">(</span><span class="default">$connection</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75075""></a>
  <div class="note">
   <strong class="user">gyokimae</strong>
   <a href="#75075" class="date">11-May-2007 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beginning with 5.2.2, binaries built for Windows also seem to have changed its default behavior.<br />
'/notls' needs to be specified for a non-SSL connection.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73514""></a>
  <div class="note">
   <strong class="user">Fladnag</strong>
   <a href="#73514" class="date">27-Feb-2007 10:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you can avoid this message :<br />
<br />
Warning: (null)(); Mailbox is empty (errflg=1) in Unknown on line 0<br />
<br />
by specified the option OP_SILENT to imap_open.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69577""></a>
  <div class="note">
   <strong class="user">Amit</strong>
   <a href="#69577" class="date">11-Sep-2006 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
None of the above comments explain the configuration issues on Apache/Windows combination. I thought it might be helpful to list my findings here so that Windows people's time is saved.<br />
<br />
There is a bug in Windows php_imap.dll that prevents it from connecting it to the SSL IMAP/POP3 server.<br />
<br />
<a href="http://bugs.php.net/bug.php?id=36496&amp;edit=1" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=36496&amp;edit=1</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63966""></a>
  <div class="note">
   <strong class="user">shaikh_zaid at yahoo dot com</strong>
   <a href="#63966" class="date">04-Apr-2006 08:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
imap_open will not open a stream if your server operates with Transport Layer Security (i.e. TLS) imap_open connects with SSL if its there. So try opening mailbox as <br />
<br />
$mailbox="{mail.domain.com:143/imap/notls}"; <br />
or<br />
$mailbox="{mail.domain.com:110/pop3/notls}"; This works...<br />
<br />
Some mail server requires you to provide username@domain.com so you can always use. user@doamin.com<br />
<br />
$conn=imap_open($mailbox, $username, $password);<br />
<br />
Some server may ask for username as "user=user@domain.com"<br />
<br />
:)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59528""></a>
  <div class="note">
   <strong class="user">admin at sellchain dot com</strong>
   <a href="#59528" class="date">09-Dec-2005 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Looking for a cool PHP Script to help you connect to a POP3 server, and download E-Mail to MySQL? Check out my neet-skeet script I wrote. Have fun.<br />
<br />
Http://www.sellchain.com/phPOP3/phPOP3.txt<br />
<br />
Download the above TXT file, and rename it to phPOP3.php.<br />
<br />
Trust me, you will learn mostly everything about IMAP with this script.<br />
<br />
By the way, be sure to use print_r($headers) to discover the headers that come with each message. You can setup your MySQL + Email Account information at the top of the script. No includes required!<br />
<br />
Enjoyz;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55417""></a>
  <div class="note">
   
   <a href="#55417" class="date">03-Aug-2005 04:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
WHen you use the /ssl connection...&nbsp; half open doesnt work...!<br />
<br />
what i did was opened it up with the .com:143/pop3}, op_halfopen<br />
<br />
when i was getting my folders...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52780""></a>
  <div class="note">
   <strong class="user">avizion at relay dot dk</strong>
   <a href="#52780" class="date">12-May-2005 12:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For FreeBSD users...<br />
<br />
If you want to have SSL support, you want to install the ports:<br />
<br />
mail/php5-imap<br />
security/php5-openssl<br />
<br />
Cheers :)<br />
<br />
&nbsp;- avizion</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52315""></a>
  <div class="note">
   <strong class="user">m dot stoel at cyberkinetic dot nl</strong>
   <a href="#52315" class="date">27-Apr-2005 07:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a little tip for those who get really frustrated even after reading all the right solutions and implementing them but still get the same errors or none at all..:<br />
after having changed the code.. restart the httpd deamon..<br />
<br />
for Fedora or any other Red Hat Linux OS (/etc/init.d/httpd restart).<br />
<br />
After this you will be able to make a imap/pop3 stream from apache..</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50375""></a>
  <div class="note">
   <strong class="user">thushara dot perera at unilink dot lk</strong>
   <a href="#50375" class="date">26-Feb-2005 06:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: imap_open() [function.imap-open]: Couldn't open stream {xx.xx.x.xxx:143}INBOX <br />
<br />
correct the connection string as :<br />
{xx.xx.x.xxx:143/notls}INBOX</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50340""></a>
  <div class="note">
   <strong class="user">info at infosoporte.com</strong>
   <a href="#50340" class="date">25-Feb-2005 03:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I can connect to my email server with no problem using regular usernames and passwords but.... in my server the usernames are long.. like name.surname1.surname2@subdomain.domain.com , and i get an error when the username size is over 40 chars:<br />
<br />
$conn = imap_open("{". $server . ":110/pop3}", $username, $user_password) or die ("Failed with error: ".imap_last_error());<br />
<br />
returns<br />
<br />
Too many login failures<br />
<br />
when the username is over 40 chars. Just remember that if you plan to use long usernames.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48159""></a>
  <div class="note">
   <strong class="user">elizar.palad</strong>
   <a href="#48159" class="date">14-Dec-2004 07:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
thanks to the one who added that the login part should be the whole email address for it to work.. (assuming of course that all other stuff is good and working ;)<br />
<br />
to add something, in the 'email address' login name, is not really the email address, ,it's the pop login name plus '@' plus the domain.. hope it's not confusing... <br />
<br />
poploginname@domain.com<br />
<br />
not<br />
<br />
emailaddress@domain.com..</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48144""></a>
  <div class="note">
   <strong class="user">gasaunde at vcu dot edu</strong>
   <a href="#48144" class="date">13-Dec-2004 08:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found that on my servers I _must_ use imap_errors() and imap_alerts() after an imap_open or this error is thrown in the logs when the mailbox is empty: [error] PHP Warning: (null)(); Mailbox is empty (errflg=1) in Unknown on line 0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43667""></a>
  <div class="note">
   <strong class="user">liamr at umich dot edu</strong>
   <a href="#43667" class="date">30-Jun-2004 01:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To authenticate using kerberos V / GSSAPI, you might need to add "user=" to the connection string.. eg:<br />
<br />
$mbox = imap_open( "\{imap.example.com:143/imap/notls/user=" . $user . "}INBOX", $user, $passwd );<br />
<br />
Our IMAP servers won't allow a user other than the user specified in the kerberos credentials connect using those credentials unless you specify that extra "user=" in the connection string.&nbsp; Passing it as an argument to imap_open() doesn't seem to be enough.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43469""></a>
  <div class="note">
   <strong class="user">nmmm at nmmm dot nu</strong>
   <a href="#43469" class="date">22-Jun-2004 07:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To open local mailbox ( mbox ) enter its absolute file name.<br />
<br />
&gt;an absolute filename <br />
&gt;This specifies a mailbox in the default format (usually &gt;Berkeley format for most default library builds) <br />
<br />
source:<br />
<a href="http://aspn.activestate.com/ASPN/CodeDoc/Mail-Cclient/Cclient.html" rel="nofollow" target="_blank">http://aspn.activestate.com/ASPN/CodeDoc/Mail-Cclient/Cclient.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38985""></a>
  <div class="note">
   <strong class="user">rvarkelen AT hortimax.nl</strong>
   <a href="#38985" class="date">14-Jan-2004 12:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to make a IMAP connection to a Microsoft Exchange Server 5.5, I used this connection-string :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(</span><span class="default">imap_open </span><span class="keyword">(</span><span class="string">"{192.168.1.6:143/imap}Inbox"</span><span class="keyword">, </span><span class="string">"DOMAIN/USERNAME/ALIAS"</span><span class="keyword">, </span><span class="string">"PASSWORD"</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Connection success!'</span><span class="keyword">;<br />
}<br />
else<br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Connection failed'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
By replacing "Inbox" with, e.g. "Tasks", its possible to see all your tasks. I Hope this helps anybody!<br />
<br />
Regards</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37104""></a>
  <div class="note">
   <strong class="user">marshall /AT\ pacdemon.org</strong>
   <a href="#37104" class="date">03-Nov-2003 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks for all your comments.&nbsp; The user comments have saved me countless times.<br />
<br />
I'd like to give back in my small way by providing this little tip.&nbsp; To test your pop or imap services you can use telnet (almost all operating systems should come with a command line telnet client).<br />
<br />
Here's the pop3 example (the lines that start with + are the server's response):<br />
<br />
&nbsp;&nbsp;&nbsp; telnet your.pop.host.com 110<br />
&nbsp;&nbsp;&nbsp; +OK POP3 your.pop.host.com v2001.78 server ready<br />
&nbsp;&nbsp;&nbsp; user your_username<br />
&nbsp;&nbsp;&nbsp; +OK User name accepted, password please<br />
&nbsp;&nbsp;&nbsp; pass your_password<br />
&nbsp;&nbsp;&nbsp; +OK Mailbox open, 23 messages<br />
<br />
Note that your pop server may be on some other port than 110 but that is the default/standard.<br />
<br />
Here's the imap example (Lines that have OK near the begining are server responses):<br />
<br />
&nbsp;&nbsp;&nbsp; telnet your.imap.host.com 143<br />
&nbsp;&nbsp;&nbsp; * OK [CAPABILITY IMAP4REV1...]<br />
&nbsp;&nbsp;&nbsp; 1 LOGIN "your_username" "your_password"<br />
&nbsp;&nbsp;&nbsp; 1 OK [CAPABILITY...] ... User your_username authenticated<br />
<br />
This might be old news to some people but I hope it's helpful for many.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35074""></a>
  <div class="note">
   <strong class="user">marshall /at/ sprux net</strong>
   <a href="#35074" class="date">19-Aug-2003 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I only run imap on port 993 (ssl only) and I was unable to use imap_open().. couldn't even get an error out of the script, it just sat there and timed out with no messages in the logs or anything--the page wouldn't load.<br />
<br />
Anyway, this is what finally worked, which I found in the readme for a popular opensource webmail system:<br />
<br />
$i = @imap_open("{localhost:993/ssl/novalidate-cert}INBOX", $user, $pw);<br />
<br />
I didn't see the 'ssl' option mentioned anywhere in these comments so maybe this will help someone out.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33042""></a>
  <div class="note">
   <strong class="user">Kyle Putnam</strong>
   <a href="#33042" class="date">15-Jun-2003 01:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was getting bizzare errors that I couldn't find documentation about anywhere on Google. I tried connecting to another server and got different, but just as unusual error messages. I even checked the POP3 server logs and it said something about invalid command... I figured it was another libc problem.<br />
<br />
Stupidly enough, the problem was that I was using an unset variable for the password! Make sure you don't have an empty username or password... you'll have a hard time debugging the problem ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31920""></a>
  <div class="note">
   <strong class="user">stefan dot greifeneder at dioezese-linz dot at</strong>
   <a href="#31920" class="date">09-May-2003 03:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Had problems to use imap_open with iMail 6.06 Server. My problem was (sounds stupid): Didn't realise that the username had to be the full email address and not just the login. Maybe this helps some people.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31497""></a>
  <div class="note">
   <strong class="user">bill dot mccoy at pictureiq dot com</strong>
   <a href="#31497" class="date">24-Apr-2003 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"notls" seems to be required for PHP on RedHat 8.0, but it seems that "/norsh" is also advisable; without it, the client library will attempt an RSH connection and wait for this to timeout before reverting to normal IMAP. This was causing a 15 second delay in imap_open for me. Looking at the client lib C code this will likely be an issue on other platforms as well as they update to the newer version. You can use both "/notls" and "/norsh", e.g. the first parameter to imap_open can be something like: "{your.imap.host/imap/notls/norsh}".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31056""></a>
  <div class="note">
   <strong class="user">kaper at nexgc dot com</strong>
   <a href="#31056" class="date">08-Apr-2003 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had been having lots of trouble trying to get imap_open to connect to an imap server.&nbsp; Then I found another post online that suggested this and it worked, so I am going to post it here.&nbsp; I hope this helps others..<br />
<br />
"I have tried with the following strings instead and it works: <br />
<br />
for pop3: {www.server.com:110/pop3/notls}INBOX <br />
<br />
and for imap: {www.server.com:143/notls}INBOX.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30885""></a>
  <div class="note">
   <strong class="user">xore at hotmail dot com</strong>
   <a href="#30885" class="date">02-Apr-2003 01:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
pop3 seems to like refusing connection if you have OP_READONLY set<br />
<br />
testers: be forewarned :P</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29881""></a>
  <div class="note">
   <strong class="user">madsiuk at morellos dot net</strong>
   <a href="#29881" class="date">27-Feb-2003 04:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
hi<br />
&nbsp; Note for all having problems to connect hosts using imap_open:<br />
<br />
&nbsp; I spent almost week trying to fix my script which was connecting to localhost but was unable to connect any other host. Sollution was actually wery simple but I'm writing that note becouse there are some posts at usenet or forums decribing similiar problems. And actually I haven't found any&nbsp; answer for that. So for all of you trying to connect to hosts with imap_open CHECK IF THERE IS NO FIREWALL BLOCKING POP3. <br />
<br />
madsiuk</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28307""></a>
  <div class="note">
   <strong class="user">russell at flora dot ca</strong>
   <a href="#28307" class="date">09-Jan-2003 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note about "PHP Warning:&nbsp; Certificate failure"<br />
<br />
I'm not sure if this is a RedHat, PHP, or IMAP library issue, but the default for SSL seems to have changed.<br />
<br />
You now need to specify "/notls" when you don't want TLS, rather than only needing to specify "/ssl" when you do.<br />
<br />
Example:&nbsp; <br />
<br />
"{localhost:143}INBOX"<br />
<br />
becomes:<br />
<br />
"{localhost:143/notls}INBOX"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22410""></a>
  <div class="note">
   <strong class="user">jpdalbec at ccNO dot ysuSPAM dot edu</strong>
   <a href="#22410" class="date">17-Jun-2002 08:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I ran into the <br />
PHP Warning:&nbsp; Certificate failure for &lt;server&gt;: self signed certificate:<br />
message while upgrading 4.0.6-&gt;4.1.2.&nbsp; I'm pleased to report that {&lt;server&gt;:&lt;port&gt;/imap/tls/novalidate-cert}&lt;mailbox&gt;<br />
works as expected (and fixes my problem).&nbsp; I'm using IMP 2.2.8.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22068""></a>
  <div class="note">
   <strong class="user">fxbois at free dot fr</strong>
   <a href="#22068" class="date">05-Jun-2002 08:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
I just want to say to all redhat people who have problem (Couldn't open stream) with the connection on the local pop server to use this :<br />
{127.0.0.1:110/pop3/notls}INBOX<br />
hope this help</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20824""></a>
  <div class="note">
   <strong class="user">frederik at roal dot no</strong>
   <a href="#20824" class="date">17-Apr-2002 06:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For all imap functions where you specify the mailbox string it is important that you ALWAYS use IP (not hostname) and the portnumber. If you do not do this imap functions will be painfully slow.<br />
Using hostname instead of IP adds 3 seconds to each IMAP call, not using portnumber adds 10 seconds to each imap call. (hint: use gethostbyname() )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="16441""></a>
  <div class="note">
   <strong class="user">brojann at netscape dot com</strong>
   <a href="#16441" class="date">30-Oct-2001 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can do
<br />

<br />
&lt;? $foo = imap_errors(); ?&gt;
<br />

<br />
to clear unwanted warning messages like 'Mailbox is empty'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14758""></a>
  <div class="note">
   <strong class="user">jdg11 at po dot cwru dot edu</strong>
   <a href="#14758" class="date">14-Aug-2001 12:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It would be nice to mention that this function does send headers. It makes sense, but it is not obvious. It took me a while to figure it out. I authenticate against a POP3 server, and set a cookie if the authentication validates. At least I wanted to :) But since it sends a header to the server, setcookie() won't work.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13648""></a>
  <div class="note">
   <strong class="user">curtis at lamere dot net</strong>
   <a href="#13648" class="date">27-Jun-2001 01:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have found that the syntax for the imap_open command in PHP 4 differs whether you're passing a variable to the imap_open function or declaring the host directly within the function.&nbsp; If you are passing variables to the imap_open function, the syntax should look like:
<br />

<br />
$username = "user";
<br />
$password = "password";
<br />
$mailserver = "mail.somedomina.com:110/imap";
<br />

<br />
$link = imap_open("\{$mailserver}INBOX",$username,$password);
<br />

<br />
If you don't include the leading backslash (\) you will not open the stream.&nbsp; Likewise you cannot pass the curly braces to the function.
<br />

<br />
If you define the server directly, omit the leading backslash.
<br />

<br />
$username = "user";
<br />
$password = "password";
<br />

<br />
$link = imap_open("{mail.somedomain.com:110/pop3}",$username,$password)"
<br />

<br />
I discovered all of this after 3 days of trying to get all of this work on redhat 7.1.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13039""></a>
  <div class="note">
   
   <a href="#13039" class="date">23-May-2001 07:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A better way to connect to a mail server would be to use uri syntax, for example:
<br />

<br />
imap://username:password@server.com:143/INBOX/message/part
<br />

<br />
this is very easy to parse using 'parse_url()'
<br />

<br />
Remember to keep your username and password hidden if your over an open network</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="12201""></a>
  <div class="note">
   <strong class="user">fferreres at joydivision dot com dot ar</strong>
   <a href="#12201" class="date">29-Mar-2001 04:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IMAP, POP and NNTP are ok. But plaintext mailboxes are unmentioned here. You just forget the {part} and go for the file (tested on unix): 
<br />

<br />
$mbox = imap_open ($a_mail_box_file_name_in_home_dir, "", "") || die("Snif...:
<br />
".imap_last_error());</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="11852""></a>
  <div class="note">
   <strong class="user">kvance at n-link dot net</strong>
   <a href="#11852" class="date">09-Mar-2001 10:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Connections to the IMAP server work without specifying the port number, but they are slow, so specifying the port number is important if you don't want a slow application.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="9968""></a>
  <div class="note">
   <strong class="user">bandpay at hotmail dot com</strong>
   <a href="#9968" class="date">04-Dec-2000 09:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have a single comment to add about imap_open.
<br />
If you want to connect to a news server, without specifying any news gruop, you can use the following:
<br />

<br />
<span class="default">&lt;?php
<br />
$server </span><span class="keyword">= </span><span class="string">"{news.servername.com/nntp:119}"</span><span class="keyword">;
<br />
</span><span class="default">$nntp </span><span class="keyword">= </span><span class="default">imap_open</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">OP_HALFOPEN</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
and $nntp will become the connection ID.
<br />

<br />
Regards 
<br />
//Babak</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
