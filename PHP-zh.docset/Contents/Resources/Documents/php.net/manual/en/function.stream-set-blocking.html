<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>为资源流设置阻塞或者阻塞模式</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.stream-select.html">? stream_select</a></li>
      <li style="float: right;"><a href="function.stream-set-chunk-size.html">stream_set_chunk_size ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.stream.html">Stream 函数</a></li>
    <li>为资源流设置阻塞或者阻塞模式</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.stream-set-blocking" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stream_set_blocking</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">stream_set_blocking</span> &mdash; <span class="dc-title">为资源流设置阻塞或者阻塞模式</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.stream-set-blocking-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>stream_set_blocking</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$stream</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code></span>
   )</div>

  <p class="para rdfs-comment">
   为 <code class="parameter">stream</code> 设置阻塞或者阻塞模。
  </p>
  <p class="para">
   此函数适用于支持非阻塞模式的任何资源流（常规文件，套接字资源流等）。 
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.stream-set-blocking-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">stream</code></dt>

     <dd>

      <p class="para">
       资源流。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">
       如果 <code class="parameter">mode</code> 为0，资源流将会被转换为非阻塞模式；如果是1，资源流将会被转换为阻塞模式。
       该参数的设置将会影响到像 <span class="function"><a href="function.fgets.html" class="function">fgets()</a></span> 和 <span class="function"><a href="function.fread.html" class="function">fread()</a></span> 这样的函数从资源流里读取数据。
       在非阻塞模式下，调用 <span class="function"><a href="function.fgets.html" class="function">fgets()</a></span> 总是会立即返回；而在阻塞模式下，将会一直等到从资源流里面获取到数据才能返回。 
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.stream-set-blocking-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>， 或者在失败时返回 <strong><code>FALSE</code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.stream-set-blocking-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>4.3.0</td>
       <td>
        在PHP 4.3.0之前，该函数只支持套接字资源流。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.stream-set-blocking-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    该函数之前叫作 <span class="function"><a href="function.set-socket-blocking.html" class="function">set_socket_blocking()</a></span> 后来又叫做 <span class="function"><a href="function.socket-set-blocking.html" class="function">socket_set_blocking()</a></span> ，但是这种用法都已经被废弃。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.stream-set-blocking-seealso">
  <h3 class="title">参见</h3>
  <ul class="simplelist">
   <li class="member"><span class="function"><a href="function.stream-select.html" class="function" rel="rdfs-seeAlso">stream_select()</a> - Runs the equivalent of the select() system call on the given
   arrays of streams with a timeout specified by tv_sec and tv_usec</span></li>
  </ul>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="110997""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#110997" class="date">04-Jan-2013 04:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Windows this function does not work with pipes opened with proc_open (https://bugs.php.net/bug.php?id=47918, https://bugs.php.net/bug.php?id=34972, https://bugs.php.net/bug.php?id=51800)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69505""></a>
  <div class="note">
   <strong class="user">MagicalTux at ookoo dot org</strong>
   <a href="#69505" class="date">08-Sep-2006 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you use fwrite() on a non-blocking stream, data isn't discarded silently as t dot starling said.<br />
<br />
Remember that fwrite() returns an int, and this int represents the amount of data really written to the stream. So, if you see that fwrite() returns less than the amount of written data, it means you'll have to call fwrite() again in the future to write the remaining amount of data.<br />
<br />
You can use stream_select() to wait for the stream to be available for writing, then continue writing data to the stream.<br />
<br />
Non-blocking streams are useful as you can have more than one non-blocking stream, and wait for them to be available for writing.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
