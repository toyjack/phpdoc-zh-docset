<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>把 ImagickDraw 对象渲染到当前图片上</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imagick.distortimage.html">? Imagick::distortImage</a></li>
      <li style="float: right;"><a href="imagick.edgeimage.html">Imagick::edgeImage ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.imagick.html">Imagick</a></li>
    <li>把 ImagickDraw 对象渲染到当前图片上</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imagick.drawimage" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Imagick::drawImage</h1>
  <p class="verinfo">(PECL imagick 2.0.0)</p><p class="refpurpose"><span class="refname">Imagick::drawImage</span> &mdash; <span class="dc-title">把 ImagickDraw 对象渲染到当前图片上</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-imagick.drawimage-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>Imagick::drawImage</strong></span>
    ( <span class="methodparam"><span class="type"><a href="class.imagickdraw.html" class="type ImagickDraw">ImagickDraw</a></span> <code class="parameter">$draw</code></span>
   )</div>

  <p class="para rdfs-comment">
      把 ImagickDraw 对象渲染到当前图片上。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-imagick.drawimage-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">draw</code></dt>

     <dd>

      <p class="para">
      被渲染到图片上的 ImagickDraw 对象（在经过各种绘画操作之后的 ImagickDraw 对象）
      </p>
     </dd>

    
   </dl>

  </p>

 </div>

 <div class="refsect1 returnvalues" id="refsect1-imagick.drawimage-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>。
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="93116""></a>
  <div class="note">
   <strong class="user">blah at blub dot com</strong>
   <a href="#93116" class="date">24-Aug-2009 03:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your imagick lib begins to say: "Non-conforming drawing primitive...", it could be that your locale are not correctly set. please locate all your setlocale and kill them temporary so you could check it that would solve the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86035""></a>
  <div class="note">
   <strong class="user">sualk at lednew dot de</strong>
   <a href="#86035" class="date">30-Sep-2008 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
the ImagickDraw (v 2.2.0) seems to disharmonise with PHP-GTK2 (v 2.0.1).
<br />

<br />
The rendering of an ImagickDraw object on the current image fails (resp. results in a flat image without drawings), if php_gtk2.so is loaded.
<br />

<br />
Code to reproduce the failure:
<br />

<br />
#!/usr/bin/php5
<br />
<span class="default">&lt;?php
<br />
dl</span><span class="keyword">(</span><span class="string">"php_gtk2.so"</span><span class="keyword">); </span><span class="comment">// comment this for a second try
<br />

<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="string">"Hello world!"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$im </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">();
<br />
</span><span class="default">$draw </span><span class="keyword">= new </span><span class="default">ImagickDraw</span><span class="keyword">();
<br />

<br />
</span><span class="default">$draw</span><span class="keyword">-&gt;</span><span class="default">setFillColor</span><span class="keyword">(new </span><span class="default">ImagickPixel</span><span class="keyword">(</span><span class="string">'blue'</span><span class="keyword">));
<br />

<br />
</span><span class="default">$draw</span><span class="keyword">-&gt;</span><span class="default">setFontSize</span><span class="keyword">(</span><span class="default">28</span><span class="keyword">);
<br />

<br />
</span><span class="default">$metrix </span><span class="keyword">= </span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">queryFontMetrics</span><span class="keyword">(</span><span class="default">$draw</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);
<br />

<br />
</span><span class="default">$draw</span><span class="keyword">-&gt;</span><span class="default">annotation</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">25</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">);
<br />

<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">newImage</span><span class="keyword">(</span><span class="default">$metrix</span><span class="keyword">[</span><span class="string">'textWidth'</span><span class="keyword">],</span><span class="default">$metrix</span><span class="keyword">[</span><span class="string">'textHeight'</span><span class="keyword">], new </span><span class="default">ImagickPixel</span><span class="keyword">(</span><span class="string">'white'</span><span class="keyword">));
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">drawImage</span><span class="keyword">(</span><span class="default">$draw</span><span class="keyword">);
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">borderImage</span><span class="keyword">(new </span><span class="default">ImagickPixel</span><span class="keyword">(</span><span class="string">'black'</span><span class="keyword">), </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageFormat</span><span class="keyword">(</span><span class="string">'png'</span><span class="keyword">);
<br />

<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">writeImage</span><span class="keyword">(</span><span class="string">"./test.png"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
