<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>针对 Solaris 的安装提示</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.unix.openbsd.html">? 在 OpenBSD 系统下的安装</a></li>
      <li style="float: right;"><a href="install.unix.debian.html">Debian GNU/Linux 安装说明 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.unix.html">Unix 系统下的安装</a></li>
    <li>针对 Solaris 的安装提示</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.unix.solaris" class="sect1">
 <h2 class="title">针对 <span class="productname">Solaris</span> 的安装提示</h2>
 <p class="para">
  本节包含了在 <span class="productname">Solaris</span> 系统上安装 PHP 的说明和提示。
 </p>
 
 <div class="sect2" id="install.solaris.required">
  <h3 class="title">需要的软件</h3>
  <p class="para">
   默认安装的 <span class="productname">Solaris</span> 系统经常缺少 C
   语言编译器和其相关工具。部分工具必须使用该工具的
   GNU 版本，原因请阅读 <a href="faq.build.html#faq.installation.needgnu" class="link">FAQ</a>。
  </p>
  <p class="para">
   要解压缩 PHP 发行包，需要：
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      tar
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      gzip 或
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      bzip2
     </span>
    </li>
   </ul>
  </p>
  <p class="para">
   要编译 PHP，需要：
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      gcc（推荐使用，其它 C 编译器也许也能用）
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      make
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      GNU sed
     </span>
    </li>
   </ul>
  </p>
  <p class="para">
   要编译更多扩展库或自行开发 PHP 代码，可能还需要：
   <ul class="itemizedlist">
    <li class="listitem">
     <span class="simpara">
      flex（直到 PHP 5.2）
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      re2c
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      bison
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      m4
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      autoconf
     </span>
    </li>
    <li class="listitem">
     <span class="simpara">
      automake
     </span>
    </li>
   </ul>
   此外，还需要安装（甚至编译）针对自己的配置所需的软件，例如
   Oracle 或 MySQL。
  </p>     
 </div>
 
 <div class="sect2" id="install.solaris.packages">
  <h3 class="title">使用软件包</h3>
  <p class="simpara">
   可以使用 pkgadd 来安装大部分需要的软件来简化
   <span class="productname">Solaris</span> 安装过程。<span class="productname">Solaris
   11 Express</span> 下的映像打包系统（Image
   Packaging System，IPS）也包含了大多数安装所需的部件，通过
   pkg 命令。
  </p>
 </div>
 
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104499""></a>
  <div class="note">
   <strong class="user">ariedederde</strong>
   <a href="#104499" class="date">18-Jun-2011 09:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Install php on solaris express:<br />
<br />
pkg search php<br />
part of output is e.g.<br />
<br />
pkg:/web/php-52@5.2.12-0.151.0.1<br />
<br />
pkg install php-52<br />
<br />
php binary installs in /usr/php/5.2/bin/php</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72016""></a>
  <div class="note">
   <strong class="user">julie at baumler dot com</strong>
   <a href="#72016" class="date">29-Dec-2006 06:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There's a great how-to for Solaris 10 from Mel Lester Jr at <a href="http://meljr.com/~meljr/AMPSolaris10.html." rel="nofollow" target="_blank">http://meljr.com/~meljr/AMPSolaris10.html.</a><br />
<br />
It even shows how to install php in a global zone and configure it in your other zones.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70188""></a>
  <div class="note">
   <strong class="user">francois at tekwire dot net</strong>
   <a href="#70188" class="date">06-Oct-2006 10:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A detailed HOWTO document describing how to build Apache &amp; PHP on Solaris is available at <a href="http://www.tekwire.net/redir.php/build_apa_php" rel="nofollow" target="_blank">http://www.tekwire.net/redir.php/build_apa_php</a><br />
<br />
This document also explains how to build from scratch every piece of software they can depend on, including almost every Apache modules and PHP extensions : Apache 2.0, PHP V4 &amp; V5, zlib, OpenSSL, OpenLDAP, expat, iconv, mod_jk, xml2, xslt, png, jpeg, freetype, bzip2, curl, imap, MySQL, PostgreSQL, mm.<br />
<br />
Also includes a cute dependency diagram making clear the relationships between all these libraries.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60741""></a>
  <div class="note">
   <strong class="user">ozone at cname dot com</strong>
   <a href="#60741" class="date">15-Jan-2006 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
php &gt;= 5.1.1 requires a fully GNU toolchain on solaris; /usr/ccs/bin/ld will fail to link. see bug 35496.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59899""></a>
  <div class="note">
   <strong class="user">AxL</strong>
   <a href="#59899" class="date">19-Dec-2005 07:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have problems building php with sqlite on solaris, add "-lrt" library so you dont get the fdatasync undefined symbol error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48294""></a>
  <div class="note">
   <strong class="user">anacreo</strong>
   <a href="#48294" class="date">18-Dec-2004 05:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Below was copied from a Sun Forum -- if having problems compiling on Solaris 10 try this:<br />
<br />
Re: where is ctid_t defined? (Solaris 10)<br />
Author: Juergen.Keil&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Nov 17, 2004 10:37 AM (reply 1 of 10)&nbsp; &nbsp;&nbsp; <br />
ctid_t is defined in /usr/include/sys/types.h ("typedef id_t ctid_t;").<br />
<br />
I guess what has happend is that you're using a gcc compiler that<br />
was build on Solaris 9 (or some other Solaris release older than<br />
Solaris 10 b69), and this gcc release has a set of "fixed" gcc specific<br />
headers that don't match your s10b69 system headers any more.<br />
<br />
The fix is to build a fresh set of gcc "fixed" headers:<br />
<br />
# cd /opt/sfw/gcc-3/lib/gcc-lib/i386-pc-solaris2.9/3.3.2/install-tools/ <br />
&nbsp;<br />
# cat &gt; mkheaders.conf<br />
SHELL=/bin/sh<br />
SYSTEM_HEADER_DIR="/usr/include"<br />
OTHER_FIXINCLUDES_DIRS=""<br />
FIXPROTO_DEFINES="-D_XOPEN_SOURCE"<br />
STMP_FIXPROTO="stmp-fixproto"<br />
STMP_FIXINC="stmp-fixinc"<br />
^D<br />
&nbsp;<br />
# ./mkheaders</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33961""></a>
  <div class="note">
   <strong class="user">xlark at sdf dot lonestar dot org</strong>
   <a href="#33961" class="date">12-Jul-2003 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you do a "Core Install" of Solaris,&nbsp; be sure you have installed the SUNWlibm and SUNWlibms packages.&nbsp; PHP 4.2.3 fails to compile without them.<br />
<br />
If you get errors with GCC about math.h, then you don't have them installed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33662""></a>
  <div class="note">
   <strong class="user">ejflores at alcatel dot es</strong>
   <a href="#33662" class="date">03-Jul-2003 03:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
./configure not run fine with /usr/ucb/tr you need to install GNU textutils</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30130""></a>
  <div class="note">
   <strong class="user">ineves at iportalmais dot pt</strong>
   <a href="#30130" class="date">07-Mar-2003 12:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have compiled php 4.2.3, on my solaris 9, sparc, it works, i have gcc 3.2.2, from sunfreeware.org, i have compiled with <br />
<br />
./configure --prefix=/opt/php --with-apxs=/opt/apache/bin/apxs --with-pgsql=/opt/pgsql --with-imap=/usr/src/soft/imap-2002b --with-ldap --with-imap-ssl=/usr/local/ssl<br />
<br />
It compiles, but when i try to run it says something like:<br />
<br />
bash-2.05# /opt/apache/bin/apachectl start<br />
Syntax error on line 205 of /opt/apache/conf/httpd.conf:<br />
Cannot load /opt/apache/libexec/libphp4.so into server: ld.so.1: /opt/apache/bin/httpd: fatal: relocation error: file /opt/apache/libexec/libphp4.so: symbol ldap_start_tls_s: referenced symbol not found<br />
/opt/apache/bin/apachectl start: httpd could not be started<br />
<br />
This means that the ldap librarys that came with solaris, are not very fine, you should use from openldap.org packages...<br />
<br />
it is using this library:<br />
<br />
bash-2.05# ldd /opt/apache/libexec/libphp4.so<br />
&nbsp;&nbsp;&nbsp; ...<br />
&nbsp;&nbsp;&nbsp; libldap.so.5 =&gt;&nbsp; /usr/lib/libldap.so.5<br />
<br />
his one is from solaris installation.<br />
<br />
(sorry about my english)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28218""></a>
  <div class="note">
   <strong class="user">nicos at php dot net</strong>
   <a href="#28218" class="date">06-Jan-2003 04:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that you also need GNU sed or you'll have some errors lile "Output line too long."</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26027""></a>
  <div class="note">
   <strong class="user">m at hackerz dot uk dot co</strong>
   <a href="#26027" class="date">15-Oct-2002 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Compiled Ok on Solaris 9 after the addition of Bison Flex automake and autoconf, adding /usr/local/bin to the path and linking /usr/ccs/bin/ar to /usr/local/bin/ar.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22671""></a>
  <div class="note">
   <strong class="user">php at woodNO-SPAMstea dot com</strong>
   <a href="#22671" class="date">26-Jun-2002 08:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Howard Glynn's post from May 22 is right on - if you're running Solaris 8, make sure you get the latest Recommended patch cluster. I've been struggling with that library problem that happens when you start Apache for several weeks, tweaking the config, setting LD_LIBRARY_PATH, etc. I couldn't believe that the PHP developers wouldn't have the Solaris build right - seems like a fairly important OS. But the latest Solaris patch cluster fixed the problem, so I guess it was my fault for not being up to date. I'm running PHP 4.2.1 now with Apache 2.0.36, works great.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22180""></a>
  <div class="note">
   <strong class="user">ltfrench at vt dot edu</strong>
   <a href="#22180" class="date">09-Jun-2002 11:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get PHP 4.2.0 or better to make on Solaris 8 (using gcc and gnu autoconf) you need to:<br />
ln -s /usr/local/bin/gcc /usr/local/bin/cc<br />
<br />
See: <a href="http://bugs.php.net/bug.php?id=16833" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=16833</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="21664""></a>
  <div class="note">
   <strong class="user">howardglynn at hotmail dot com</strong>
   <a href="#21664" class="date">22-May-2002 07:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've had a lot of problems with "dn_skipname" reference errors when trying to do a php / apache shared-library install on solaris 8. All compiling was clean, but could not restart apache with mod_php. After much trial and error, I found a solution by installing patch 109326-07 which has some fixes for resolver (I think). I had one web server without the patch, and one with it, and was able to show the same commands compiling, working and restarting on one, but not the other. Installed patch on machine, compiled clean and was up and running after doing this. Works great. Get the patch from sun.com</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19134""></a>
  <div class="note">
   <strong class="user">shane dot kinsch at netracorp dot comNOSPAM</strong>
   <a href="#19134" class="date">17-Feb-2002 09:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 4.1.1 / Apache 1.32 Buile Issues (Solaris 2.8)<br />
<br />
Apache build options:<br />
./configure --prefix=/usr/local/etc/apache --enable-module=rewrite --enable-shared=rewrite<br />
<br />
PHP build options:<br />
./configure --with-mysql=/usr/local/etc/mysql --with-apxs=/usr/local/etc/apache/bin/apxs<br />
<br />
Both Apache and PHP compiled without errors and installed cleanly.<br />
<br />
The Error when starting Apache:<br />
Syntax error on line 208 of /usr/local/etc/apache/conf/httpd.conf:<br />
Cannot load /usr/local/etc/apache/libexec/libphp4.so into server:<br />
ld.so.1: /usr/local/etc/apache/bin/httpd: fatal: relocation error: file /usr/local/etc/apache/libexec/libphp4.so: symbol dn_skipname: referenced symbol not found ./apachectl start: httpd could not be started<br />
<br />
Line 208 in the httpd.conf file is: <br />
LoadModule php4_module&nbsp; &nbsp; &nbsp; &nbsp; libexec/libphp4.so<br />
<br />
The solution:<br />
For some reason, even though LD_LIBRARY_PATH was being set properly,<br />
it wasn't being read fully.&nbsp; You will need to create a runtime<br />
linking environment by doing this:<br />
<br />
#crle -c /var/ld/ld.config -l /usr/lib:/usr/local/lib:/usr/local/etc/mysql/lib<br />
<br />
Shane Kinsch<br />
NetraCorp LLC / SecurNET Consulting</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13597""></a>
  <div class="note">
   <strong class="user">Louis at ewens dot com</strong>
   <a href="#13597" class="date">23-Jun-2001 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On Solaris, if upon starting Apache you get an error like this:
<br />

<br />
Syntax error on line 33 of /usr/local/apache/conf/httpd.conf:
<br />
Cannot load /usr/local/apache/libexec/libphp4.so into server: ld.so.1: /usr/loca
<br />
l/apache/bin/httpd: fatal: libmysqlclient.so.10: open failed: No such file or directory
<br />
./apachectl start: httpd could not be started
<br />

<br />
..try inserting the following lines into the configuration section of your apachectl startup shell script:
<br />

<br />
LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/local/mysql/lib/mysql
<br />
export LD_LIBRARY_PATH
<br />

<br />
Change the /usr/local/mysql/ prefix to where ever your MySQL installation is. Make sure to add on the /lib/mysql extension to your own path though.
<br />

<br />
Do your normal "apachectl start" command to start Apache and voila, no more error. Apachectl can be found in the bin directory of your Apache installation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
