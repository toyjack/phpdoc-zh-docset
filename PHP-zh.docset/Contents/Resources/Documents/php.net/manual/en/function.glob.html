<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>寻找与模式匹配的文件路径</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.fwrite.html">? fwrite</a></li>
      <li style="float: right;"><a href="function.is-dir.html">is_dir ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">Filesystem 函数</a></li>
    <li>寻找与模式匹配的文件路径</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.glob" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">glob</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">glob</span> &mdash; <span class="dc-title">寻找与模式匹配的文件路径</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.glob-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">array</span> <span class="methodname"><strong>glob</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$pattern</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$flags</code><span class="initializer"> = 0</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>glob()</strong></span> 函数依照 libc glob() 函数使用的规则寻找所有与
   <code class="parameter">pattern</code> 匹配的文件路径，类似于一般 shells
   所用的规则一样。不进行缩写扩展或参数替代。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.glob-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">pattern</code></dt>

     <dd>

      <p class="para">
       The pattern. No tilde expansion or parameter substitution is done.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">flags</code></dt>

     <dd>

      <p class="para">
       有效标记有：
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          <strong><code>GLOB_MARK</code></strong> - 在每个返回的项目中加一个斜线
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
           <strong><code>GLOB_NOSORT</code></strong> - 按照文件在目录中出现的原始顺序返回（不排序）
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>GLOB_NOCHECK</code></strong> - 如果没有文件匹配则返回用于搜索的模式
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>GLOB_NOESCAPE</code></strong> - 反斜线不转义元字符
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>GLOB_BRACE</code></strong> - 扩充 {a,b,c} 来匹配 &#039;a&#039;，&#039;b&#039; 或 &#039;c&#039;
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>GLOB_ONLYDIR</code></strong> - 仅返回与模式匹配的目录项
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          <strong><code>GLOB_ERR</code></strong> - 停止并读取错误信息（比如说不可读的目录），默认的情况下忽略所有错误
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.glob-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">返回一个包含有匹配文件／目录的数组。如果出错返回 <strong><code>FALSE</code></strong>。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    On some systems it is impossible to distinguish between empty match and an
    error.
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.glob-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.1.0</td>
       <td>
        <strong><code>GLOB_ERR</code></strong> was added
       </td>
      </tr>

      <tr>
       <td>4.3.3</td>
       <td>
        <strong><code>GLOB_ONLYDIR</code></strong>
       在 Windows 或者其它不使用 GNU C 库的系统上开始可用。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.glob-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2558">
    <p><strong>Example #1 怎样用 <span class="function"><strong>glob()</strong></span> 方便地替代
    <span class="function"><a href="function.opendir.html" class="function">opendir()</a></span> 和相关函数</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">glob</span><span style="color: #007700">(</span><span style="color: #DD0000">"*.txt"</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$filename</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">&nbsp;size&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">filesize</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
funclist.txt size 44686
funcsummary.txt size 267625
quickref.txt size 137820
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.glob-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数不能作用于<a href="features.remote-files.html" class="link">远程文件</a>，被检查的文件必须是可通过服务器的文件系统访问的。</span></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    此函数在一些系统上还不能工作（例如一些旧的 Sun OS）。
   </span>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    <strong><code>GLOB_BRACE</code></strong> 在一些非 GNU 系统上无效，比如 Solaris。
   </span>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.glob-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.opendir.html" class="function" rel="rdfs-seeAlso">opendir()</a> - 打开目录句柄</span></li>
    <li class="member"><span class="function"><a href="function.readdir.html" class="function" rel="rdfs-seeAlso">readdir()</a> - 从目录句柄中读取条目</span></li>
    <li class="member"><span class="function"><a href="function.closedir.html" class="function" rel="rdfs-seeAlso">closedir()</a> - 关闭目录句柄</span></li>
    <li class="member"><span class="function"><a href="function.fnmatch.html" class="function" rel="rdfs-seeAlso">fnmatch()</a> - 用模式匹配文件名</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="119423""></a>
  <div class="note">
   <strong class="user">simon at paragi dot dk</strong>
   <a href="#119423" class="date">03-Jun-2016 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple and versatile function that returns an array tree of files, matching wildcards:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// List files in tree, matching wildcards * and ?<br />
</span><span class="keyword">function </span><span class="default">tree</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">){<br />
&nbsp; static </span><span class="default">$match</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">// Find the real directory part of the path, and set the match parameter<br />
&nbsp; </span><span class="default">$last</span><span class="keyword">=</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">);<br />
&nbsp; if(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$match</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">$last</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while(!</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$last</span><span class="keyword">)) &amp;&amp; </span><span class="default">$last</span><span class="keyword">!==</span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$last</span><span class="keyword">=</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; if(empty(</span><span class="default">$match</span><span class="keyword">)) </span><span class="default">$match</span><span class="keyword">=</span><span class="string">"/*"</span><span class="keyword">;<br />
&nbsp; if(!</span><span class="default">$path</span><span class="keyword">=</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) return;<br />
<br />
&nbsp; </span><span class="comment">// List files<br />
&nbsp; </span><span class="keyword">foreach(</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">.</span><span class="default">$match</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$list</span><span class="keyword">[]=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp; }&nbsp; <br />
<br />
&nbsp; </span><span class="comment">// Process sub directories<br />
&nbsp; </span><span class="keyword">foreach(</span><span class="default">glob</span><span class="keyword">(</span><span class="string">"</span><span class="default">$path</span><span class="string">/*"</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">) as </span><span class="default">$dir</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$list</span><span class="keyword">[</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">,</span><span class="string">"/"</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">)]=</span><span class="default">tree</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; return @</span><span class="default">$list</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119231""></a>
  <div class="note">
   <strong class="user">sebastian dot wasser at gmail dot com</strong>
   <a href="#119231" class="date">23-Apr-2016 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I created a rglob function to support a '/**/' wildcard. You can even set the order to post-order or pre-order traversal.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">rglob </span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$flags </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$traversePostOrder </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Keep away the hassles of the rest if we don't use the wildcard anyway<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="string">'/**/'</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$patternParts </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/**/'</span><span class="keyword">, </span><span class="default">$pattern</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Get sub dirs<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$patternParts</span><span class="keyword">) . </span><span class="string">'/*'</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR </span><span class="keyword">| </span><span class="default">GLOB_NOSORT</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Get files for current dir<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subDirContent </span><span class="keyword">= </span><span class="default">rglob</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/**/' </span><span class="keyword">. </span><span class="default">implode</span><span class="keyword">(</span><span class="string">'/**/'</span><span class="keyword">, </span><span class="default">$patternParts</span><span class="keyword">), </span><span class="default">$flags</span><span class="keyword">, </span><span class="default">$traversePostOrder</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$traversePostOrder</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">$subDirContent</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$subDirContent</span><span class="keyword">, </span><span class="default">$files</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
};<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118782""></a>
  <div class="note">
   <strong class="user">roland at rd-creation dot fr</strong>
   <a href="#118782" class="date">05-Feb-2016 09:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FIX to use GLOB_BRACE pattern in glob_recursive function submitted by Mike<br />
<br />
if (! function_exists('glob_recursive')){<br />
&nbsp;&nbsp;&nbsp; function glob_recursive($pattern, $flags = 0, $startdir = ''){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $files = glob($startdir.$pattern, $flags);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (glob($startdir.'*', GLOB_ONLYDIR|GLOB_NOSORT|GLOB_MARK) as $dir){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $files = array_merge($files, glob_recursive($pattern, $flags, $dir));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $files;<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118256""></a>
  <div class="note">
   <strong class="user">sharshun dot aliaksandr at gmail dot com</strong>
   <a href="#118256" class="date">04-Nov-2015 11:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$flags </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){<br />
</span><span class="comment">// forked from https://github.com/rodurma/PHP-Functions/<br />
&nbsp;&nbsp;&nbsp; // blob/master/glob_recursive.php<br />
&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp; foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">).</span><span class="string">'/*'</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">|</span><span class="default">GLOB_NOSORT</span><span class="keyword">) as </span><span class="default">$dir</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">glob_recursive<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">), </span><span class="default">$flags</span><span class="keyword">));<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
}<br />
</span><span class="comment">// $a=glob_recursive('c:/test_directory/'."*.*");<br />
// print_r($a);<br />
<br />
</span><span class="keyword">function </span><span class="default">dirInfoReGet</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">=</span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">.</span><span class="string">"*.*"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ar</span><span class="keyword">=</span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">.</span><span class="string">"**/**"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">=</span><span class="default">array_unique</span><span class="keyword">(</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$ar</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arra</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][]=</span><span class="default">$v</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arra</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">][]=</span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">sort</span><span class="keyword">(</span><span class="default">$arra</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$arra</span><span class="keyword">;<br />
}<br />
</span><span class="default">$a</span><span class="keyword">=</span><span class="default">dirInfoReGet</span><span class="keyword">(</span><span class="string">'c:/test_directory/'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
<a href="http://i.stack.imgur.com/H7UF3.jpg" rel="nofollow" target="_blank">http://i.stack.imgur.com/H7UF3.jpg</a><br />
<br />
Best regards.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116253""></a>
  <div class="note">
   <strong class="user">Anxiety35 at gmail dot com</strong>
   <a href="#116253" class="date">02-Dec-2014 06:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After fiddling with GLOB_BRACE a bunch, I have found the most items that can be included in the braces is about 10 before glob no longer returns any matches.<br />
<br />
I have a scenario where there can be a thousand or more files to check for where I can't pattern match and need to check specific names. I was hoping to batch them in large groups to see if it would help performance. However, if I include more than 10 in a GLOB_BRACE the function will return FALSE.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114024""></a>
  <div class="note">
   <strong class="user">rene dot rathmann at gmx dot de</strong>
   <a href="#114024" class="date">02-Jan-2014 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can do a recursive file search with yield.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">findAllDirs</span><span class="keyword">(</span><span class="default">$start</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirStack</span><span class="keyword">=[</span><span class="default">$start</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$dir</span><span class="keyword">=</span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$dirStack</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ar</span><span class="keyword">=</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/*'</span><span class="keyword">,</span><span class="default">GLOB_ONLYDIR</span><span class="keyword">|</span><span class="default">GLOB_NOSORT</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">$ar</span><span class="keyword">) continue;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirStack</span><span class="keyword">=</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$dirStack</span><span class="keyword">,</span><span class="default">$ar</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$ar </span><span class="keyword">as </span><span class="default">$DIR</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; yield </span><span class="default">$DIR</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$fname</span><span class="keyword">=</span><span class="string">'*.php'</span><span class="keyword">;<br />
</span><span class="default">$result</span><span class="keyword">=[];<br />
foreach(</span><span class="default">findAllDirs</span><span class="keyword">(</span><span class="string">'/var/www/localhost'</span><span class="keyword">) as </span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$match</span><span class="keyword">=</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$fname</span><span class="keyword">,</span><span class="default">GLOB_NOSORT</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$match</span><span class="keyword">) continue;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">=</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="default">$match</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112673""></a>
  <div class="note">
   <strong class="user">mif</strong>
   <a href="#112673" class="date">11-Jul-2013 06:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
glob() doesn't work on php 5.4.14 with curl extension.<br />
<br />
error:<br />
Call to undefined function glob()<br />
<br />
function_exists('glob') &mdash; false<br />
<br />
without curl - ok.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112052""></a>
  <div class="note">
   <strong class="user">soywiz at gmail dot com</strong>
   <a href="#112052" class="date">26-Apr-2013 07:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Recursive glob for PHP&gt;=5.5<br />
<br />
function globRecursive($path, $find) {<br />
&nbsp;&nbsp;&nbsp; $dh = opendir($path);<br />
&nbsp;&nbsp;&nbsp; while (($file = readdir($dh)) !== false) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (substr($file, 0, 1) == '.') continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $rfile = "{$path}/{$file}";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (is_dir($rfile)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (globRecursive($rfile, $find) as $ret) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; yield $ret;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (fnmatch($find, $file)) yield $rfile;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; closedir($dh);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111605""></a>
  <div class="note">
   <strong class="user">bimal at sanjaal dot com</strong>
   <a href="#111605" class="date">08-Mar-2013 01:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To pick one of the file randomly from your directory with full physical path, you can write something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">one_random_image_file</span><span class="keyword">()<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">'../images/*.jpg'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">shuffle</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
}<br />
</span><span class="default">$image_to_read </span><span class="keyword">= </span><span class="default">one_random_image_file</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111217""></a>
  <div class="note">
   <strong class="user">agd243 at gmail dot com</strong>
   <a href="#111217" class="date">27-Jan-2013 11:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple function that find all files by extension an return it by an array.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">findFiles</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, </span><span class="default">$extensions </span><span class="keyword">= array()) {<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, &amp;</span><span class="default">$directories </span><span class="keyword">= array()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR </span><span class="keyword">| </span><span class="default">GLOB_NOSORT</span><span class="keyword">) as </span><span class="default">$folder</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$directories</span><span class="keyword">[] = </span><span class="default">$folder</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="string">"</span><span class="keyword">{</span><span class="default">$folder</span><span class="keyword">}</span><span class="string">/*"</span><span class="keyword">, </span><span class="default">$directories</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">, </span><span class="default">$directories</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= array ();<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$directories </span><span class="keyword">as </span><span class="default">$directory</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$extensions </span><span class="keyword">as </span><span class="default">$extension</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">glob</span><span class="keyword">(</span><span class="string">"</span><span class="keyword">{</span><span class="default">$directory</span><span class="keyword">}</span><span class="string">/*.</span><span class="keyword">{</span><span class="default">$extension</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[</span><span class="default">$extension</span><span class="keyword">][] = </span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
}<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">findFiles</span><span class="keyword">(</span><span class="string">"C:"</span><span class="keyword">, array (<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"jpg"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"pdf"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"png"</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">"html"<br />
</span><span class="keyword">)));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110510""></a>
  <div class="note">
   <strong class="user">Gabriel S. Luraschi</strong>
   <a href="#110510" class="date">31-Oct-2012 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use this to exclude hidden files on MS Windows.<br />
<br />
<span class="default">&lt;?php<br />
exec</span><span class="keyword">(</span><span class="string">"dir \"</span><span class="keyword">{</span><span class="default">$path</span><span class="keyword">}</span><span class="string">\" /A:-H /B"</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110340""></a>
  <div class="note">
   <strong class="user">ni dot pineau at gmail dot com</strong>
   <a href="#110340" class="date">13-Oct-2012 01:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that in case you are using braces with glob you might retrieve duplicated entries for files that matche more than one item :<br />
<br />
<span class="default">&lt;?php<br />
<br />
$a </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">'/path/*{foo,bar}.dat'</span><span class="keyword">,</span><span class="default">GLOB_BRACE</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Result : <br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; /path/file_foo.dat<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; /path/file_foobar.dat<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; /path/file_foobar.dat<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108440""></a>
  <div class="note">
   <strong class="user">Sam Bryan</strong>
   <a href="#108440" class="date">27-Apr-2012 01:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
glob is case sensitive, even on Windows systems.<br />
<br />
It does support character classes though, so a case insensitive version of<br />
<span class="default">&lt;?php glob</span><span class="keyword">(</span><span class="string">'my/dir/*.csv'</span><span class="keyword">) </span><span class="default">?&gt;<br />
</span><br />
could be written as<br />
<span class="default">&lt;?php glob</span><span class="keyword">(</span><span class="string">'my/dir/*.[cC][sS][vV]'</span><span class="keyword">) </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106595""></a>
  <div class="note">
   <strong class="user">Mike</strong>
   <a href="#106595" class="date">21-Nov-2011 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if ( ! </span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'glob_recursive'</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Does not support flag GLOB_BRACE<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$flags </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">).</span><span class="string">'/*'</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">|</span><span class="default">GLOB_NOSORT</span><span class="keyword">) as </span><span class="default">$dir</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">glob_recursive</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">), </span><span class="default">$flags</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106047""></a>
  <div class="note">
   <strong class="user">mkas at destiny dot lt</strong>
   <a href="#106047" class="date">05-Oct-2011 09:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
recursive file search<br />
<br />
<span class="default">&lt;?php<br />
$path</span><span class="keyword">[] = </span><span class="string">'starting_place/*'</span><span class="keyword">;<br />
<br />
while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">) != </span><span class="default">0</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">) as </span><span class="default">$item</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">[] = </span><span class="default">$item </span><span class="keyword">. </span><span class="string">'/*'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//do something<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103022""></a>
  <div class="note">
   <strong class="user">Ultimater at gmail dot com</strong>
   <a href="#103022" class="date">21-Mar-2011 08:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
glob() isn't limited to one directory:<br />
<br />
<span class="default">&lt;?php<br />
$results</span><span class="keyword">=</span><span class="default">glob</span><span class="keyword">(</span><span class="string">"{includes/*.php,core/*.php}"</span><span class="keyword">,</span><span class="default">GLOB_BRACE</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">,</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$results</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">),</span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Just be careful when using GLOB_BRACE regarding spaces around the comma:<br />
{includes/*.php,core/*.php} works as expected, but<br />
{includes/*.php, core/*.php} with a leading space, will only match the former as expected but not the latter<br />
unless you have a directory named " core" on your machine with a leading space.<br />
PHP can create such directories quite easily like so:<br />
mkdir(" core");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102931""></a>
  <div class="note">
   <strong class="user">david dot schueler at tel-billig dot de</strong>
   <a href="#102931" class="date">15-Mar-2011 03:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't use glob() if you try to list files in a directory where very much files are stored (&gt;100.000). You get an "Allowed memory size of XYZ bytes exhausted ..." error.<br />
You may try to increase the memory_limit variable in php.ini. Mine has 128MB set and the script will still reach this limit while glob()ing over 500.000 files.<br />
<br />
The more stable way is to use readdir() on very large numbers of files:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// code snippet<br />
</span><span class="keyword">if (</span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// do something with the file<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // note that '.' and '..' is returned even<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102691""></a>
  <div class="note">
   <strong class="user">troy at troyonline dot com</strong>
   <a href="#102691" class="date">01-Mar-2011 06:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have open_basedir set in php.ini to limit which files php can execute, glob(...) will return false when there are no matching files.&nbsp; If open_basedir is not set, the very same code will return an empty array in the same situation.<br />
<br />
This is unfortunate as a seemingly innocuous change causes different functionality that breaks code like:<br />
<br />
foreach(glob("*.ext") as $file)<br />
...<br />
<br />
See this link if you have any questions as to why this is so:<br />
<a href="http://bugs.php.net/bug.php?id=47358" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=47358</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97899""></a>
  <div class="note">
   <strong class="user">peter dot adrianov at gmail dot com</strong>
   <a href="#97899" class="date">14-May-2010 01:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Non-recursive search files, proceeding down directory tree.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">scandir_through</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$items </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/*'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$items</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$items</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$add </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$items</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] . </span><span class="string">'/*'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$items</span><span class="keyword">, </span><span class="default">$add</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$items</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97793""></a>
  <div class="note">
   <strong class="user">BigueNique at yahoo dot ca</strong>
   <a href="#97793" class="date">08-May-2010 08:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is the function array_prepend() used by my latest post of safe_glob().<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Prepends $string to each element of $array<br />
&nbsp;* If $deep is true, will indeed also apply to sub-arrays<br />
&nbsp;* @author BigueNique AT yahoo DOT ca<br />
&nbsp;* @since 080324<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">array_prepend</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$deep</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(empty(</span><span class="default">$array</span><span class="keyword">)||empty(</span><span class="default">$string</span><span class="keyword">)) return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$element</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$deep</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">array_prepend</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$deep</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'array_prepend: array element'</span><span class="keyword">,</span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$string</span><span class="keyword">.</span><span class="default">$element</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95972""></a>
  <div class="note">
   <strong class="user">ottodenn at gmail dot com</strong>
   <a href="#95972" class="date">01-Feb-2010 11:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
just a quick one:
<br />

<br />
get all dirs, without files:
<br />
<span class="default">&lt;?php
<br />
$dirs </span><span class="keyword">= </span><span class="default">array_filter</span><span class="keyword">(</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">.</span><span class="string">'*'</span><span class="keyword">), </span><span class="string">'is_dir'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94541""></a>
  <div class="note">
   <strong class="user">dragos dot rusu at ymail dot com</strong>
   <a href="#94541" class="date">11-Nov-2009 09:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Glob function doesn't return the hidden files (including ".*" files). PHP5 RecursiveIterator can be used for iterating through directories recursively.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93669""></a>
  <div class="note">
   <strong class="user">wang yun</strong>
   <a href="#93669" class="date">22-Sep-2009 03:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function to quickly remove a directory (works in seconds for a hundred thousand files)<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* Remove the directory and its content (all files and subdirectories).<br />
&nbsp;* @param string $dir the directory name<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">rmrf</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">rmrf</span><span class="keyword">(</span><span class="string">"</span><span class="default">$file</span><span class="string">/*"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">rmdir</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92710""></a>
  <div class="note">
   <strong class="user">uramihsayibok, gmail, com</strong>
   <a href="#92710" class="date">05-Aug-2009 12:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Those of you with PHP 5 don't have to come up with these wild functions to scan a directory recursively: the SPL can do it.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$dir_iterator </span><span class="keyword">= new </span><span class="default">RecursiveDirectoryIterator</span><span class="keyword">(</span><span class="string">"/path"</span><span class="keyword">);<br />
</span><span class="default">$iterator </span><span class="keyword">= new </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">(</span><span class="default">$dir_iterator</span><span class="keyword">, </span><span class="default">RecursiveIteratorIterator</span><span class="keyword">::</span><span class="default">SELF_FIRST</span><span class="keyword">);<br />
</span><span class="comment">// could use CHILD_FIRST if you so wish<br />
<br />
</span><span class="keyword">foreach (</span><span class="default">$iterator </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$file</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Not to mention the fact that $file will be an SplFileInfo class, so you can do powerful stuff really easily:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$size </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
foreach (</span><span class="default">$iterator </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">isFile</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">getPathname</span><span class="keyword">(), </span><span class="default">27</span><span class="keyword">) . </span><span class="string">": " </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">getSize</span><span class="keyword">() . </span><span class="string">" B; modified " </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y-m-d"</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">getMTime</span><span class="keyword">()) . </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">+= </span><span class="default">$file</span><span class="keyword">-&gt;</span><span class="default">getSize</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
echo </span><span class="string">"\nTotal file size: "</span><span class="keyword">, </span><span class="default">$size</span><span class="keyword">, </span><span class="string">" bytes\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
\Luna\luna.msstyles: 4190352 B; modified 2008-04-13<br />
\Luna\Shell\Homestead\shellstyle.dll: 362496 B; modified 2006-02-28<br />
\Luna\Shell\Metallic\shellstyle.dll: 362496 B; modified 2006-02-28<br />
\Luna\Shell\NormalColor\shellstyle.dll: 361472 B; modified 2006-02-28<br />
\Luna.theme: 1222 B; modified 2006-02-28<br />
\Windows Classic.theme: 3025 B; modified 2006-02-28<br />
<br />
Total file size: 5281063 bytes</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92565""></a>
  <div class="note">
   <strong class="user">endiku</strong>
   <a href="#92565" class="date">29-Jul-2009 05:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who need to recursively search a directory tree and cannot or wish not to call a function within itself here is another suggestion.<br />
<br />
I tried the previously suggested listdirs_safe() and it didn't seem to find all subfolders in a directory tree.<br />
<br />
There are two variations on the same theme.<br />
<br />
Single Array.<br />
<span class="default">&lt;?php<br />
$dir </span><span class="keyword">=</span><span class="string">'/dir'</span><span class="keyword">;<br />
while(</span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/*'</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">)) {<br />
&nbsp; </span><span class="default">$dir </span><span class="keyword">.= </span><span class="string">'/*'</span><span class="keyword">;<br />
&nbsp; if(!</span><span class="default">$d</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$d</span><span class="keyword">=</span><span class="default">$dirs</span><span class="keyword">;<br />
&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">=</span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$dirs</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Multiple arrays.<br />
<span class="default">&lt;?php<br />
$n</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
</span><span class="default">$dir </span><span class="keyword">=</span><span class="string">'/dir'</span><span class="keyword">;<br />
while(</span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/*'</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">)) {<br />
&nbsp; </span><span class="default">$dir </span><span class="keyword">.= </span><span class="string">'/*'</span><span class="keyword">;<br />
&nbsp; if(!</span><span class="default">$d</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$d</span><span class="keyword">=</span><span class="default">$dirs</span><span class="keyword">;<br />
&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$n</span><span class="keyword">]=</span><span class="default">$dirs</span><span class="keyword">;<br />
&nbsp;&nbsp; }<br />
&nbsp; </span><span class="default">$n</span><span class="keyword">++;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This will result in the glob looping via "dir/*/*/*/*.." until it is no longer finding a directory structure.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92037""></a>
  <div class="note">
   <strong class="user">nuntius</strong>
   <a href="#92037" class="date">06-Jul-2009 07:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
First off, it's nice to see all of the different takes on this. Thanks for all of the great examples. <br />
<br />
Fascinated by the foreach usage I was curious how it might work with a for loop. I found that glob was well suited for this, especially compared to opendir.&nbsp; The for loop is always efficient when you want to protect against a potential endless loop. <br />
<br />
$dir=$_SERVER['DOCUMENT_ROOT']."/test/directory_listing/test";<br />
&nbsp;&nbsp;&nbsp; echo $dir;<br />
&nbsp;&nbsp;&nbsp; $filesArray=glob($dir."/*.*");&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $line.="&lt;pre&gt;";<br />
&nbsp;&nbsp;&nbsp; $line.=print_r($filesArray, true);<br />
&nbsp;&nbsp;&nbsp; $line.="&lt;/pre&gt;";<br />
&nbsp;&nbsp;&nbsp; $line.="&lt;hr&gt;";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for($i=0;$i&lt;count($filesArray);$i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $line.=key($filesArray)." - ";&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $line.=$filesArray[$i]."&lt;br/&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; next($filesArray);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; echo $line;<br />
<br />
Note that I pulled the glob array keys if you should need them. <br />
<br />
Also you can tweak it for searches with something like this... (case sensitive)<br />
<br />
$search_names="Somedocname";<br />
$filesArray=glob($dir."/".$search_names."*.*");&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
Enjoy!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91475""></a>
  <div class="note">
   <strong class="user">sven at NOSPAM dot sven dot globalunix dot org</strong>
   <a href="#91475" class="date">11-Jun-2009 06:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use wildcard expressions (like they are used by glob() ) to search on strings, you can use this function:<br />
<br />
<span class="default">&lt;?php&nbsp; &nbsp; <br />
</span><span class="keyword">function </span><span class="default">match_wildcard</span><span class="keyword">( </span><span class="default">$wildcard_pattern</span><span class="keyword">, </span><span class="default">$haystack </span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$regex </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; array(</span><span class="string">"\*"</span><span class="keyword">, </span><span class="string">"\?"</span><span class="keyword">), </span><span class="comment">// wildcard chars<br />
&nbsp;&nbsp; &nbsp; </span><span class="keyword">array(</span><span class="string">'.*'</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">),&nbsp;&nbsp; </span><span class="comment">// regexp chars<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">preg_quote</span><span class="keyword">(</span><span class="default">$wildcard_pattern</span><span class="keyword">)<br />
&nbsp;&nbsp; );<br />
<br />
&nbsp;&nbsp; return </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^'</span><span class="keyword">.</span><span class="default">$regex</span><span class="keyword">.</span><span class="string">'$/is'</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$test </span><span class="keyword">= </span><span class="string">"foobar and blob\netc."</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">match_wildcard</span><span class="keyword">(</span><span class="string">'foo*'</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">),&nbsp; &nbsp; &nbsp; </span><span class="comment">// TRUE<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">match_wildcard</span><span class="keyword">(</span><span class="string">'bar*'</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">),&nbsp; &nbsp; &nbsp; </span><span class="comment">// FALSE<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">match_wildcard</span><span class="keyword">(</span><span class="string">'*bar*'</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">),&nbsp; &nbsp;&nbsp; </span><span class="comment">// TRUE<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">match_wildcard</span><span class="keyword">(</span><span class="string">'**blob**'</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">),&nbsp; </span><span class="comment">// TRUE<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">match_wildcard</span><span class="keyword">(</span><span class="string">'*a?d*'</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">),&nbsp; &nbsp;&nbsp; </span><span class="comment">// TRUE<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">match_wildcard</span><span class="keyword">(</span><span class="string">'*etc**'</span><span class="keyword">, </span><span class="default">$test</span><span class="keyword">)&nbsp; &nbsp;&nbsp; </span><span class="comment">// TRUE<br />
</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90672""></a>
  <div class="note">
   <strong class="user">r dot hartung at roberthartung dot de</strong>
   <a href="#90672" class="date">04-May-2009 09:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use multiple asterisks with the glob() - function.<br />
<br />
Example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; $paths </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">'my/*/dir/*.php'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
$paths will contains paths as following examples:<br />
<br />
- my/1/dir/xyz.php<br />
- my/bar/dir/bar.php<br />
- my/bar/dir/foo.php</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88250""></a>
  <div class="note">
   <strong class="user">crayonviolent at phpfreaks dot com</strong>
   <a href="#88250" class="date">17-Jan-2009 08:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since I feel this is rather vague and non-helpful, I thought I'd make a post detailing the mechanics of the glob regex.
<br />

<br />
glob uses two special symbols that act like sort of a blend between a meta-character and a quantifier.&nbsp; These two characters are the * and ? 
<br />

<br />
The ? matches 1 of any character except a /
<br />
The * matches 0 or more of any character except a /
<br />

<br />
If it helps, think of the * as the pcre equivalent of .* and ? as the pcre equivalent of the dot (.)
<br />

<br />
Note: * and ? function independently from the previous character. For instance, if you do glob("a*.php") on the following list of files, all of the files starting with an 'a' will be returned, but * itself would match:
<br />

<br />
a.php // * matches nothing
<br />
aa.php // * matches the second 'a'
<br />
ab.php // * matches 'b'
<br />
abc.php // * matches 'bc'
<br />
b.php // * matches nothing, because the starting 'a' fails
<br />
bc.php // * matches nothing, because the starting 'a' fails
<br />
bcd.php // * matches nothing, because the starting 'a' fails
<br />

<br />
It does not match just a.php and aa.php as a 'normal' regex would, because it matches 0 or more of any character, not the character/class/group before it. 
<br />

<br />
Executing glob("a?.php") on the same list of files will only return aa.php and ab.php because as mentioned, the ? is the equivalent of pcre's dot, and is NOT the same as pcre's ?, which would match 0 or 1 of the previous character.
<br />

<br />
glob's regex also supports character classes and negative character classes, using the syntax [] and [^]. It will match any one character inside [] or match any one character that is not in [^].
<br />

<br />
With the same list above, executing 
<br />

<br />
glob("[ab]*.php) will return (all of them):
<br />
a.php&nbsp; // [ab] matches 'a', * matches nothing
<br />
aa.php // [ab] matches 'a', * matches 2nd 'a'
<br />
ab.php // [ab] matches 'a', * matches 'b'
<br />
abc.php // [ab] matches 'a', * matches 'bc'
<br />
b.php // [ab] matches 'b', * matches nothing
<br />
bc.php // [ab] matches 'b', * matches 'c'
<br />
bcd.php // [ab] matches 'b', * matches 'cd'
<br />

<br />
glob("[ab].php") will return a.php and b.php
<br />

<br />
glob("[^a]*.php") will return:
<br />
b.php // [^a] matches 'b', * matches nothing
<br />
bc.php // [^a] matches 'b', * matches 'c'
<br />
bcd.php // [^a] matches 'b', * matches 'cd'
<br />

<br />
glob("[^ab]*.php") will return nothing because the character class will fail to match on the first character. 
<br />

<br />
You can also use ranges of characters inside the character class by having a starting and ending character with a hyphen in between.&nbsp; For example, [a-z] will match any letter between a and z, [0-9] will match any (one) number, etc.. 
<br />

<br />
glob also supports limited alternation with {n1, n2, etc..}.&nbsp; You have to specify GLOB_BRACE as the 2nd argument for glob in order for it to work.&nbsp; So for example, if you executed glob("{a,b,c}.php", GLOB_BRACE) on the following list of files:
<br />

<br />
a.php
<br />
b.php
<br />
c.php
<br />

<br />
all 3 of them would return.&nbsp; Note: using alternation with single characters like that is the same thing as just doing glob("[abc].php").&nbsp; A more interesting example would be glob("te{xt,nse}.php", GLOB_BRACE) on:
<br />

<br />
tent.php
<br />
text.php
<br />
test.php
<br />
tense.php
<br />

<br />
text.php and tense.php would be returned from that glob.
<br />

<br />
glob's regex does not offer any kind of quantification of a specified character or character class or alternation.&nbsp; For instance, if you have the following files:
<br />

<br />
a.php
<br />
aa.php
<br />
aaa.php
<br />
ab.php
<br />
abc.php
<br />
b.php
<br />
bc.php
<br />

<br />
with pcre regex you can do ~^a+\.php$~ to return 
<br />

<br />
a.php
<br />
aa.php
<br />
aaa.php
<br />

<br />
This is not possible with glob.&nbsp; If you are trying to do something like this, you can first narrow it down with glob, and then get exact matches with a full flavored regex engine.&nbsp; For example, if you wanted all of the php files in the previous list that only have one or more 'a' in it, you can do this:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; $list </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"a*.php"</span><span class="keyword">);
<br />
&nbsp;&nbsp; foreach (</span><span class="default">$list </span><span class="keyword">as </span><span class="default">$l</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"~^a+\.php$~"</span><span class="keyword">,</span><span class="default">$file</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$l</span><span class="keyword">;
<br />
&nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
glob also does not support lookbehinds, lookaheads, atomic groupings, capturing, or any of the 'higher level' regex functions.
<br />

<br />
glob does not support 'shortkey' meta-characters like \w or \d.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86425""></a>
  <div class="note">
   <strong class="user">carlos dot lage at nospam at foo dot bar at gmail dot com</strong>
   <a href="#86425" class="date">18-Oct-2008 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I lost hours looking for the solution for this problem.<br />
glob() wasn't eating up my directory names (stuff like "foobar[]"), and I searched online for some hours, I tried preg_quote to no avail.<br />
<br />
I finally found the proper way to escape stuff in glob() in an obscure Python mailing list:<br />
<br />
<span class="default">&lt;?php <br />
preg_replace</span><span class="keyword">(</span><span class="string">'/(\*|\?|\[)/'</span><span class="keyword">, </span><span class="string">'[$1]'</span><span class="keyword">, </span><span class="default">$dir_path</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
If you want to add a directory path before your pattern, you should do it like this:<br />
<br />
<span class="default">&lt;?php<br />
glob</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(\*|\?|\[)/'</span><span class="keyword">, </span><span class="string">'[$1]'</span><span class="keyword">, </span><span class="default">$dir_path</span><span class="keyword">).</span><span class="string">'*.txt'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>preg_quote WILL NOT work in all cases (if any).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85263""></a>
  <div class="note">
   <strong class="user">vidmantas dot norkus at neo dot lt</strong>
   <a href="#85263" class="date">22-Aug-2008 03:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My version of recursive glob<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">all_files</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= Array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file_tmp</span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'*'</span><span class="keyword">,</span><span class="default">GLOB_MARK </span><span class="keyword">| </span><span class="default">GLOB_NOSORT</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$file_tmp </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">)!=</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[] = </span><span class="default">$item</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">,</span><span class="default">all_files</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$files</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83287""></a>
  <div class="note">
   <strong class="user">heavyraptor at gmail dot com</strong>
   <a href="#83287" class="date">19-May-2008 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
glob() (array_sum() and array_map() in fact too) can be very useful if you want to calculate the sum of all the files' sizes located in a directory:<br />
<br />
<span class="default">&lt;?php<br />
$bytes </span><span class="keyword">= </span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'filesize'</span><span class="keyword">,</span><span class="default">glob</span><span class="keyword">(</span><span class="string">'*'</span><span class="keyword">)));<br />
</span><span class="default">?&gt;<br />
</span><br />
Unfortunately there's no way to do this recursively, using glob() (as far as I know).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82744""></a>
  <div class="note">
   <strong class="user">pope at q dot com</strong>
   <a href="#82744" class="date">24-Apr-2008 03:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
alan at ridersite dot org 18-Mar-2007 03:26 -- Stated '*.*' is the same as '*' -- This is not true as * alone will return directories too and *.* will only return files with an extension such as .pdf or .doc or .php.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82539""></a>
  <div class="note">
   <strong class="user">alan at synergymx dot com</strong>
   <a href="#82539" class="date">15-Apr-2008 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function that returns specific files in an array, with all of the details. Includes some basic garbage checking.<br />
<br />
Variables<br />
<br />
$source_folder // the location of your files<br />
$ext // file extension you want to limit to (i.e.: *.txt)<br />
$sec // if you only want files that are at least so old.<br />
<br />
The function<br />
<br />
function glob_files($source_folder, $ext, $sec, $limit){<br />
&nbsp;&nbsp;&nbsp; if( !is_dir( $source_folder ) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; die ( "Invalid directory.\n\n" );<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $FILES = glob($source_folder."\*.".$ext);<br />
&nbsp;&nbsp;&nbsp; $set_limit&nbsp; &nbsp; = 0;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach($FILES as $key =&gt; $file) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( $set_limit == $limit )&nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( filemtime( $file ) &gt; $sec ){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $FILE_LIST[$key]['path']&nbsp; &nbsp; = substr( $file, 0, ( strrpos( $file, "\\" ) +1 ) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $FILE_LIST[$key]['name']&nbsp; &nbsp; = substr( $file, ( strrpos( $file, "\\" ) +1 ) );&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $FILE_LIST[$key]['size']&nbsp; &nbsp; = filesize( $file );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $FILE_LIST[$key]['date']&nbsp; &nbsp; = date('Y-m-d G:i:s', filemtime( $file ) );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $set_limit++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(!empty($FILE_LIST)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $FILE_LIST;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; die( "No files found!\n\n" );<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
So....<br />
<br />
$source_folder = "c:\temp\my_videos";<br />
$ext = "flv"; // flash video files<br />
$sec = "7200"; // files older than 2 hours<br />
$limit = 2;<br />
<br />
print_r(glob_files($source_folder, $ext, $sec, $limit));<br />
<br />
Would return:<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [path] =&gt; c:\temp\my_videos\<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; fluffy_bunnies.flv<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 21160480<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [date] =&gt; 2007-10-30 16:48:05<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [path] =&gt; c:\temp\my_videos\<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [name] =&gt; synergymx.com.flv<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [size] =&gt; 14522744<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [date] =&gt; 2007-10-25 15:34:45<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82455""></a>
  <div class="note">
   <strong class="user">eric at muyser dot com</strong>
   <a href="#82455" class="date">11-Apr-2008 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As a follow up to recursively determining all paths (by viajy at yoyo dot org) and opendir being faster than glob (by Sam Yong - hellclanner at live [dot] com).<br />
<br />
The list all dirs code didn't seem to work, at least on my server (provided by parazuce [at] gmail [dot] com).<br />
<br />
I needed a function to create an unlimited multidimensional array, with the names of the folders/files intact (no realpath's, although that is easily possible). This is so I can simply loop through the array, create an expandable link on the folder name, with all the files inside it.<br />
<br />
This is the correct way to recurse I believe (no static, return small arrays to build up the multidimensional array), and includes a check for files/folders beginning with dots.<br />
<br />
// may need modifications<br />
<br />
function list_files($path)<br />
{<br />
&nbsp;&nbsp;&nbsp; $files = array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(is_dir($path))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if($handle = opendir($path))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(($name = readdir($handle)) !== false)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!preg_match("#^\.#", $name))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(is_dir($path . "/" . $name))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $files[$name] = list_files($path . "/" . $name);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $files[] = $name;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; closedir($handle);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return $files;<br />
}<br />
<br />
print_r(list_files("/path/to/folder"));<br />
<br />
// example usage<br />
<br />
function list_html($list)<br />
{<br />
&nbsp;&nbsp;&nbsp; $html = "";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach($list as $folder =&gt; $file)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(is_array($list[$folder]))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $html .= "&gt; (folder) " . $folder . "&lt;br&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $html .= list_html($list[$folder]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $html .= " (file) " . $file . "&lt;br&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return $html;<br />
}<br />
<br />
echo list_html(list_files("/path/to/folder"));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82182""></a>
  <div class="note">
   <strong class="user">parazuce [at] gmail [dot] com</strong>
   <a href="#82182" class="date">31-Mar-2008 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As a response to a post by viajy at yoyo dot org on 10-Feb-2007 04:50, he posted the following code:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">listdirs</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; static </span><span class="default">$alldirs </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'/*'</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$dirs</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$d</span><span class="keyword">) </span><span class="default">$alldirs</span><span class="keyword">[] = </span><span class="default">$d</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$dirs </span><span class="keyword">as </span><span class="default">$dir</span><span class="keyword">) </span><span class="default">listdirs</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$alldirs</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It is not best practice to use recursive functions like that, so I wrote a safe (non-recursive) function below:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">listdirs_safe</span><span class="keyword">(</span><span class="default">$start</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir&nbsp; </span><span class="keyword">= </span><span class="default">$start</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dirs </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$next </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">true</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_dirs </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/*'</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$_dirs</span><span class="keyword">) &gt; </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$_dirs </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$_dir</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dirs</span><span class="keyword">[] = </span><span class="default">$_dir</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">= </span><span class="default">$dirs</span><span class="keyword">[</span><span class="default">$next</span><span class="keyword">++];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$dirs</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example:<br />
<br />
print_r(listdirs_safe('*'));<br />
<br />
Output:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; Dummy folder/Dummy folder 2<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; Dummy folder/Dummy folder 2/Dummy Folder 3<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; Dummy folder/Dummy folder 2/Dummy Folder 3/4<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; Dummy folder/Dummy folder 2/Dummy Folder 3/Dummy folder 4<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; Dummy folder/Dummy folder 2/Dummy Folder 3/4/5<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81510""></a>
  <div class="note">
   <strong class="user">bisqwit at iki dot fi</strong>
   <a href="#81510" class="date">02-Mar-2008 12:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Pomle.com wrote:<br />
&gt; Here's a function that behaves as a recursive glob(). It does<br />
&gt; rely on shell command find, but works like a charm.<br />
&gt; function glob_rec($pattern, $path) {<br />
&gt;&nbsp; &nbsp; return explode("\n", shell_exec("find $path -name $pattern"));<br />
&gt; }<br />
<br />
Do note that this command has a security hole.<br />
If the $path or $pattern given includes special characters, for example a command substitution such as "`rm index.php`", the shell will process it and execute that command.<br />
<br />
You can fix the problem by either escaping the characters properly (use shell_escape) or by writing a function that actually calls glob(), or opendir()/readdir()/closedir(), recursively.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79231""></a>
  <div class="note">
   <strong class="user">sean at syosoft dot com</strong>
   <a href="#79231" class="date">16-Nov-2007 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Run your directory + "file pattern" through preg_quote to get around [ ] / etc issues...glob uses pattern matching.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76621""></a>
  <div class="note">
   <strong class="user">josh at servebyte dot com</strong>
   <a href="#76621" class="date">23-Jul-2007 02:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To:&nbsp; martinlarsen at bigfoot dot com (14-Jun-2007 01:13)<br />
<br />
[quote]<br />
glob() does not work if the path contains brackets "[" and "]".<br />
<br />
For example, this will make it fail:<br />
<br />
$files = glob("[myfolder]/*.txt");<br />
<br />
No error is returned, just an empty array!<br />
[/quote]<br />
<br />
Hi there,<br />
if you backslash the brackets, it should work. Try:<br />
$files = glob("\[myfolder\]/*.txt");<br />
Hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76499""></a>
  <div class="note">
   <strong class="user">Sam Yong - hellclanner at live [dot] com</strong>
   <a href="#76499" class="date">18-Jul-2007 02:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An alternative to this glob function. Like what edogs [at] dogsempire.com said, opendir should be faster than glob. I have not tested timing for this function but it works perfectly for me on my PHP v5.2.2 server.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$_foo </span><span class="keyword">=</span><span class="string">'/server/public_html/path/'</span><span class="keyword">;<br />
<br />
function </span><span class="default">s_glob</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">){<br />
</span><span class="default">$files </span><span class="keyword">= array();<br />
if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$dh</span><span class="keyword">=</span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; while((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$dh</span><span class="keyword">)) !== </span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$files</span><span class="keyword">[]=</span><span class="default">$dir</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }}<br />
}<br />
return </span><span class="default">$files</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">s_glob</span><span class="keyword">(</span><span class="default">$_foo</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
This function returns an empty array if no files are found in the directory or the path specified is not a directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75752""></a>
  <div class="note">
   <strong class="user">martinlarsen at bigfoot dot com</strong>
   <a href="#75752" class="date">14-Jun-2007 02:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
glob() does not work if the path contains brackets "[" and "]".<br />
<br />
For example, this will make it fail:<br />
<br />
$files = glob("[myfolder]/*.txt");<br />
<br />
No error is returned, just an empty array!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74996""></a>
  <div class="note">
   <strong class="user">nataxia at gmail dot com</strong>
   <a href="#74996" class="date">08-May-2007 01:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Something I used to sort dir &amp; subdir into array (multidimensional) reflecting dir structure.<br />
<br />
&nbsp;&nbsp;&nbsp; function getRecursiveFolderList($curDir,$currentA=false) <br />
&nbsp;&nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dirs = glob($curDir . '/*', GLOB_ONLYDIR);&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $cur = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach($dirs as $dir)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $currentA[$cur]['path'] = $dir;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $currentA[$cur] = $this-&gt;getRecursiveFolderList($dir,$currentA[$cur]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ++$cur;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $currentA;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74109""></a>
  <div class="note">
   
   <a href="#74109" class="date">25-Mar-2007 05:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Reply to ny_obaATgmxDOTnet:<br />
<br />
You could also use sql_regcase() to build a pattern for case insensitive matches.<br />
You may also want to set the locale before, so it is used when building the pattern.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$pattern </span><span class="keyword">= </span><span class="default">sql_case</span><span class="keyword">(</span><span class="string">"*.pdf"</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
should therefore match file.pdf AND OtherFile.PDF<br />
<br />
See <a href="http://www.php.net/sql_regcase for more information." rel="nofollow" target="_blank">http://www.php.net/sql_regcase for more information.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73967""></a>
  <div class="note">
   <strong class="user">alan at ridersite dot org</strong>
   <a href="#73967" class="date">18-Mar-2007 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A couple of notes: <br />
glob() handles symbolic filesystem links and resolves references to './', '../'&nbsp; nicely and handles an extra '/' character , at least on X-systems. e.g., glob("../*") will do next higher dir.<br />
<br />
This is good to use so warnings or errors show as "../foo" and not your system's full path.&nbsp; <br />
<br />
Several of the examples use a notation "*.*" when just plain "*" does the same thing.&nbsp; The "*.*" notation is misleading as it implies foo.ext will not be found with "*" because the "." is not present.<br />
<br />
Watch the flags must not be strings. They are defined constants. Thus, <br />
glob("../*", GLOB_ONLYDIR)&nbsp; works; <br />
glob("../*", "GLOB_ONLYDIR")&nbsp; does not.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73145""></a>
  <div class="note">
   <strong class="user">viajy at yoyo dot org</strong>
   <a href="#73145" class="date">10-Feb-2007 01:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this is a recursive function i wrote to return an array of all subdirectories of a dir<br />
<br />
function listdirs($dir) {<br />
&nbsp;&nbsp;&nbsp; static $alldirs = array();<br />
&nbsp;&nbsp;&nbsp; $dirs = glob($dir . '/*', GLOB_ONLYDIR);<br />
&nbsp;&nbsp;&nbsp; if (count($dirs) &gt; 0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($dirs as $d) $alldirs[] = $d;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; foreach ($dirs as $dir) listdirs($dir);<br />
&nbsp;&nbsp;&nbsp; return $alldirs;<br />
}<br />
<br />
example: <br />
print_r(listdirs('/some/path'));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71531""></a>
  <div class="note">
   <strong class="user">lesion at autistici dot org</strong>
   <a href="#71531" class="date">04-Dec-2006 05:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Maybe all of you still know this, but it seems that if the directory contains some unresolved symlink, glob() simply ignore those files.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71327""></a>
  <div class="note">
   <strong class="user">torch at torchsdomain dot com</strong>
   <a href="#71327" class="date">22-Nov-2006 09:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is simple function that will find and remove all files (except "." ones) that match the expression ($match, "*" as wildcard) under starting directory ($path) and all other directories under it.
<br />

<br />
function rfr($path,$match){
<br />
&nbsp;&nbsp; static $deld = 0, $dsize = 0;
<br />
&nbsp;&nbsp; $dirs = glob($path."*");
<br />
&nbsp;&nbsp; $files = glob($path.$match);
<br />
&nbsp;&nbsp; foreach($files as $file){
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(is_file($file)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $dsize += filesize($file);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; unlink($file);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $deld++;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; foreach($dirs as $dir){
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(is_dir($dir)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $dir = basename($dir) . "/";
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; rfr($path.$dir,$match);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; return "$deld files deleted with a total size of $dsize bytes";
<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70544""></a>
  <div class="note">
   <strong class="user">guilleva at gmail dot com</strong>
   <a href="#70544" class="date">20-Oct-2006 05:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In some systems (AIX for example) GLOB_BRACE isn't defined and you get the error:<br />
glob() expects parameter 2 to be long, string given in /XX/XX.php<br />
<br />
&lt;?<br />
<br />
foreach (glob("{*.pdf,*.PDF}",GLOB_BRACE ) as $filename) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "$filename \n";<br />
}<br />
<br />
?&gt;<br />
<br />
The method may help you in this case.<br />
<br />
&lt;?<br />
<br />
foreach (array_merge(glob("*.pdf"),glob("*.PDF")) as $filename) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo "$filename \n";<br />
}<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68939""></a>
  <div class="note">
   <strong class="user">joseph dot morphy at gmail dot com</strong>
   <a href="#68939" class="date">16-Aug-2006 08:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
$html_array </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"*.html"</span><span class="keyword">);<br />
<br />
function </span><span class="default">sort_by_mtime</span><span class="keyword">(</span><span class="default">$file1</span><span class="keyword">,</span><span class="default">$file2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time1 </span><span class="keyword">= </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$file1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$time2 </span><span class="keyword">= </span><span class="default">filemtime</span><span class="keyword">(</span><span class="default">$file2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$time1 </span><span class="keyword">== </span><span class="default">$time2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$time1 </span><span class="keyword">&lt; </span><span class="default">$time2</span><span class="keyword">) ? </span><span class="default">1 </span><span class="keyword">: -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">usort</span><span class="keyword">(</span><span class="default">$html_array</span><span class="keyword">,</span><span class="string">"sort_by_mtime"</span><span class="keyword">);<br />
</span><span class="comment">//$html_array is now ordered by the time it was last modified<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68869""></a>
  <div class="note">
   <strong class="user">redcube at gmx dot de</strong>
   <a href="#68869" class="date">14-Aug-2006 11:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The answer for the difference in the dirsize function of "management at twilightus dot net":<br />
<br />
glob('*') ignores all 'hidden' files by default. This means it does not return files that start with a dot (e.g. ".file").<br />
If you want to match those files too, you can use "{,.}*" as the pattern with the GLOB_BRACE flag.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Search for all files that match .* or *<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">'{,.}*'</span><span class="keyword">, </span><span class="default">GLOB_BRACE</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Note: This also returns the directory special entries . and ..</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68790""></a>
  <div class="note">
   <strong class="user">management at twilightus dot net</strong>
   <a href="#68790" class="date">10-Aug-2006 09:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was making a directory filesize function but found there's a slight difference between glob and readdir in terms of getting sizes.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">dirsize_glob</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">.= (!</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">'/$'</span><span class="keyword">, </span><span class="default">$dir</span><span class="keyword">)) ? </span><span class="string">'/' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="string">'*'</span><span class="keyword">) as </span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">+= (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)) ? </span><span class="default">dirsize_glob</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">) : </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$size</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">dirsize_readdir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dir </span><span class="keyword">.= (!</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">'/$'</span><span class="keyword">, </span><span class="default">$dir</span><span class="keyword">)) ? </span><span class="string">'/' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)) !== </span><span class="default">FALSE</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">'^\.{1,2}$'</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">+= (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">)) ? </span><span class="default">dirsize_readdir</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">) : </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$dir </span><span class="keyword">. </span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$size</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
For a directory that's 529216 bytes, readdir correctly gives 529216 while glob gives 528996, a difference of 220 bytes. Anyone know why there's such a difference?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68238""></a>
  <div class="note">
   <strong class="user">okumurya at hotmail dot com</strong>
   <a href="#68238" class="date">19-Jul-2006 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
4.3.8 and 4.4.2 has incompatible behavior.<br />
If there is no glob result, 4.4.2 return empty array but 4.3.8 returns FALSE.<br />
<br />
code:<br />
<span class="default">&lt;?php<br />
$a </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">'hoge'</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
result at 4.3.8:<br />
&nbsp;bool(false)<br />
<br />
result at 4.4.2:<br />
&nbsp;array(0) {<br />
&nbsp;}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="67284""></a>
  <div class="note">
   <strong class="user">c_windows_temp at hotmail dot com</strong>
   <a href="#67284" class="date">07-Jun-2006 01:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this function does not list broken symbolic links.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60421""></a>
  <div class="note">
   <strong class="user">info at urbits dot com</strong>
   <a href="#60421" class="date">06-Jan-2006 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have been working towards a CMS-type design that is both modular and quite flat. For example, included files are all one level below the installation folder.<br />
<br />
glob() just help me get rid of a lot of opendir() hassle. I wasn't sure if the double asterix would work - but it's fine:<br />
<br />
foreach (glob(SERVER_PATH."/*/includes/*.php") as $inc) {<br />
&nbsp;&nbsp; require($inc);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59000""></a>
  <div class="note">
   <strong class="user">admiral [at] nuclearpixel [dot] com</strong>
   <a href="#59000" class="date">23-Nov-2005 05:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've written a function that I've been using quite a lot over the past year or so. I've built whole websites and their file based CMSs based on this one function, mostly because (I think) databases are not as portable as groups of files and folders. In previous versions, I used opendir and readdir to get contents, but now I can do in one line what used to take several. How? Most of the work in the whole script is done by calling<br />
<br />
glob("$dir/*")<br />
<br />
Giving me an array containing the names of the items in the folder, minus the ones beginning with '.', as well as the ones I specify.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/* alpharead version 3: This function returns an array containing the names of the files inside any given folder, excluding files that start with a '.', as well as the filenames listed in the '$killit' array. This array is sorted using the 'natural alphabetical' sorting manner. If no input is given to the function, it lists items in the script's interpreted folder. Version 3 fixes a MAJOR bug in version 2 which corrupted certain arrays with greater than 5 keys and one of the supposedly removed filenames.<br />
written by Admiral at NuclearPixel.com */<br />
<br />
</span><span class="keyword">function </span><span class="default">alpharead3</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">){<br />
if(!</span><span class="default">$dir</span><span class="keyword">){</span><span class="default">$dir </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">;}<br />
foreach(</span><span class="default">glob</span><span class="keyword">(</span><span class="string">"</span><span class="default">$dir</span><span class="string">/*"</span><span class="keyword">) as </span><span class="default">$item</span><span class="keyword">){</span><span class="default">$sort</span><span class="keyword">[]= </span><span class="default">end</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$item</span><span class="keyword">));}<br />
<br />
</span><span class="default">$killit </span><span class="keyword">= array(</span><span class="string">'index.html'</span><span class="keyword">, </span><span class="string">'index.php'</span><span class="keyword">, </span><span class="string">'thumbs.db'</span><span class="keyword">, </span><span class="string">'styles.css'</span><span class="keyword">);<br />
</span><span class="default">$killcounter </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
foreach(</span><span class="default">$sort </span><span class="keyword">as </span><span class="default">$sorteditem</span><span class="keyword">){<br />
foreach(</span><span class="default">$killit </span><span class="keyword">as </span><span class="default">$killcheck</span><span class="keyword">){<br />
if(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$sorteditem</span><span class="keyword">) == </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$killcheck</span><span class="keyword">))<br />
{unset(</span><span class="default">$sort</span><span class="keyword">[</span><span class="default">$killcounter</span><span class="keyword">]);}<br />
}</span><span class="default">$killcounter</span><span class="keyword">++;}<br />
if(</span><span class="default">$sort</span><span class="keyword">){</span><span class="default">natsort</span><span class="keyword">(</span><span class="default">$sort</span><span class="keyword">);}<br />
foreach(</span><span class="default">$sort </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">){</span><span class="default">$return</span><span class="keyword">[]= </span><span class="default">$item</span><span class="keyword">;}<br />
<br />
if(!</span><span class="default">$return</span><span class="keyword">){return array();}<br />
return </span><span class="default">$return</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//some basic usage<br />
<br />
</span><span class="default">$folder </span><span class="keyword">= </span><span class="string">'images'</span><span class="keyword">;<br />
foreach(</span><span class="default">alpharead3</span><span class="keyword">(</span><span class="default">$folder</span><span class="keyword">) as </span><span class="default">$item</span><span class="keyword">)<br />
{<br />
echo </span><span class="string">'&lt;img src="'</span><span class="keyword">.</span><span class="default">$folder</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$item</span><span class="keyword">.</span><span class="string">'"&gt;&lt;br&gt;'</span><span class="keyword">.</span><span class="default">$item</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Commens on this function are welcome!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57506""></a>
  <div class="note">
   <strong class="user">Jacob Eisenberg</strong>
   <a href="#57506" class="date">06-Oct-2005 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that on Windows, glob distinguishes between uppercase and lowercase extensions, so if the directory contains a file "test.txt" and you glob for "*.TXT" then the file will not be found!<br />
That bug only happens when you use patterns containing "*", like the example above. If you for example search for the full filename "test.TXT" then everything works correctly.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56231""></a>
  <div class="note">
   <strong class="user">DMan</strong>
   <a href="#56231" class="date">28-Aug-2005 09:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Whilst on Windows, a path starting with a slash resolves OK for most file functions - but NOT glob. <br />
If the server is LAUNCHED (or chdir()ed) to W:, then <br />
file_exists("/temp/test.txt")<br />
returns true for the file "W:/temp/test.txt".<br />
But glob("/temp/*.txt") FAILS to find it!<br />
<br />
A solution (if you want to avoid getting drive letters into your code) is to chdir() first, then just look for the file.<br />
<span class="default">&lt;?php<br />
$glob</span><span class="keyword">=</span><span class="string">"/temp/*.txt"</span><span class="keyword">;<br />
</span><span class="default">chdir</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$glob</span><span class="keyword">));<br />
</span><span class="comment">// getcwd() is now actually "W:\temp" or whatever<br />
<br />
</span><span class="keyword">foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$glob</span><span class="keyword">)) as </span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; </span><span class="default">$filepath </span><span class="keyword">= </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$glob</span><span class="keyword">).</span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">; </span><span class="comment">// must re-attach full path<br />
&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"</span><span class="default">$filepath</span><span class="string"> size " </span><span class="keyword">. </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$filepath</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Note also, glob() IS case sensitive although most other file funcs on Windows are not.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54519""></a>
  <div class="note">
   <strong class="user">x_terminat_or_3 at yahoo dot country:fr</strong>
   <a href="#54519" class="date">07-Jul-2005 12:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a replacement for glob on servers that are running a php version &lt; 4.3<br />
<br />
It supports * and ? jokers, and stacking of parameters with ;&nbsp; <br />
<br />
So you can do <br />
<br />
&lt;? $results=glob('/home/user/*.txt;*.doc') ?&gt;<br />
<br />
And it will return an array of matched files.&nbsp; <br />
<br />
As is the behaviour of the built-in glob function, this one will also return boolean false if no matches are found, and will use the current working directory if none is specified.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if(!(</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'glob'</span><span class="keyword">)))<br />
{function </span><span class="default">glob</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">)<br />
&nbsp;{</span><span class="comment">#get pathname (everything up until the last / or \)<br />
&nbsp; </span><span class="default">$path</span><span class="keyword">=</span><span class="default">$output</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">;<br />
&nbsp; if(</span><span class="default">PHP_OS</span><span class="keyword">==</span><span class="string">'WIN32'</span><span class="keyword">)<br />
&nbsp;&nbsp; </span><span class="default">$slash</span><span class="keyword">=</span><span class="string">'\\'</span><span class="keyword">;<br />
&nbsp; else<br />
&nbsp;&nbsp; </span><span class="default">$slash</span><span class="keyword">=</span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$lastpos</span><span class="keyword">=</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$slash</span><span class="keyword">);<br />
&nbsp; if(!(</span><span class="default">$lastpos</span><span class="keyword">===</span><span class="default">false</span><span class="keyword">))<br />
&nbsp; {</span><span class="default">$path</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,-</span><span class="default">$lastpos</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">); </span><span class="comment">#negative length means take from the right<br />
&nbsp;&nbsp; </span><span class="default">$pattern</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$lastpos</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; else<br />
&nbsp; {</span><span class="comment">#no dir info, use current dir<br />
&nbsp;&nbsp; </span><span class="default">$path</span><span class="keyword">=</span><span class="default">getcwd</span><span class="keyword">();<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$handle</span><span class="keyword">=@ </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp; if(</span><span class="default">$handle</span><span class="keyword">===</span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; while(</span><span class="default">$dir</span><span class="keyword">=</span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))<br />
&nbsp; {if(</span><span class="default">pattern_match</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$dir</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[]=</span><span class="default">$dir</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">))<br />
&nbsp;&nbsp; return </span><span class="default">$output</span><span class="keyword">;<br />
&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;}<br />
<br />
&nbsp;function </span><span class="default">pattern_match</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">)<br />
&nbsp;{</span><span class="comment">#basically prepare a regular expression<br />
&nbsp; </span><span class="default">$out</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$chunks</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">';'</span><span class="keyword">,</span><span class="default">$pattern</span><span class="keyword">);<br />
&nbsp; foreach(</span><span class="default">$chunks </span><span class="keyword">as </span><span class="default">$pattern</span><span class="keyword">)<br />
&nbsp; {</span><span class="default">$escape</span><span class="keyword">=array(</span><span class="string">'$'</span><span class="keyword">,</span><span class="string">'^'</span><span class="keyword">,</span><span class="string">'.'</span><span class="keyword">,</span><span class="string">'{'</span><span class="keyword">,</span><span class="string">'}'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'('</span><span class="keyword">,</span><span class="string">')'</span><span class="keyword">,</span><span class="string">'['</span><span class="keyword">,</span><span class="string">']'</span><span class="keyword">,</span><span class="string">'|'</span><span class="keyword">);<br />
&nbsp;&nbsp; while(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="string">'**'</span><span class="keyword">)!==</span><span class="default">false</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pattern</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'**'</span><span class="keyword">,</span><span class="string">'*'</span><span class="keyword">,</span><span class="default">$pattern</span><span class="keyword">);<br />
&nbsp;&nbsp; foreach(</span><span class="default">$escape </span><span class="keyword">as </span><span class="default">$probe</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pattern</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$probe</span><span class="keyword">,</span><span class="string">"\\</span><span class="default">$probe</span><span class="string">"</span><span class="keyword">,</span><span class="default">$pattern</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$pattern</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'?*'</span><span class="keyword">,</span><span class="string">'*'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'*?'</span><span class="keyword">,</span><span class="string">'*'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'*'</span><span class="keyword">,</span><span class="string">".*"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'?'</span><span class="keyword">,</span><span class="string">'.{1,1}'</span><span class="keyword">,</span><span class="default">$pattern</span><span class="keyword">))));<br />
&nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[]=</span><span class="default">$pattern</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; if(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">)==</span><span class="default">1</span><span class="keyword">)<br />
&nbsp;&nbsp; return(</span><span class="default">eregi</span><span class="keyword">(</span><span class="string">"^</span><span class="default">$out</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]</span><span class="string">$"</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">));<br />
&nbsp; else<br />
&nbsp;&nbsp; foreach(</span><span class="default">$out </span><span class="keyword">as </span><span class="default">$tester</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">eregi</span><span class="keyword">(</span><span class="string">"^</span><span class="default">$tester</span><span class="string">$"</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This function is case insensitive, but if needed, you can do this to make it behave depending on os:<br />
<br />
* replace eregi in the example with my_regexp<br />
<br />
add this function<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">my_regexp</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$probe</span><span class="keyword">)<br />
{</span><span class="default">$sensitive</span><span class="keyword">=(</span><span class="default">PHP_OS</span><span class="keyword">!=</span><span class="string">'WIN32'</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$sensitive</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;<br />
&nbsp;return (</span><span class="default">$sensitive</span><span class="keyword">?<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">ereg</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$probe</span><span class="keyword">):<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">eregi</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">,</span><span class="default">$probe</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51582""></a>
  <div class="note">
   <strong class="user">Deviant</strong>
   <a href="#51582" class="date">05-Apr-2005 01:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A slight edit on the globr() function stated by sthomas. This does exactly the same just works on windows systems for &lt; PHP 4.3.3. :<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">globr</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">, </span><span class="default">$sPattern</span><span class="keyword">, </span><span class="default">$nFlags </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aFiles </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"</span><span class="default">$sDir</span><span class="string">/</span><span class="default">$sPattern</span><span class="string">"</span><span class="keyword">, </span><span class="default">$nFlags</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$files </span><span class="keyword">= </span><span class="default">getDir</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$files </span><span class="keyword">as </span><span class="default">$file </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aSubFiles </span><span class="keyword">= </span><span class="default">globr</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$sPattern</span><span class="keyword">, </span><span class="default">$nFlags</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aFiles </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$aFiles</span><span class="keyword">,</span><span class="default">$aSubFiles</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$aFiles</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">getDir</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$rContents </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">$sNode </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$rContents</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$sNode </span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$sNode </span><span class="keyword">!=</span><span class="string">"." </span><span class="keyword">&amp;&amp; </span><span class="default">$sNode </span><span class="keyword">!=</span><span class="string">".."</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aDirs</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$sDir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$sNode </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$aDirs</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51228""></a>
  <div class="note">
   <strong class="user">fraggy(AT)chello.nl</strong>
   <a href="#51228" class="date">24-Mar-2005 12:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
glob caused me some real pain in the buttom on windows, because of the DOS thing with paths (backslashes instead of slashes)...<br />
<br />
This was my own fault because I "forgot" that the backslash, when used in strings, needs to be escaped, but well, it can cause a lot of confusion, even for people who are not exactly newbies anymore...<br />
<br />
For some reason, I didn't have this problem with other file operations (chdir, opendir, etc...), which was the most confusing of all...<br />
<br />
So, for people running scripts on Windows machines (Dos95, 98 or WinNT or DosXP), just remember this:<br />
<br />
glob('c:\temp\*.*'); // works correctly, returns an array with files.<br />
glob("c:\temp\*.*"); // does NOT work... the backslashes need to be escaped...<br />
glob("c:\\temp\\*.*"); // that works again...<br />
<br />
This is especially confusing when temporary writable directories are returned as an unescaped string.<br />
<br />
$tempdir = getenv('TEMP');<br />
// this returns "C:\DOCUME~1\user\LOCALS~1\Temp"<br />
so in order to scan that directoy I need to do:<br />
<br />
glob($tempdir . "\\*.*");<br />
<br />
Or perhaps it's easier to replace all backslashes with slashes in order to avoid these kinds of confusions...<br />
<br />
glob("c:/temp/*.*"); // works fine too...<br />
<br />
I know I'm not contributing anything new here, but I just hope this post may avoid some unnecessary headaches...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50960""></a>
  <div class="note">
   <strong class="user">NOSPAM sketch at infinite dot net dot au</strong>
   <a href="#50960" class="date">15-Mar-2005 02:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
in the example below, i found i got an error if the directory was empty.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="string">"*.txt"</span><span class="keyword">) as </span><span class="default">$filename</span><span class="keyword">) {
<br />
&nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$filename</span><span class="string"> size " </span><span class="keyword">. </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
I think its because glob()'ing an empty directory returns false, and so calling foreach (false as $value) will obviously break.
<br />

<br />
to fix this, i did the following:
<br />
<span class="default">&lt;?php
<br />
$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"*.txt) or array(); // give it an empty array if the directory is empty or glob fails otherwise
<br />
&nbsp;&nbsp; echo "</span><span class="default">$filename size </span><span class="string">" . filesize(</span><span class="default">$filename</span><span class="string">) . "</span><span class="keyword">\</span><span class="default">n</span><span class="string">";
<br />
}
<br />
?&gt;
<br />

<br />
Hope this helps someone</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49483""></a>
  <div class="note">
   
   <a href="#49483" class="date">29-Jan-2005 11:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware...<br />
<br />
On Windows you need to add "/" mark:<br />
<span class="default">&lt;?php<br />
$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"/dir/*.txt"</span><span class="keyword">); </span><span class="comment">// Works properly.<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"dir/*.txt"</span><span class="keyword">); </span><span class="comment">// Failure!, first letter is missing on every filename!<br />
</span><span class="default">?&gt;<br />
</span><br />
On Unix you cant add the "/" mark:<br />
<span class="default">&lt;?php<br />
$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"dir/*.txt"</span><span class="keyword">); </span><span class="comment">// Works properly.<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"/dir/*.txt"</span><span class="keyword">); </span><span class="comment">// No files found!<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope this will save your time :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49308""></a>
  <div class="note">
   
   <a href="#49308" class="date">23-Jan-2005 10:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The example on this page will generate a warning if the glob function does not find any filenames that match the pattern.
<br />

<br />
The glob function result will only be an array if it finds some files and the foreach statement requires its argument to be an array.
<br />

<br />
By checking for the possibility that the result of the glob function may not be an array you can eliminate the warning.
<br />

<br />
Here's a better example:
<br />

<br />
<span class="default">&lt;?php
<br />
$matches </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"*.txt"</span><span class="keyword">);
<br />
if ( </span><span class="default">is_array </span><span class="keyword">( </span><span class="default">$matches </span><span class="keyword">) ) {
<br />
&nbsp;&nbsp; foreach ( </span><span class="default">$matches </span><span class="keyword">as </span><span class="default">$filename</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">"</span><span class="default">$filename</span><span class="string"> size " </span><span class="keyword">. </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37751""></a>
  <div class="note">
   <strong class="user">Per Lundberg</strong>
   <a href="#37751" class="date">25-Nov-2003 04:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware that on UNIX, * as the pattern will *not* match dot-files and dot-directories.&nbsp; Knowing this will save you some headache.&nbsp; :-)&nbsp; May He bless you.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30238""></a>
  <div class="note">
   <strong class="user">sthomas at townnews dot com</strong>
   <a href="#30238" class="date">12-Mar-2003 12:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* Recursive version of glob
<br />
&nbsp;*
<br />
&nbsp;* @return array containing all pattern-matched files.
<br />
&nbsp;*
<br />
&nbsp;* @param string $sDir&nbsp; &nbsp; &nbsp; Directory to start with.
<br />
&nbsp;* @param string $sPattern&nbsp; Pattern to glob for.
<br />
&nbsp;* @param int $nFlags&nbsp; &nbsp; &nbsp;&nbsp; Flags sent to glob.
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">globr</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">, </span><span class="default">$sPattern</span><span class="keyword">, </span><span class="default">$nFlags </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">)
<br />
{
<br />
&nbsp; </span><span class="default">$sDir </span><span class="keyword">= </span><span class="default">escapeshellcmd</span><span class="keyword">(</span><span class="default">$sDir</span><span class="keyword">);
<br />

<br />
&nbsp; </span><span class="comment">// Get the list of all matching files currently in the
<br />
&nbsp; // directory.
<br />

<br />
&nbsp; </span><span class="default">$aFiles </span><span class="keyword">= </span><span class="default">glob</span><span class="keyword">(</span><span class="string">"</span><span class="default">$sDir</span><span class="string">/</span><span class="default">$sPattern</span><span class="string">"</span><span class="keyword">, </span><span class="default">$nFlags</span><span class="keyword">);
<br />

<br />
&nbsp; </span><span class="comment">// Then get a list of all directories in this directory, and
<br />
&nbsp; // run ourselves on the resulting array.&nbsp; This is the
<br />
&nbsp; // recursion step, which will not execute if there are no
<br />
&nbsp; // directories.
<br />

<br />
&nbsp; </span><span class="keyword">foreach (</span><span class="default">glob</span><span class="keyword">(</span><span class="string">"</span><span class="default">$sDir</span><span class="string">/*"</span><span class="keyword">, </span><span class="default">GLOB_ONLYDIR</span><span class="keyword">) as </span><span class="default">$sSubDir</span><span class="keyword">)
<br />
&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aSubFiles </span><span class="keyword">= </span><span class="default">rglob</span><span class="keyword">(</span><span class="default">$sSubDir</span><span class="keyword">, </span><span class="default">$sPattern</span><span class="keyword">, </span><span class="default">$nFlags</span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="default">$aFiles </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$aFiles</span><span class="keyword">, </span><span class="default">$aSubFiles</span><span class="keyword">);
<br />
&nbsp; }
<br />

<br />
&nbsp; </span><span class="comment">// The array we return contains the files we found, and the
<br />
&nbsp; // files all of our children found.
<br />

<br />
&nbsp; </span><span class="keyword">return </span><span class="default">$aFiles</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27870""></a>
  <div class="note">
   <strong class="user">tmm at aon dot at</strong>
   <a href="#27870" class="date">22-Dec-2002 01:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have written my own function for searching files, but it only supports ? and *
<br />
However it should be easily expandable.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// e.g. $matches=GetMachingFiles(GetContents("."),"*.txt");
<br />
</span><span class="keyword">function </span><span class="default">GetMatchingFiles</span><span class="keyword">(</span><span class="default">$files</span><span class="keyword">, </span><span class="default">$search</span><span class="keyword">) {
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Split to name and filetype
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$baseexp</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$typeexp</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$search</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; } else { 
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$baseexp</span><span class="keyword">=</span><span class="default">$search</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$typeexp</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } 
<br />
&nbsp;&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Escape all regexp Characters 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$baseexp</span><span class="keyword">=</span><span class="default">preg_quote</span><span class="keyword">(</span><span class="default">$baseexp</span><span class="keyword">); 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$typeexp</span><span class="keyword">=</span><span class="default">preg_quote</span><span class="keyword">(</span><span class="default">$typeexp</span><span class="keyword">); 
<br />
&nbsp;&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Allow ? and *
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$baseexp</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">"\*"</span><span class="keyword">,</span><span class="string">"\?"</span><span class="keyword">), array(</span><span class="string">".*"</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">), </span><span class="default">$baseexp</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$typeexp</span><span class="keyword">=</span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">"\*"</span><span class="keyword">,</span><span class="string">"\?"</span><span class="keyword">), array(</span><span class="string">".*"</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">), </span><span class="default">$typeexp</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Search for Matches
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$filename</span><span class="keyword">=</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else { 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$base</span><span class="keyword">=</span><span class="default">$filename</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$type</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^"</span><span class="keyword">.</span><span class="default">$baseexp</span><span class="keyword">.</span><span class="string">"$/i"</span><span class="keyword">,</span><span class="default">$base</span><span class="keyword">) &amp;&amp; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/^"</span><span class="keyword">.</span><span class="default">$typeexp</span><span class="keyword">.</span><span class="string">"$/i"</span><span class="keyword">,</span><span class="default">$type</span><span class="keyword">))&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]=</span><span class="default">$file</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$matches</span><span class="keyword">;
<br />
}
<br />

<br />
And if </span><span class="default">someone</span><span class="string">'s searching for a function which gets all files from a directory including the subdirectories:
<br />

<br />
// Returns all Files contained in given dir, including subdirs
<br />
function GetContents($dir,$files=array()) {
<br />
&nbsp; if(!($res=opendir($dir))) exit("$dir doesn'</span><span class="default">t exist</span><span class="keyword">!</span><span class="string">");
<br />
&nbsp; while((</span><span class="default">$file</span><span class="string">=readdir(</span><span class="default">$res</span><span class="string">))==TRUE) 
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$file</span><span class="string">!="</span><span class="keyword">.</span><span class="string">" &amp;&amp; </span><span class="default">$file</span><span class="string">!="</span><span class="keyword">..</span><span class="string">")
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(is_dir("</span><span class="default">$dir</span><span class="keyword">/</span><span class="default">$file</span><span class="string">")) </span><span class="default">$files</span><span class="string">=GetContents("</span><span class="default">$dir</span><span class="keyword">/</span><span class="default">$file</span><span class="string">",</span><span class="default">$files</span><span class="string">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else array_push(</span><span class="default">$files</span><span class="string">,"</span><span class="default">$dir</span><span class="keyword">/</span><span class="default">$file</span><span class="string">");
<br />
&nbsp;&nbsp; &nbsp;&nbsp; 
<br />
&nbsp; closedir(</span><span class="default">$res</span><span class="string">);
<br />
&nbsp; return </span><span class="default">$files</span><span class="string">;
<br />
}
<br />

<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
