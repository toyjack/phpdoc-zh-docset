<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>SOAP</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="sca-soapproxy.createdataobject.html">? SCA_SoapProxy::createDataObject</a></li>
      <li style="float: right;"><a href="intro.soap.html">简介 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="refs.webservice.html">Web 服务</a></li>
    <li>SOAP</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="book.soap" class="book">
 
 <h1 class="title">SOAP</h1>
 

 

 







 







 
 








 






 






 






 






 






 








<ul class="chunklist chunklist_book"><li><a href="intro.soap.html">简介</a></li><li><a href="soap.setup.html">安装／配置</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="soap.requirements.html">需求</a></li><li><a href="soap.installation.html">安装</a></li><li><a href="soap.configuration.html">运行时配置</a></li><li><a href="soap.resources.html">资源类型</a></li></ul></li><li><a href="soap.constants.html">预定义常量</a></li><li><a href="ref.soap.html">SOAP 函数</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.is-soap-fault.html">is_soap_fault</a> &mdash; Checks if a SOAP call has failed</li><li><a href="function.use-soap-error-handler.html">use_soap_error_handler</a> &mdash; Set whether to use the SOAP error handler</li></ul></li><li><a href="class.soapclient.html">SoapClient</a> &mdash; The SoapClient class<ul class="chunklist chunklist_book chunklist_children"><li><a href="soapclient.call.html">SoapClient::__call</a> &mdash; Calls a SOAP function (deprecated)</li><li><a href="soapclient.construct.html">SoapClient::__construct</a> &mdash; SoapClient constructor</li><li><a href="soapclient.dorequest.html">SoapClient::__doRequest</a> &mdash; Performs a SOAP request</li><li><a href="soapclient.getfunctions.html">SoapClient::__getFunctions</a> &mdash; Returns list of available SOAP functions</li><li><a href="soapclient.getlastrequest.html">SoapClient::__getLastRequest</a> &mdash; Returns last SOAP request</li><li><a href="soapclient.getlastrequestheaders.html">SoapClient::__getLastRequestHeaders</a> &mdash; Returns the SOAP headers from the last request</li><li><a href="soapclient.getlastresponse.html">SoapClient::__getLastResponse</a> &mdash; Returns last SOAP response</li><li><a href="soapclient.getlastresponseheaders.html">SoapClient::__getLastResponseHeaders</a> &mdash; Returns the SOAP headers from the last response</li><li><a href="soapclient.gettypes.html">SoapClient::__getTypes</a> &mdash; Returns a list of SOAP types</li><li><a href="soapclient.setcookie.html">SoapClient::__setCookie</a> &mdash; The __setCookie purpose</li><li><a href="soapclient.setlocation.html">SoapClient::__setLocation</a> &mdash; Sets the location of the Web service to use</li><li><a href="soapclient.setsoapheaders.html">SoapClient::__setSoapHeaders</a> &mdash; Sets SOAP headers for subsequent calls</li><li><a href="soapclient.soapcall.html">SoapClient::__soapCall</a> &mdash; Calls a SOAP function</li><li><a href="soapclient.soapclient.html">SoapClient::SoapClient</a> &mdash; SoapClient constructor</li></ul></li><li><a href="class.soapserver.html">SoapServer</a> &mdash; The SoapServer class<ul class="chunklist chunklist_book chunklist_children"><li><a href="soapserver.addfunction.html">SoapServer::addFunction</a> &mdash; 添加一个或多个函数来处理SOAP请求</li><li><a href="soapserver.addsoapheader.html">SoapServer::addSoapHeader</a> &mdash; Add a SOAP header to the response</li><li><a href="soapserver.construct.html">SoapServer::__construct</a> &mdash; SoapServer constructor</li><li><a href="soapserver.fault.html">SoapServer::fault</a> &mdash; Issue SoapServer fault indicating an error</li><li><a href="soapserver.getfunctions.html">SoapServer::getFunctions</a> &mdash; Returns list of defined functions</li><li><a href="soapserver.handle.html">SoapServer::handle</a> &mdash; Handles a SOAP request</li><li><a href="soapserver.setclass.html">SoapServer::setClass</a> &mdash; Sets the class which handles SOAP requests</li><li><a href="soapserver.setobject.html">SoapServer::setObject</a> &mdash; Sets the object which will be used to handle SOAP requests</li><li><a href="soapserver.setpersistence.html">SoapServer::setPersistence</a> &mdash; Sets SoapServer persistence mode</li><li><a href="soapserver.soapserver.html">SoapServer::SoapServer</a> &mdash; SoapServer constructor</li></ul></li><li><a href="class.soapfault.html">SoapFault</a> &mdash; The SoapFault class<ul class="chunklist chunklist_book chunklist_children"><li><a href="soapfault.construct.html">SoapFault::__construct</a> &mdash; SoapFault constructor</li><li><a href="soapfault.soapfault.html">SoapFault::SoapFault</a> &mdash; SoapFault constructor</li><li><a href="soapfault.tostring.html">SoapFault::__toString</a> &mdash; Obtain a string representation of a SoapFault</li></ul></li><li><a href="class.soapheader.html">SoapHeader</a> &mdash; The SoapHeader class<ul class="chunklist chunklist_book chunklist_children"><li><a href="soapheader.construct.html">SoapHeader::__construct</a> &mdash; SoapHeader constructor</li><li><a href="soapheader.soapheader.html">SoapHeader::SoapHeader</a> &mdash; SoapHeader constructor</li></ul></li><li><a href="class.soapparam.html">SoapParam</a> &mdash; The SoapParam class<ul class="chunklist chunklist_book chunklist_children"><li><a href="soapparam.construct.html">SoapParam::__construct</a> &mdash; SoapParam constructor</li><li><a href="soapparam.soapparam.html">SoapParam::SoapParam</a> &mdash; SoapParam constructor</li></ul></li><li><a href="class.soapvar.html">SoapVar</a> &mdash; The SoapVar class<ul class="chunklist chunklist_book chunklist_children"><li><a href="soapvar.construct.html">SoapVar::__construct</a> &mdash; SoapVar constructor</li><li><a href="soapvar.soapvar.html">SoapVar::SoapVar</a> &mdash; SoapVar constructor</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="117956""></a>
  <div class="note">
   <strong class="user">Luke</strong>
   <a href="#117956" class="date">08-Sep-2015 04:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Was calling an asmx method like $success=$x-&gt;AuthenticateUser($userName,$password) and this was returning me an error.<br />
<br />
However i changed it and added the userName and password in an array and its now KAWA...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116747""></a>
  <div class="note">
   <strong class="user">spectrumcat at gmail dot com</strong>
   <a href="#116747" class="date">23-Feb-2015 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In case you'll get a .p12 certificate for your SOAP client to use (or any other actually) make sure to convert it to PEM and merge with the private key. <br />
<br />
Convert p12 to PEM with merged private key:<br />
openssl pkcs12 -in supplied_cert.p12 -out php_soap_cert.pem -clcerts<br />
<br />
Example:<br />
$wsdl = "./mywsdl.wsdl"; // Or "<a href="http://provider.com/api/api.wsdl" rel="nofollow" target="_blank">http://provider.com/api/api.wsdl</a>"<br />
<br />
$options = [<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'location'&nbsp; &nbsp; &nbsp; =&gt; "<a href="http://provider.com/api/" rel="nofollow" target="_blank">http://provider.com/api/</a>",<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'local_cert'&nbsp; &nbsp; =&gt; "./php_soap_cert.pem",<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'passphrase'&nbsp; &nbsp; =&gt; "certificate_password",<br />
];<br />
<br />
try {<br />
&nbsp;&nbsp;&nbsp; $soapClient = new SoapClient($wsdl, $options);<br />
} catch(Exception $e) {<br />
&nbsp;&nbsp;&nbsp; var_dump($e);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108646""></a>
  <div class="note">
   <strong class="user">rafinskipg at gmail dot com</strong>
   <a href="#108646" class="date">14-May-2012 11:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Support for MTOM addign this code to your project:<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">class </span><span class="default">MySoapClient </span><span class="keyword">extends </span><span class="default">SoapClient<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__doRequest</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">, </span><span class="default">$location</span><span class="keyword">, </span><span class="default">$action</span><span class="keyword">, </span><span class="default">$version</span><span class="keyword">, </span><span class="default">$one_way </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$response </span><span class="keyword">= </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__doRequest</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">, </span><span class="default">$location</span><span class="keyword">, </span><span class="default">$action</span><span class="keyword">, </span><span class="default">$version</span><span class="keyword">, </span><span class="default">$one_way</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// parse $response, extract the multipart messages and so on<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //this part removes stuff<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$start</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">,</span><span class="string">'&lt;?xml'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$end</span><span class="keyword">=</span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">,</span><span class="string">'&gt;'</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$response_string</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$response</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">-</span><span class="default">$start</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">$response_string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Then you can do this <br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">new </span><span class="default">MySoapClient</span><span class="keyword">(</span><span class="default">$wsdl_url</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106732""></a>
  <div class="note">
   <strong class="user">dennis at pleasedontspam dot clansman dot nl</strong>
   <a href="#106732" class="date">02-Dec-2011 12:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you receive the soapfault message: "looks like we got no XML document" it might be that you're talking to a server that supports MTOM (<a href="http://www.w3.org/TR/soap12-mtom/" rel="nofollow" target="_blank">http://www.w3.org/TR/soap12-mtom/</a>). <br />
<br />
MTOM is, as of yet (5.3.6), not supported by the SoapClient.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100453""></a>
  <div class="note">
   <strong class="user">mariamr at gmail dot com</strong>
   <a href="#100453" class="date">17-Oct-2010 03:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"SOAP-ERROR: Parsing WSDL: Couldn't find in 'PATH/TO/YOUR/WSDL'"
<br />

<br />
This error occurs because some versions of PHP SOAP client&nbsp; do not send the user name and password that you pass as the options input parameter of the SoapClient constructor&nbsp; . Yu need to pass the credentials in the web service URL like this:
<br />
$soapClient =new SoapClient("<a href="http://user:password@example.com/blahblah.wsdl"" rel="nofollow" target="_blank">http://user:password@example.com/blahblah.wsdl"</a>);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96345""></a>
  <div class="note">
   <strong class="user">vishal dot thakkar at exateam dot com</strong>
   <a href="#96345" class="date">22-Feb-2010 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was trying to figure out for days and days to make SOAP server return an associative array and NOT an object ....<br />
<br />
To get an array (not object) in the SOAP response, just serialize the array before returning it to the clent..<br />
<br />
hope it helps...<br />
Thanks.....<br />
Vishal Thakkar.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96033""></a>
  <div class="note">
   <strong class="user">stephenlansell at gmail dot com</strong>
   <a href="#96033" class="date">04-Feb-2010 04:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example of a php client talking to a asmx server:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $soapClient </span><span class="keyword">= new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"https://soapserver.example.com/blahblah.asmx?wsdl"</span><span class="keyword">); 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Prepare SoapHeader parameters
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sh_param </span><span class="keyword">= array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'Username'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="string">'username'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'Password'&nbsp; &nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="string">'password'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$headers </span><span class="keyword">= new </span><span class="default">SoapHeader</span><span class="keyword">(</span><span class="string">'<a href="http://soapserver.example.com/webservices" rel="nofollow" target="_blank">http://soapserver.example.com/webservices</a>'</span><span class="keyword">, </span><span class="string">'UserCredentials'</span><span class="keyword">, </span><span class="default">$sh_param</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Prepare Soap Client
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$soapClient</span><span class="keyword">-&gt;</span><span class="default">__setSoapHeaders</span><span class="keyword">(array(</span><span class="default">$headers</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Setup the RemoteFunction parameters
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ap_param </span><span class="keyword">= array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'amount'&nbsp; &nbsp;&nbsp; </span><span class="keyword">=&gt;&nbsp; &nbsp; </span><span class="default">$irow</span><span class="keyword">[</span><span class="string">'total_price'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Call RemoteFunction ()
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$error </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; try {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">$soapClient</span><span class="keyword">-&gt;</span><span class="default">__call</span><span class="keyword">(</span><span class="string">"RemoteFunction"</span><span class="keyword">, array(</span><span class="default">$ap_param</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } catch (</span><span class="default">SoapFault $fault</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$error </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print(</span><span class="string">"
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; alert('Sorry, blah returned the following ERROR: "</span><span class="keyword">.</span><span class="default">$fault</span><span class="keyword">-&gt;</span><span class="default">faultcode</span><span class="keyword">.</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">$fault</span><span class="keyword">-&gt;</span><span class="default">faultstring</span><span class="keyword">.</span><span class="string">". We will now take you back to our home page.');
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; window.location = 'main.php';
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; "</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$error </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$auth_num </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">-&gt;</span><span class="default">RemoteFunctionResult</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$auth_num </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ....
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Setup the OtherRemoteFunction() parameters
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$at_param </span><span class="keyword">= array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'amount'&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">$irow</span><span class="keyword">[</span><span class="string">'total_price'</span><span class="keyword">],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'description'&nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">$description</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Call OtherRemoteFunction()
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trans </span><span class="keyword">= </span><span class="default">$soapClient</span><span class="keyword">-&gt;</span><span class="default">__call</span><span class="keyword">(</span><span class="string">"OtherRemoteFunction"</span><span class="keyword">, array(</span><span class="default">$at_param</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$trans_result </span><span class="keyword">= </span><span class="default">$trans</span><span class="keyword">-&gt;</span><span class="default">OtherRemoteFunctionResult</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ....
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Record the transaction error in the database
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Kill the link to Soap
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$soapClient</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; 
<br />
}
<br />
&nbsp;&nbsp;&nbsp; 
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93888""></a>
  <div class="note">
   <strong class="user">moazzam at moazzam-khan dot com</strong>
   <a href="#93888" class="date">05-Oct-2009 06:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If anyone is trying to use this for accessing Sabre's web services, it won't work. Sabre checks the request header "Content-Type" to see if it is "text/xml" . If it is not text/xml then it sends an error back. <br />
<br />
You will need to create a socket connection and use that to send the request over.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90379""></a>
  <div class="note">
   <strong class="user">Raphal Gertz</strong>
   <a href="#90379" class="date">19-Apr-2009 06:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Juste a note to avoid wasting time on php-soap protocol and format support.<br />
<br />
Until php 5.2.9 (at least) the soap extension is only capable of understanding wsdl 1.0 and 1.1 format.<br />
<br />
The wsdl 2.0, a W3C recommendation since june 2007, ISN'T supported in php soap extension.<br />
(the soap/php_sdl.c source code don't handle wsdl2.0 format)<br />
<br />
The wsdl 2.0 is juste the 1.2 version renamed because it has substantial differences from WSDL 1.1.<br />
<br />
The differences between the two format may not be invisible if you don't care a lot.<br />
<br />
The wsdl 1.0 format structure (see <a href="http://www.w3.org/TR/wsdl" rel="nofollow" target="_blank">http://www.w3.org/TR/wsdl</a>) :<br />
&lt;definitions ...&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;types ...&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/types&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;message ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;part ...&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/message&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;portType ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;operation ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;input ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;output ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;fault ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/operation&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/portType&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;binding ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;operation ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;input ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;output ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;fault ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/operation&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/binding&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;service ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;port ...&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/service&gt;<br />
&lt;/definitions&gt;<br />
<br />
And the wsdl 2.0 format structure (see <a href="http://www.w3.org/TR/wsdl20/" rel="nofollow" target="_blank">http://www.w3.org/TR/wsdl20/</a>) :<br />
&lt;description ...&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;types ...&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/types&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;interface ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;fault ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;operation ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;input ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;output ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;fault ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/operation&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/interface&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;binding ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;fault ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;operation ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;input ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;output ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;fault ... /&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;/operation&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/binding&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;service ...&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;endpoint ...&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;/service&gt;<br />
&lt;/description&gt;<br />
<br />
The typical error message if you provide a wsdl 2.0 format file :<br />
PHP Fatal error:&nbsp; SOAP-ERROR: Parsing WSDL: Couldn't find &lt;definitions&gt; in 'wsdl/example.wsdl' in /path/client.php on line 9</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88692""></a>
  <div class="note">
   <strong class="user">jeff at jeffrodriguez dot com</strong>
   <a href="#88692" class="date">03-Feb-2009 10:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Named parameters are actually super easy once you know how to do it. No need to bother with SoapParam or SoapVar for the most part.<br />
<br />
The code:<br />
<span class="default">&lt;?php<br />
$ws</span><span class="keyword">-&gt;</span><span class="default">getAsset</span><span class="keyword">(array(<br />
&nbsp; </span><span class="string">'assetId' </span><span class="keyword">=&gt; </span><span class="default">5967<br />
</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
Generates the following SOAP body: (formatted for readability)<br />
&lt;SOAP-ENV:Body&gt;<br />
&nbsp; &lt;ns1:getAsset&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;assetId&gt;5967&lt;/assetId&gt;<br />
&nbsp; &lt;/ns1:getAsset&gt;<br />
&lt;/SOAP-ENV:Body&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86521""></a>
  <div class="note">
   <strong class="user">beau dot scott at gmail dot com</strong>
   <a href="#86521" class="date">23-Oct-2008 12:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you've been trying to send null to a service that considers empty property tags as empty strings rather than null, here's an extending class that fixes this using xsi:nil:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">XSoapClient </span><span class="keyword">extends </span><span class="default">SoapClient
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">XSI_NS </span><span class="keyword">= </span><span class="string">"<a href="http://www.w3.org/2001/XMLSchema-instance" rel="nofollow" target="_blank">http://www.w3.org/2001/XMLSchema-instance</a>"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">_NULL_ </span><span class="keyword">= </span><span class="string">"xxx_replacedduetobrokephpsoapclient_xxx"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; protected </span><span class="default">$mustParseNulls </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__doRequest</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">, </span><span class="default">$location</span><span class="keyword">, </span><span class="default">$action</span><span class="keyword">, </span><span class="default">$version</span><span class="keyword">, </span><span class="default">$one_way </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mustParseNulls</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mustParseNulls </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$request </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/&lt;ns1:(\w+)&gt;'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">_NULL_</span><span class="keyword">.</span><span class="string">'&lt;\/ns1:\\1&gt;/'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'&lt;ns1:$1 xsi:nil="true"/&gt;'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$request</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, &amp;</span><span class="default">$count</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$count </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$request </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(&lt;SOAP-ENV:Envelope )/'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'\\1 xmlns:xsi="'</span><span class="keyword">.</span><span class="default">self</span><span class="keyword">::</span><span class="default">XSI_NS</span><span class="keyword">.</span><span class="string">'" '</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$request</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__doRequest</span><span class="keyword">(</span><span class="default">$request</span><span class="keyword">, </span><span class="default">$location</span><span class="keyword">, </span><span class="default">$action</span><span class="keyword">, </span><span class="default">$version</span><span class="keyword">, </span><span class="default">$one_way</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$params </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$v </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">mustParseNulls </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$params</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">self</span><span class="keyword">::</span><span class="default">_NULL_</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__call</span><span class="keyword">(</span><span class="default">$method</span><span class="keyword">, </span><span class="default">$params</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86503""></a>
  <div class="note">
   <strong class="user">Ryan</strong>
   <a href="#86503" class="date">22-Oct-2008 03:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having an issue where SOAP cannot find the functions that are actually there if you view the wsdl file, it's because PHP is caching the wsdl file (for a day at a time). To turn this off, have this line on every script that uses SOAP: ini_set("soap.wsdl_cache_enabled", "0"); to disable the caching feature.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84977""></a>
  <div class="note">
   <strong class="user">ivan dot cubillas at xeridia dot com</strong>
   <a href="#84977" class="date">08-Aug-2008 10:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The problem with the PHP WebService Client<br />
<br />
We've a JAVA WebService Server which could have attached documents. When the PHP Client send the dates, the Server take it correctly, but when <br />
the server return it to the PHP Client, the client reply always that is not a XML valid document.<br />
<br />
The problem could be than the JAVA Server adds (to this type of XML binary files)&nbsp; the documentType head: xml+xop and the clean doesn't understand<br />
this head as a XML document.<br />
<br />
There is some possibility to solve this problem in the PHP Client without doing changes in the JAVA Server?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83489""></a>
  <div class="note">
   <strong class="user">aeg at mallxs dot nl</strong>
   <a href="#83489" class="date">28-May-2008 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SoapFault exception: [SOAP-ENV:Client] looks like we got no XML document<br />
<br />
This error can have to reasons:<br />
1: Your server script has some hidden output like spaces before or afher <span class="default">&lt;?php </span><span class="keyword">... </span><span class="default">?&gt;</span> or echoing some text<br />
2: You have a bug in your server script;<br />
&nbsp;&nbsp;&nbsp; resulting in a error message output<br />
<br />
Test your server script by calling it direct&nbsp; from the browser.<br />
The result should be a clean output like :<br />
<br />
?&lt;SOAP-ENV:Envelope&gt;<br />
?&lt;SOAP-ENV:Body&gt;<br />
?&lt;SOAP-ENV:Fault&gt;<br />
&nbsp; &lt;faultcode&gt;SOAP-ENV:Server&lt;/faultcode&gt;<br />
&nbsp; &lt;faultstring&gt;Bad Request. Can't find HTTP_RAW_POST_DATA&lt;/faultstring&gt;<br />
&lt;/SOAP-ENV:Fault&gt;<br />
&lt;/SOAP-ENV:Body&gt;<br />
&lt;/SOAP-ENV:Envelope&gt;<br />
<br />
This tell's you there was a request but without data; This is OK<br />
Now if you get the error when calling with your soap client;<br />
remember that your server now will call other functions in the server.php script because it now has some data to process</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83409""></a>
  <div class="note">
   <strong class="user">nodkz at mail dot ru</strong>
   <a href="#83409" class="date">24-May-2008 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PROBLEM (with SOAP extension under PHP5) of transferring object, that contains objects or array of objects. Nested object would not transfer.<br />
<br />
SOLUTION:<br />
This class was developed by trial and error by me. So this 23 lines of code for most developers writing under PHP5 solves fate of using SOAP extension.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
According to specific of organization process of SOAP class in PHP5, we must wrap up complex objects in SoapVar class. Otherwise objects would not be encoded properly and could not be loaded on remote SOAP handler.<br />
<br />
Function "getAsSoap" call for encoding object for transmission. After encoding it can be properly transmitted.<br />
*/<br />
</span><span class="keyword">abstract class </span><span class="default">SOAPable </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">getAsSOAP</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$this </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;&amp;</span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">prepareSOAPrecursive</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">prepareSOAPrecursive</span><span class="keyword">(&amp;</span><span class="default">$element</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$element </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;&amp;</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">prepareSOAPrecursive</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element</span><span class="keyword">=new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">,</span><span class="default">SOAP_ENC_ARRAY</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$element </span><span class="keyword">instanceof </span><span class="default">SOAPable</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element</span><span class="keyword">-&gt;</span><span class="default">getAsSOAP</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element</span><span class="keyword">=new </span><span class="default">SoapVar</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">,</span><span class="default">SOAP_ENC_OBJECT</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// ------------------------------------------<br />
//&nbsp; ABSTRACT EXAMPLE<br />
// ------------------------------------------<br />
<br />
</span><span class="keyword">class </span><span class="default">PersonList </span><span class="keyword">extends </span><span class="default">SOAPable </span><span class="keyword">{<br />
&nbsp; protected </span><span class="default">$ArrayOfPerson</span><span class="keyword">; </span><span class="comment">// variable MUST be protected or public!<br />
</span><span class="keyword">}<br />
<br />
class </span><span class="default">Person </span><span class="keyword">extends </span><span class="default">SOAPable </span><span class="keyword">{<br />
&nbsp;&nbsp; </span><span class="comment">//any data<br />
</span><span class="keyword">} <br />
<br />
</span><span class="default">$client</span><span class="keyword">=new </span><span class="default">SoapClient</span><span class="keyword">(</span><span class="string">"test.wsdl"</span><span class="keyword">, array( </span><span class="string">'soap_version'</span><span class="keyword">=&gt;</span><span class="default">SOAP_1_2</span><span class="keyword">, </span><span class="string">'trace'</span><span class="keyword">=&gt;</span><span class="default">1</span><span class="keyword">, </span><span class="string">'classmap' </span><span class="keyword">=&gt; array(</span><span class="string">'Person' </span><span class="keyword">=&gt; </span><span class="string">"Person"</span><span class="keyword">, </span><span class="string">'PersonList' </span><span class="keyword">=&gt; </span><span class="string">"PersonList"</span><span class="keyword">)&nbsp; ));<br />
<br />
</span><span class="default">$PersonList</span><span class="keyword">=new </span><span class="default">PersonList</span><span class="keyword">;<br />
<br />
</span><span class="comment">// some actions<br />
<br />
</span><span class="default">$PersonList</span><span class="keyword">-&gt;</span><span class="default">getAsSOAP</span><span class="keyword">();<br />
<br />
</span><span class="default">$client</span><span class="keyword">-&gt;</span><span class="default">someMethod</span><span class="keyword">(</span><span class="default">$PersonList</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
So every class, which will transfer via SOAP, must be extends from class SOAPable.&nbsp; <br />
As you can see, in code above, function prepareSOAPrecursive search another nested objects in parent object or in arrays, and if does it, tries call function getAsSOAP() for preparation of nested objects, after that simply wrap up via SoapVar class.<br />
<br />
So in code before transmitting simply call $obj-&gt;getAsSOAP()</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
