<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>启动新会话或者重用现有会话</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.session-set-save-handler.html">? session_set_save_handler</a></li>
      <li style="float: right;"><a href="function.session-status.html">session_status ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.session.html">Session 函数</a></li>
    <li>启动新会话或者重用现有会话</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.session-start" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_start</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">session_start</span> &mdash; <span class="dc-title">启动新会话或者重用现有会话</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.session-start-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><strong>session_start</strong></span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>session_start()</strong></span> 会创建新会话或者重用现有会话。
   如果通过 GET 或者 POST 方式，或者使用 cookie 提交了会话 ID，
   则会重用现有会话。
  </p>
  <p class="para">
   当会话自动开始或者通过 <span class="function"><strong>session_start()</strong></span> 手动开始的时候，
   PHP 内部会调用会话管理器的 open 和 read 回调函数。
   会话管理器可能是 PHP 默认的，
   也可能是扩展提供的（SQLite 或者 Memcached 扩展），
   也可能是通过 <span class="function"><a href="function.session-set-save-handler.html" class="function">session_set_save_handler()</a></span> 设定的用户自定义会话管理器。
   通过 read 回调函数返回的现有会话数据（使用特殊的序列化格式存储），
   PHP 会自动反序列化数据并且填充 $_SESSION 超级全局变量。
  </p>
  <p class="para">
   要想使用命名会话，请在调用 <span class="function"><strong>session_start()</strong></span> 函数
   之前调用 <span class="function"><a href="function.session-name.html" class="function">session_name()</a></span> 函数。
  </p>
  <p class="para">
   如果启用了 <a href="session.configuration.html#ini.session.use-trans-sid" class="link">session.use_trans_sid</a> 选项，
   <span class="function"><strong>session_start()</strong></span> 函数会注册一个内部输出管理器，
   该输出管理器完成 URL 重写的工作。
  </p>
  <p class="para">
   如果用户联合使用 <span class="function"><a href="function.ob-start.html" class="function">ob_start()</a></span> 
   和 <em>ob_gzhandler</em> 函数，
   那么函数的调用顺序会影响输出结果。
   例如，必须在开始会话之前调用 <em>ob_gzhandler</em> 函数完成注册。
  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.session-start-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功开始会话返回 <strong><code>TRUE</code></strong> ，反之返回 <strong><code>FALSE</code></strong>
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.session-start-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
        如果函数调用失败返回 <strong><code>FALSE</code></strong>，
        之前版本返回了 <strong><code>TRUE</code></strong>。
       </td>
      </tr>

      <tr>
       <td>4.3.3</td>
       <td>
        在 PHP 4.3.3 中，
        会话开始之后调用 <span class="function"><strong>session_start()</strong></span> 函数
        会引发 <strong><code>E_NOTICE</code></strong> 级别的错误，
        并且第二次请求开始会话的调用会被忽略。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.session-start-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-4804">
    <p><strong>Example #1 会话示例： <var class="filename">page1.php</var></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;page1.php<br /><br /></span><span style="color: #0000BB">session_start</span><span style="color: #007700">();<br /><br />echo&nbsp;</span><span style="color: #DD0000">'Welcome&nbsp;to&nbsp;page&nbsp;#1'</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'favcolor'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'green'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'animal'</span><span style="color: #007700">]&nbsp;&nbsp;&nbsp;=&nbsp;</span><span style="color: #DD0000">'cat'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'time'</span><span style="color: #007700">]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;如果使用&nbsp;cookie&nbsp;方式传送会话&nbsp;ID<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;&lt;a&nbsp;href="page2.php"&gt;page&nbsp;2&lt;/a&gt;'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;如果不是使用&nbsp;cookie&nbsp;方式传送会话&nbsp;ID，则使用&nbsp;URL&nbsp;改写的方式传送会话&nbsp;ID<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;&lt;a&nbsp;href="page2.php?'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">SID&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'"&gt;page&nbsp;2&lt;/a&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   请求 <var class="filename">page1.php</var> 页面之后，
   第二个页面 <var class="filename">page2.php</var> 
   会包含会话数据。
   请查阅 <a href="ref.session.html" class="link">会话参考</a>
   获取更多关于 <a href="session.idpassing.html" class="link">会话 ID 传送</a>的信息，
   在该参考页面中有关于常量 <strong><code>SID</code></strong> 的详细说明。
  </p>
  <p class="para">
   <div class="example" id="example-4805">
    <p><strong>Example #2 会话示例： <var class="filename">page2.php</var></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;page2.php<br /><br /></span><span style="color: #0000BB">session_start</span><span style="color: #007700">();<br /><br />echo&nbsp;</span><span style="color: #DD0000">'Welcome&nbsp;to&nbsp;page&nbsp;#2&lt;br&nbsp;/&gt;'</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'favcolor'</span><span style="color: #007700">];&nbsp;</span><span style="color: #FF8000">//&nbsp;green<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'animal'</span><span style="color: #007700">];&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;cat<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">date</span><span style="color: #007700">(</span><span style="color: #DD0000">'Y&nbsp;m&nbsp;d&nbsp;H:i:s'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'time'</span><span style="color: #007700">]);<br /><br /></span><span style="color: #FF8000">//&nbsp;类似&nbsp;page1.php&nbsp;中的代码，你可能需要在这里处理使用&nbsp;SID&nbsp;的场景<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'&lt;br&nbsp;/&gt;&lt;a&nbsp;href="page1.php"&gt;page&nbsp;1&lt;/a&gt;'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.session-start-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    要使用基于 cookie 的会话，
    必须在输出开始之前调用 <span class="function"><strong>session_start()</strong></span> 函数。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    建议使用 <a href="zlib.configuration.html#ini.zlib.output-compression" class="link">zlib.output_compression</a>
    来替代 <span class="function"><a href="function.ob-gzhandler.html" class="function">ob_gzhandler()</a></span>。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    根据配置不同，本函数会发送几个 HTTP 响应头。
    参考 <span class="function"><a href="function.session-cache-limiter.html" class="function">session_cache_limiter()</a></span>
    来自定义 HTTP 响应头。
   </p>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.session-start-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><var class="varname"><var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION</a></var></var></li>
    <li class="member">
     <a href="session.configuration.html#ini.session.auto-start" class="link">session.auto_start</a>
     配置指示
    </li>
    <li class="member"><span class="function"><a href="function.session-id.html" class="function" rel="rdfs-seeAlso">session_id()</a> - 获取/设置当前会话 ID</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114209""></a>
  <div class="note">
   <strong class="user">elitescripts2000 at yahoo dot com</strong>
   <a href="#114209" class="date">25-Jan-2014 12:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
3 easy but vital things about Sessions in AJAX Apps.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// session start<br />
<br />
//&nbsp; It is VERY important to include a Period if using<br />
// a whole domain.&nbsp; (.yourdomain.com)<br />
// It is VERY important to set the root path your session will always<br />
// operate in... (/members) will ensure sessions will NOT be interfered<br />
// with a session with a path of say (/admin) ... so you can log in<br />
// as /admin and as /members... NEVER do unset($_SESSION)<br />
// $_SESSION=array(); is preferred, session_unset();&nbsp; session_destroy();<br />
<br />
</span><span class="default">session_set_cookie_params</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="string">'/members'</span><span class="keyword">, </span><span class="string">'.yourdomain.com'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
</span><span class="default">$_SESSION </span><span class="keyword">= array();<br />
</span><span class="default">session_unset</span><span class="keyword">();<br />
</span><span class="default">session_destroy</span><span class="keyword">();<br />
<br />
</span><span class="default">session_set_cookie_params</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="string">'/members'</span><span class="keyword">, </span><span class="string">'.yourdomain.com'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'whatever'</span><span class="keyword">] = </span><span class="string">'youwhat'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// session destroying <br />
<br />
// To be safe, clear out your $_SESSION array<br />
// Next, what most people do NOT do is delete the session cookie!<br />
// It is easy to delete a cookie by expiring it long before the current time.<br />
// The ONLY WAY to delete a cookie, is to make sure ALL parameters match the<br />
// cookie to be deleted...which is easy to get those params with <br />
// session_get_cookie_params()...<br />
// FInally, use&nbsp; session_unset(); and session_destroy(); in this order to ensure<br />
// Chrome, IE, Firefox and others, are properly destroying the session.<br />
</span><span class="default">$_SESSION </span><span class="keyword">= array();<br />
if (</span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.use_cookies'</span><span class="keyword">))<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">= </span><span class="default">session_get_cookie_params</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="default">session_name</span><span class="keyword">(), </span><span class="string">''</span><span class="keyword">, </span><span class="default">time</span><span class="keyword">() - </span><span class="default">31536000</span><span class="keyword">, </span><span class="default">$p</span><span class="keyword">[</span><span class="string">'path'</span><span class="keyword">], </span><span class="default">$p</span><span class="keyword">[</span><span class="string">'domain'</span><span class="keyword">], </span><span class="default">$p</span><span class="keyword">[</span><span class="string">'secure'</span><span class="keyword">], </span><span class="default">$p</span><span class="keyword">[</span><span class="string">'httponly'</span><span class="keyword">]);<br />
&nbsp;}<br />
</span><span class="default">session_unset</span><span class="keyword">();<br />
</span><span class="default">session_destroy</span><span class="keyword">();<br />
<br />
</span><span class="comment">// AJAX and SESSIONS.<br />
// Example... you start a session based PHP page, which then calls an Ajax (XMLHTTP) authenticated<br />
// using the SAME SESSION to Poll and output the data, for example.&nbsp; But, you notice when you<br />
// try to start the Polling AJAX call always HANGS and seems to hang at the session_start().<br />
// This is because the session is opened in the first page, calls the AJAX polling example, and<br />
// tries to open the same session (for authentication) and do the AJAX call, you MUST call<br />
// session_write_close(); meaning you are done writing to the $_SESSION variable, which really<br />
// represents a file that must be CLOSED with session_write_close();....<br />
// THAN you can call your AJAX Polling code to reopen the same session and do its polling...<br />
// Normally, the $_SESSION is closed automatically when the script is closed or finished executing<br />
// So, if you need to keep a PHP page running after opening a SESSION, simply close it when finished<br />
// writing to $_SESSION so the AJAX polling page can authenticate and use the same session in a<br />
// seperate web page...<br />
<br />
</span><span class="default">session_write_close</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope this helps someone with their sessions...<br />
Thanks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114113""></a>
  <div class="note">
   <strong class="user">web at metelab dot com</strong>
   <a href="#114113" class="date">13-Jan-2014 12:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IMPORTAN NOTE for all newby!!!<br />
Before session_start() !<br />
you must set session_cache_limiter()<br />
&nbsp;in the value public, private_no_expire or private,<br />
otherwise the standard session will be send headers 1981year (nocache)<br />
and you will be very long to find someone sends headers!<br />
&nbsp;&nbsp; &nbsp; <br />
Maybe this will help, because not find the headers are sent in the browser</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113985""></a>
  <div class="note">
   <strong class="user">ohcc at 163 dot com</strong>
   <a href="#113985" class="date">26-Dec-2013 01:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The constant SID would always be '' (an empty string) if directive session.use_trans_sid in php ini file is set to 0. <br />
<br />
So remember to set session.use_trans_sid to 1 and restart your server before you use SID in your php script.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113041""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#113041" class="date">22-Aug-2013 02:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In the Classes and Objects docs, there is this: In order to be able to unserialize() an object, the class of that object needs to be defined.<br />
<br />
An object made by SimpleXML_Load_String() cannot be serialized.&nbsp; An attempt to do so will result in a run-time failure, throwing an exception.&nbsp; If you store such an object in $_SESSION, you will get a post-execution error that says this:<br />
<br />
Fatal error: Uncaught exception 'Exception' with message 'Serialization of 'SimpleXMLElement' is not allowed' in [no active file]:0 Stack trace: #0 {main} thrown in [no active file] on line 0<br />
<br />
The entire contents of the session will be lost.&nbsp; This script demonstrates the failure.&nbsp; Hope this saves someone some time!<br />
<br />
<span class="default">&lt;?php </span><span class="comment">// RAY_temp_ser.php<br />
</span><span class="default">error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">);<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'hello'</span><span class="keyword">] = </span><span class="string">'World'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">);<br />
<br />
</span><span class="comment">// AN XML STRING FOR TEST DATA<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="string">'&lt;?xml version="1.0"?&gt;<br />
&lt;families&gt;<br />
&nbsp; &lt;parent&gt;<br />
&nbsp;&nbsp;&nbsp; &lt;child index="1" value="Category 1"&gt;Child One&lt;/child&gt;<br />
&nbsp; &lt;/parent&gt;<br />
&lt;/families&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// MAKE AN OBJECT (GIVES SimpleXMLElement)<br />
</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">SimpleXML_Load_String</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
<br />
</span><span class="comment">// STORE THE OBJECT IN THE SESSION<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'obj'</span><span class="keyword">] = </span><span class="default">$obj</span><span class="keyword">;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112973""></a>
  <div class="note">
   <strong class="user">ilnomedellaccount at gmail dot com</strong>
   <a href="#112973" class="date">14-Aug-2013 12:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A note about session_start(), custom handlers and database foreign key constraints, which I think may be of some use...<br />
<br />
We know that if we want our sessions into a database table (rather than the default storage), we can refer to session_set_save_handler(...) to get them there. Note that session_set_save_handler must (obviously) be called before session_start(), but let me get to the point...<br />
<br />
Upon calling session_start() the "first time", when the session does not already exist, php will spawn a new session but will not call the write handler until script execution finishes.<br />
<br />
Thus, the session at this point exists in the server process memory, but won't be visible as a row in the DB before the script ends.<br />
<br />
This seems reasonable, because this avoids some unnecessary database access and resource usage before we even populate our session with meaningfull and definitive data, but this also has side-effects.<br />
<br />
In my case, the script called session_start() to make sure a session was initiated, then used session_id() to populate another table in the DB, which had foreign_key constraint to the "sessions" table. This failed because no session was in the db at that point, yet!<br />
<br />
I know I could simply force the creation of the row in the DB by manually calling the write handler after session_start(), when necessary, but I am not sure if this is the best possible approach.<br />
<br />
As soon as I find an "elegant" solution, or a completely different approach, I will post some working sample code.<br />
<br />
In the meanwhile... have fun!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111326""></a>
  <div class="note">
   <strong class="user">AlexW</strong>
   <a href="#111326" class="date">07-Feb-2013 09:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note:<br />
<br />
If your session contains a class, include the class definition *before* calling session_start() otherwise you will get an error!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110649""></a>
  <div class="note">
   <strong class="user">someOne_01 at somewhere dot com</strong>
   <a href="#110649" class="date">17-Nov-2012 11:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you have an import script that takes long to execute, the browser seem to lock up and you cannot access the website anymore. this is because a request is reading and locking the session file to prevent corruption.
<br />

<br />
you can either 
<br />
- use a different session handler with session_set_save_handler()
<br />
- use session_write_close() in the import script as soon you don't need session anymore (best moment is just before the long during part takes place), you can session_start when ever you want and as many times you like if your import script requires session variables changed. 
<br />

<br />
example
<br />
<span class="default">&lt;?php
<br />
session_start</span><span class="keyword">(); </span><span class="comment">//initiate / open session
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'count'</span><span class="keyword">] = </span><span class="default">0</span><span class="keyword">; </span><span class="comment">// store something in the session
<br />
</span><span class="default">session_write_close</span><span class="keyword">(); </span><span class="comment">//now close it, 
<br />
# from here every other script can be run (and makes it seem like multitasking)
<br />
</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">100</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){ </span><span class="comment">//do 100 cycles
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_start</span><span class="keyword">(); </span><span class="comment">//open the session again for editing a variable
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'count'</span><span class="keyword">] += </span><span class="default">1</span><span class="keyword">; </span><span class="comment">//change variable
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_write_close</span><span class="keyword">(); </span><span class="comment">//now close the session again!
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">); </span><span class="comment">//every cycle sleep two seconds, or do a heavy task
<br />
</span><span class="keyword">}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109506""></a>
  <div class="note">
   <strong class="user">foxz</strong>
   <a href="#109506" class="date">23-Jul-2012 11:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Cannot send session cache limiter...
<br />

<br />
if you use UTF-8 charactere format
<br />
*** dont use BOM ! ***
<br />

<br />
(convert to UTF-8 without BOM)
<br />

<br />
config your FTP client to transfert *.php in BINARY format
<br />

<br />
BOM is an mark in start of file.
<br />
"hey, I'm UTF-8 encoded"<span class="default">&lt;?php session_start</span><span class="keyword">() </span><span class="default">?&gt;
<br />
</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ^--- something before&nbsp; !
<br />

<br />
Syl</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108833""></a>
  <div class="note">
   <strong class="user">henrik at raketten dot net</strong>
   <a href="#108833" class="date">29-May-2012 07:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have found, like many others, that sometimes IE looses SESSION variables. In my case, this was caused due to a CNAME foirwarded IP address and it went away, when I changed it to a A node in my DNS settings. <br />
I hope this will help somebody....</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107764""></a>
  <div class="note">
   <strong class="user">LaKing at D250 dot hu</strong>
   <a href="#107764" class="date">03-Mar-2012 12:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a warning complaining about session_start() after adding an include file.<br />
<br />
- It broke the functionality of my php code in a very strange manner.<br />
- The included tree did not contain any additional session_start calls.<br />
- it produced this warning only with with php -l from my development environment, and didn't produce any errors in the error_log.<br />
- the warning pointed into a non-existing line, 1 line after last line of the file.<br />
<br />
I use gedit on CentOS 6.1 with UTF-8 as current locale.<br />
- Switching encoding back and forth didn't help. <br />
- Commented out all the included content, only the php tags left, the error wa still there. .. <br />
<br />
The solution was to clear out everything, and re-writing the php tags and posting back the content.<br />
<br />
As it seems "hidden" unsupported characters produce errors and warnings falsely pointing to this function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106509""></a>
  <div class="note">
   <strong class="user">james at ustelcom dot net</strong>
   <a href="#106509" class="date">15-Nov-2011 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had the infamous "Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent ..." error, and I was convinced it was because I was trying to open a session AND send a cookie.&nbsp; I tried everything that was suggested, uploaded in ANSI, uploaded in UTF 8, etc.&nbsp; I tried opening the session first, then sending the cookie first.&nbsp; Turns out my problem was quite simple:
<br />

<br />
" <span class="default">&lt;?php
<br />
session_start</span><span class="keyword">();
<br />

<br />
</span><span class="default">?&gt;</span>"
<br />

<br />
Do you see the problem with my code?&nbsp; I finally did:
<br />

<br />
" &lt;?php"
<br />
^^------ There is an accidental space!
<br />

<br />
I'm sure I'm not the only one who encounters this problem.&nbsp; Hopefully this helps others!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106394""></a>
  <div class="note">
   <strong class="user">max_bilyk at yahoo dot com</strong>
   <a href="#106394" class="date">04-Nov-2011 03:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An interesting bug/misfunction was discovered when using Flash-based file uploader (in my case jQuery plugin Uploadify, but also found similar problem reports about SWFupload).<br />
<br />
Problem occurs with PHP 5.2 (and probably later as well) when it is compiled with Suhosin patch.<br />
<br />
The problem is that session_start() does not load session data into $_SESSION variable when it gets request from Flash, and in this case $_SESSION variable becomes empty and at the end&nbsp; of script execution erases session data when script execution ends (PHP saves this empty $_SESSION to file).<br />
<br />
The fact that Flash is using its own session management is solved by passing via POST/GET correct session ID, but erasing session data is definitely a problem.<br />
<br />
The reason for the problem is method of session data encryption - Suhosin uses user-agent data as a part of encryption key.<br />
<br />
And in case client machine makes requests from two different user-agents (browser + flash) Suhosin generates different session decryption key which is unable to decrypt session data (and notice that there's no message about this fact in any log-file).<br />
<br />
So the solution for such case may be either by disabling encryption of session data by putting such directive in php.ini:<br />
<br />
suhosin.session.encrypt=Off<br />
<br />
or, alternatively, still keep session data encrypted but exclude user-agent data from encryption key by using this directive in php.ini:<br />
<br />
suhosin.session.cryptua=Off</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106172""></a>
  <div class="note">
   <strong class="user">Dark Angel</strong>
   <a href="#106172" class="date">16-Oct-2011 04:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had script which should under CLI restore session set by web interface.<br />
<br />
Spent like few hours understanding why script with session_id($sid) and session_start() is not restoring session, but generating new one. No any notices or anything helping to resolve.<br />
<br />
$sid was read from STDIN. Issue was that value from STDIN contained '\n' character at the end, which is invalid for session identifier. Discovered by stracing CLI script.<br />
<br />
Hope this will save you a lot of time.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105447""></a>
  <div class="note">
   <strong class="user">sanjuro at 1up-games dot com</strong>
   <a href="#105447" class="date">18-Aug-2011 08:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The problem with SID is that if on occasions you don't start a session, instead of outputting an empty string for transparent integration it will return the regular undefined constant notice. So you might want to test the constant with defined() beforehand.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104973""></a>
  <div class="note">
   <strong class="user">egonrp</strong>
   <a href="#104973" class="date">19-Jul-2011 03:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SOLVED: Session data lost<br />
<br />
My session data lost problem was resolved by using a short name for session key.<br />
This error happens with PHP version 5.2.6 (Debian Lenny), others versions works fine without any modification.<br />
<br />
Before:<br />
$_SESSION['current_user_search_filter'] = serialize($myArray);<br />
$value = unserialize($_SESSION['current_user_search_filter']);<br />
<br />
After (short key name):<br />
$_SESSION['usearchfilter'] = serialize($myArray);<br />
$value = unserialize($_SESSION['usearchfilter']);<br />
<br />
Good Luck! :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103550""></a>
  <div class="note">
   <strong class="user">gkemaldag at gmail dot com</strong>
   <a href="#103550" class="date">20-Apr-2011 09:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For the error:
<br />

<br />
Warning: session_start(): Cannot send session cache limiter - headers already sent ...
<br />

<br />
this kind of errors would occur, when the encoding of your script file needs to send some headers just after your script starts to execute,
<br />

<br />
this happens mostly with the scripts using normal utf8 encoding.
<br />

<br />
To overcome the issue, use utf8(without BOM) encoding provided by notepad++ and most modern editors. Using utf8 encoding and cookie based sessions, will result in headers already sent by error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102751""></a>
  <div class="note">
   <strong class="user">alakys</strong>
   <a href="#102751" class="date">03-Mar-2011 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sorry for the noob comment but for those having the error : <br />
<br />
Warning: session_start(): Cannot send session cache limiter - headers already sent ...<br />
<br />
And before trying all the solutions added by the experts, simply ensure to have your php code before even the DOCTYPE tag like this (and not between the doctype and html tags as I was doing):<br />
<br />
<span class="default">&lt;?php session_start</span><span class="keyword">(); </span><span class="default">?&gt;<br />
</span>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" rel="nofollow" target="_blank">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>"&gt;<br />
&lt;html xmlns="<a href="http://www.w3.org/1999/xhtml" rel="nofollow" target="_blank">http://www.w3.org/1999/xhtml</a>"&gt;<br />
&lt;head&gt;<br />
&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /&gt;<br />
&lt;title&gt;Test Page&lt;/title&gt;<br />
&lt;/head&gt;<br />
<br />
&lt;body&gt;<br />
etc ....<br />
<br />
It might sound funny but I am sure this post will save time to some others noobs like me ... !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102460""></a>
  <div class="note">
   <strong class="user">linblow at hotmail dot fr</strong>
   <a href="#102460" class="date">16-Feb-2011 02:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to handle sessions with a class, I wrote this little class:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp;&nbsp; Use the static method getInstance to get the object.<br />
*/<br />
<br />
</span><span class="keyword">class </span><span class="default">Session<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">SESSION_STARTED </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; const </span><span class="default">SESSION_NOT_STARTED </span><span class="keyword">= </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// The state of the session<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private </span><span class="default">$sessionState </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">SESSION_NOT_STARTED</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// THE only instance of the class<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private static </span><span class="default">$instance</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">__construct</span><span class="keyword">() {}<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; Returns THE instance of 'Session'.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; The session is automatically initialized if it wasn't.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @return&nbsp; &nbsp; object<br />
&nbsp;&nbsp;&nbsp; **/<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">getInstance</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( !isset(</span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance </span><span class="keyword">= new </span><span class="default">self</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance</span><span class="keyword">-&gt;</span><span class="default">startSession</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">$instance</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; (Re)starts the session.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @return&nbsp; &nbsp; bool&nbsp; &nbsp; TRUE if the session has been initialized, else FALSE.<br />
&nbsp;&nbsp;&nbsp; **/<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">startSession</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sessionState </span><span class="keyword">== </span><span class="default">self</span><span class="keyword">::</span><span class="default">SESSION_NOT_STARTED </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sessionState </span><span class="keyword">= </span><span class="default">session_start</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sessionState</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; Stores datas in the session.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; Example: $instance-&gt;foo = 'bar';<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @param&nbsp; &nbsp; name&nbsp; &nbsp; Name of the datas.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @param&nbsp; &nbsp; value&nbsp; &nbsp; Your datas.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @return&nbsp; &nbsp; void<br />
&nbsp;&nbsp;&nbsp; **/<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__set</span><span class="keyword">( </span><span class="default">$name </span><span class="keyword">, </span><span class="default">$value </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; Gets datas from the session.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; Example: echo $instance-&gt;foo;<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @param&nbsp; &nbsp; name&nbsp; &nbsp; Name of the datas to get.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @return&nbsp; &nbsp; mixed&nbsp; &nbsp; Datas stored in session.<br />
&nbsp;&nbsp;&nbsp; **/<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__get</span><span class="keyword">( </span><span class="default">$name </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__isset</span><span class="keyword">( </span><span class="default">$name </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__unset</span><span class="keyword">( </span><span class="default">$name </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset( </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] );<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; Destroys the current session.<br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; *&nbsp; &nbsp; @return&nbsp; &nbsp; bool&nbsp; &nbsp; TRUE is session has been deleted, else FALSE.<br />
&nbsp;&nbsp;&nbsp; **/<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">destroy</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sessionState </span><span class="keyword">== </span><span class="default">self</span><span class="keyword">::</span><span class="default">SESSION_STARTED </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sessionState </span><span class="keyword">= !</span><span class="default">session_destroy</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset( </span><span class="default">$_SESSION </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return !</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">sessionState</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp;&nbsp; Examples:<br />
*/<br />
<br />
// We get the instance<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">Session</span><span class="keyword">::</span><span class="default">getInstance</span><span class="keyword">();<br />
<br />
</span><span class="comment">// Let's store datas in the session<br />
</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">nickname </span><span class="keyword">= </span><span class="string">'Someone'</span><span class="keyword">;<br />
</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">age </span><span class="keyword">= </span><span class="default">18</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Let's display datas<br />
</span><span class="default">printf</span><span class="keyword">( </span><span class="string">'&lt;p&gt;My name is %s and I\'m %d years old.&lt;/p&gt;' </span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">nickname </span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">age </span><span class="keyword">);<br />
<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp;&nbsp; It will display:<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; Array<br />
&nbsp;&nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; [nickname] =&gt; Someone<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; [age] =&gt; 18<br />
&nbsp;&nbsp;&nbsp; )<br />
*/<br />
<br />
</span><span class="default">printf</span><span class="keyword">( </span><span class="string">'&lt;pre&gt;%s&lt;/pre&gt;' </span><span class="keyword">, </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$_SESSION </span><span class="keyword">, </span><span class="default">TRUE </span><span class="keyword">));<br />
<br />
</span><span class="comment">// TRUE<br />
</span><span class="default">var_dump</span><span class="keyword">( isset( </span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">nickname </span><span class="keyword">));<br />
<br />
</span><span class="comment">// We destroy the session<br />
</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">destroy</span><span class="keyword">();<br />
<br />
</span><span class="comment">// FALSE<br />
</span><span class="default">var_dump</span><span class="keyword">( isset( </span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">nickname </span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I prefer using this class instead of using directly the array $_SESSION.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102431""></a>
  <div class="note">
   <strong class="user">math[dot]lechat[at-at]gmail[dot]com</strong>
   <a href="#102431" class="date">14-Feb-2011 10:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"Cannot send session cookie - headers already sent" comes most often when the file is encoded in UTF-8 WITH BOM under Windows.<br />
When transfered on an UNIX server the BOM is considered as text and sent before any header you can define.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102254""></a>
  <div class="note">
   <strong class="user">anon at ymous dot com</strong>
   <a href="#102254" class="date">04-Feb-2011 10:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am trying to get a session created by a browser call to be used by a command line cli-&gt;curl php call (in this case, both calls to the same server and php.ini), for a set of flexible media import routines, <br />
<br />
but the cli-&gt;curl call always starts a new session despite me putting PHPSESSID=validID as the first parameter for the url called by curl.<br />
<br />
I was able to fix it by calling session_id($_GET['PHPSESSID']) before calling session_start() in the script called via curl.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101903""></a>
  <div class="note">
   <strong class="user">nizamgok at gmail dot com</strong>
   <a href="#101903" class="date">17-Jan-2011 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware that when you deliver your flash file through php, you cannot access the session vars that are set from the parent page in Opera, Safari and IE9. I didn't test it with IE6-8. Chrome and Firefox are OK. I don't know the real reason but guessing some of the header data are missing.
<br />

<br />
swf.php:
<br />
<span class="default">&lt;?php
<br />

<br />
session_start</span><span class="keyword">();
<br />

<br />
</span><span class="comment">//$_SESSION['test'] --&gt; doesn't exist!
<br />
//session_id() --&gt; != 'hey123'
<br />

<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: application/x-shockwave-flash'</span><span class="keyword">);
<br />

<br />
</span><span class="default">readfile</span><span class="keyword">(</span><span class="string">'/path/to/flash.swf'</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
index.php"
<br />
<span class="default">&lt;?php
<br />

<br />
session_id</span><span class="keyword">(</span><span class="string">'hey123'</span><span class="keyword">);
<br />
</span><span class="default">session_start</span><span class="keyword">();
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test'</span><span class="keyword">] = </span><span class="string">'test'</span><span class="keyword">;
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>&lt;object width="550" height="400"&gt;
<br />
&lt;param name="movie" value="<a href="http://example.com/swf/" rel="nofollow" target="_blank">http://example.com/swf/</a>"&gt;
<br />
&lt;/object&gt;
<br />

<br />
* swf directory has an .htaccess file which points to swf.php</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101452""></a>
  <div class="note">
   <strong class="user">dave1010 at gmail dot com</strong>
   <a href="#101452" class="date">17-Dec-2010 10:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP locks the session file until it is closed. If you have 2 scripts using the same session (i.e. from the same user) then the 2nd script will not finish its call to session_start() until the first script finishes execution.<br />
<br />
If you have scripts that run for more than a second and users may be making more than 1 request at a time then it is worth calling session_write_close() as soon as you've finished writing session data.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// a lock is places on the session, so other scripts will have to wait<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="comment">// do all your writing to $_SESSION<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'a'</span><span class="keyword">] = </span><span class="default">1</span><span class="keyword">;<br />
<br />
</span><span class="comment">// $_SESSION can still be read, but writing will not update the session.<br />
// the lock is removed and other scripts can now read the session<br />
</span><span class="default">session_write_close</span><span class="keyword">();<br />
<br />
</span><span class="default">do_something_slow</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Found this out from <a href="http://konrness.com/php5/how-to-prevent-blocking-php-requests/" rel="nofollow" target="_blank">http://konrness.com/php5/how-to-prevent-blocking-php-requests/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101301""></a>
  <div class="note">
   <strong class="user">chong at completemr dot com</strong>
   <a href="#101301" class="date">09-Dec-2010 04:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
We are facing a problem and getting an error when loading a php page<br />
<br />
Warning: session_start() [&lt;a href='function.session-start'&gt;function.session-start&lt;/a&gt;]: Cannot send session cookie - headers already sent by (output started at /www/http/example/zh_CN/unsubscribe.php:1) in /www/http/example/inc/common.php on line 4<br />
<br />
We had google and browse through some helps file and found some suggestion as below.<br />
<br />
1. Use ob_start to cache any output before session_start function.<br />
<br />
2. Make sure the session.save_path in php.ini is set and point to a valid path<br />
<br />
We had tried the above but still having some the same problem.<br />
<br />
We are using notepad ++ for the coding.<br />
<br />
And we notice that this file is somehow being encoded to UTF-8 by one of my colleague because he though that this will help to display the result in the correct languages.<br />
<br />
Solution:<br />
Change the encode to use ANSI and make sure the EOL conversion is set to UNIX.<br />
Bingo. Things are back to normal as expected.<br />
<br />
Note:<br />
The encode might cause this problem in certain machine but not others. So i had no clue on this. We had no problem running the php code with UTF-8 encode in a 64bits Linux Enterprise but hit the problem running in a 32 bits Linux slackware.<br />
<br />
Hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99286""></a>
  <div class="note">
   <strong class="user">user at annon dot org</strong>
   <a href="#99286" class="date">09-Aug-2010 01:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I recently stumbled upon a problem in my download script where a download link would be clicked but then no other links would work until that download had finished. Other instances/windows would not work either.<br />
<br />
This is because session_start() locks the session data until the script finishes. In my case, until the script had finished sending the file data (which in a throttling script can take a while).<br />
<br />
The solution is to use session_write_close();<br />
This writes the current session data back to the session and closes the session so that other instances/windows can access the script using the same session.<br />
<br />
Since adding it to my script my site can now have several files downloading at once from the same session and still serve pages.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99249""></a>
  <div class="note">
   <strong class="user">milanzivanovic at gmail dot com</strong>
   <a href="#99249" class="date">05-Aug-2010 10:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Resolve for:<br />
<br />
Warning: session_start() [function.session-start]: Cannot send session cookie - headers already sent by (output started at<br />
<br />
is in changing text editor encoding to ANSI or UTF-8 without BOM.<br />
<br />
Thanks God I found the answer!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98197""></a>
  <div class="note">
   <strong class="user">aladinfajr at gmail dot com</strong>
   <a href="#98197" class="date">01-Jun-2010 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
my problem was in<br />
session_start();<br />
when i include this term in my first code it show me Warning Message: Cannot Modfie cache limiter<br />
i had tryed many solves and dosn't work<br />
<br />
finally<br />
<br />
i write my code in other encode<br />
and it sccussfully worked<br />
<br />
i hope that help</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97061""></a>
  <div class="note">
   <strong class="user">gultron at hotmail dot com</strong>
   <a href="#97061" class="date">30-Mar-2010 05:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,<br />
<br />
I just had this error saying that there is something wrong with session_start(); even if session_start(); is the only command in the script.<br />
<br />
Warning: session_start() [function.session-start]: Node no longer exists in C:\xampp\htdocs\soui\index.php on line 3<br />
<br />
Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at C:\xampp\htdocs\soui\index.php:3) in C:\xampp\htdocs\soui\index.php on line 3<br />
<br />
I corrected this problem by deleting all the files in the tmp directory of the webserver, C:\xampp\tmp</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96491""></a>
  <div class="note">
   <strong class="user">info.at.merchandisinginteractive.sk</strong>
   <a href="#96491" class="date">02-Mar-2010 03:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A handy script that checks fot the presence of uft-8 byte order mark (BOM) in all files in all directories starting on current dir. Combined from the work of other people here...
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">fopen_utf8 </span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$file </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bom </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$bom </span><span class="keyword">!= </span><span class="string">b"\xEF\xBB\xBF"</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
} 
<br />

<br />
function </span><span class="default">file_array</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$exclude </span><span class="keyword">= </span><span class="string">".|..|design"</span><span class="keyword">, </span><span class="default">$recursive </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">) . </span><span class="string">"/"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$folder_handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exclude_array </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"|"</span><span class="keyword">, </span><span class="default">$exclude</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$filename </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$folder_handle</span><span class="keyword">))) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">), </span><span class="default">$exclude_array</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$filename </span><span class="keyword">. </span><span class="string">"/"</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Need to include full "path" or it's an infinite loop
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$recursive</span><span class="keyword">) </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">file_array</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$filename </span><span class="keyword">. </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$exclude</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">fopen_utf8</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$filename</span><span class="keyword">) )
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//$result[] = $filename;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo (</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$filename </span><span class="keyword">. </span><span class="string">"&lt;br&gt;"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">file_array</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95377""></a>
  <div class="note">
   <strong class="user">info at nospam dot mmfilm dot sk</strong>
   <a href="#95377" class="date">30-Dec-2009 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you running in problems with UTF-8 encoded files:<br />
<br />
I was getting an error because of the BOM, although i set Dreamweaver to "save as" the without the BOM. It appears that DW will not change this setting in already existing files. After creating a new file withou the BOM, everything worked well.<br />
<br />
I also recommend <a href="http://people.w3.org/rishida/utils/bomtester/index.php - a utility that remote checks for the presence of BOM." rel="nofollow" target="_blank">http://people.w3.org/rishida/utils/bomtester/index.php - a utility that remote checks for the presence of BOM.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95372""></a>
  <div class="note">
   <strong class="user">jamestrowbridge at gmail dot com</strong>
   <a href="#95372" class="date">29-Dec-2009 06:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Unfortunately, after pulling my hair out trying to figure out why my application was working fine in every browser other than IE ( Internet Explorer) (Opera, Chrome, Firefox, Safari are what I've tested this in) - when using a DNS CNAME record (like a vanity name that is different from the DNS A record, which is the hostname of the server) sessions do not work correctly.
<br />

<br />
If you store a session var while on the CNAME:
<br />
vanity.example.com and the hostname of the server is hosname.example.com
<br />
Then try to call the variable from a different page, it will not find it because of the CNAME (I guess it store the variable under the hostname, then when trying to read it it's still looking under the CNAME) the same application works fine when accessing it under the hostname directly.&nbsp; Keep in mind that I was testing this on an internal network.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94783""></a>
  <div class="note">
   <strong class="user">eugene at ultimatecms dot co dot za</strong>
   <a href="#94783" class="date">24-Nov-2009 07:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ever get an error like this:
<br />

<br />
Warning: Unknown: open(/tmp/sess_lLFJ,tk9eFs5PGtWKKf559oKFM3, O_RDWR) failed: Permission denied (13) ?
<br />

<br />
Don't ask me how, but I managed to fix it by calling
<br />
session_id() before session_start(), at the top of the page.
<br />

<br />
Try it. Hopefully it'll help someone else.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93954""></a>
  <div class="note">
   <strong class="user">myemail gerolf at pictureparking dot com</strong>
   <a href="#93954" class="date">08-Oct-2009 01:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
please note that at least in php 5.3.0 the setting session.use_only_cookies (in php.ini) defaults to "on". This means that using trans_id, and passing the PHPSESSID via the url does not work untill you change that setting.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93673""></a>
  <div class="note">
   <strong class="user">Charlie at NOSPAM dot example dot com</strong>
   <a href="#93673" class="date">22-Sep-2009 04:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be warned that depending on end of script to close the session will effectively serialize concurrent session requests.&nbsp;&nbsp; Concurrent background "data retrieval" (e.g. applications such as AJAX or amfphp/Flex) expecting to retrieve data in parallel can fall into this trap easily.<br />
<br />
Holding the session_write_close until after an expensive operation is likewise problematic.<br />
<br />
To minimize effects, call session_write_close (aka session_commit) as early as practical (e.g. without introducing race conditions) or otherwise avoid the serialization bottleneck.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92490""></a>
  <div class="note">
   <strong class="user">schlang</strong>
   <a href="#92490" class="date">27-Jul-2009 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you store your sessions in a database, always ensure that the type of the database column is large enough for your session values</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92432""></a>
  <div class="note">
   <strong class="user">emre@yazici</strong>
   <a href="#92432" class="date">23-Jul-2009 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP Manual specifically denotes this common mistake:<br />
<br />
Depending on the session handler, not all characters are allowed within the session id. For example, the file session handler only allows characters in the range a-z A-Z 0-9 , (comma) and - (minus)!<br />
<br />
See session_id() manual page for more details.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92356""></a>
  <div class="note">
   <strong class="user">dstuff at brainsware dot org</strong>
   <a href="#92356" class="date">21-Jul-2009 02:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems like spaces in the name don't work either - got a new session id generated each time</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92162""></a>
  <div class="note">
   <strong class="user">abiusx at gmail dot com</strong>
   <a href="#92162" class="date">12-Jul-2009 12:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Working with Comet, or any other parallel or simultaneous requests from a single browser (a single session) would lock the application if it uses a centralized session management. <br />
<br />
To fix this, you should add session_commit() (Alias of session_write_close() ) after ALL session management, i.e using any session_* functions except session_start() is forbidden after that an causes an error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91759""></a>
  <div class="note">
   <strong class="user">hperrin at gmail dot com</strong>
   <a href="#91759" class="date">24-Jun-2009 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using session_start() multiple times in one script, it seems to only maintain $_SESSION variables with string keys.<br />
<br />
<span class="default">&lt;?php<br />
session_start</span><span class="keyword">();<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">'this is a test'</span><span class="keyword">;<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="string">'this is also a test'</span><span class="keyword">;<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test0'</span><span class="keyword">] = </span><span class="string">'this is a test'</span><span class="keyword">;<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test1'</span><span class="keyword">] = </span><span class="string">'this is also a test'</span><span class="keyword">;<br />
</span><span class="default">session_write_close</span><span class="keyword">();<br />
<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
echo </span><span class="string">"Session var 0 = "</span><span class="keyword">.</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">].</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"Session var 1 = "</span><span class="keyword">.</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">].</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"Session var 'test0' = "</span><span class="keyword">.</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test0'</span><span class="keyword">].</span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"Session var 'test1' = "</span><span class="keyword">.</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test1'</span><span class="keyword">];<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs:<br />
Session var 0 =<br />
Session var 1 =<br />
Session var 'test0' = this is a test<br />
Session var 'test1' = this is also a test</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91298""></a>
  <div class="note">
   <strong class="user">gilthans NOSPAN  at  gmail  dot com</strong>
   <a href="#91298" class="date">04-Jun-2009 02:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If two different files don't access the same session, it can only mean one thing: they aren't on the same directory level.
<br />
Examples:
<br />
a) One is under https, and one is under http. (very common and annoying error)
<br />
b) One is under /, another is under /dir1, and /dir1 was first to run. The cookie created by the session is for /dir1 and deeper only, so the other script can't read it; it sees no session so it starts a new one.
<br />

<br />
Solutions:
<br />
1) Session start should always happen at root dir. If one of your scripts discovers user is not logged in, for example, use session_destroy() and send him to the login in the root dir. Scripts that use session without requiring login needs more creative solutions, like redirecting to the root dir, setting the session, and redirecting back.
<br />
2) Use SID from page to page, instead of cookies. The upside is that this also works with http/https. The downside is very ugly URL codes and more difficult maintainability ('which pages links to gallery.php without using SID?!').</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90968""></a>
  <div class="note">
   <strong class="user">kavih7 at yahoo dot com</strong>
   <a href="#90968" class="date">19-May-2009 01:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I ran into a problem that has a solution that may not be quite intuitive to people (well, atleast it wasn't for me). I had one script that called session_start() and that script would run for an indefinite amount of time. I had a second script that would also call session_start(), but would only run for a few seconds each time it is called.<br />
<br />
Here is where the problem occurs: Once session_start is called from the long living script, no other script can call session_start until that long running script calls session_commit() (session_write_close()) or ends.<br />
<br />
In any case, this may have seem very intuitive to others, but having an abstracted system in place, I never see the session management at the script level, so it was hard to figure out what was locking any other requests.<br />
<br />
Hope this helps others.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90007""></a>
  <div class="note">
   <strong class="user">Gravis</strong>
   <a href="#90007" class="date">01-Apr-2009 08:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to check if a session has already been activated, you can check $_COOKIE["PHPSESSID"] for a value before reactivating that session.<br />
<br />
Example code:<br />
<br />
== login.php ==<br />
<span class="default">&lt;?php<br />
&nbsp; session_start</span><span class="keyword">();<br />
&nbsp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"data"</span><span class="keyword">] = </span><span class="string">"you have an active session!"</span><span class="keyword">;<br />
&nbsp; echo </span><span class="string">"&lt;a href=\"page.php\"&gt;go&lt;/a&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
== page.php ==<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">if(isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">"PHPSESSID"</span><span class="keyword">]))<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"data"</span><span class="keyword">];<br />
&nbsp; }<br />
&nbsp; else<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"no cookies required!"</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
This can prevent forcing a cookie on someone (very annoying in lynx) that doesnt intend to login on your site.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89989""></a>
  <div class="note">
   <strong class="user">LaurenceJ44 at Hotmail dot com</strong>
   <a href="#89989" class="date">01-Apr-2009 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I kept getting:<br />
Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at myfile.php:2)<br />
<br />
Only when I had uploaded my pages from my home development server to my hosted website.&nbsp; the same page worked fine in development, so there must be a difference in the php setup, but since this is a site that hosts many different clients web sites, I can't get them to change thier config.<br />
<br />
After a little bit of research and trial and error, I found the cure was to move the line:<br />
<span class="default">&lt;?php session_start</span><span class="keyword">(); </span><span class="default">?&gt;</span> <br />
<br />
to be the very 1st line in any .php file.<br />
<br />
orginally I had:<br />
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" rel="nofollow" target="_blank">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>"&gt;<br />
<span class="default">&lt;?php session_start</span><span class="keyword">(); </span><span class="default">?&gt;<br />
</span>&lt;html&gt;<br />
&lt;head&gt;<br />
...etc<br />
<br />
so I changed it to :<br />
<span class="default">&lt;?php session_start</span><span class="keyword">(); </span><span class="default">?&gt;<br />
</span>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "<a href="http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd" rel="nofollow" target="_blank">http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd</a>"&gt;<br />
&lt;html&gt;<br />
&lt;head&gt;<br />
...etc<br />
<br />
and all is well...<br />
<br />
The clue is in the warning message, it ends :2)&nbsp; which means the session_start() call is not on line 1 of the file!<br />
<br />
Hope this helps &amp; good Luck<br />
<br />
Loz</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89775""></a>
  <div class="note">
   <strong class="user">microvalen at NOSPAM dot microvalen dot com</strong>
   <a href="#89775" class="date">23-Mar-2009 07:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have tried many times a lot of login scripts but sometimes when you have a lot of traffic you can note the "overloading" of the server tring to deal with all sessions specialy with the long, long scripts and classes ... checking all stuffs (ids, ips, usernames, etc) the loading page increase ...specialy when you have a "home" server with a small blog..
<br />

<br />
if you open the folder "/tmp" you will thousands of files that do nothing else that increasing the size of the folder.
<br />
Sessions are good and I just offer an alternative.
<br />
.. and for that I just created in about 20 min a simple script that can handle a simple login.
<br />

<br />
&lt;b&gt;(Be aware !! this is just an example .. it not make use of any check of xss atacks or other scripts !!!&lt;/b&gt;
<br />

<br />
and make use of cookies [today all moderns browsers use cookies])
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$mysqli </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="string">'localhost'</span><span class="keyword">, </span><span class="string">'root'</span><span class="keyword">, </span><span class="string">'pass'</span><span class="keyword">, </span><span class="string">'nameofDB'</span><span class="keyword">);
<br />

<br />
if (</span><span class="default">mysqli_connect_errno</span><span class="keyword">()) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"Connect failed: %s\n"</span><span class="keyword">, </span><span class="default">mysqli_connect_error</span><span class="keyword">());
<br />
&nbsp;&nbsp;&nbsp; exit(); }
<br />

<br />
</span><span class="default">$cookie </span><span class="keyword">= (isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'vuid'</span><span class="keyword">])) ? </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'vuid'</span><span class="keyword">] : </span><span class="string">''</span><span class="keyword">;
<br />

<br />
if(!</span><span class="default">$cookie</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$user_level </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'vuid'</span><span class="keyword">, </span><span class="string">'0.' </span><span class="keyword">. </span><span class="default">md5</span><span class="keyword">(</span><span class="string">'anonymous'</span><span class="keyword">)); }
<br />
else {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$part </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'.'</span><span class="keyword">, </span><span class="default">$cookie</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$user_level </span><span class="keyword">= (int) </span><span class="default">$part</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$user_name </span><span class="keyword">= (string) </span><span class="default">$part</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];
<br />

<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$user_level </span><span class="keyword">!= </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$is_logged </span><span class="keyword">= </span><span class="default">check_login</span><span class="keyword">(</span><span class="default">$user_level</span><span class="keyword">, </span><span class="default">$user_name</span><span class="keyword">); }
<br />
&nbsp;&nbsp;&nbsp; else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$is_logged </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">; } }
<br />

<br />
if(isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'login'</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// here you MUST make a form and a function that realy check the login ...
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$YourFunctionCheckIsOk</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'vuid'</span><span class="keyword">, </span><span class="comment">/*levels betwen 1-9*/ </span><span class="string">'9.' </span><span class="keyword">. </span><span class="default">md5</span><span class="keyword">(</span><span class="string">'PutTheUserNameHere'</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;meta http-equiv="refresh" content="1;URL=index.php"&gt;
<br />
&nbsp;&nbsp;&nbsp; Correct Login&lt;br&gt;
<br />
&nbsp;&nbsp;&nbsp; You will be redirected to the main page'</span><span class="keyword">; } }
<br />
elseif(isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'logout'</span><span class="keyword">])) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'vuid'</span><span class="keyword">, </span><span class="string">'0.' </span><span class="keyword">. </span><span class="default">md5</span><span class="keyword">(</span><span class="string">'anonymous'</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;meta http-equiv="refresh" content="1;URL=index.php"&gt;
<br />
&nbsp;&nbsp;&nbsp; You are out now ... see you soon&lt;br&gt;
<br />
&nbsp;&nbsp;&nbsp; You will be redirected to the main page'</span><span class="keyword">; }
<br />
else {
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$is_logged</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'Welcome ' </span><span class="keyword">. </span><span class="default">USERNAME </span><span class="keyword">. </span><span class="string">' &lt;a href="?logout"&gt;LOGOUT&lt;/a&gt;'</span><span class="keyword">; }
<br />
&nbsp;&nbsp;&nbsp; else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'You are a Anonymous. LOGIN &lt;a href="?login"&gt;HERE&lt;/a&gt;'</span><span class="keyword">; } }
<br />

<br />
function </span><span class="default">check_login</span><span class="keyword">(</span><span class="default">$user_level</span><span class="keyword">, </span><span class="default">$user_name</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$mysqli</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$is_logged </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="string">'SELECT nick FROM accounts WHERE user_level = ' </span><span class="keyword">. </span><span class="default">$user_level</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$row </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetch_array</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$user_name </span><span class="keyword">=== </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">[</span><span class="string">'nick'</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">define</span><span class="keyword">(</span><span class="string">'USERNAME'</span><span class="keyword">, </span><span class="default">$row</span><span class="keyword">[</span><span class="string">'nick'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$is_logged </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$is_logged </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">; }
<br />

<br />
</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
PS: you can change the nick with the ip or better use both !
<br />
like:
<br />
&nbsp;"level.md5(sha1(nick)).sha1(md5(ip)) etc ...
<br />
&nbsp;"0.4aea7c7d495676.4aea7c7d495676"
<br />
and check them separetly by &lt;a href="<a href="http://php.net/explode" rel="nofollow" target="_blank">http://php.net/explode</a>"&gt;"exploding"&lt;/a&gt; them ..
<br />
play arround ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89134""></a>
  <div class="note">
   <strong class="user">tchalvakspam at gmail dot com</strong>
   <a href="#89134" class="date">23-Feb-2009 10:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware that if a browser isn't accepting cookies, it can cause the session to invisibly not save between two pages.<br />
<br />
So for example, in Firefox 3.0.6 there is a bug where "localhost" addresses are currently not saving cookies.&nbsp; This will kill any attempts to use session code in development where localhost is used.<br />
<br />
One workaround for this is to use a different synonym for the localhost address, i.e. <a href="http://127.0.0.1/, or set up a virtualhost, e.g. http://localdevelopment/" rel="nofollow" target="_blank">http://127.0.0.1/, or set up a virtualhost, e.g. http://localdevelopment/</a><br />
<br />
Overall, pay close attention if you see to different, unexpected session behavior in two different browsers, it may be a result of the cookies being handled differently or being dropped.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88731""></a>
  <div class="note">
   <strong class="user">yesmarklapointe at hotmail dot com</strong>
   <a href="#88731" class="date">05-Feb-2009 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is some info about how to use SID with session_start(). 
<br />
Experiment run on WAMPserver, PHP version 5.2.6. 
<br />
Using FireFox 3.0.
<br />

<br />
The definition found at <a href="http://www.php.net/manual/en/session.constants.php&nbsp; " rel="nofollow" target="_blank">http://www.php.net/manual/en/session.constants.php&nbsp; </a>
<br />
describes SID is a "pre-defined constant" containing either: 
<br />
1). the session name and session ID in the form of "name=ID" .
<br />
This is the same name as would be returned by session_name(), and the same id as would be returned 
<br />
by session_id().&nbsp; 
<br />

<br />
2).&nbsp; Or an empty string,&nbsp; if the session ID was set in an appropriate session cookie. 
<br />

<br />
Example code:
<br />
<span class="default">&lt;?php
<br />
session_start</span><span class="keyword">();
<br />
echo </span><span class="string">'&lt;a href="page2.php?' </span><span class="keyword">. </span><span class="default">SID </span><span class="keyword">. </span><span class="string">'"&gt;page2&lt;/a&gt;'</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
This code will yield in the browser one of the following: 
<br />
a).&nbsp;&nbsp; "page 2"&nbsp; &nbsp; &nbsp; (as a hyperlink, but mouseover shows the link is to something in the form of 
<br />
<a href="http://www.example.com/page2.php?PHPSESSID=e2bd7072....&nbsp; " rel="nofollow" target="_blank">http://www.example.com/page2.php?PHPSESSID=e2bd7072....&nbsp; </a>)
<br />

<br />
b).&nbsp;&nbsp; "page 2"&nbsp; &nbsp;&nbsp; (as a hyperlink, but mouseover shows <a href="http://www.example.com/page2.php? " rel="nofollow" target="_blank">http://www.example.com/page2.php? </a>)
<br />

<br />
Which result is determined by whether or not the browser is sending a matching session cookie back to the script. Result "a" above always appears at least initially since the script hasn't yet set a cookie and neither has it been done automatically yet by the php.ini setting session.use_cookies. However, after refreshing or using the back button, the form in "b" will appear because then the cookie exists (either you set it or session.use_cookies did it automatically).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88588""></a>
  <div class="note">
   <strong class="user">info at vanylla dot it</strong>
   <a href="#88588" class="date">30-Jan-2009 01:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If while testing locally on your Windows machine you get many warnigns like:<br />
<br />
Warning: session_start()... failed: No such file or directory<br />
Warning: session_start()...: Cannot send session cache limiter - headers already sent <br />
etc.<br />
<br />
you need to configure properly the session.save_path in your php.ini file.<br />
<br />
Set session.save_path to an existing folder on your PC.<br />
For example: session.save_path="C:\Temp";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88448""></a>
  <div class="note">
   <strong class="user">Jessycormier at gmail dot com</strong>
   <a href="#88448" class="date">25-Jan-2009 12:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found i was getting a lot of <br />
"Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent "<br />
<br />
Warnings, on some pages, where as on other pages it worked just fine.<br />
<br />
After some time looking around and trying things like ob_start() and session_write_close()... nothing seemed to work.<br />
<br />
Then i realized the encoding of the page. I checked the encoding of the page and it was set to UTF-8, so I changed it to ANSI and now the Warnings went away.<br />
<br />
Good luck any one else.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88123""></a>
  <div class="note">
   <strong class="user">philippe dot latulippe at xxxxgmail dot com</strong>
   <a href="#88123" class="date">12-Jan-2009 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using session_start() with cookies over an encrypted connection (like HTTPS) it is important to set php_ini('session.cookie_secure',true).&nbsp; This sets a flag in the cookie which will stop browsers from sending this cookie over an unsecured connection.&nbsp; If this is not done, a Man-In-The-Middle could easily cause the victim's browser to send his session ID in plaintext, gaining access to the account and defeating the goal of the secure connection.<br />
<br />
<a href="http://fscked.org/blog/fully-automated-active-https-cookie-hijacking" rel="nofollow" target="_blank">http://fscked.org/blog/fully-automated-active-https-cookie-hijacking</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87462""></a>
  <div class="note">
   <strong class="user">zidaine_38 at yahoo dot com</strong>
   <a href="#87462" class="date">06-Dec-2008 05:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">SESSION 
<br />
</span><span class="keyword">{
<br />
&nbsp;&nbsp; public function </span><span class="default">__construct </span><span class="keyword">()
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">commence </span><span class="keyword">();
<br />
&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; public function </span><span class="default">commence </span><span class="keyword">()
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; if ( !isset( </span><span class="default">$_SESSION </span><span class="keyword">[</span><span class="string">'ready'</span><span class="keyword">] ) ) 
<br />
&nbsp;&nbsp; &nbsp; { 
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">session_start </span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">[</span><span class="string">'ready'</span><span class="keyword">] = </span><span class="default">TRUE</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; } 
<br />
&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; public function </span><span class="default">set </span><span class="keyword">( </span><span class="default">$fld </span><span class="keyword">, </span><span class="default">$val </span><span class="keyword">) 
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">commence </span><span class="keyword">();
<br />
&nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">[ </span><span class="default">$fld</span><span class="keyword">]&nbsp; = </span><span class="default">$val</span><span class="keyword">;
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; public function </span><span class="default">un_set </span><span class="keyword">( </span><span class="default">$fld </span><span class="keyword">)&nbsp; 
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">commence </span><span class="keyword">();
<br />
&nbsp;&nbsp; unset( </span><span class="default">$_SESSION </span><span class="keyword">[</span><span class="default">$fld</span><span class="keyword">] );
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; public function </span><span class="default">destroy </span><span class="keyword">()
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">commence </span><span class="keyword">();
<br />
&nbsp;&nbsp; unset ( </span><span class="default">$_SESSION </span><span class="keyword">);
<br />
&nbsp;&nbsp; </span><span class="default">session_destroy </span><span class="keyword">();
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; public function </span><span class="default">get </span><span class="keyword">( </span><span class="default">$fld </span><span class="keyword">) 
<br />
&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">commence </span><span class="keyword">();
<br />
&nbsp;&nbsp; return </span><span class="default">$_SESSION </span><span class="keyword">[</span><span class="default">$fld</span><span class="keyword">];
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; public function </span><span class="default">is_set </span><span class="keyword">( </span><span class="default">$fld </span><span class="keyword">) {
<br />
&nbsp;&nbsp; </span><span class="default">self </span><span class="keyword">:: </span><span class="default">commence </span><span class="keyword">();
<br />
&nbsp;&nbsp; return isset( </span><span class="default">$_SESSION </span><span class="keyword">[</span><span class="default">$fld</span><span class="keyword">] );
<br />
&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
This Class is handy to all who want easy session handling.
<br />
Just include () or require () this to pages where you will have to use session.
<br />

<br />
example:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;</span><span class="keyword">include ( </span><span class="string">"/path/to/sess.inc.php" </span><span class="keyword">);
<br />
&nbsp;if( !</span><span class="default">SESSION </span><span class="keyword">:: </span><span class="default">is_set </span><span class="keyword">( </span><span class="string">"number" </span><span class="keyword">) )
<br />
&nbsp; {
<br />
&nbsp;&nbsp; </span><span class="default">SESSION </span><span class="keyword">:: </span><span class="default">set </span><span class="keyword">( </span><span class="string">"number" </span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);
<br />
&nbsp; }
<br />
&nbsp;else 
<br />
&nbsp; {
<br />
&nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">[</span><span class="string">"number"</span><span class="keyword">] ++;
<br />
&nbsp; }
<br />
&nbsp; echo </span><span class="default">SESSION </span><span class="keyword">:: </span><span class="default">get </span><span class="keyword">( </span><span class="string">"number" </span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87069""></a>
  <div class="note">
   <strong class="user">andy_isherwood at hotmail dot com</strong>
   <a href="#87069" class="date">18-Nov-2008 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A session created with session_start will only be available to pages within the directory tree of the page that first created it.<br />
<br />
i.e. If the page that first creates the session is /dir1/dir2/index.php and the user then goes to any page above dir2 (e.g. /dir1/index.php), session_start will create a new session rather than use the existing one.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84528""></a>
  <div class="note">
   <strong class="user">aban at datahouselibya dot com</strong>
   <a href="#84528" class="date">17-Jul-2008 05:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for resolve the problem with session_start()
<br />
Cannot send session cache limiter - headers already sent (output started at ..."
<br />

<br />
write it at first line of the page like
<br />

<br />
<span class="default">&lt;?php session_start</span><span class="keyword">(); </span><span class="default">?&gt;
<br />
</span>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;
<br />
&lt;html&gt;
<br />
&lt;body&gt;
<br />
<span class="default">&lt;?php $_SESSION</span><span class="keyword">[</span><span class="string">'name'</span><span class="keyword">]=</span><span class="string">'mohamed'</span><span class="keyword">; </span><span class="default">?&gt;
<br />
</span>&lt;/body&gt;
<br />
&lt;html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84423""></a>
  <div class="note">
   <strong class="user">michael at pythontech dot net dot au</strong>
   <a href="#84423" class="date">14-Jul-2008 05:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@ash<br />
<br />
Whilst this may prevent session hijacking attempts, it also ruins the user experience, pressing back and forward will result in the 'security' token being out of sync. Also opening new tabs/ windows will also cause issues.<br />
<br />
A better method would be to simply check the ip address or ip block of the user. But this is not without problems either.<br />
<br />
To access highly sensitive information, the user should be required to enter his/her password again, even tho they are logged in. This ensures that session hijackers can not access this information.<br />
<br />
All this goes hand-in-hand with regenerating session ids on login, and good use of https.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83499""></a>
  <div class="note">
   <strong class="user">ash at atomic-network dot co dot uk</strong>
   <a href="#83499" class="date">28-May-2008 06:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@My last post...<br />
the function will generate the session "token" you just need to do a check and regenerate it on each page load...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83498""></a>
  <div class="note">
   <strong class="user">ash at atomic-network dot co dot uk</strong>
   <a href="#83498" class="date">28-May-2008 06:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When developing applications or just creating a general website with the use of sessions, many developers do not think about securing session hijacking attacks. For further information I recommend searching google, however I have produced a small function to be called immediately after session_start().<br />
<br />
your_page.php:<br />
<span class="default">&lt;?php<br />
session_start</span><span class="keyword">();<br />
include_once </span><span class="string">'session_secure.inc.php'</span><span class="keyword">;<br />
</span><span class="default">session_secure</span><span class="keyword">();<br />
</span><span class="comment"># Your content here.<br />
</span><span class="default">?&gt;<br />
</span><br />
session_secure.inc.php :<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">session_secure</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// wrapped for the php entry....<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$alph </span><span class="keyword">=array(</span><span class="string">'A'</span><span class="keyword">,</span><span class="string">'a'</span><span class="keyword">,</span><span class="string">'B'</span><span class="keyword">,</span><span class="string">'b'</span><span class="keyword">,</span><span class="string">'C'</span><span class="keyword">,</span><span class="string">'c'</span><span class="keyword">,</span><span class="string">'D'</span><span class="keyword">,</span><span class="string">'d'</span><span class="keyword">,</span><span class="string">'E'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'e'</span><span class="keyword">,</span><span class="string">'F'</span><span class="keyword">,</span><span class="string">'f'</span><span class="keyword">,</span><span class="string">'G'</span><span class="keyword">,</span><span class="string">'g'</span><span class="keyword">,</span><span class="string">'H'</span><span class="keyword">,</span><span class="string">'h'</span><span class="keyword">,</span><span class="string">'I'</span><span class="keyword">,</span><span class="string">'i'</span><span class="keyword">,</span><span class="string">'J'</span><span class="keyword">,</span><span class="string">'K'</span><span class="keyword">,</span><span class="string">'k'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'L'</span><span class="keyword">,</span><span class="string">'l'</span><span class="keyword">,</span><span class="string">'M'</span><span class="keyword">,</span><span class="string">'m'</span><span class="keyword">,</span><span class="string">'N'</span><span class="keyword">,</span><span class="string">'n'</span><span class="keyword">,</span><span class="string">'O'</span><span class="keyword">,</span><span class="string">'o'</span><span class="keyword">,</span><span class="string">'P'</span><span class="keyword">,</span><span class="string">'p'</span><span class="keyword">,</span><span class="string">'Q'</span><span class="keyword">,</span><span class="string">'q'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'R'</span><span class="keyword">,</span><span class="string">'r'</span><span class="keyword">,</span><span class="string">'S'</span><span class="keyword">,</span><span class="string">'s'</span><span class="keyword">,</span><span class="string">'T'</span><span class="keyword">,</span><span class="string">'t'</span><span class="keyword">,</span><span class="string">'U'</span><span class="keyword">,</span><span class="string">'u'</span><span class="keyword">,</span><span class="string">'V'</span><span class="keyword">,</span><span class="string">'v'</span><span class="keyword">,</span><span class="string">'W'</span><span class="keyword">,</span><span class="string">'w'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'X'</span><span class="keyword">,</span><span class="string">'x'</span><span class="keyword">,</span><span class="string">'Y'</span><span class="keyword">,</span><span class="string">'y'</span><span class="keyword">,</span><span class="string">'Z'</span><span class="keyword">,</span><span class="string">'z'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">rand</span><span class="keyword">(</span><span class="default">10</span><span class="keyword">,</span><span class="default">20</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp</span><span class="keyword">[] =</span><span class="default">$alph</span><span class="keyword">[</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">count</span><span class="keyword">(</span><span class="default">$alph</span><span class="keyword">))];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tmp</span><span class="keyword">[] =</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">9</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">shuffle</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
There are quicker ways like md5(time()*rand()), however the function above is completely random, and will render an attackers hijacking task almost impossible.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83182""></a>
  <div class="note">
   <strong class="user">vladimir at pixeltomorrow dot com</strong>
   <a href="#83182" class="date">14-May-2008 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Kind of ankward it's not mentioned here, but you should also trigger the session_write_close() function as soon as possible so you'll release the lock over the session files.<br />
<br />
Cheers,<br />
Vladimir Ghetau</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83114""></a>
  <div class="note">
   <strong class="user">chrismckeeuk at gmail dot com</strong>
   <a href="#83114" class="date">10-May-2008 09:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your sessions are failing to hold the stored data ensure that session.use_only_cookies is set to 1 in your PHP.ini config.<br />
<br />
Also using the session auto start saves on a lot of issues and removes the issue of people setting the session_start after the html begins.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82957""></a>
  <div class="note">
   <strong class="user">Anthony Catel p at NOSPAM dot rabol dot fr</strong>
   <a href="#82957" class="date">03-May-2008 05:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
session_start() generate a warning if PHPSESSID contains illegal characters<br />
<br />
Warning: session_start() [function.session-start]: The session id contains illegal characters, valid characters are a-z, A-Z, 0-9 and '-,' in /home/para/dev/mon_site/header.php on line 17<br />
<br />
To avoid i wrote this :<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">my_session_start</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sessid </span><span class="keyword">= </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else if (isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sessid </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^[a-z0-9]{32}$/'</span><span class="keyword">, </span><span class="default">$sessid</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">session_start</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81485""></a>
  <div class="note">
   <strong class="user">php at hogerheijde dot net</strong>
   <a href="#81485" class="date">29-Feb-2008 08:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
That's why you shouldn't use register_globals and refer to<br />
$_GET['id']<br />
for the page.php?id=1<br />
or if you don't care if it is GET or POST you can use<br />
$_REQUEST['id']<br />
<br />
Those will not be cleared by session_start().<br />
<br />
To complete: you should use $_SESSION['id'] to get the content of the session.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81378""></a>
  <div class="note">
   <strong class="user">jphansen at uga dot edu</strong>
   <a href="#81378" class="date">25-Feb-2008 08:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just wrote that session_start() will erase your querystring variable(s) once called. I want to clarify that it will only do this if a variable by the same subscript is defined in $_SESSION[].</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81377""></a>
  <div class="note">
   <strong class="user">jphansen at uga dot edu</strong>
   <a href="#81377" class="date">25-Feb-2008 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning, calling session_start() will reset your querystring values.<br />
<br />
Navigating to page.php?id=1<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">"id = </span><span class="default">$id</span><span class="string">"</span><span class="keyword">; </span><span class="comment">// 1<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
echo </span><span class="string">"id = </span><span class="default">$id</span><span class="string">"</span><span class="keyword">; </span><span class="comment">// ""<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81167""></a>
  <div class="note">
   <strong class="user">fixis at nexus dot com</strong>
   <a href="#81167" class="date">16-Feb-2008 03:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I also found using session_write_close(); after you send your custom headers sometimes helps on some servers.&nbsp; This protects any data from being cleared out by some of these errors mentioned.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80882""></a>
  <div class="note">
   <strong class="user">cbake6807 at comcast dot net</strong>
   <a href="#80882" class="date">05-Feb-2008 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Having a problem in IE causing your getFile.php script to be pushed to the browser as an empty text file, instead of the intended attachment?<br />
<br />
If your php config causes session_start() to output a cookie, or anything funky, IE will not like the filename and will also try and read the file contents inline into the browser window. <br />
<br />
Don't use session_start() or USE Output Buffering after the session is started.<br />
<br />
&lt;? //session_start();<br />
<br />
&nbsp;&nbsp;&nbsp; function force_download($file)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((isset($file))&amp;&amp;(file_exists($file))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $fileArray = explode("/", $file);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; header("Content-type: application/force-download");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; header("Content-Disposition: attachment; filename=".$fileArray[sizeof($fileArray)-1]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; header("Content-Transfer-Encoding: Binary");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; header("Content-length: ".filesize($file));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; header('Content-Type: application/octet-stream');<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; header("Content-Disposition: attachment; filename=".$fileArray[sizeof($fileArray)-1]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; readfile("$file");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "No file selected";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } //end if<br />
<br />
&nbsp;&nbsp;&nbsp; }//end function<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80653""></a>
  <div class="note">
   <strong class="user">rudylattae at gmail dot com</strong>
   <a href="#80653" class="date">28-Jan-2008 02:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
File Encoding was causing my session_start() statement to generate an unexpected warning.<br />
<br />
Environment:<br />
OS: Windows XP Pro (32bit)<br />
PHP: v5.2.5<br />
Apache: v2.0.61<br />
<br />
I was having this warning:<br />
Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at ...<br />
<br />
I was rather pissed off because I know of this issue and I know how to fix it:<br />
<br />
1) Just make sure the session_start() directive is processed before any other statements that modify the content headers.<br />
<br />
2) Failing #1 above, you should also make sure that your script files do not have any beginning/trailing space or carriage return characters.<br />
<br />
3) As a last stand, you could use output buffering to hold your stuff in memory and then spit it out at the very end. This would essentially allow you to manipulate the headers to your heart's content without getting any crap from php.<br />
<br />
Note: with regards to #2 above, I know some devels use the interesting construct of no closing php braces e.g.:<br />
<br />
&gt; info.php<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; phpinfo</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span> (they omit this)<br />
<br />
It seems the tag is not required by php (at least php does not puke) so the parser does not treat any trailing spaces as output to be sent to the user agent. I'm not using this loop-hole at the moment.<br />
<br />
Anyway the above resolutions *did not* work for me (yer even #3) and I was about to give up and just gag php with good ol "@". <br />
<br />
It was then that I thought to check the encoding of my php file. Turns out I had left my editor in UTF-8 encode mode from some previous (i18n) work I had done. I switched to ANSI and that fixed the problem. Suddenly the same file that had caused php to scream in pain was being processed without any issues. <br />
<br />
I also noted that I could set the editor to "Encode in UTF-8 without BOM" and that also works. The BOM is the byte order mark which php probably glosses over (or does not understand). I didn't look too far into it. <br />
<br />
I hope this helps someone else.<br />
<br />
Cheers!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80264""></a>
  <div class="note">
   <strong class="user">omnibus at omnibus dot edu dot pl</strong>
   <a href="#80264" class="date">07-Jan-2008 12:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You probably know it but in case somebody did not:<br />
session_start() must be called BEFORE any explicit operations on the $_SESSION variable; otherwise $_SESSION will be treated as an ordinary variable and not stored for future use.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79175""></a>
  <div class="note">
   <strong class="user">k dot dafalias at ist dot eduhi dot at</strong>
   <a href="#79175" class="date">14-Nov-2007 01:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you encounter "The session id contains illegal characters" error, find out, if you get an empty session id.<br />
If so, the problem ist fixed easily:<br />
<br />
if(!session_id()) session_regenerate_id();</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77918""></a>
  <div class="note">
   <strong class="user">ehassler at synapsestudios dot com</strong>
   <a href="#77918" class="date">20-Sep-2007 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
At work we had an odd warning, "Cannot send session cache limiter - headers already sent". In the following: <br />
<br />
header('meta:1'); <br />
session_start();<br />
<br />
the first header went across fine, but the session_start died with the warning.&nbsp; <br />
<br />
What was happening was that the session contained an object which fired __autoload() when it was unserialized. The __autoload() then included the file with the class definition, but that file also output non-header text.&nbsp; This caused session_start() to be unable to add the session_id to the headers.<br />
<br />
This was difficult to find because we weren't able to see the text that was output from the file that was __autoload()ed, only the warning.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76241""></a>
  <div class="note">
   <strong class="user">(zero)luke(zero)(at)gmail(dot)com</strong>
   <a href="#76241" class="date">07-Jul-2007 12:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding the posts discussing ways of checking if a session is active, I've found that this is the best way, aslong as you dont assign any variables to the $_SESSION superglobal before calling the function.<br />
<br />
The Function:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">session_started</span><span class="keyword">(){<br />
<br />
&nbsp;&nbsp;&nbsp; if(isset(</span><span class="default">$_SESSION</span><span class="keyword">)){ return </span><span class="default">true</span><span class="keyword">; }else{ return </span><span class="default">false</span><span class="keyword">; }<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
An Example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">session_started</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; if(isset(</span><span class="default">$_SESSION</span><span class="keyword">)){ return </span><span class="default">true</span><span class="keyword">; }else{ return </span><span class="default">false</span><span class="keyword">; }<br />
}<br />
<br />
</span><span class="comment">//Start the output buffer so we dont create any errors with headers<br />
</span><span class="default">ob_start</span><span class="keyword">(); <br />
<br />
</span><span class="comment">//Check to see if it has been started<br />
</span><span class="keyword">if(</span><span class="default">session_started</span><span class="keyword">()){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'The session has been started.&lt;br /&gt;'</span><span class="keyword">;<br />
}else{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'The session has not been started.&lt;br /&gt;'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//Start the session<br />
</span><span class="keyword">echo </span><span class="string">'Starting Session...&lt;br /&gt;'</span><span class="keyword">;<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="comment">//Check again<br />
</span><span class="keyword">if(</span><span class="default">session_started</span><span class="keyword">()){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'The session has been started.&lt;br /&gt;'</span><span class="keyword">;<br />
}else{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'The session has not been started.&lt;br /&gt;'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//Flush the buffer to screen<br />
</span><span class="default">ob_end_flush</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope this helps some people.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75147""></a>
  <div class="note">
   <strong class="user">Steffen dot Pietsch at berlinonline dot de</strong>
   <a href="#75147" class="date">15-May-2007 12:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Beware to use $_SESSION as parameter to a function.<br />
(here: php5&nbsp; 5.1.2)<br />
<br />
Use:<br />
&nbsp;&nbsp;&nbsp; $s=array(); foreach($_SESSION as $k =&gt; $v) $s[$k]=$v;<br />
&nbsp;&nbsp;&nbsp; $result = VeranstaltungTermin::search($s, $quellen, $KatCount);<br />
<br />
otherwise the garbage-collection of php5 will destroy at end of script Your $_SESSION array before writing to disk</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74703""></a>
  <div class="note">
   <strong class="user">Chris Brown</strong>
   <a href="#74703" class="date">24-Apr-2007 01:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's another session tip for you, relevant to IE6:<br />
<br />
If you find that your session is unexpectedly lost when your application opens a page in a pop-up window, try closing down any other copies of IE running on your machine.<br />
<br />
The problem is that IE doesn't always use the same IE process to host a new pop-up window - it chooses one (using some mysterious strategy) from the pool of running IE processes! Since session information (cookies) is not preserved across processes, the pop-up may loose the session (and probably redirect the user to your log-in page.)<br />
<br />
I don't know a work-around for this, except for close all other IE windows. Microsoft state that they do not guarantee that sessions will be preserved across multiple windows: <a href="http://support.microsoft.com/default.aspx/kb/196383" rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx/kb/196383</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73952""></a>
  <div class="note">
   <strong class="user">leandroico---at---gmail---dot---com</strong>
   <a href="#73952" class="date">17-Mar-2007 01:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
TAGS: session_start headers output errors include_once require_once php tag new line<br />
<br />
Errors with output headers related to *session_start()* being called inside include files.<br />
<br />
If you are starting your session inside an include file you must be aware of the presence of undesired characters after php end tag.<br />
<br />
Let's take an example:<br />
&gt; page.php<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">include_once </span><span class="string">'i_have_php_end_tag.inc.php'</span><span class="keyword">;<br />
include_once </span><span class="string">'init_session.inc.php'</span><span class="keyword">;<br />
<br />
echo </span><span class="string">"Damn! Why I'm having these output header errors?"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
&gt; i_have_php_end_tag.inc.php<br />
<span class="default">&lt;?php<br />
$_JUST_A_GLOBAL_VAR </span><span class="keyword">= </span><span class="string">'Yes, a global var, indeed'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
&gt; init_session.inc.php<br />
<span class="default">&lt;?php<br />
session_start</span><span class="keyword">();<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'blabla'</span><span class="keyword">] = </span><span class="default">123</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
With all this stuff we will get an error, something like:<br />
"... Cannot send session cache limiter - headers already sent (output started at ...", right?<br />
<br />
To solve this problem we have to ignore all output sent by include files. To ensure that we need to use the couple of functions: *ob_start()* and *ob_end_clean()* to suppress the output. So, all we have to do is changing the *page.php* to this:<br />
<br />
<span class="default">&lt;?php<br />
ob_start</span><span class="keyword">();<br />
include_once </span><span class="string">'i_have_php_end_tag.inc.php'</span><span class="keyword">;<br />
include_once </span><span class="string">'init_session.inc.php'</span><span class="keyword">;<br />
</span><span class="default">ob_end_clean</span><span class="keyword">();<br />
<br />
echo </span><span class="string">"Woo hoo! All right! Die you undesired outputs!!!"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73496""></a>
  <div class="note">
   <strong class="user">iam1981</strong>
   <a href="#73496" class="date">26-Feb-2007 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had the same "session data lost" issue. I couldn't solve it with a single session_start(). Instead I had to include session_start() in each page.<br />
<br />
Another X File archived...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73277""></a>
  <div class="note">
   <strong class="user">design at ericcorriel dot com</strong>
   <a href="#73277" class="date">15-Feb-2007 05:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those encoding their pages in UTF-8 but running into problems with BOM data (Byte Order Marks) being outputted before anything else - such as $_SESSION data - but wish to use UTF-8 encoding, and who do NOT wish to use UTF-8 No BOM encoding because the latter produces weird results when using foreign language accented characters, try the following :<br />
<br />
- Save your document with UTF-8 No BOM encoding (on a mac, using BBEdit, this is normally found on the very bottom left corner of the window).&nbsp; This will produce a document that will not output BOM data.<br />
- then, in your scripts, include the following:&nbsp; <br />
<br />
header('Content-Type: text/html; CHARSET=gb2312'); <br />
<br />
before your call to session_start()<br />
<br />
hope that helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72579""></a>
  <div class="note">
   <strong class="user">r dot s dot goldsmith at far-blue dot co dot uk</strong>
   <a href="#72579" class="date">25-Jan-2007 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you ever want to know whether a session is open or has already been closed (e.g. with session_write_close()) when you need to open one (in my case, writing a framework and, therefore, not controlling the session directly), I have been unable to find an official check. However, I did notice that session_start() has the following behaviour:<br />
<br />
* If the session has been open before but is now closed, when you call session_start() the $_SESSION array is reset to the content of the session.<br />
<br />
* If the session is already open, the $_SESSION array is left totally untouched.<br />
<br />
Therefore, I came up with the following (obviously assuming you have already tested $_SESSION exists):<br />
<br />
<span class="default">&lt;?php<br />
$_SESSION</span><span class="keyword">[</span><span class="string">'testMe'</span><span class="keyword">]=</span><span class="string">'test'</span><span class="keyword">;<br />
@</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
if(isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'testMe'</span><span class="keyword">]))<br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Session was open\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; unset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'testMe'</span><span class="keyword">]);<br />
}<br />
else<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Session was closed\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Until someone can tell me the 'official' way to do it, this seems to work.<br />
<br />
Just to save some confusion, $_SESSION, session_id() and the SID define all maintain their values after a session_write_close() so are of no use in identifying if a session is currently open or not. Hence this trick.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72444""></a>
  <div class="note">
   <strong class="user">Devour</strong>
   <a href="#72444" class="date">18-Jan-2007 11:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How many times you've seen this error when actually your code is perfect:<br />
<br />
Warning: session_start(): The session id contains invalid characters,<br />
valid characters are only a-z, A-Z and 0-9 in<br />
<br />
Usually there are MANY reasons why such an error can appear into your logs, page, etc. (one way to generate it, is to send PHPSESSID='').<br />
<br />
But it wasn't our case. We checked everything, and we even logged the entire request ($_GET, $_POST) that was generating the error.<br />
Still no luck. Until one point, when we checked what the session cookie contains.<br />
It seems there are few bots that are trying to buffer overflow (?) a page, using session cookies manually changed to contain something else than session id (strlen == 32 and&nbsp; hex number) The bot in our case was trying to mass submit spam on pages.<br />
So we needed to check and destroy any session id that do not comply.<br />
<br />
After adding this code:<br />
$sn=session_name();<br />
if(isset($_GET[$sn])) if(strlen($_GET[$sn])!=32) unset($_GET[$sn]);<br />
if(isset($_POST[$sn])) if(strlen($_POST[$sn])!=32) unset($_POST[$sn]);<br />
if(isset($_COOKIE[$sn])) if(strlen($_COOKIE[$sn])!=32) unset($_COOKIE[$sn]);<br />
if(isset($PHPSESSID)) if(strlen($PHPSESSID)!=32) unset($PHPSESSID);<br />
session_start();<br />
we got rid of that.<br />
<br />
( Note: The code is before session_start() )<br />
<br />
Strange, kinda paranoid, but effective.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71834""></a>
  <div class="note">
   <strong class="user">cppforlife at yahoo dot com</strong>
   <a href="#71834" class="date">18-Dec-2006 07:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are getting headers sent error check what is the encoding of your file. In my case i had utf-8, so i changed it to ansi, and everything worked.<br />
<br />
hope it helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71666""></a>
  <div class="note">
   <strong class="user">mike at mikebird dot co dot uk</strong>
   <a href="#71666" class="date">10-Dec-2006 11:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems that the session file is opened exclusively.<br />
On some occasions (Windows) I have found that the file lock is not released properly for whatever reason, therefore causing session_start() to hang infinitely on any future script executions.<br />
My way round this problem was to use session_set_save_handler() and make sure the write function used fopen($file, 'w') instead of fopen($file, 'x')</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70235""></a>
  <div class="note">
   <strong class="user">evil dot 2000 at web dot de</strong>
   <a href="#70235" class="date">08-Oct-2006 01:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a problem accessing a session which is open in another frame at the same time.<br />
I had a frame, which is displaying a live text like a chat. It has an opend and locked session. I tried to add data to this session with another frame, but this wouldn't work.<br />
In the first frame i had a loop which is looking for fresh data in the session and prints it out like this:<br />
<span class="default">&lt;?php<br />
&nbsp;session_start</span><span class="keyword">();<br />
<br />
&nbsp;[...]<br />
<br />
&nbsp;while (</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp; echo </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"input"</span><span class="keyword">].</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;}<br />
</span><span class="default">?&gt;<br />
</span>But this locks the session, and no other frame can access the session data at the same time.<br />
So i modified this loop a bit like this:<br />
<span class="default">&lt;?php<br />
&nbsp;session_start</span><span class="keyword">();<br />
<br />
&nbsp;[...]<br />
<br />
&nbsp;</span><span class="default">session_commit</span><span class="keyword">();<br />
&nbsp;while (</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">ob_start</span><span class="keyword">(); </span><span class="default">session_start</span><span class="keyword">(); </span><span class="default">ob_end_clean</span><span class="keyword">();<br />
&nbsp; echo </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">"input"</span><span class="keyword">].</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">session_commit</span><span class="keyword">();<br />
&nbsp; </span><span class="default">sleep</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;}<br />
</span><span class="default">?&gt;<br />
</span>Now the second frame is able to access the session.<br />
The ob_start() and ob_end_clean() is just for surpressing the cookie output to the browser.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70033""></a>
  <div class="note">
   <strong class="user">Dino</strong>
   <a href="#70033" class="date">30-Sep-2006 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With IE and FF, session_start() appears to stop form values being preserved when the user browses 'back' to a page (I'm using SBS2K3 IIS6 PHP5.1.1).<br />
<br />
For example if you set some hidden form values from javascript in one page, then navigate to another page and come back using the browsers back button, the form values should be preserved. But this does not happen when your your form page uses session_start().<br />
<br />
The following seems to sort this out nicely:<br />
<br />
session_cache_limiter('public');<br />
session_start();</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70028""></a>
  <div class="note">
   <strong class="user">double at dumpit dot de</strong>
   <a href="#70028" class="date">30-Sep-2006 04:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A bedder way to check wether the session is started including ip logging, so it will be a little saver. in 4 small lines.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if( !isset( </span><span class="default">$_SESSION </span><span class="keyword">) ) { </span><span class="default">session_start</span><span class="keyword">(); }<br />
&nbsp;&nbsp;&nbsp; if( isset( </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">] ) &amp;&amp; </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">] != </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">] ) <br />
&nbsp;&nbsp;&nbsp; { </span><span class="default">session_regenerate_id</span><span class="keyword">(); </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">] = </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">]; }<br />
&nbsp;&nbsp;&nbsp; if( !isset( </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">] ) ) { </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">] = </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REMOTE_ADDR'</span><span class="keyword">]; }<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
Yes, the code is a little bit self-willed ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70007""></a>
  <div class="note">
   <strong class="user">ben dot morin at spaboom dot com</strong>
   <a href="#70007" class="date">29-Sep-2006 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
James at skinsupport dot com raises a good point (warning) about additional requests from the browser.&nbsp; The request for favicon.ico, depending on how it is handled, can have unintended results on your sessions.&nbsp; <br />
<br />
For example, suppose you have ErrorDocument 404 /signin.php, no favicon.ico file and all pages in your site where the user signs in are also redirected to /signin.php if they're not already signed in.&nbsp; <br />
<br />
If signin.php does any clean up or reassigning of session_id (as all good signin.php pages should) then the additional request from the browser for favicon.ico could potentially corrupt the session as set by the actual request.&nbsp; <br />
<br />
Kudos to James for pointing it out and shame on me for skimming past it and not seeing how it applied to my problem.&nbsp; Thanks too to the Firefox Live HTTP Headers extension for showing the additional request.&nbsp; <br />
<br />
Don't waste days or even hours on this if your session cookies are not being sent or if the session data isn't what you expect it to be.&nbsp; At a minimum, eliminate this case and see if any additional requests could be at fault.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69908""></a>
  <div class="note">
   <strong class="user">truthhunter</strong>
   <a href="#69908" class="date">26-Sep-2006 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another one bitten by the "a different domain name gives you a new session" in IE...
<br />

<br />
My site uses interactive PDF documents.&nbsp; A user saves data from them into FDF documents, and when this happens, the site also includes the URL of the PDF in the FDF data (using the FDF "/F" tag).
<br />

<br />
This URL is generated using the $_SERVER["HTTP_HOST"] value from PHP.&nbsp; For some as-yet-undetermined reason, when my hosting provider updated PHP (I believe to 4.4.1), for a time the $_SERVER["HTTP_HOST"] value apparently dropped the "www." from my domain name.&nbsp; So, some FDF files were saved with this different URL value.&nbsp; Needless to say, when one of these FDFs loaded the corresponding PDF, although the load and display of the PDF worked, any subsequent save operation (which relies on current session information for validating the user, etc.) initiated from within the PDF failed.&nbsp; The original session had been established for the "www.example.com", but because the PDF URL lacked the "www.", PHP/IE had established a new, essentially empty, session.
<br />

<br />
I scratched my head over this problem for months and only recently happened upon this fix.&nbsp; In my case, manually patching the failing (binary) FDF files to include the "www." in the URL for the PDF did fix it.
<br />

<br />
Hopefully someone else finds this helpful...!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69669""></a>
  <div class="note">
   <strong class="user">mjr-php at ranney dot com</strong>
   <a href="#69669" class="date">14-Sep-2006 06:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For some reason, MSIE gets confused when session_start() is called and the Content-disposition has been set to "attachment".&nbsp; The only solution I've found is this:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_USER_AGENT'</span><span class="keyword">],</span><span class="string">"MSIE"</span><span class="keyword">)) {
<br />
&nbsp; </span><span class="default">session_cache_limiter</span><span class="keyword">(</span><span class="string">'public'</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">session_start</span><span class="keyword">();
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69493""></a>
  <div class="note">
   <strong class="user">roope dot luhtalaNOSPAM at iki dot fi</strong>
   <a href="#69493" class="date">07-Sep-2006 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your session_start() does not set a cookie, but instead just generates a new session_id on every request, you should check if your script is echoing something before the function call. Even a line change in the code before the session_start() function prevents the cookie to be set.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69252""></a>
  <div class="note">
   <strong class="user">colemanc at colemanesolutions dot com</strong>
   <a href="#69252" class="date">29-Aug-2006 12:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reference to the "Cannot send session cache limiter..." error message, I have tried a number of ways to supress the error. An If/Then block will work only if you store the flag in a session variable, cookie, or other method. Or, you can obviously supress error messages by the error level. However, the simplest way to do it is a simple:<br />
<br />
@session_start();<br />
<br />
This will hide all error messages resulting from that line of code. I would only recommend this method AFTER you have fully tested your code but it is very effective when that is your only error and you do not want to completely stop code exectution by means of a die() or exit() function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68710""></a>
  <div class="note">
   <strong class="user">core58 at mail dot ru</strong>
   <a href="#68710" class="date">08-Aug-2006 03:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
when you're using session trans sid ENABLED, and you perform redirect such as Header( "Location..." ), redirected client will SURELY loose his session.<br />
to avoid this, you can use a modified version of redirect function, like this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">Redirect302</span><span class="keyword">( </span><span class="default">$location </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sname </span><span class="keyword">= </span><span class="default">session_name</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sid </span><span class="keyword">= </span><span class="default">session_id</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$sid </span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">Header</span><span class="keyword">( </span><span class="default">$location </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if( isset( </span><span class="default">$_COOKIE</span><span class="keyword">[ </span><span class="default">$sname </span><span class="keyword">] ) || </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$location</span><span class="keyword">, </span><span class="default">$sname</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">$sid </span><span class="keyword">) !== </span><span class="default">false </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">Header</span><span class="keyword">( </span><span class="default">$location </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">strpos</span><span class="keyword">( </span><span class="default">$location</span><span class="keyword">, </span><span class="string">"?" </span><span class="keyword">) &gt; </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$separator </span><span class="keyword">= </span><span class="string">"&amp;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$separator </span><span class="keyword">= </span><span class="string">"?"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fixed </span><span class="keyword">= </span><span class="default">$location </span><span class="keyword">. </span><span class="default">$separator </span><span class="keyword">. </span><span class="default">$sname</span><span class="keyword">.</span><span class="string">"="</span><span class="keyword">.</span><span class="default">$sid</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">Header</span><span class="keyword">( </span><span class="default">$fixed </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
expamle:<br />
Redirect302( "Location: /YourPage/index.php" );<br />
<br />
the function performs common redirect if no session is active, and appends session "name=sid" to query string when session is already started,&nbsp; like PHP parser does when outputting your page.<br />
<br />
hope, you'll find it useful.<br />
yours:)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68418""></a>
  <div class="note">
   <strong class="user">devonmitton at gmail dot com</strong>
   <a href="#68418" class="date">26-Jul-2006 10:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I ran into the problem of losing the session after i redirect the user with header( location:);<br />
<br />
I found that the problem doesn't occur in php5. Atleast for myself. I tested it on IIS as well as Apache and both times using php5 fixed the issue.<br />
<br />
Secondly, I found a weird solution: The website i'm building required Cyrillic type, so i encode the pages using UTF-8. The problem that happens is that UTF-8 sends information before the php tags, and therefore before the session_start(); which ultimately renders the session_start(); call ineffective.<br />
<br />
The UTF-8 encoding sends a small chunk of information before anything. This is called BOM (byte order marks).<br />
<br />
To ensure that they don't show up, you need to save your files with a UTF-8 encoding which bypasses BOM. BBEdit for the Macintosh with allow for this under the file encoding options.<br />
<br />
To recap: In this instance and for my situation, UTF-8, no BOM will allow sessions to pass through the header( location:); redirect, or using PHP5.<br />
<br />
Hope this helps someone! [i will also repeat this comment under the header() function]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68123""></a>
  <div class="note">
   <strong class="user">James</strong>
   <a href="#68123" class="date">14-Jul-2006 01:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To avoid the notice commited by PHP since 4.3.3 when you start a session twice, check session_id() first:<br />
<br />
if (session_id() == "")<br />
&nbsp; session_start();</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68084""></a>
  <div class="note">
   <strong class="user">saykyo (mail at gmail dot com)</strong>
   <a href="#68084" class="date">12-Jul-2006 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Watch out for using UTF-8 encoding in your php scripts!<br />
<br />
I don't know about other enviroments, but in Windows XP, if you edit a document and set it to be UTF-8, the editor (notepad for exapmle) inserts two invisible bytes at the beginning of the file (they read FF FE in hex for me). I suppose this happens so Windows can identify the file as UTF-8.<br />
<br />
Since these two bytes are placed before anything else in the file, including &lt;? ?&gt; tags, when you execute the php script, they get outputed to the browser (even tough they won't be shown in the source of the result document, they're there!) before your php code gets a chance to run anything. This effectively cripples functions like session_start() ($_COOKIE to be exact).<br />
<br />
The solution is to save the php file in a different encoding, or to manually remove them (I prefer the former).<br />
<br />
I hope I helped somebody.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65944""></a>
  <div class="note">
   <strong class="user">admin at haravikk dot com</strong>
   <a href="#65944" class="date">10-May-2006 03:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a note for any of you who have the same trouble as I did. $_SESSION appears to break horribly if you attempt to assign information into integer keys.<br />
<br />
For example, a result from a MySQL query may look like:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; </span><span class="string">'haravikk'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'username' </span><span class="keyword">=&gt; </span><span class="string">'haravikk'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">'fish'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="string">'password' </span><span class="keyword">=&gt; </span><span class="string">'fish'<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Attempting to assign that to $_SESSION either as a straight array, or by placing all keys (for example using a foreach) will FAIL and the data will be unavailable when you move to another page. My solution was to do this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">storeSessionArray</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">)) </span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">] = </span><span class="default">$v</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This worked correctly =)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60018""></a>
  <div class="note">
   <strong class="user">james at skinsupport dot com</strong>
   <a href="#60018" class="date">23-Dec-2005 03:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One thing of note that caused me three days of trouble:<br />
<br />
It's important to note that Firefox (for one) makes two calls to the server automatically.&nbsp; One for the page, and one for favicon.ico.<br />
<br />
If you are setting session variables (as I was) to certain values when a page exists, and other values when pages don't exist, the values for non-existent pages will overwrite the values for existing pages if favicon.ico doesn't exist.<br />
<br />
I doubt many of you are doing this, but if you are, this is a consideration you need to address or you'll be bald over the course of a three day period!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59352""></a>
  <div class="note">
   <strong class="user">zackbloom at gmail dot com</strong>
   <a href="#59352" class="date">04-Dec-2005 08:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Yes php does not automatically insert the SID in header redirects.&nbsp; You must use something like:<br />
'&lt;address&gt;?SID='.SID<br />
to manually insert the SID.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57875""></a>
  <div class="note">
   <strong class="user">jeremygiberson at gmail dot com</strong>
   <a href="#57875" class="date">17-Oct-2005 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
foltscane at yahoo dot com wrote about people losing session information on page redirects. <br />
<br />
The problem is some times the redirect may kick you off to the next page before all the session variables have been saved. The true solution to lost session vars on redirect is to simply call session_write_close(); before setting the redirect header. This will insure that php finishes writing the session info before page redirect gets underway.<br />
<br />
ie:<br />
&lt;?<br />
&nbsp;&nbsp;&nbsp; session_start();<br />
&nbsp;&nbsp;&nbsp; $_SESSION['forward'] = "This session data will not be lost!";<br />
<br />
&nbsp;&nbsp;&nbsp; session_write_close();<br />
&nbsp;&nbsp;&nbsp; header('Location: nextpage.php');<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53293""></a>
  <div class="note">
   <strong class="user">erm[at]the[dash]erm[dot]com</strong>
   <a href="#53293" class="date">27-May-2005 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are insane like me, and want to start a session from the cli so other scripts can access the same information.<br />
<br />
I don't know how reliable this is.&nbsp; The most obvious use I can see is setting pids.<br />
<br />
// temp.php<br />
<br />
#!/usr/bin/php -q<br />
<span class="default">&lt;?php<br />
<br />
session_id </span><span class="keyword">(</span><span class="string">"temp"</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
if (</span><span class="default">$_SESSION</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'test'</span><span class="keyword">] = </span><span class="string">"this is a test if sessions are usable inside scripts"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
// Temp 2<br />
<br />
#!/usr/bin/php -q<br />
<span class="default">&lt;?php<br />
<br />
session_id </span><span class="keyword">(</span><span class="string">"temp"</span><span class="keyword">);<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r </span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52988""></a>
  <div class="note">
   <strong class="user">corey at eyewantmedia dot com</strong>
   <a href="#52988" class="date">20-May-2005 04:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a crazy feature -- you get one concurrent database connection per session, transparent to the programmer!<br />
<br />
I am running php 5.0.4 on iis 6 (yeah, I know...). I noticed under stress testing that database connections were my bottleneck. I spent like 5 hours turning this on, that off, etc because I could not get php to create more than one database connection at a time, regardless of how many requests it was servicing. I tried running php as fastcgi, cgi, and isapi module. I tried using mysql and mysqli extensions. Same thing every time. Then I happened to turn off auto-start sessions and commented out my session_start() calls, and all of the sudden I get multiple connections like I expected!<br />
<br />
Don't let this happen to you -- don't freak out! Apparently something somewhere tries to make sure your visitors don't get more than their share of your resources, so they get one db connection per session. I can't say it is what I would like to happen, but now that I know, it doesn't bother me much :) Hope this saves someone some time and headache!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51833""></a>
  <div class="note">
   <strong class="user">Jose Cavieres</strong>
   <a href="#51833" class="date">12-Apr-2005 07:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For the problem of session lost after of redirect with header location...<br />
<br />
Try with this:<br />
&lt;?<br />
session_start();<br />
$_SESSION['mySession'] = "hello";<br />
<br />
header ("Location: xpage.php");<br />
exit(); //This sentence do the magic<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51520""></a>
  <div class="note">
   <strong class="user">jorrizza at gmail dot com</strong>
   <a href="#51520" class="date">02-Apr-2005 02:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you open a popup window (please no commercial ones!) with javascript window.open it might happen IE blocks the session cookie.<br />
A simple fix for that is opening the new window with the session ID in a GET value. Note I don't use SID for this, because it will not allways be available.<br />
<br />
----page.php----<br />
//you must have a session active here<br />
window.open('popup.php?sid=<span class="default">&lt;?php </span><span class="keyword">echo </span><span class="default">session_id</span><span class="keyword">(); </span><span class="default">?&gt;</span>', '700x500', 'toolbar=no, status=no, scrollbars=yes, location=no, menubar=no, directories=no, width=700, height=500');<br />
<br />
----popup.php----<br />
<span class="default">&lt;?php<br />
session_id</span><span class="keyword">(</span><span class="default">strip_tags</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'sid'</span><span class="keyword">]));<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
</span><span class="comment">//and go on with your session vars<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50905""></a>
  <div class="note">
   <strong class="user">hbertini at sapo dot pt</strong>
   <a href="#50905" class="date">13-Mar-2005 09:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
workaround when using session variables in a .php file referred by a frame (.html, or other file type) at a different server than the one serving the .php:<br />
<br />
Under these conditions IE6 or later silently refuses the session cookie that is attempted to create (either implicitly or explicitly by invoquing session_start()).<br />
<br />
As a consequence, your session variable will return an empty value.<br />
<br />
According to MS kb, the workaround is to add a header that says your remote .php page will not abuse from the fact that permission has been granted.<br />
<br />
Place this header on the .php file that will create/update the session variables you want:<br />
<br />
<span class="default">&lt;?php header</span><span class="keyword">(</span><span class="string">'P3P: CP="CAO PSA OUR"'</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span><br />
Regards,<br />
Hugo</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50236""></a>
  <div class="note">
   <strong class="user">raphael at cynage dot com</strong>
   <a href="#50236" class="date">22-Feb-2005 05:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Quick point, since this had been going round in circles for days...<br />
<br />
IE will not accept sessions from a domain that has an non alpha-numeric character in it. My development site was running under the vhost mos_dev and it was killing me, trying to work out why IE kept dropping my sessions.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48283""></a>
  <div class="note">
   <strong class="user">lukasl at ackleymedia dot REMOVESPAM dot com</strong>
   <a href="#48283" class="date">17-Dec-2004 07:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About the Session not getting saved on a header("Location:") redirect.<br />
<br />
Make sure to call session_write_close() before doing the redirect.&nbsp; This will make sure that the session values get written to the disk.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33369""></a>
  <div class="note">
   <strong class="user">m dot kuiphuis at hccnet dot nl</strong>
   <a href="#33369" class="date">24-Jun-2003 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[Editors Note: For more information about this
<br />
<a href="http://www.zvon.org/tmRFC/RFC882/Output/chapter5.html ]" rel="nofollow" target="_blank">http://www.zvon.org/tmRFC/RFC882/Output/chapter5.html ]</a>
<br />
&nbsp;
<br />
I use name-based virtual hosting on Linux with Apache and PHP 4.3.2. 
<br />
Every time when I refreshed (by pressing F5 in Internet Explorer) I noticed that I got a new session_id. Simultaneously browsing the same site with Netscape didn't give me that problem. First I thought this was some PHP issue (before I tested it with Netscape), but after searching a lot on the internet I found the problem.
<br />
Since I was using name based virtual hosting for my testserver and we have different webshops for different customers I used the syntax webshop_customername.servername.nl as the domain-name.
<br />
The _ in the domain name seemed to be the problem. Internet Explorer just denies setting the cookie on the client when there is a special character (like an _ ) in the domain name. For more information regarding this issue: <a href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;316112 " rel="nofollow" target="_blank">http://support.microsoft.com/default.aspx?scid=kb;EN-US;316112 </a>
<br />
Stupidly enough, this information was related to asp (yuk :o)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33290""></a>
  <div class="note">
   <strong class="user">gadgetguy03 at lycos dot com</strong>
   <a href="#33290" class="date">21-Jun-2003 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SESSION LOST ON HEADER REDIRECT (CGI on IIS 5.0)<br />
<br />
I realize there are numerous scattered posts on this issue, but I would like to add my 2? since it took me a whole day and a download of the LiveHTTPHeaders Mozilla plugin to figure it out.<br />
<br />
On the **CGI** version of PHP on IIS 5.0/Windows 2000, the following code will not work as expected:<br />
<br />
/***** sess1.php *****/<br />
session_start();<br />
$_SESSION["key1"] = "testvalue";<br />
header("Location: sess2.php");<br />
<br />
/***** sess2.php *****/<br />
session_start();<br />
echo "key1 = '".$_SESSION["key1"]."'";<br />
<br />
PROBLEM:<br />
All session data is lost after a header redirect from the first page on which the session is initialized. The problem is, the PHPSESSID cookie is not being sent to the browser (ANY browser, IE or Mozilla) on the initial session page with the header("Location: ...") redirect. This is unrelated to client cookie settings - the set-cookie: header just isn't sent.<br />
<br />
SOLUTION:<br />
I was able to remedy the problem by switching to the ISAPI DLL version. This seems to be an MS/IIS bug, NOT a PHP bug - go figure. I hope this saves you some headaches especially with your user authentication scripts!!<br />
<br />
The closest matching "bug" report I found:<br />
<a href="http://bugs.php.net/bug.php?id=14636" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=14636</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
