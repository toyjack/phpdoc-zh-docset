<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>执行运算符</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.operators.errorcontrol.html">? 错误控制运算符</a></li>
      <li style="float: right;"><a href="language.operators.increment.html">递增／递减运算符 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.operators.html">运算符</a></li>
    <li>执行运算符</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.operators.execution" class="sect1">
   <h2 class="title">执行运算符</h2>
   <p class="para">
    PHP 支持一个执行运算符：反引号（``）。注意这不是单引号！PHP
    将尝试将反引号中的内容作为外壳命令来执行，并将其输出信息返回（即，可以赋给一个变量而不是简单地丢弃到标准输出）。使用反引号运算符"`"的效果与函数
    <span class="function"><a href="function.shell-exec.html" class="function">shell_exec()</a></span> 相同。
    <div class="informalexample">
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$output&nbsp;</span><span style="color: #007700">=&nbsp;`</span><span style="color: #DD0000">ls&nbsp;-al</span><span style="color: #007700">`;<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;pre&gt;</span><span style="color: #0000BB">$output</span><span style="color: #DD0000">&lt;/pre&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     反引号运算符在激活了<a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">安全模式</a>或者关闭了 <span class="function"><a href="function.shell-exec.html" class="function">shell_exec()</a></span> 时是无效的。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     与其它某些语言不同，反引号不能在双引号字符串中使用。
    </p>
   </p></blockquote>
   <p class="para">
    参见手册中<a href="ref.exec.html" class="link">程序执行函数</a>，<span class="function"><a href="function.popen.html" class="function">popen()</a></span>，<span class="function"><a href="function.proc-open.html" class="function">proc_open()</a></span>
    以及 <a href="features.commandline.html" class="link">PHP 的命令行模式</a>。
   </p>
  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="111732""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#111732" class="date">22-Mar-2013 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
escapeshellarg()<br />
<br />
if you're usimg popen, `` exec or anything else which takes a command-line<br />
use escapeshellarg() on any variable parts, or risk being pwned.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109882""></a>
  <div class="note">
   <strong class="user">inform dot to dot kannan at gmail dot com</strong>
   <a href="#109882" class="date">31-Aug-2012 01:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can use the backtick operator on windows to run windows command too and it is not restricted only to execute the exe. <br />
Example:<br />
<span class="default">&lt;?php<br />
$output </span><span class="keyword">= `</span><span class="string">dir</span><span class="keyword">`;<br />
echo </span><span class="string">"&lt;pre&gt;</span><span class="default">$output</span><span class="string">&lt;/pre&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span>It lists all the files in the directory</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62489""></a>
  <div class="note">
   <strong class="user">robert</strong>
   <a href="#62489" class="date">01-Mar-2006 08:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a general usage note.&nbsp; I had a very difficult time solving a problem with my script, when I accidentally put one of these backticks at the beginning of a line, like so:<br />
<br />
[lots of code]<br />
`&nbsp; &nbsp; $URL = "blah...";<br />
[more code]<br />
<br />
Since the backtick is right above the tab key, I probably just fat-fingered it while indenting the code.<br />
<br />
What made this so hard to find, was that PHP reported a parse error about 50 or so lines *below* the line containing the backtick.&nbsp; (There were no other backticks anywhere in my code.)&nbsp; And the error message was rather cryptic:<br />
<br />
Parse error: parse error, expecting `T_STRING' or `T_VARIABLE' or `T_NUM_STRING' in /blah.php on line 446<br />
<br />
Just something to file away in case you're pulling your hair out trying to find an error that "isn't there."</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60212""></a>
  <div class="note">
   <strong class="user">cs at kainaw dot com</strong>
   <a href="#60212" class="date">29-Dec-2005 11:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After much trouble, I have concluded that the backtick operator (and shell_exec) have a limited buffer for the return.&nbsp; My problem was that I was grepping a file with over 500,000 lines, receiving a response with well over 100,000 lines.&nbsp; After a short pause, I was flooded with errors from grep about the pipe being closed.<br />
<br />
I have searched, but I cannot find the exact size of the buffer used by the backtick operator and shell_exec.&nbsp; So, to avoid this error, you must limit the output of your commands (such as using -m with grep).&nbsp; Through trial and error, you can get the command to run without error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58986""></a>
  <div class="note">
   <strong class="user">vdboor at codingdomain dot com</strong>
   <a href="#58986" class="date">23-Nov-2005 09:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that most OS-es define two channels for file-output, the stdout and stderr (standard out and standard error). To read the data sent to stderr too, include 2&gt;&amp;1 in the backticks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="34273""></a>
  <div class="note">
   <strong class="user">aaron dot bentley at utoronto dot ca</strong>
   <a href="#34273" class="date">21-Jul-2003 01:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
waylanator's example can be dangerous, since it doesn't prevent characters with special meaning from being emitted to the commandline.&nbsp; Programming errors or untrusted data could cause serious problems.&nbsp; At the bare minimum, remove all non-alphanumeric characters before passing a string to the shell.&nbsp; escapeshellarg() is also useful in *nix environments, but usually the best approach is to bypass the shell, using exec() etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29479""></a>
  <div class="note">
   <strong class="user">waylanator no at spam hotmail dot com</strong>
   <a href="#29479" class="date">14-Feb-2003 06:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In Windows it appears you can only call an executable file that resides in the system path which is defined by Windows.&nbsp; As a workaround you can place a batch file in the system path that calls the program from it's dir. Just make sure to use short MS-DOS file and dir names.<br />
For example:<br />
If you were calling the file c:\program files\my program\program.exe do this:<br />
<br />
mybat.bat look like this:<br />
_________<br />
@echo off<br />
c:\progra~1\myprog~1\program.exe<br />
_________<br />
<br />
Save mybat.bat in c:\ or c:\windows or any other dir in the system path as defined by windows.<br />
<br />
Then in php call the batch file:<br />
_________<br />
<span class="default">&lt;?php<br />
$test </span><span class="keyword">= `</span><span class="string">c:\mybat.bat</span><span class="keyword">`;<br />
echo </span><span class="string">"&lt;pre&gt;</span><span class="default">$test</span><span class="string">&lt;/pre&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span>_________<br />
<br />
That should do it.<br />
Of course this will only work for a program you can run from the MS-DOS command prompt, but (as I understant it) that goes for any executable you call with PHP anyway.<br />
Tested in Win98 running Apache 1.3.27 and PHP 4.3.0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19848""></a>
  <div class="note">
   <strong class="user">reed-NO at SPAM-zerohour dot net</strong>
   <a href="#19848" class="date">13-Mar-2002 09:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When a program is run using backticks, and the user cancels page loading (if your program is taking too long!), the shell running the program (the one in the backticks) may continue indefinitely on the server. I do not know if this is a bug, or just a danger of using this feature.&nbsp; (It may depend on the way the browser "cancels" the request -- it was a problem on both IE and OmniWeb for the Mac).&nbsp; Beware!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
