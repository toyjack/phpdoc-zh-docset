<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Windows 系统下的安装</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.macosx.compile.html">? 在 Mac OS X 下编译 PHP</a></li>
      <li style="float: right;"><a href="install.windows.installer.html">Windows 安装程序（PHP 5.1.0 及更早版本） ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.html">安装与配置</a></li>
    <li>Windows 系统下的安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.windows" class="chapter">
 <h1>Windows 系统下的安装</h1>
<h2>Table of Contents</h2><ul class="chunklist chunklist_chapter"><li><a href="install.windows.installer.html">Windows 安装程序（PHP 5.1.0 及更早版本）</a></li><li><a href="install.windows.installer.msi.html">Windows 安装程序（PHP 5.2 及更新版本）</a></li><li><a href="install.windows.manual.html">手工安装步骤</a></li><li><a href="install.windows.iis.html">Microsoft IIS</a></li><li><a href="install.windows.iis6.html">Microsoft IIS 5.1 和 IIS 6.0</a></li><li><a href="install.windows.iis7.html">Microsoft IIS 7.0 及更高版本</a></li><li><a href="install.windows.apache1.html">Microsoft Windows 下的 Apache 1.3.x</a></li><li><a href="install.windows.apache2.html">Microsoft Windows 下的 Apache 2.x</a></li><li><a href="install.windows.sun.html">Microsoft Windows 下的 Sun，iPlanet 和 Netscape 服务器</a></li><li><a href="install.windows.sambar.html">Microsoft Windows 下的 Sambar 服务器</a></li><li><a href="install.windows.xitami.html">Microsoft Windows 下的 Xitami</a></li><li><a href="install.windows.building.html">从源程序编译</a></li><li><a href="install.windows.extensions.html">Windows 下安装扩展库</a></li><li><a href="install.windows.commandline.html">PHP 在 Microsoft Windows 下的命令行方式</a></li></ul>

 <p class="para">
  本节内容适用于 Windows 98/Me 以及 Windows NT/2000/XP/2003。PHP
  不能在 16 位平台例如 Windows 3.1 下运行。有时把支持 PHP 的 Windows
  平台称为 Win32。自 PHP 4.3.0 开始不再支持 Windows 95。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   自 PHP 5.3.0 起不再支持 Windows 98/ME/NT4。
  </p>
 </p></blockquote>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   自 PHP 4.3.0 起不再支持 Windows 95。
  </p>
 </p></blockquote>
 <p class="para">
  有两种方法在 Windows 下安装 PHP：<a href="install.windows.manual.html" class="link">手工安装</a>或者使用<a href="install.windows.installer.html" class="link">安装程序</a>安装。
 </p>
 <p class="para">
  如果有开发环境例如 Microsoft Visual Studio，也可以<a href="install.windows.building.html" class="link">编译</a> PHP 的源程序。
 </p>
 <p class="para">
  一旦在 Windows 系统下安装好 PHP 之后，可能需要<a href="install.windows.extensions.html" class="link">加载各种扩展库</a>以实现更多的功能。
 </p>
 <div class="warning"><strong class="warning">Warning</strong>
  <p class="para">
   互联网上还有一些多合一的安装程序，但是它们没有一个是被 PHP.net 认可的，因为我们相信，从
   <a href="http://www.php.net/downloads.php" class="link external" title="Link : http://www.php.net/downloads.php">&raquo;&nbsp;http://www.php.net/downloads.php</a>
   下载官方 Windows 安装包是系统安全和优化的最好选择。
  </p>
 </div>
   
 





 






 







 








 








 






   
 






 








 







 







 







 






 






 








</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114592""></a>
  <div class="note">
   <strong class="user">phper at www dot thewindowshelp dot com</strong>
   <a href="#114592" class="date">10-Mar-2014 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
install php on windows, you can find some help here!<br />
<a href="http://www.thewindowshelp.com/tag/php/" rel="nofollow" target="_blank">http://www.thewindowshelp.com/tag/php/</a><br />
<br />
Enjoy!!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102087""></a>
  <div class="note">
   <strong class="user">falling174fps at hotmail dot com</strong>
   <a href="#102087" class="date">26-Jan-2011 05:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note carefully that no matter what it says above, Windows 2000 has been (effectively) desupported in PHP 5.3. However, 5.2 still seems to work, ignoring the spate of dll messages.<br />
<br />
See: <a href="http://bugs.php.net/bug.php?id=48761" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=48761</a><br />
<br />
It is highly useful to run the php command line executable (php.exe) from a command line (start/run: cmd.exe) to check whether the compiled php executable will start at all:<br />
<br />
&nbsp;&nbsp;&nbsp; cd \php<br />
&nbsp;&nbsp;&nbsp; php -v<br />
<br />
This is in preference to wondering why IIS/Apache returns some obscure message about missing headers.<br />
- Conor</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93607""></a>
  <div class="note">
   <strong class="user">bufoni at hotmail dot com</strong>
   <a href="#93607" class="date">18-Sep-2009 04:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Oh Man!<br />
<br />
I installed by Microsoft Installer, manually, whatever I always received de same error from IIS7.<br />
<br />
HTTP Error 404.3 - Not Found<br />
The page you are requesting cannot be served because of the extension configuration. If the page is a script, add a handler. If the file should be downloaded, add a MIME map.<br />
<br />
The IIS7 interface is quite diferent and are not all together like IIS6<br />
<br />
The 5.3 version have not any of those files: php5stdll, php5isapi.dll. etc.<br />
<br />
The installer puts others files in handlers and I decided to use them as substitutes. Nothing done!<br />
<br />
After that, I discovered that installer do not install these files within the sites, but in the root default site configuration of IIS7.<br />
<br />
So, I copied the root configuration to my site and them it worked (all others procedures were done e.g. copy php.ini to windows folder)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92627""></a>
  <div class="note">
   <strong class="user">Fernando O.</strong>
   <a href="#92627" class="date">01-Aug-2009 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found a way to install it properly, on IIS 7:<br />
<br />
Note<br />
<br />
Set IIS to allow 32-bits if you are on 64-bits<br />
<br />
cscript %SYSTEMDRIVE%\inetpub\adminscripts\adsutil.vbs SET W3SVC/AppPools/Enable32bitAppOnWin64 1<br />
<br />
Set enviroment variables<br />
<br />
PATH to, say, C:\php\<br />
<br />
PHPRC to, that same dir<br />
<br />
Go to Web Service Extensions: Add a new extension...<br />
<br />
Name it for example php, and point it to the php5isapi.dll.<br />
<br />
Set status to Allowed.<br />
<br />
Right click Web Sites:<br />
<br />
On the tab, ISAPI Filters, name it for example php, and point it to the php5isapi.dll<br />
<br />
Then go to Home directory tab:<br />
<br />
Click Configuration<br />
<br />
On Mappings, click add:<br />
<br />
Executable would be: php5isapi.dll<br />
Extension to: .php<br />
<br />
Click OK, then OK.<br />
<br />
Then on the tab Documents click Add:<br />
<br />
and add there what you want to load as default, say index.php<br />
<br />
Then stop, and start IIS.<br />
<br />
This worked for me on a Windows 2003 Server, and WinXP 64.<br />
<br />
I hope this saves time for someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90974""></a>
  <div class="note">
   <strong class="user">robert dot johnson at icap dot com</strong>
   <a href="#90974" class="date">19-May-2009 12:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IIS ISAPI module is not included in the Windows msi installer for version 5.2.9-2.<br />
<br />
Either use the zip file and set it up manually, or use the installer for version 5.2.9-1 instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90936""></a>
  <div class="note">
   <strong class="user">dpharshman at dslextreme dot com</strong>
   <a href="#90936" class="date">17-May-2009 02:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 5.2.9.2 Install on XP Pro IIS 5.1 - phpinfo( ) results incorrect<br />
<br />
Testing Date:&nbsp; 05.15.09<br />
<br />
Background:<br />
For several days now I, as a newbie, have been unsure if I had installed PHP correctly, or not.&nbsp; No matter what I did phpinfo( ) reported "Configuratin File Path" as:&nbsp; "C:\WINDOWS".&nbsp; I was left to wonder what was wrong.<br />
<br />
To help resolve the phpinfo() "issue", I conducted a series of tests using two scripts:<br />
<br />
The first is "test-php-ini-loaded.php"; it is stored in c:\inetpub\wwwroot, and has the following code:<br />
<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $inipath </span><span class="keyword">= </span><span class="default">php_ini_loaded_file</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$inipath</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'Loaded php.ini: ' </span><span class="keyword">. </span><span class="default">$inipath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'A php.ini file is not loaded'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">?&gt;<br />
</span><br />
The second script is simply calls phpinfo( ).&nbsp; It is named test.php, is stored in "c:\inetpub\wwroot",&nbsp; and has the following code:<br />
<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php phpinfo</span><span class="keyword">( ); </span><span class="default">?&gt;<br />
</span><br />
My Dev Environment:<br />
1. Windows XP Pro SP3<br />
2. IIS 5.1 / MMC 3.0<br />
3. PHP 5.2.9.2 - phpMyAdmin not yet installed<br />
4. (plus MySQL 5.1, etc.)<br />
5. Install location is on my local E: drive<br />
<br />
The Tests:<br />
<br />
Test 1:<br />
a. PHPRC environment variable and IniFilePath Registry left in place and active<br />
b. Verified no other copies of php.ini exist on the system other than in my E:\PHP folder<br />
c. Renamed php.ini to hold-php.ini<br />
d. Stopped and started IIS ("net stop iisadmin" and "net start w3svc")<br />
e. Ran "test-php-ini-loaded.php" to check whether my php.ini is loaded.&nbsp; It is not.<br />
f. Ran "test.php".&nbsp; "Loaded Configuration File" was empty, while "Configuration File (php.ini) Path" showed:&nbsp; C:\WINDOWS.<br />
<br />
Test 2:<br />
a. Moved php.ini from E:\PHP to C:\WINDOWS<br />
b. Stopped and started IIS<br />
c. Ran "test-php-ini-loaded.php" to check if my php.ini is loaded.&nbsp; It is not, which surprised me.<br />
d. Ran "test.php".&nbsp; My php.ini is apparently not loaded, or found, by phpinfo( ), even though "Configuration File (php.ini) Path" reports it as being in C:\WINDOWS.<br />
e. Note:&nbsp; Per PHP's "The configuration file" note, PHP's search order includes:&nbsp; "Windows directory (C:\windows or C:\winnt) (for Windows), ..."; but it apparently doesn't or php.ini would have been found and displayed at "Loaded Configuration File".<br />
<br />
Test 3:<br />
a. Left the solo copy of my php.ini in C:\WINDOWS<br />
b. Disabled PHPRC environment variable by renaming it to "Ex-PHPRC and saving the settings (note: for this test&nbsp; I left the Registry entry for PHP IniFilePath intact)<br />
c. Stopped and started IIS<br />
d. Ran "test-php-ini-loaded.php" to check whether my php.ini is loaded.&nbsp; Predictably it is not found.<br />
e. Ran the "test.php".&nbsp; Again, my php.ini file is reported as not found in C:\WINDOWS though "Configuration File (php.ini) Path" reports it as being there.<br />
<br />
Test 4:<br />
a. To be thorough and eliminate all possible sources of "mis-direction" I deleted the PHP IniFilePath Registry entry (after backing up the Registry).&nbsp; The PHPRC environment variable was left disabled.&nbsp; <br />
b. Stopped and started IIS<br />
c. Ran "test-php-ini-loaded.php" to check whether my php.ini is loaded.&nbsp; Predictably it is not.<br />
d. Ran "test.php".&nbsp; Again, no change.&nbsp; My php.ini file is not found "Configuration File (php.ini) Path" reports it as being there.<br />
<br />
Conclusions:<br />
The first conclusion I came to is that, in the default download version of phpinfo( ), "Configuration File (php.ini) Path" is hard-wired to report C:\WINDOWS whether php.ini is there or not.&nbsp; Further, that C:\WINDOWS is not a default search location (at least not on XP).&nbsp; <br />
<br />
However, given an otherwise "proper" setup, phpinfo() reporting C:\WINDOWS as the value for "Configuration File (php.ini) Path" is merely misleading and is not actually harmful or indicative of a failed installation. <br />
<br />
Thanks go to Peter Guy of www.peterguy.com who suggested the testing, and to Daniel Brown of www.php.net for some initial guidance.<br />
<br />
P.S.&nbsp; This note is not meant to take anything away from PHP.&nbsp; It is a fine tool.&nbsp; The sole purpose of the testing was to confirm that my installation of PHP was correct.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90268""></a>
  <div class="note">
   <strong class="user">Mark C in SF</strong>
   <a href="#90268" class="date">13-Apr-2009 08:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I hadn't installed PHP in years, used the PHP 5.2.9-2 installer.&nbsp; Selected FastCGI on IIS, I just didn't work.&nbsp; On both a w2k3 server and on a Vista laptop.<br />
<br />
First, I forget to install from ZIP, as I had before.&nbsp; I suggest a notice on the download page. The message "Use of the installer isn't the preferred method for installing PHP." is on the "Windows Installer (PHP 5.1.0 and earlier)" page.&nbsp; Is that no longer true for "Windows Installer (PHP 5.2 and later)"?<br />
&nbsp;<br />
Next, I found the recent Microsoft Web Platform Installer (WPI) at <a href="http://php.iis.net" rel="nofollow" target="_blank">http://php.iis.net</a><br />
<br />
It just works.&nbsp; There are no config settings, it just installed FastCGI on IIS on the W2k3 server and on the Vista laptop.&nbsp; Took a download+install of the WPI tool, and a few minutes for php install.<br />
<br />
I'll likely never take a more careful look at what happened; for a production server I'll install manually. (or use Apache :))</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90129""></a>
  <div class="note">
   <strong class="user">brian dot twardzik at usask dot ca</strong>
   <a href="#90129" class="date">07-Apr-2009 07:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Been fighting with this for a while.<br />
<br />
Installing PHP on IIS 6.0 using the ISAPI extension.<br />
<br />
Note, if you have a web.config file present within the Virtual Directory folder, or otherwise configure the Virtual Directory to run ASP.NET scripts in a specific configuration...<br />
<br />
IIS will ignore its ISAPI obligations to render your PHP script and then cite a 401.3 error, access denied based on ACL. If you have Integrated Windows Authentication turned on as a second authentication method, the web browser will prompt you for credentials. If you supply some, either from the local machine or from your domain, the website will suddenly work. This will also result in your website loading when you reference it via Localhost. Only works with Localhost, and does not work with any network-access IP.<br />
<br />
Oddly enough, Anonymous impersonation will FAIL under these conditions! Why? I suspect it is because ASP.NET scripts run under the APPLICATION-POOL USERNAME CONTEXT. Once its kicked into that gear, any hope of using Anonymous user impersonation may go out the window.<br />
<br />
References:<br />
/*******************/<br />
Impersonation in ASP.NET: <br />
<br />
(Look up "Impersonation in ASP.NET (IIS 6.0)" on www.microsoft.com/Technet/ )<br />
<br />
Developer.com Article Demonstrating how ASP.NET Runs under ApplicationPools: <br />
<br />
<a href="http://www.developer.com/net/asp/article.php/2245511" rel="nofollow" target="_blank">http://www.developer.com/net/asp/article.php/2245511</a><br />
<br />
/*******************/<br />
<br />
This, to date, is my only theory.<br />
<br />
Filemon/Process Mon will not register any kind of failed file access attempts, everything will appear normally. Even the presence of a BUFFER_OVERFLOW message is normal within the context of SYSINTERNALS traces...<br />
<br />
But if you download the IIS 6.0 resource kit, pay attention specifically to IISTRACE.<br />
<br />
Running IISTRACE and hitting your webserver will reveal that the PHP5ISAPI filter DLL is never called! Only the asp filter DLL.<br />
<br />
The moral of your story? Keep web.config files out of your PHP directories!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84819""></a>
  <div class="note">
   <strong class="user">rowoot at gmail dot com</strong>
   <a href="#84819" class="date">31-Jul-2008 05:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a tutorial on how to get the latest
<br />
apache, php/mysql alongwith phpmyadmin installed
<br />
in windows vista/xp.
<br />

<br />
<a href="http://www.visionmasterdesigns.com/category/wp/php/" rel="nofollow" target="_blank">http://www.visionmasterdesigns.com/category/wp/php/</a>
<br />

<br />
Regards</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84740""></a>
  <div class="note">
   <strong class="user">J Veitch {a} Computer Muskoka dot - calm</strong>
   <a href="#84740" class="date">28-Jul-2008 02:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On IIS7 and Vista I got errors using Appcmd to add the handlers. I also wasn't able to choose FastCGI when adding the handler in the IIS Manager GUI. Removal of CGI from IIS components, a reboot, and re-adding CGI to IIS components allowed selection of FastCGI in the GUI and made it possible to complete the configuration steps.<br />
<br />
Here is a URL (note the complete URL is presented here as 2 lines) for another tutorial on the process with steps for both GUI and command line configuration: learn.iis.net/page.aspx/246/<br />
using-fastcgi-to-host-php-applications-on-iis7/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83683""></a>
  <div class="note">
   <strong class="user">php at vondi dot no-ip dot com</strong>
   <a href="#83683" class="date">07-Jun-2008 08:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get errors like this:<br />
PHP Notice: Constant XML_ELEMENT_NODE already defined in Unknown on line 0<br />
<br />
And many more complaining about XML constants, comment out the line:<br />
extension=php_domxml.dll<br />
in your php.ini. That extension seems to be compiled into PHP when you get those errors or something else is including the functionality before that dll.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81369""></a>
  <div class="note">
   <strong class="user">badscorp at hotmail dot com</strong>
   <a href="#81369" class="date">25-Feb-2008 09:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My experience in running php 4 and php 5 on the same machine with IIS as ISAPI module (tested on XP Pro).<br />
<br />
1- Extract the ZIP packages of both php 4 &amp; php 5 to c:\php4 &amp; c:\php5, each in its own folder.<br />
<br />
2- Setup the corresponding php.ini files in c:\php4 and c:\php5, by renaming php.ini-dist to php.ini..<br />
<br />
3- Add the Web Service Extensions for php4 and php5. For php4 use c:\php4\sapi\php4isapi.dll, php5 use c:\php5\php5isapi.dll..<br />
<br />
4- Add the following registry keys:<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\PHP\5\IniFilePath -&gt; c:\php5<br />
<br />
HKEY_LOCAL_MACHINE\SOFTWARE\PHP\IniFilePath -&gt; c:\php4<br />
<br />
5- Add c:\php4 and c:\php5 to the PATH environment variable, separated by semis.<br />
<br />
6- Create a session and an uploadtemp folders in any location, then add them in the session.save_path in bothe php ini files (there are two in php4?), and give IUSR_machinename write access to them.<br />
<br />
7- Associate each web site in IIS with the corresponding php version.<br />
<br />
8- Reboot..<br />
<br />
Use phpinfo() to test it in each site.<br />
<br />
Regards,,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80416""></a>
  <div class="note">
   <strong class="user">Eduardo Bigai at xedco dot net</strong>
   <a href="#80416" class="date">15-Jan-2008 05:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get this error: "Service Unavailable" after installing PHP to a Windows XP x64 Pro, and you followed all the instructions posted in this page, you may want to try checking the ISAPI Filters in your IIS.<br />
<br />
Make sure your a running the 32-bit version of the Microsoft.NET\Framework\v2.0.50727\aspnet_filter.dll.<br />
<br />
If you are running the 64-bit version, you will notice that liested item in the ISAPI Filters has a red arrow pointing down. This means that the service failed to load. Delete this item from the list and add a new one. Make sure you use the one located here: %Windows%/Microsoft.NET\Framework\v2.*\aspnet_filter.dll.<br />
<br />
Also make sure the permissions to your PHP folder have "NETWORK SERVICE", "IUSR_*", "SYSTEM" included.<br />
<br />
I hope this helps you saving some precious time</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80291""></a>
  <div class="note">
   <strong class="user">sediaz at simpleonlinehelp dot com</strong>
   <a href="#80291" class="date">08-Jan-2008 06:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you that would like visuals, there's a video tutorial that will help you get PHP5 installed on Windows 2K3 w/ IIS6.<br />
<br />
It's pretty straight forward.<br />
<br />
The link to the site, if you're interested, is:<br />
<a href="http://www.videotutorialzone.com" rel="nofollow" target="_blank">http://www.videotutorialzone.com</a><br />
<br />
The title is:<br />
Installing PHP5 on Windows 2003 and IIS6<br />
<br />
I hope this helps others as it did me.<br />
<br />
Scott</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80001""></a>
  <div class="note">
   <strong class="user">smileclick at hotmail dot com</strong>
   <a href="#80001" class="date">23-Dec-2007 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Still Can't Run PHP Code?<br />
<br />
After installing php-5.2.5-win32-installer.msi on my Windows XP2. with IIS5.1 it still didn't run PHP files.<br />
<br />
I eventually found the fix*:<br />
<br />
1. Goto Control Panel&gt;System&gt;Advanced&gt;Environmental Variables<br />
2. Add a New System Variable "PHRC" and set its path as "C:\Program Files\PHP"<br />
3. Restart<br />
<br />
*source: <br />
<a href="http://us2.php.net/manual/en/faq.installation.php" rel="nofollow" target="_blank">http://us2.php.net/manual/en/faq.installation.php</a><br />
#faq.installation.addtopath</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79809""></a>
  <div class="note">
   <strong class="user">robert dot johnson at icap dot com</strong>
   <a href="#79809" class="date">13-Dec-2007 04:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IIS setup: 403 forbidden error.&nbsp; <br />
<br />
We had installed two separate different PHP versions - PHP 5.1.4 followed by 5.2.5.<br />
<br />
We configured 5.2.5 php5isapi.dll to be loaded as the .php file type extension.<br />
<br />
Despite this, php version 5.1.4 was being loaded.&nbsp; We renamed 5.1.4's folder and then PHP was not loading at all.<br />
<br />
There were no visible references to 5.1.4 in the IIS configuration, but in the file \webConfig.xml, there was a reference to 5.1.4's isapi under IISFilters.<br />
<br />
To fix this problem, we added version 5.2.5's php5isapi.dll to the ISAPI Filter category for the web site, in the IIS control panel.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79465""></a>
  <div class="note">
   <strong class="user">Philip Thompson</strong>
   <a href="#79465" class="date">28-Nov-2007 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use the installer for Windows (PHP &gt;= 5.2.x) and you want the mysql_* functions to be used, you may have to restart your machine after you install.<br />
<br />
I was getting the error "Call to undefined function mysql_connect..." However, I knew that my php.ini settings were correct and I was including php_mysql.dll. When I viewed phpinfo(), it was not showing that MySQL was part of the install. My first thought was to restart Apache - this did not change anything. So, then I restarted the machine, viewed phpinfo() again and it was now there.<br />
<br />
I've manually installed several times on Windows and not had this problem. This was my first time running the installer. I think it may have something to do with setting registry values or changing environment variables. Nonetheless, hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78989""></a>
  <div class="note">
   <strong class="user">infortechpro at yahoo dot com</strong>
   <a href="#78989" class="date">06-Nov-2007 11:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello,<br />
<br />
I had trouble setting up PHP 5 to work IIS 5 (Windows 2000).<br />
<br />
I keep getting a HTTP 500 error.<br />
<br />
I checked the php5isapi.dll file path, the permissions and all that but the error did not go way.<br />
<br />
The way I got it to work was by adding the IUSR_(machine name) and IWAM_(machine name) account to the administrators group and restarting the computer.<br />
<br />
I hope this helps someone out there.<br />
<br />
Cheers.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78671""></a>
  <div class="note">
   <strong class="user">snapper</strong>
   <a href="#78671" class="date">22-Oct-2007 10:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding the "No input file specified." problem where 404 error pages aren't sent if the requested non-existent file ends in .php, this was helpful to me . . . <a href="http://www.phpbuilder.com/board/showthread.php?t=9212" rel="nofollow" target="_blank">http://www.phpbuilder.com/board/showthread.php?t=9212</a><br />
<br />
In a nutshell:<br />
<br />
In IIS Management Console (v5.1 in my case), select "Default Web Site", right-click and select "Properties", "Home Directory" tab, "Configuration..." under Application Settings, "Mappings" tab, select the line for the .php file extension, select "Edit" and check these two things:<br />
<br />
1) ensure that executable C:\PHP\php5isapi.dll filename is not truncated<br />
2) ensure there is a tick in the box next to "Check that file exists".<br />
<br />
Click OK, OK, OK.<br />
<br />
Cheers.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78144""></a>
  <div class="note">
   <strong class="user">Uday Kari</strong>
   <a href="#78144" class="date">30-Sep-2007 03:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
First I got a HTTP 405 error, resolving which I got an HTTP 404 error...read on for how this was fixed...<br />
<br />
Environment:&nbsp; PHP 5.2.4, IIS 6.0 ISAPI, Windows Server 2003.&nbsp; <br />
<br />
Installation:&nbsp; Simply downloaded the PHP 5.2.4 installer [22,002Kb] - 30 August 2007 and ran it doing next, next until Finish. <br />
<br />
To get rid of 405 error, ensure that your php directory allows scripts.&nbsp; Start-&gt;Control Panel-&gt;Administrative Tools-&gt;Internet Information Services-&gt; (select website, navigate to directory with your php and right-click your directory) -&gt; Properties -&gt; Directory TAB -&gt; Change Execute Permissions from "None" to "Scripts" (to allow PHP).<br />
<br />
To get rid of 404 error, ensure that your executable mapping for the .php extension is properly coded.&nbsp; Start-&gt;Control Panel-&gt;Administrative Tools-&gt;Internet Information Services-&gt; (select web site) -&gt;Properties-&gt;Home Directory-&gt;Configuration-&gt;Mapping and then change the Executable Path for .php files from C:\Program~\PHP\php5is~1.DLL (or whatever crazy path) to "C:\Program Files\PHP\php5isapi.dll" <br />
<br />
(IMPORTANT: the quotes from c:\ to end of dll are important since the default install location, Program Files, has a space...in my youth I would yell "Stupid Microsoft"...but now I would more maturely just note that there is an inconsistency with the way that Paths are defined...in definingenvironment variables, for instance, such spaces are OK...).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77680""></a>
  <div class="note">
   <strong class="user">Jack Hardie</strong>
   <a href="#77680" class="date">08-Sep-2007 11:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are installing PHP on Vista just go to David Wang's blog. <a href="http://blogs.msdn.com/david.wang/" rel="nofollow" target="_blank">http://blogs.msdn.com/david.wang/</a><br />
archive/2006/06/21/HOWTO-Install-and-Run-PHP-on-IIS7-Part-2.aspx<br />
&nbsp;<br />
Magic!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76944""></a>
  <div class="note">
   <strong class="user">Ananda Sim</strong>
   <a href="#76944" class="date">07-Aug-2007 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I installed php 5.2.3 using the msi package to Windows XP SP2. First time, ISAPI choice defaulted to installing php to c:\program files\php. The IIS Manager &gt; Websites &gt; Home Directory &gt; Extensions used the short filename. Didn't work - message was "module not found". I then removed and installed to c:\php. That worked easily.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76443""></a>
  <div class="note">
   <strong class="user">fabrizio dot barbarino at uniud dot it</strong>
   <a href="#76443" class="date">16-Jul-2007 12:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to enable your x64 version of Windows 2003 Server executing the php*.dll through IIS, you can execute the script shown here: <br />
<br />
<a href="http://technet2.microsoft.com/windowsserver/en/library/" rel="nofollow" target="_blank">http://technet2.microsoft.com/windowsserver/en/library/</a><br />
36f8964c-cf86-44cf-94a4-2873ad0d175f1033.mspx?mfr=true<br />
<br />
I've tested it with Windows 2003 Server x64 SP2 and PHP 5.2.3 and it works.<br />
<br />
Good work,<br />
Fabar</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75898""></a>
  <div class="note">
   <strong class="user">Jeremy Griffith</strong>
   <a href="#75898" class="date">20-Jun-2007 08:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have installed using the msi file, allowed it to configure IIS6 for you using the default directory, and are receiving a 404 error (specifically 404 2 error in your log file), then you need to modify the "application extension" for .php to include the full quoted path.&nbsp; The default uses the old 8.3 convention which is not considered the same by IIS, and therefor the web extension isn't allowed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75581""></a>
  <div class="note">
   <strong class="user">imi at deltanet dot hr</strong>
   <a href="#75581" class="date">06-Jun-2007 06:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 5.2.3 under IIS 5.1 (as ISAPI) and Windows XP<br />
<br />
If you have trouble trying to get run the combination above using PHP installer please make sure that your executable path for .php file on IIS has been written correctly. <br />
<br />
Start-&gt;Control Panel-&gt;Administrative Tools-&gt;Internet Information Services-&gt; (then select your web site) -&gt;Properties-&gt;Home Directory-&gt;Configuration-&gt;Mapping and then change the Executable Path for .php files from C:\PHP\php5is~1.DLL to C:\PHP\php5isapi.dll</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75172""></a>
  <div class="note">
   <strong class="user">jcwebb at dicoe dot com</strong>
   <a href="#75172" class="date">16-May-2007 10:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHPv522 configuration considerations (php.ini) on Win3k(iis6)<br />
<br />
cgi.force_redirect = 0<br />
++ You MUST set this (its commented out by default)<br />
<br />
two new settings are included...<br />
session.save_path = "C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\php\session"<br />
upload_tmp_dir = "C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\php\upload"<br />
++ sessions will fail: $_SESSION['something'] unless you deal with permissions on the new location,<br />
or simply comment out the session.save_path and go back to default "c:\windows\temp"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74981""></a>
  <div class="note">
   <strong class="user">davideatarkehostdotnet</strong>
   <a href="#74981" class="date">07-May-2007 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i have encountered always the same problem installing php on windows 2003 (it always worked fine with w2k) "php has encountered an access violation at xxxx". tried php5.x and downgrade to php4.x without success. problem was solved only by giving r+w+e permission on php folder to user IIS_WPG</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74674""></a>
  <div class="note">
   <strong class="user">i_robot73 at hotmail dot com</strong>
   <a href="#74674" class="date">23-Apr-2007 04:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running on Win2k3 x64 w/ IIS6.&nbsp; Followed the BASIC setup (unzip, PHPRC, add extension to IIS) and still no go.<br />
<br />
Wasn't until I enabled x86 that it 'popped':<br />
<br />
cscript d:\inetpub\adminscripts\adsutil.vbs SET W3SVC/AppPools/Enable32bitAppOnWin64 1<br />
<br />
No security issues that needed fixing.&nbsp; Test .php file came up like a champ!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72320""></a>
  <div class="note">
   <strong class="user">christian dot ulbrich at gmx dot de</strong>
   <a href="#72320" class="date">13-Jan-2007 08:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have an IIS 6.0 with PHP 5.2.0 as ISAPI-module. Installation went fine, using one of the numerous guides available, however I couldn't get my PHP to load any extensions!<br />
<br />
It took me quite a while, to find the catch, it seems, that PHP 5.2.0 doesn't like the quotation marks " in some of its directory variables.<br />
<br />
Thus, changing<br />
<br />
extension_dir = "c:\php\ext\"<br />
<br />
to<br />
<br />
extension_dir = c:\php\ext\<br />
<br />
did the trick for me...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71110""></a>
  <div class="note">
   <strong class="user">john@ellingsworth</strong>
   <a href="#71110" class="date">13-Nov-2006 02:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another cause of the "No input file specified" on systems with multiple hosts is that the doc_root setting in the php.ini file has been set to a specific directory.&nbsp; When using IIS with multiple hosts in distinct top level directories you should comment the doc_root line out.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71027""></a>
  <div class="note">
   <strong class="user">jneill at gamedaytv dot com</strong>
   <a href="#71027" class="date">09-Nov-2006 02:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's how to run dual PHP instances with PHP 5.2 and any previous PHP on Windows 2003:<br />
<br />
1. Right-click My Computer, go to Advanced tab, and click on Environment Variables.<br />
<br />
Add the two installations and their EXT directories to the Path variable. For example, add:<br />
c:\php;c:\php\ext;c:\TMAS\php;c:\tmas\php\ext;<br />
<br />
Then, add the newer PHP version's directory as a variable called PHPRC. For example:<br />
Variable:PHPRC<br />
Value: C:\PHP<br />
<br />
Click OK to close the Environment Variables window, and click OK to close System Properties.<br />
<br />
2. In registry, under HKEY_LOCAL_MACHINE&gt;SOFTWARE&gt;PHP, add a REG_SZ key called iniFilePath and give it a value<br />
of the directory where the older PHP is installed. For example:<br />
C:\TMAS\PHP<br />
<br />
3. In IIS, go to the Web Service Extensions. Add both versions' ISAPI module separately to the extensions<br />
list, and allow both.<br />
<br />
4. In IIS, go to each website utilizing the PHP versions. Set an ISAPI filter if needed. On the Home Directory<br />
tab, click Configuration, and add .php, .php3, .phtml, and any other extensions needed (perhaps .html?) to<br />
be filtered through PHP, and specify the ISAPI module version needed for each website.<br />
<br />
You can now run two versions of PHP. This is because the order of where to look for the .ini file changed<br />
between previous PHP versions and PHP 5.2, as documented at <a href="http://us2.php.net/ini:" rel="nofollow" target="_blank">http://us2.php.net/ini:</a><br />
<br />
---------------------------------------------------<br />
&nbsp;php.ini is searched in these locations (in order):<br />
<br />
&nbsp;&nbsp;&nbsp; * SAPI module specific location (PHPIniDir directive in Apache 2, -c command line option in CGI and CLI, php_ini parameter in NSAPI, PHP_INI_PATH environment variable in THTTPD)<br />
&nbsp;&nbsp;&nbsp; * The PHPRC environment variable. Before PHP 5.2.0 this was checked after the registry key mentioned below.<br />
&nbsp;&nbsp;&nbsp; * HKEY_LOCAL_MACHINE\SOFTWARE\PHP\IniFilePath (Windows Registry location)<br />
&nbsp;&nbsp;&nbsp; * Current working directory (for CLI)<br />
&nbsp;&nbsp;&nbsp; * The web server's directory (for SAPI modules), or directory of PHP (otherwise in Windows)<br />
&nbsp;&nbsp;&nbsp; * Windows directory (C:\windows or C:\winnt) (for Windows), or --with-config-file-path compile time option <br />
----------------------------------------------------</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71023""></a>
  <div class="note">
   <strong class="user">afitzs at for-finance dot com</strong>
   <a href="#71023" class="date">08-Nov-2006 08:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have found the following procedure to work correctly EVERY time for installing PHP version 5.x.x on Windows 2003 servers. (I have done over 100 of these on Web, Standard &amp; Enterprise)<br />
<br />
1. Download the current PHP Zip file to a folder of your choosing.<br />
<br />
2. Download the old Installer.exe (I use 5.0.2)<br />
<br />
3. Run the installer and accept the defaults in all cases except the IIS server, choose IIS 6.0 or later. The installer will complain that a script map is not registered and ask you if you want to register it. SAY YES!!!<br />
<br />
4. Run the installer a *second* time, using the same settings as above. This time instead of the complaint that a script is not registered you should see a black dos box open and then close. This is your clue that the install was successful.<br />
<br />
5. Copy your PHP .zip file to c:\php and extract and overwrite all files from the regular installer.<br />
<br />
6. Edit c:\windows\php.ini to enable any extensions you may need and to set the extension directory to c:/php/ext<br />
<br />
All should be good to go. Test by running an info() from the web server.<br />
<br />
I have used this install on over 100 installs of 2003/IIS web servers. Generally they have been virgin installs, but a few have had existing sites on them. Using the above method I am able to install PHP in under 2 min. Of course, these are windows systems thus your mileage may vary.<br />
<br />
Note: I just tried to use the new .msi installer without success. Resorted to the above procedure and now have 5.2.0 running on the new server.<br />
<br />
Note2: PHP powers that be, please make a copy of the old installer available again somewhere easily found by people. I would be screwed if I had not kept an archive copy of the 5.0 installer.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71006""></a>
  <div class="note">
   <strong class="user">webmaster at nachelfamily dot com</strong>
   <a href="#71006" class="date">08-Nov-2006 02:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made the mistake of setting a 'wildcard application map' for PHP on a Windows 2003 / IIS 6.0 / PHP ISAPI installation.&nbsp; <br />
<br />
This resulted in "No input file specified" errors whenever I tried to load the default page in my site's directories.&nbsp; I don't know why this broke things, but it did.<br />
<br />
If anyone has the same problem, this may be the cause.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70176""></a>
  <div class="note">
   <strong class="user">yacahuma</strong>
   <a href="#70176" class="date">05-Oct-2006 09:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IIS6 AND PHP5 on w2k3<br />
1.download php and unzip to c:\php<br />
&nbsp;&nbsp; - also create c:\php\sessions<br />
2.add c:\php to you path <br />
&nbsp;&nbsp; -right click mycomputer,properties,advance,env variables<br />
2.On IIS Manager add web service extension<br />
&nbsp;&nbsp; -name: php isapi<br />
&nbsp;&nbsp; -req files: c:\php\php5isapi.dll<br />
3.Now let iis know what to do with .php<br />
&nbsp; -On iis Manager,right click Web Sites, properties, home directory tab, configuration button, add button<br />
&nbsp;&nbsp; &nbsp; executable: c:\php\php5isapi.dll<br />
&nbsp;&nbsp; &nbsp; extension: .php<br />
&nbsp;&nbsp; &nbsp; limit to: GET,POST,HEAD<br />
4. rename php.ini-recommended to php.ini<br />
&nbsp; you can copy php.ini to c:windows or modify the registry to look for php.ini in c:\php<br />
&nbsp;&nbsp; to use the registry create a php.reg file with the following inside. after this just double click. do not put the lines.<br />
-------------------------------------------------<br />
Windows Registry Editor Version 5.00<br />
<br />
[HKEY_LOCAL_MACHINE\SOFTWARE\PHP]<br />
"IniFilePath"="C:\\php"<br />
-------------------------------------------------<br />
<br />
5. modify php.ini with<br />
short_open_tag = On<br />
extension_dir = "c:\php\ext"<br />
cgi.force_redirect = 0<br />
<br />
6. the web sites are going to be using the default pool. this runs under network service. go to c:\php and give the network service&nbsp; read&amp; execute, list folder content,read<br />
&nbsp; -go to c:\php\sessions and add write and modify access network service</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64764""></a>
  <div class="note">
   <strong class="user">Cam McVey</strong>
   <a href="#64764" class="date">20-Apr-2006 12:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using Application Pool Isolation and you're trying to get PHP to run as CGI and you're getting 403 errors, try looking at this article (watch the word wrap):<br />
<a href="http://www.servertastic.com/articles/2005/11/" rel="nofollow" target="_blank">http://www.servertastic.com/articles/2005/11/</a><br />
unable-to-run-perl-or-php-in-application-pool-isolation/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64754""></a>
  <div class="note">
   <strong class="user">SmugWimp at smugwimp dot com</strong>
   <a href="#64754" class="date">20-Apr-2006 11:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you make changes to your PHP.ini file, consider the following.
<br />

<br />
(I'm running IIS5 on W2K server. I don't know about 2K3)
<br />

<br />
PHP will not "take" the changes until the webserver is restarted, and that doesn't mean through the MMC.&nbsp; Usually folks just reboot. But you can also use the following commands, for a much faster "turnaround".&nbsp; At a command line prompt, type:
<br />

<br />
iisreset /stop
<br />

<br />
and that will stop the webserver service.&nbsp; Then type:
<br />

<br />
net start w3svc
<br />

<br />
and that will start the webserver service again.&nbsp; MUCH faster than a reboot, and you can check your changes faster as a result with the old:
<br />

<br />
&lt;?php&gt;
<br />
phpinfo();
<br />
?&gt;
<br />

<br />
in your page somewhere.
<br />

<br />
I wish I could remember where I read this tip; it isn't anything I came up with...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63937""></a>
  <div class="note">
   <strong class="user">ratkinson at tbs-ltd dot co dot uk</strong>
   <a href="#63937" class="date">04-Apr-2006 02:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When installing onto the Windows IIS platform, ensure you add the PHPRC Server Variable to point to your PHP.INI file.<br />
<br />
Also, add '.INI' to the FILEEXT Server Variable. Failure to add these could stop the PHP engine being able to find your PHP.INI file, and none of your modifications will be read.<br />
<br />
Rob.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62483""></a>
  <div class="note">
   <strong class="user">niatech</strong>
   <a href="#62483" class="date">01-Mar-2006 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thought someone would save some time and headaches by using this post.<br />
<br />
Our tech department is migrating to Windows 2003 Server and they have some complex security implementations between our Web Servers and our Application (COM) servers.<br />
<br />
If you have this type of scenario and are receiving the "Warning (null)(): Unable to lookup.... Access is denied." error, it is because the "Identity" in the Web Server's application pool does not have sufficient permissions to connect to the Application (COM) Server.<br />
<br />
To fix this:<br />
<br />
- create a new Application Pool<br />
- right click the new pool and select "properties"<br />
- click on the "Identity" tab<br />
- change the permissions from "Network Service" to a user on the Web Server who has access to call the Application (COM) server.<br />
- right click the application pool<br />
- click "start"<br />
- right click your web site<br />
- click on the "Home Directory" tab<br />
- change the application pool to the new application pool you've just created.<br />
- restart IIS<br />
<br />
Hopefully this will save someone some time and headaches.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62426""></a>
  <div class="note">
   <strong class="user">mach</strong>
   <a href="#62426" class="date">28-Feb-2006 03:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've installed Apache + PHP on a Windows machine of which I'm not an administrator.<br />
<br />
I found out it was necessary to change the permissions of the httpd.conf file on C:\Program Files\Apache Group\Apache\conf in order to have everything working. Since I'm also using cygwin this was simply done with: &gt;chmod 755 httpd.conf.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60737""></a>
  <div class="note">
   <strong class="user">lukasz at szostak dot biz</strong>
   <a href="#60737" class="date">15-Jan-2006 04:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can have multiple versions of PHP running on the same Apache server. I have seen many different solutions pointing at achieving this, but most of them required installing additional instances of Apache, redirecting ports/hosts, etc., which was not satisfying for me.<br />
Finally, I have come up with the simplest solution I've seen so far, limited to reconfiguring Apache's httpd.conf.<br />
<br />
My goal is to have PHP5 as the default scripting language for .php files in my DocumentRoot (which is in my case d:/htdocs), and PHP4 for specified DocumentRoot subdirectories.<br />
<br />
Here it is (Apache's httpd.conf contents):<br />
<br />
---------------------------<br />
# replace with your PHP4 directory<br />
ScriptAlias /php4/ "c:/usr/php4/"<br />
# replace with your PHP5 directory<br />
ScriptAlias /php5/ "c:/usr/php5/"<br />
<br />
AddType application/x-httpd-php .php<br />
Action application/x-httpd-php "/php5/php-cgi.exe"<br />
<br />
# populate this for every directory with PHP4 code<br />
&lt;Directory "d:/htdocs/some_subdir"&gt;<br />
&nbsp;&nbsp;&nbsp; Action application/x-httpd-php "/php4/php.exe"<br />
&nbsp;&nbsp;&nbsp; # directory where your PHP4 php.ini file is located at<br />
&nbsp;&nbsp;&nbsp; SetEnv PHPRC "c:/usr/php4"<br />
&lt;/Directory&gt;<br />
<br />
# remember to put this section below the above<br />
&lt;Directory "d:/htdocs"&gt;<br />
&nbsp;&nbsp;&nbsp; # directory where your PHP5 php.ini file is located at<br />
&nbsp;&nbsp;&nbsp; SetEnv PHPRC "c:/usr/php5"<br />
&lt;/Directory&gt;<br />
---------------------------<br />
<br />
This solution is not limited to having only two parallel versions of PHP. You can play with httpd.conf contents to have as many PHP versions configured as you want.<br />
You can also use multiple php.ini configuration files for the same PHP version (but for different DocumentRoot subfolders), which might be useful in some cases.<br />
<br />
Remember to put your php.ini files in directories specified in lines "SetEnv PHPRC...", and make sure that there's no php.ini files in other directories (such as c:\windows in Windows).<br />
<br />
And finally, as you can see, I run PHP in CGI mode. This has its advantages and limitations. If you have to run PHP as Apache module, then... sorry - you have to use other solution (the best advice as always is: Google it!).<br />
<br />
Hope this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59980""></a>
  <div class="note">
   <strong class="user">cormierma_at_csdcso.on.ca</strong>
   <a href="#59980" class="date">21-Dec-2005 10:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note to windows server 2003 users<br />
<br />
If you install php5 ISAPI on windows server 2003 / IIS and keep getting a 404 when you try to view a php script don`t just activate "all unknown ISAPI extensions" but also activate "All Unknown CGI Extensions".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57757""></a>
  <div class="note">
   <strong class="user">Cevher Bozkur</strong>
   <a href="#57757" class="date">13-Oct-2005 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've installed php 5.0.5 with the ISAPI module, as the isapi dll file (php5isapi.dll) resides in the php root directory, I didn't have trouble in my installation (In php4 this dll file is in sapi directory and it should be moved to php root directory). <br />
<br />
I changed some of my settings in php.ini file and restart IIS Web site,but my changes weren't applied. <br />
<br />
Then I go to Control Panel&gt;Administrative Tools&gt;Services and restart the IIS Admin Service.<br />
<br />
Everything worked like a charm...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57268""></a>
  <div class="note">
   <strong class="user">william keith</strong>
   <a href="#57268" class="date">29-Sep-2005 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Dirt Simple Install Guide For PHP5/W2K Servers<br />
<br />
For those of us out there who still have 2K servers, this is a great 3 min step by step to get you up and running.<br />
<br />
<a href="http://www.onlamp.com/pub/a/php/2000/12/14/php_admin.html" rel="nofollow" target="_blank">http://www.onlamp.com/pub/a/php/2000/12/14/php_admin.html</a><br />
<br />
Thanks to it's author, Darrell Brogdon!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56316""></a>
  <div class="note">
   <strong class="user">thedeadraptor2000 at yahoo dot com</strong>
   <a href="#56316" class="date">30-Aug-2005 05:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note regarding PHP4 Installation on IIS5 + Win2K<br />
<br />
Tip: Don't install PHP4 on Directories with spaces in between.<br />
<br />
I've had problems Installing PHP 4.0.0 on IIS5, Win2k's default web server, spanish version (I live in Colombia). I've had HTTP 500 Errors and I followed all instructions step by step, but nothing seemed to work.<br />
<br />
I solved the problem eventually, and I think it had something to do with the fact that I have installed PHP4 manually and placed it in the directory "C:\Archivos de programa\php-4.4.0-Win32" ('Archivos de programa' stands for 'Program Files'), a directory with spaces in between.<br />
<br />
When I added the application mappings for "C:\Archivos de programa\php-4.4.0-Win32/sapi/php4isapi.php", An error would ocurr and a message along with it: "Escriba una ruta de acceso valida", as in "Write a valid access rute", as in "I can't find the file".<br />
<br />
I thought i had it when I encapsulated it with Doublequotes ("), but that didn't work either.<br />
<br />
As a final long shot, I copied the php4isapi.dll to the windows/system32 directory and 'WALA!' It worked.<br />
<br />
I'm not sure, but i suspect that it had to do with spaces in between directory names, so avoid those, or copy the isapi module to another directory.<br />
<br />
Hope this helps someone!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55500""></a>
  <div class="note">
   <strong class="user">wappa at hotmail dotandthekangaroo com</strong>
   <a href="#55500" class="date">05-Aug-2005 05:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't forget if you are getting ACL exceptions to reading the test php page you have created you MUST share the PHP directory or the resources PHP uses to "everyone" but remember use restricted access for security.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55049""></a>
  <div class="note">
   <strong class="user">jp at iticonsulting dot nl</strong>
   <a href="#55049" class="date">23-Jul-2005 06:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get 404 page not found on Windows/IIS5, have a look at C:\SYSTEM32\INETSRV\URLSCAN<br />
<br />
There is a .ini file there that prevents some files from being served by IIS, even if they exist, instead IIS will give a 404. The urlscan logfile (same place) should give you some insight into what parameter is preventing a page from loading, if any.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53646""></a>
  <div class="note">
   <strong class="user">Feroz Zahid</strong>
   <a href="#53646" class="date">08-Jun-2005 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to run php scripts with php.exe CGI instead of php4isapi.dll under IIS, following steps can be followed.<br />
<br />
i) Add a web service extension for PHP using IIS manager. Choose a web service extension name like 'PHP' and add your php.exe path in the 'file location' while adding the required file e.g. 'C:\php\php.exe' in the Add extension dialog box. Don't forget to 'Allow' the extension file.<br />
<br />
ii) Open php.ini file located at %systemroot%. Set the following variables to the shown values.<br />
<br />
cgi.force_redirect = 0<br />
cgi.redirect_status_env = ENV_VAR_NAME<br />
<br />
iii) In your websites, add Application Mapping for '.php' and set the executable path to your php.exe file path. <br />
<br />
You can test whether PHP is running or not and other PHP settings using the following simple PHP script.<br />
<br />
&lt;?php&gt;<br />
phpinfo();<br />
?&gt;<br />
<br />
Feroz Zahid<br />
ferozzahid [_at_] usa [_dot_] [_com_]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52530""></a>
  <div class="note">
   <strong class="user">donald at netriver dot net</strong>
   <a href="#52530" class="date">04-May-2005 10:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On the Windows 2003 &amp; IIS6 platform, you can run different websites on different versions &amp; copies of PHP. This is useful in at least two cases:<br />
<br />
&nbsp; 1. You want one website on your box to have register_globals on, but since you're running IIS, you cannot specify that in an .htaccess file. And you definately don't want register_globals on for the rest of the websites.<br />
&nbsp; 2. You want to run different versions of PHP for different websites, or even just different extensions. Say you wanted one site to use 4.0.5 and a different site to use 4.1.11.<br />
<br />
Its simple, just:<br />
&nbsp; 1. Move your php.ini file from your c:\windows\ directory directly to your php directory (by default that would be c:\php\)<br />
&nbsp; 2. Make sure you don't have a php.ini file in any other location that would supercede the c:\php\php.ini file. Using phpinfo(); is useful here.<br />
&nbsp; 3. Have your alternate version of php (either a different version or a different php.ini) have its own install directory, like c:\php4RG\ or c:\php405\.<br />
&nbsp; 4. In the Home Directory Configuration for your website, specify the .php extension to use a different script, pointing it at the alternate directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50583""></a>
  <div class="note">
   <strong class="user">doyouunderstand at gmail dot com</strong>
   <a href="#50583" class="date">04-Mar-2005 01:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those having trouble installing PHP 5+ ISAPI for IIS 6 (on Windows 2003 server), who have tried everything on this site and all over the net, with no success (like I did) - try the following before throwing your server out of a 3rd story window.<br />
<br />
<a href="http://www.benmardesign.com/IIS_PHP_MYSQL_setup/php_setup.html" rel="nofollow" target="_blank">http://www.benmardesign.com/IIS_PHP_MYSQL_setup/php_setup.html</a><br />
<br />
It was the only thing that worked out of all the many solutions I tried.<br />
<br />
Probably some other solutions would've worked as well, but in my frusterated state of mind, this explanation was the clearest.&nbsp; <br />
<br />
My problem was that in addition to adding the the Web service extension, I was not adding the ISAPI extensions for the websites in IIS Manager manaully.&nbsp; ALSO, remember to reboot after the changes on the site listed above.&nbsp; It's the only thing he forgot to mention, and depending on your setup, you may need to reboot to register the dll moves and changes made.&nbsp; (IIS restart will not re-register dlls).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49595""></a>
  <div class="note">
   <strong class="user">Steve N</strong>
   <a href="#49595" class="date">02-Feb-2005 05:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a note following on from Luis D regarding adding the pgp4ts.dll as a Web Server Extension.<br />
<br />
I just used the latest php-4.3.10-installer.exe from php.net and had the problems where .php files could not be found.<br />
<br />
In order to get them to work I added and allowed the php.exe as a Web Service Extension and not the php4tx.dll.<br />
<br />
Cheers,<br />
<br />
Steve</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49014""></a>
  <div class="note">
   <strong class="user">claudio_jvt at hotmail dot com</strong>
   <a href="#49014" class="date">14-Jan-2005 01:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One very helpfull note to Win2003 iis6 users:<br />
If you'd like to use isapi in the web service extensions and you're in a development server (or even if your php.ini config file changes frequently), here's what you can do:<br />
<br />
Php.ini runtime changes:<br />
Create a new application pool in iis:<br />
iis-&gt;select server-&gt;application pools-&gt;new application pool<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Use default settings;<br />
&nbsp;&nbsp; &nbsp;&nbsp; go to the application pool you've created, properties-&gt;<br />
&nbsp;&nbsp;&nbsp; check the "Recycle worker process" option, and give it a small value (10 is nice :) ).<br />
<br />
Now go to your site (or virtual directory site)-&gt; properties-&gt;<br />
change the application pool to the newly configured appPool.<br />
<br />
At this moment, is good to make a iss restart (note this is the only resart needed).<br />
<br />
Your site is now semi-runtime changed :) <br />
You can try it with the usal php info() test. Change something in the php.ini and check the number of requests it takes to use the new configuration.<br />
<br />
The downside of this approach (wich is still better than to use php-cgi.exe): the process is recycled, so all the configuration in php.ini is read every N requests - with php-cgi.exe, this would happen for every request, so.. is a good solution. <br />
<br />
Again, be carefull when using this in a production environment, since the load can increase (not sure how much, but it will certainly increase). <br />
<br />
And keep in the new appPool JUST the php sites that require runtime changes in php.ini !<br />
<br />
------<br />
You've helped me, so I help you ;)<br />
Tks</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48866""></a>
  <div class="note">
   <strong class="user">chris at move dash media dot com</strong>
   <a href="#48866" class="date">10-Jan-2005 01:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note to windows users, if you are trying to install php5 ISAPI on windows server 2003 / IIS and getting a 404 when you try to view a simple php script, even though everything else seems to be right...&nbsp; click into "web service extensions" from IIS and either add a new web service extension, or click onto "all unknown ISAPI extensions" and click allow.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41589""></a>
  <div class="note">
   <strong class="user">Sean Boulter</strong>
   <a href="#41589" class="date">15-Apr-2004 11:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This fixes the "The directory name is invalid" error.<br />
<br />
In IIS 5.1 on Windows XP Pro, Go into the Internet Information Services, and into the properties of the virtual directory where the problem occurs.&nbsp; On The 'Virtual Directory' tab, click on the 'Configuration...' button.&nbsp; Select the '.php' extension, and press 'Edit'.&nbsp; On the bottom, Check the 'Check that file exists' checkbox.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41030""></a>
  <div class="note">
   <strong class="user">Luis D</strong>
   <a href="#41030" class="date">27-Mar-2004 01:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is just to clarify on a posting on this page that states the nescesity of allowing all unknown cgi Extensions in Windows 2003 IIS 6. Although this will work and it should be consider as a quick option for an itranet solution with no web access at all.<br />
<br />
This poses a very serious security problem and its not the best course of action, in my opinion.&nbsp; The proper way of making this work will be to actually enable the extension that you want to execute.&nbsp; After verifying that the .php extension is present, simply go to "Web Service extensions" in the IIS Manager and click on "Add a new web service extension";<br />
<br />
Once the "new web service extension" opens:<br />
<br />
1- Add the "extension name" field, please enter "PHP" (or what ever you wanna call it) Other more conservative admins will say call it what it is and always input ".php".&nbsp; Its up to you!<br />
2-Click on the "add" button and browse to the php4ts.dll file on your c:\PHP (default)&nbsp; and then click open --&gt; OK and set the checkmark under "set extension status to allowed" click OK and thats it!!!<br />
<br />
If you missed the checkmark moment cause you are just so impatient, like me, then simply select the extension on the web service extensions windows and click ALLOW.<br />
<br />
This is a very simple process and it will work everytime.<br />
<br />
I hope this helps, as I have found several things in this forums that are incredibly helpfull!!<br />
<br />
PS: For the non programmer, it is a good practice to install mysql and a free php forum like bb2 to test how well your php IIS and mysql is working.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39222""></a>
  <div class="note">
   <strong class="user">ungdi at hotmail dot com</strong>
   <a href="#39222" class="date">21-Jan-2004 10:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under a Windows 2003 and IIS 6.x installation of PHP, it is interesting to note that by default in most cases, the "DefaultAppPool" for the "Default Web Site" is running under the security context of "Network Service" which maybe too restrictive. This results in a 403: Forbidden error every time you try to access a PHP page.<br />
<br />
You have several options to remedy the problem:<br />
an obvious one is to make it run as the "Local System", but that may be too much power for some administrators' tastes. <br />
<br />
The other option is at the IIS Manager,<br />
go to the computer's "Application Pools" folder,<br />
and go to the properties dialog box of the "DefaultAppPool",<br />
and then to the "Identity" tab, and select the "Configurable" identity of "IWAM_[COMPUTER_NAME]" as the security context. This will make the application pool run the way it did in the previous versions.<br />
<br />
This solved the repeated problems of the 403 errors. However, do not forget to give permission to "IUSR_[COMPUTER_NAME]" and "IWAM_[COMPUTER_NAME]" appropriate directory permissions for your web directories as stated above.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24489""></a>
  <div class="note">
   <strong class="user">spf at users dot sf dot net</strong>
   <a href="#24489" class="date">19-Aug-2002 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To allow acWEB.sf.net win32-webserver and Eserv 2.98 (www.eserv.ru) web-server run PHP 4.2.2 without problems with FORCE_REDIRECT you should set "cgi.force_redirect = Off" in php.ini in windows directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19920""></a>
  <div class="note">
   <strong class="user">adam dot swick at pantellos dot com</strong>
   <a href="#19920" class="date">15-Mar-2002 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IIS 5: If you change the application mappings for PHP (for example, from CGI to ISAPI module), reboot after the change is made.&nbsp; The PHP Application Mapping change may cause a conflict if ISAPI applications are cached.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7315""></a>
  <div class="note">
   <strong class="user">mike at schild dot com</strong>
   <a href="#7315" class="date">01-Aug-2000 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's a hard way to get work php on win98/PWS... but with this comment-page I found it out how it works:&lt;br&gt;
<br />
- error 403: give read/write rights to the directory. You can do this by clicking the right mouse key on the directory in the explorer.&lt;br&gt;
<br />
- html file in a dos box: 1) clean the "doc_root" line in the php.ini file.&nbsp;&nbsp; 2) start personal web-manager / go to 'advanced' / make for your web-default-directory a virtual directory with all possible rights.&lt;br&gt;
<br />
On my system it works now!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
