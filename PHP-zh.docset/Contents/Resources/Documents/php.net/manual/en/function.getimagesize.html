<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>取得图像大小</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.gd-info.html">? gd_info</a></li>
      <li style="float: right;"><a href="function.getimagesizefromstring.html">getimagesizefromstring ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.image.html">GD 和图像处理 函数</a></li>
    <li>取得图像大小</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.getimagesize" class="refentry">
  <div class="refnamediv">
   <h1 class="refname">getimagesize</h1>
   <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">getimagesize</span> &mdash; <span class="dc-title">取得图像大小</span></p>

  </div>
  <div class="refsect1 description" id="refsect1-function.getimagesize-description">
   <h3 class="title">说明</h3>
   <div class="methodsynopsis dc-description">
    <span class="type">array</span> <span class="methodname"><strong>getimagesize</strong></span>
     ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
    [, <span class="methodparam"><span class="type">array</span> <code class="parameter reference">&$imageinfo</code></span>
   ] )</div>

   <p class="para rdfs-comment">
    <span class="function"><strong>getimagesize()</strong></span> 函数将测定任何
    <acronym title="Graphic Interchange Format">GIF</acronym>，<acronym>JPG</acronym>，<acronym title="Portable Network Graphics">PNG</acronym>，<acronym title="Shockwave Flash">SWF</acronym>，<acronym>SWC</acronym>，<acronym title="Photoshop Document">PSD</acronym>，<acronym title="Tagged Image File Format">TIFF</acronym>，<acronym title="Bitmap">BMP</acronym>，<acronym title="Interchange File Format">IFF</acronym>，<acronym title="JPEG-2000">JP2</acronym>，<acronym>JPX</acronym>，<acronym title="Joint Bilevel Image Experts Group">JB2</acronym>，<acronym title="Japan Picture">JPC</acronym>，<acronym title="X Bitmap">XBM</acronym>
    或 <acronym title="Wireless Bitmap">WBMP</acronym> 图像文件的大小并返回图像的尺寸以及文件类型和一个可以用于普通
    <acronym title="Hyper Text Markup Language">HTML</acronym> 文件中 <code class="tag">IMG</code> 标记中的
    height/width 文本字符串。
   </p>
   <p class="para">
    如果不能访问 <code class="parameter">filename</code>
    指定的图像或者其不是有效的图像，<span class="function"><strong>getimagesize()</strong></span>
    将返回 <strong><code>FALSE</code></strong> 并产生一条 <var class="varname"><var class="varname">E_WARNING</var></var> 级的错误。
   </p>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
     对 <acronym title="Japan Picture">JPC</acronym>，<acronym title="JPEG-2000">JP2</acronym>，<acronym>JPX</acronym>，<acronym title="Joint Bilevel Image Experts Group">JB2</acronym>，<acronym title="X Bitmap">XBM</acronym>
     和 <acronym title="Wireless Bitmap">WBMP</acronym> 的支持自 PHP 4.3.2
     起可用。对 <acronym>SWC</acronym> 的支持自 PHP 4.3.0 起可用。对
     <acronym title="Tagged Image File Format">TIFF</acronym> 的支持是 PHP 4.2.0 添加的。
    </p>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <span class="simpara">
     JPEG 2000 支持是 PHP 4.3.2 添加的。注意 JPC 和 JP2
     可以有不同的色彩深度的成分。此情况下，"bits"的值是碰到的最高的位深度。此外，JP2
     文件可能包含有多个 JPEG 2000 代码流，此情况下，<span class="function"><strong>getimagesize()</strong></span>
     返回此文件顶层中碰到的第一个代码流的值。
    </span>
   </p></blockquote>
   <blockquote class="note"><p><strong class="note">Note</strong>: 
    <span class="simpara">
     本函数不需要 GD 图像库。
    </span>
   </p></blockquote>
   <p class="para">
    返回一个具有四个单元的数组。索引 0 包含图像宽度的像素值，索引 1
    包含图像高度的像素值。索引 2 是图像类型的标记：1 = GIF，2 = JPG，3 =
    PNG，4 = SWF，5 = PSD，6 = BMP，7 = TIFF(intel byte order)，8 =
    TIFF(motorola byte order)，9 = JPC，10 = JP2，11 = JPX，12 =
    JB2，13 = SWC，14 = IFF，15 = WBMP，16 = XBM。这些标记与 PHP 4.3.0
    新加的 IMAGETYPE 常量对应。索引 3 是文本字符串，内容为"height=&quot;yyy&quot;
    width=&quot;xxx&quot;"，可直接用于 IMG 标记。
    <div class="example" id="example-3389">
     <p><strong>Example #1 getimagesize（文件）</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">list(</span><span style="color: #0000BB">$width</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$height</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$attr</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"img/flag.jpg"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;img&nbsp;src=\"img/flag.jpg\"&nbsp;</span><span style="color: #0000BB">$attr</span><span style="color: #DD0000">&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    URL 支持是 PHP 4.0.5 添加的。
    <div class="example" id="example-3390">
     <p><strong>Example #2 getimagesize（URL）</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.example.com/gifs/logo.gif"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;if&nbsp;the&nbsp;file&nbsp;name&nbsp;has&nbsp;space&nbsp;in&nbsp;it,&nbsp;encode&nbsp;it&nbsp;properly<br /></span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.example.com/gifs/lo%20go.gif"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    对于 <acronym>JPG</acronym> 图像，还会多返回两个索引：<em>channels</em>
    和 <em>bits</em>。<em>channels</em>
    对于 RGB 图像其值为 3，对于 CMYK 图像其值为 4。<em>bits</em>
    是每种颜色的位数。
   </p>
   <p class="para">
    自 PHP 4.3.0 起，<em>bits</em> 和
    <em>channels</em> 对于其它图像类型也存在。但是这些值可能会把人搞糊涂。例如，<acronym title="Graphic Interchange Format">GIF</acronym>
    总是对每个像素使用 3 个 channel，但是对于动画 <acronym title="Graphic Interchange Format">GIF</acronym>
    来说每个像素的位数无法通过全局颜色表计算出来。
   </p>
   <p class="para">
    某些格式可能不包含图像或者包含多个图像。此种情况下，<span class="function"><strong>getimagesize()</strong></span>
    可能不能用来准确测定图像的大小。此时 <span class="function"><strong>getimagesize()</strong></span>
    将返回零作为宽度和高度。
   </p>
   <p class="para">
    自 PHP 4.3.0 起，<span class="function"><strong>getimagesize()</strong></span> 还会返回额外的参数
    <em>mime</em>，符合该图像的 MIME 类型。此信息可以用来在
    HTTP Content-type 头信息中发送正确的信息：
    <div class="example" id="example-3391">
     <p><strong>Example #3 getimagesize() 和 MIME 类型</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$fp</span><span style="color: #007700">=</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"rb"</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">$fp</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-type:&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$size</span><span style="color: #007700">[</span><span style="color: #DD0000">'mime'</span><span style="color: #007700">]}</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">fpassthru</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br />&nbsp;&nbsp;exit;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;error<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    可选的 <code class="parameter">imageinfo</code>
    参数允许从图像文件中提取一些扩展信息。目前，这将以一个关联数组返回不同的
    <acronym>JPG</acronym> APP 标识。某些程序用这些 APP
    标识来在图像中嵌入文本信息。一个非常常见的是 APP13 标识中嵌入的
    <acronym>IPTC</acronym> <a href="http://www.iptc.org/" class="link external" title="Link : http://www.iptc.org/">&raquo;&nbsp;http://www.iptc.org/</a>
    信息。可以用 <span class="function"><a href="function.iptcparse.html" class="function">iptcparse()</a></span> 函数来将二进制的
    APP13 标识解析为可读的信息。
   </p>
   <p class="para">
    <div class="example" id="example-3392">
     <p><strong>Example #4 getimagesize() 返回 IPTC</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"testimg.jpg"</span><span style="color: #007700">,&nbsp;&amp;</span><span style="color: #0000BB">$info</span><span style="color: #007700">);<br />if&nbsp;(isset(</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"APP13"</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$iptc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">iptcparse</span><span style="color: #007700">(</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"APP13"</span><span style="color: #007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$iptc</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    参见 <span class="function"><a href="function.image-type-to-mime-type.html" class="function">image_type_to_mime_type()</a></span>，<span class="function"><a href="function.exif-imagetype.html" class="function">exif_imagetype()</a></span>，<span class="function"><a href="function.exif-read-data.html" class="function">exif_read_data()</a></span>
    和 <span class="function"><a href="function.exif-thumbnail.html" class="function">exif_thumbnail()</a></span>。
   </p>
  </div>

 
 <div class="refsect1 parameters" id="refsect1-function.getimagesize-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
        This parameter specifies the file you wish to retrieve information
        about. It can reference a local file or (configuration permitting) a
        remote file using one of the supported streams. 
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">imageinfo</code></dt>

     <dd>

      <p class="para">
       This optional parameter allows you to extract some extended
       information from the image file. Currently, this will return the
       different <acronym>JPG</acronym> APP markers as an associative array.
       Some programs use these APP markers to embed text information in 
       images. A very common one is to embed 
       <a href="http://www.iptc.org/" class="link external" title="Link : http://www.iptc.org/">&raquo;&nbsp;IPTC</a> information in the APP13 marker.
       You can use the <span class="function"><a href="function.iptcparse.html" class="function">iptcparse()</a></span> function to parse the
       binary APP13 marker into something readable.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.getimagesize-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an array with 7 elements.
  </p>
  <p class="para">
   Index 0 and 1 contains respectively the width and the height of the image.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    Some formats may contain no image or may contain multiple images. In these
    cases, <span class="function"><strong>getimagesize()</strong></span> might not be able to properly
    determine the image size. <span class="function"><strong>getimagesize()</strong></span> will return
    zero for width and height in these cases.
   </p>
  </p></blockquote>
  <p class="para">
   Index 2 is one of the <em>IMAGETYPE_XXX</em> constants indicating 
   the type of the image.
  </p>
  <p class="para">
   Index 3 is a text string with the correct 
   <em>height=&quot;yyy&quot; width=&quot;xxx&quot;</em> string that can be used
   directly in an <acronym>IMG</acronym> tag.
  </p>
  <p class="para">
   <em>mime</em> is the correspondant MIME type of the image.
   This information can be used to deliver images with the correct HTTP 
   <em>Content-type</em> header:
   <div class="example" id="example-3393">
    <p><strong>Example #5 <span class="function"><strong>getimagesize()</strong></span> and MIME types</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"rb"</span><span style="color: #007700">);<br />if&nbsp;(</span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">&amp;&amp;&nbsp;</span><span style="color: #0000BB">$fp</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-type:&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$size</span><span style="color: #007700">[</span><span style="color: #DD0000">'mime'</span><span style="color: #007700">]}</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fpassthru</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;error<br /></span><span style="color: #007700">}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <em>channels</em> will be 3 for RGB pictures and 4 for CMYK
   pictures.
  </p>
  <p class="para">
   <em>bits</em> is the number of bits for each color.
  </p>
  <p class="para">
   For some image types, the presence of <em>channels</em> and
   <em>bits</em> values can be a bit
   confusing. As an example, <acronym title="Graphic Interchange Format">GIF</acronym> always uses 3 channels
   per pixel, but the number of bits per pixel cannot be calculated for an
   animated <acronym title="Graphic Interchange Format">GIF</acronym> with a global color table.
  </p>
  <p class="para">
   On failure, <strong><code>FALSE</code></strong> is returned.
  </p>
 </div>

 
 <div class="refsect1 errors" id="refsect1-function.getimagesize-errors">
  <h3 class="title">错误／异常</h3>
  <p class="para">
   If accessing the <code class="parameter">filename</code> image is impossible, or
   if it isn&#039;t a valid picture, <span class="function"><strong>getimagesize()</strong></span> will
   generate an error of level <strong><code>E_WARNING</code></strong>. On read error,
   <span class="function"><strong>getimagesize()</strong></span> will generate an error of level
   <strong><code>E_NOTICE</code></strong>.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.getimagesize-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.3.0</td>
       <td>
        Added icon support.
       </td>
      </tr>

      <tr>
       <td>5.2.3</td>
       <td>
        Read errors generated by this function downgraded to
        <strong><code>E_NOTICE</code></strong> from <strong><code>E_WARNING</code></strong>.
       </td>
      </tr>

      <tr>
       <td>4.3.2</td>
       <td>
        Support for <acronym title="Japan Picture">JPC</acronym>, <acronym title="JPEG-2000">JP2</acronym>,
        <acronym>JPX</acronym>, <acronym title="Joint Bilevel Image Experts Group">JB2</acronym>, 
        <acronym title="X Bitmap">XBM</acronym>, and <acronym title="Wireless Bitmap">WBMP</acronym> became available.
       </td>
      </tr>

      <tr>
       <td>4.3.2</td>
       <td>
        JPEG 2000 support was added for the <code class="parameter">imageinfo</code>
        parameter.
       </td>
      </tr>

      <tr>
       <td>4.3.0</td>
       <td>
        <em>bits</em> and <em>channels</em> are present
        for other image types, too.
       </td>
      </tr>

      <tr>
       <td>4.3.0</td>
       <td>
        <em>mime</em> was added.
       </td>
      </tr>

      <tr>
       <td>4.3.0</td>
       <td>
        Support for <acronym>SWC</acronym> and <acronym title="Interchange File Format">IFF</acronym> was
        added.
       </td>
      </tr>

      <tr>
       <td>4.2.0</td>
       <td>
        Support for <acronym title="Tagged Image File Format">TIFF</acronym> was added.
       </td>
      </tr>

      <tr>
       <td>4.0.6</td>
       <td>
        Support for <acronym title="Bitmap">BMP</acronym> and <acronym title="Photoshop Document">PSD</acronym> was
        added.
       </td>
      </tr>

      <tr>
       <td>4.0.5</td>
       <td>
        URL support was added.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.getimagesize-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-3394">
    <p><strong>Example #6 <span class="function"><strong>getimagesize()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">list(</span><span style="color: #0000BB">$width</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$height</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$type</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$attr</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"img/flag.jpg"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"&lt;img&nbsp;src=\"img/flag.jpg\"&nbsp;</span><span style="color: #0000BB">$attr</span><span style="color: #DD0000">&nbsp;alt=\"getimagesize()&nbsp;example\"&nbsp;/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-3395">
    <p><strong>Example #7 getimagesize (URL)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.example.com/gifs/logo.gif"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;if&nbsp;the&nbsp;file&nbsp;name&nbsp;has&nbsp;space&nbsp;in&nbsp;it,&nbsp;encode&nbsp;it&nbsp;properly<br /></span><span style="color: #0000BB">$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"http://www.example.com/gifs/lo%20go.gif"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
   <div class="example" id="example-3396">
    <p><strong>Example #8 getimagesize() returning IPTC</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$size&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getimagesize</span><span style="color: #007700">(</span><span style="color: #DD0000">"testimg.jpg"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$info</span><span style="color: #007700">);<br />if&nbsp;(isset(</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"APP13"</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$iptc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">iptcparse</span><span style="color: #007700">(</span><span style="color: #0000BB">$info</span><span style="color: #007700">[</span><span style="color: #DD0000">"APP13"</span><span style="color: #007700">]);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$iptc</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 notes" id="refsect1-function.getimagesize-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <p class="para">此函数不需要 GD 图象库。</p></p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.getimagesize-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.image-type-to-mime-type.html" class="function" rel="rdfs-seeAlso">image_type_to_mime_type()</a> - 取得 getimagesize，exif_read_data，exif_thumbnail，exif_imagetype
    所返回的图像类型的 MIME 类型</span></li>
    <li class="member"><span class="function"><a href="function.exif-imagetype.html" class="function" rel="rdfs-seeAlso">exif_imagetype()</a> - 判断一个图像的类型</span></li>
    <li class="member"><span class="function"><a href="function.exif-read-data.html" class="function" rel="rdfs-seeAlso">exif_read_data()</a> - 从 JPEG 或 TIFF
   文件中读取 EXIF 头信息</span></li>
    <li class="member"><span class="function"><a href="function.exif-thumbnail.html" class="function" rel="rdfs-seeAlso">exif_thumbnail()</a> - 取得嵌入在 TIFF 或 JPEG 图像中的缩略图</span></li>
   </ul>
  </p>
 </div>

 </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116976""></a>
  <div class="note">
   <strong class="user">simon dot waters at surevine dot com</strong>
   <a href="#116976" class="date">30-Mar-2015 06:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: getimage size doesn't attempt to validate image file formats<br />
<br />
It is possible for malformed GIF images to contain PHP and still have valid dimensions.<br />
<br />
Programmers need to ensure such images are validated by other tools, or never treated as PHP or other executable types (enforcing appropriate extensions, avoiding user controlled renaming, restricting uploaded images to areas of the website where PHP is not enabled).<br />
<br />
<a href="http://ha.ckers.org/blog/20070604/passing-malicious-php-through-getimagesize/" rel="nofollow" target="_blank">http://ha.ckers.org/blog/20070604/passing-malicious-php-through-getimagesize/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114601""></a>
  <div class="note">
   <strong class="user">kazuya</strong>
   <a href="#114601" class="date">11-Mar-2014 11:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i made function img_resize($path,$tmp_name,$new_name,$new_width)<br />
this could be useful.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$new_file </span><span class="keyword">= </span><span class="default">img_resize</span><span class="keyword">(</span><span class="string">"./img/"</span><span class="keyword">, </span><span class="string">"test.jpg"</span><span class="keyword">,</span><span class="string">"copy_test.jpg"</span><span class="keyword">,</span><span class="default">300</span><span class="keyword">);<br />
echo </span><span class="string">"&lt;IMG src = '</span><span class="default">$new_file</span><span class="string">'&gt;"</span><span class="keyword">;<br />
<br />
function </span><span class="default">img_resize</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">$tmp_name</span><span class="keyword">,</span><span class="default">$new_name</span><span class="keyword">,</span><span class="default">$new_width</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"file not found!"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_writable</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"error:permission denied!"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$tmp_name</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$new_height </span><span class="keyword">= </span><span class="default">abs</span><span class="keyword">(</span><span class="default">$new_width </span><span class="keyword">* </span><span class="default">$height </span><span class="keyword">/ </span><span class="default">$width</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image_p </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$new_width</span><span class="keyword">, </span><span class="default">$new_height</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$path </span><span class="keyword">. </span><span class="default">$tmp_name</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$image_p</span><span class="keyword">, </span><span class="default">$image</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_width</span><span class="keyword">, </span><span class="default">$new_height</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$image_p</span><span class="keyword">, </span><span class="default">$path </span><span class="keyword">. </span><span class="default">$new_name</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$path</span><span class="keyword">.</span><span class="default">$new_name</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113158""></a>
  <div class="note">
   <strong class="user">tomasz at trejderowski dot pl</strong>
   <a href="#113158" class="date">06-Sep-2013 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to "convert" value returned by "getimagesize()" as index "2" into something more human-readable, you may consider using a function like this one:<br />
<br />
&nbsp;&nbsp;&nbsp; $imageTypeArray = array<br />
&nbsp;&nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 0=&gt;'UNKNOWN',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 1=&gt;'GIF',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 2=&gt;'JPEG',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 3=&gt;'PNG',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 4=&gt;'SWF',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 5=&gt;'PSD',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 6=&gt;'BMP',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 7=&gt;'TIFF_II',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 8=&gt;'TIFF_MM',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 9=&gt;'JPC',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 10=&gt;'JP2',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 11=&gt;'JPX',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 12=&gt;'JB2',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 13=&gt;'SWC',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 14=&gt;'IFF',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 15=&gt;'WBMP',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 16=&gt;'XBM',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 17=&gt;'ICO',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 18=&gt;'COUNT'&nbsp; <br />
&nbsp;&nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $size = getimagesize($filename);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $size[2] = $imageTypeArray[$size[2]];<br />
<br />
Or something similar.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112002""></a>
  <div class="note">
   <strong class="user">eng dot honey007 at gmail dot com</strong>
   <a href="#112002" class="date">21-Apr-2013 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function Get_Image_size($img,$req){<br />
&nbsp; $get&nbsp; &nbsp; = getimagesize($img);<br />
&nbsp; $width&nbsp; = $get[0];<br />
&nbsp; $height = $get[1];<br />
&nbsp; $type&nbsp;&nbsp; = $get[2];<br />
&nbsp; $attr&nbsp;&nbsp; = $get[3];<br />
&nbsp; $bits&nbsp;&nbsp; = $get['bits'];<br />
&nbsp; $mime&nbsp;&nbsp; = $get['mime'];<br />
&nbsp; return $$req;<br />
}<br />
echo Get_Image_size('5.png','attr');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109063""></a>
  <div class="note">
   <strong class="user">chris at ocportal dot com</strong>
   <a href="#109063" class="date">18-Jun-2012 07:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that animated gifs may have frames width different dimensions. This function will not get the first frame's width/height. GIFs define "Logical Screen Descriptor" dimensions, which are the maximum for all frames.
<br />

<br />
To get the screen descriptor dimensions, use:
<br />

<br />
<span class="default">&lt;?php
<br />
$header </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'@6/vwidth/vheight'</span><span class="keyword">, </span><span class="default">$binaryData</span><span class="keyword">);
<br />
</span><span class="comment">// $header['width'] and $header['width'];
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107537""></a>
  <div class="note">
   <strong class="user">alexyam at live dot com</strong>
   <a href="#107537" class="date">16-Feb-2012 08:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wanted to use getimagesize() on .SWF files stored in the database as blob data and couldn't find a simple solution, so I created my own.<br />
<br />
I am releasing this code under the MIT license to save everyone some time:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; PHP Blob Data As File Stream v1.0 (C) 2012 Alex Yam &lt;alexyam@live.com&gt;<br />
&nbsp;&nbsp;&nbsp; This code is released under the MIT License.<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; [Summary]<br />
<br />
&nbsp;&nbsp;&nbsp; A simple class for PHP functions to read and write blob data as a file<br />
&nbsp;&nbsp;&nbsp; using a stream wrapper.<br />
<br />
&nbsp;&nbsp;&nbsp; Particularly useful for running getimagesize() to get the width and<br />
&nbsp;&nbsp;&nbsp; height of .SWF Flash files that are stored in the database as blob data.<br />
<br />
&nbsp;&nbsp;&nbsp; Tested on PHP 5.3.10.<br />
<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; [Usage Example]<br />
<br />
&nbsp;&nbsp;&nbsp; //Include<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; include('./blob_data_as_file_stream.php');<br />
<br />
&nbsp;&nbsp;&nbsp; //Register the stream wrapper<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; stream_wrapper_register("BlobDataAsFileStream", "blob_data_as_file_stream");<br />
<br />
&nbsp;&nbsp;&nbsp; //Fetch a .SWF file from the Adobe website and store it into a variable.<br />
&nbsp;&nbsp;&nbsp; //Replace this with your own fetch-swf-blob-data-from-database code.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $swf_url = '<a href="http://www.adobe.com/swf/software/flash/about/flashAbout_info_small.swf" rel="nofollow" target="_blank">http://www.adobe.com/swf/software/flash/about/flashAbout_info_small.swf</a>';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $swf_blob_data = file_get_contents($swf_url);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //Store $swf_blob_data to the data stream<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; blob_data_as_file_stream::$blob_data_stream = $swf_blob_data;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //Run getimagesize() on the data stream<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $swf_info = getimagesize('BlobDataAsFileStream://');<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; var_dump($swf_info);<br />
<br />
&nbsp;&nbsp;&nbsp; ----------------------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp; [Usage Output]<br />
<br />
&nbsp;&nbsp;&nbsp; array(5) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; [0]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; int(159)<br />
&nbsp;&nbsp; &nbsp;&nbsp; [1]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; int(91)<br />
&nbsp;&nbsp; &nbsp;&nbsp; [2]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; int(13)<br />
&nbsp;&nbsp; &nbsp;&nbsp; [3]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; string(23) "width="159" height="91""<br />
&nbsp;&nbsp; &nbsp;&nbsp; ["mime"]=&gt;<br />
&nbsp;&nbsp; &nbsp;&nbsp; string(29) "application/x-shockwave-flash"<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
*/<br />
<br />
</span><span class="keyword">class </span><span class="default">blob_data_as_file_stream </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; private static </span><span class="default">$blob_data_position </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; public static </span><span class="default">$blob_data_stream </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_open</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">,</span><span class="default">$mode</span><span class="keyword">,</span><span class="default">$options</span><span class="keyword">,&amp;</span><span class="default">$opened_path</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_position </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_seek</span><span class="keyword">(</span><span class="default">$seek_offset</span><span class="keyword">,</span><span class="default">$seek_whence</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$blob_data_length </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$seek_whence</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">SEEK_SET</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_blob_data_position </span><span class="keyword">= </span><span class="default">$seek_offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">SEEK_CUR</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_blob_data_position </span><span class="keyword">= static::</span><span class="default">$blob_data_position</span><span class="keyword">+</span><span class="default">$seek_offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">SEEK_END</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_blob_data_position </span><span class="keyword">= </span><span class="default">$blob_data_length</span><span class="keyword">+</span><span class="default">$seek_offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$new_blob_data_position </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">) AND (</span><span class="default">$new_blob_data_position </span><span class="keyword">&lt;= </span><span class="default">$blob_data_length</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_position </span><span class="keyword">= </span><span class="default">$new_blob_data_position</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_tell</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return static::</span><span class="default">$blob_data_position</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_read</span><span class="keyword">(</span><span class="default">$read_buffer_size</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$read_data </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">,static::</span><span class="default">$blob_data_position</span><span class="keyword">,</span><span class="default">$read_buffer_size</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_position </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$read_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$read_data</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_write</span><span class="keyword">(</span><span class="default">$write_data</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$write_data_length</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$write_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; static::</span><span class="default">$blob_data_stream </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,static::</span><span class="default">$blob_data_position</span><span class="keyword">).<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$write_data</span><span class="keyword">.</span><span class="default">substr</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">,static::</span><span class="default">$blob_data_position</span><span class="keyword">+=</span><span class="default">$write_data_length</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$write_data_length</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">stream_eof</span><span class="keyword">(){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return static::</span><span class="default">$blob_data_position </span><span class="keyword">&gt;= </span><span class="default">strlen</span><span class="keyword">(static::</span><span class="default">$blob_data_stream</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105033""></a>
  <div class="note">
   <strong class="user">utilmind</strong>
   <a href="#105033" class="date">23-Jul-2011 12:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is the function which determines whether the PNG image contains alpha or not:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">is_alpha_png</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">){
<br />
&nbsp; return (</span><span class="default">ord</span><span class="keyword">(@</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)) == </span><span class="default">6</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The color type of PNG image is stored at byte offset 25. Possible values of that 25'th byte is:
<br />
&nbsp;* 0 - greyscale
<br />
&nbsp;* 2 - RGB
<br />
&nbsp;* 3 - RGB with palette
<br />
&nbsp;* 4 - greyscale + alpha
<br />
&nbsp;* 6 - RGB + alpha</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103516""></a>
  <div class="note">
   <strong class="user">Steve</strong>
   <a href="#103516" class="date">18-Apr-2011 12:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The list of defined IMAGETYPE_ constants is on the manual page for exif_imagetype:<br />
<br />
<a href="http://www.php.net/manual/en/function.exif-imagetype.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/function.exif-imagetype.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103301""></a>
  <div class="note">
   <strong class="user">msfs11 at gmail dot com</strong>
   <a href="#103301" class="date">06-Apr-2011 01:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One more reason of "Error: getimagesize(): Read error!" may be an zero file size. Check the file size first with function filesize( $file ).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102902""></a>
  <div class="note">
   <strong class="user">kumarldh at gmail dot com</strong>
   <a href="#102902" class="date">14-Mar-2011 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I spent quite a time and realised one needs "allow_url_fopen" turned on to be able to use getimagesize(). Hope this help others.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102418""></a>
  <div class="note">
   <strong class="user">Jesus Zamora</strong>
   <a href="#102418" class="date">13-Feb-2011 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Returns a array with 4 elements.<br />
The 0 index is the width of the image in pixels.<br />
The 1 index is the height of the image in pixels.<br />
The 2 index is a flag for the image type:<br />
<br />
1 = GIF, 2 = JPG, 3 = PNG, 4 = SWF, 5 = PSD, 6 = BMP, 7 = TIFF(orden de bytes intel), 8 = TIFF(orden de bytes motorola), 9 = JPC, 10 = JP2, 11 = JPX, 12 = JB2, 13 = SWC, 14 = IFF, 15 = WBMP, 16 = XBM. <br />
<br />
The 3 index contains ' height="yyy" width="xxx" '</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102353""></a>
  <div class="note">
   <strong class="user">falkon303 at gmail dot com</strong>
   <a href="#102353" class="date">10-Feb-2011 07:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple way to resize your images based on a percentage.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$image_path </span><span class="keyword">= </span><span class="string">"images/your_image.png"</span><span class="keyword">;<br />
<br />
list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">)= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$image_path</span><span class="keyword">); <br />
<br />
</span><span class="comment">//specify what percentage you are resizing to<br />
</span><span class="default">$percent_resizing </span><span class="keyword">= </span><span class="default">80</span><span class="keyword">;<br />
<br />
</span><span class="default">$new_width </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(((</span><span class="default">$percent_resizing</span><span class="keyword">/</span><span class="default">100</span><span class="keyword">)*</span><span class="default">$width</span><span class="keyword">));<br />
</span><span class="default">$new_height </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(((</span><span class="default">$percent_resizing</span><span class="keyword">/</span><span class="default">100</span><span class="keyword">)*</span><span class="default">$height</span><span class="keyword">));<br />
<br />
echo </span><span class="string">'&lt;img src="'</span><span class="keyword">.</span><span class="default">$image_path</span><span class="keyword">.</span><span class="string">'" height="'</span><span class="keyword">.</span><span class="default">$new_height</span><span class="keyword">.</span><span class="string">'" width="'</span><span class="keyword">.</span><span class="default">$new_width</span><span class="keyword">.</span><span class="string">'"&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102326""></a>
  <div class="note">
   <strong class="user">Urchin</strong>
   <a href="#102326" class="date">08-Feb-2011 10:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On a Debian machine I had a lot of Notices in my log because the system did not understand spaces. While the str_replace and rawurlencode options are ok for remote images, for the local system it is of no use.<br />
<br />
I used the following:<br />
<br />
getimagesize('"'.$location.'"');<br />
<br />
so basically I quoted the location (single_quot-dubble_quote-single_quote).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97564""></a>
  <div class="note">
   <strong class="user">modnyj at gmail dot com</strong>
   <a href="#97564" class="date">26-Apr-2010 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple method to resize a image keeping the constraint proportions:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Constraints
<br />
</span><span class="default">$max_width </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;
<br />
</span><span class="default">$max_height </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;
<br />
list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$img_path</span><span class="keyword">);
<br />
</span><span class="default">$ratioh </span><span class="keyword">= </span><span class="default">$max_height</span><span class="keyword">/</span><span class="default">$height</span><span class="keyword">;
<br />
</span><span class="default">$ratiow </span><span class="keyword">= </span><span class="default">$max_width</span><span class="keyword">/</span><span class="default">$width</span><span class="keyword">;
<br />
</span><span class="default">$ratio </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">(</span><span class="default">$ratioh</span><span class="keyword">, </span><span class="default">$ratiow</span><span class="keyword">);
<br />
</span><span class="comment">// New dimensions
<br />
</span><span class="default">$width </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$ratio</span><span class="keyword">*</span><span class="default">$width</span><span class="keyword">);
<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$ratio</span><span class="keyword">*</span><span class="default">$height</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96284""></a>
  <div class="note">
   <strong class="user">@hill79</strong>
   <a href="#96284" class="date">18-Feb-2010 04:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed to find image dimensions for use in some dynamic css, since getimagesize() returns width="x" height="y" at index 3 I had to convert that to a valid CSS format.
<br />

<br />
Thought I'd share the function in case anyone else needs the same.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">cssifysize</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) {
<br />
</span><span class="default">$dimensions </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
</span><span class="default">$dimensions </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"=\""</span><span class="keyword">, </span><span class="string">":"</span><span class="keyword">, </span><span class="default">$dimensions</span><span class="keyword">[</span><span class="string">'3'</span><span class="keyword">]);
<br />
</span><span class="default">$dimensions </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\""</span><span class="keyword">, </span><span class="string">"px;"</span><span class="keyword">, </span><span class="default">$dimensions</span><span class="keyword">);
<br />
return </span><span class="default">$dimensions</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">returns width</span><span class="keyword">:</span><span class="default">x</span><span class="keyword">;</span><span class="default">height</span><span class="keyword">:</span><span class="default">y</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
I expect there's a way of making that more efficient</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95876""></a>
  <div class="note">
   <strong class="user">Nikki</strong>
   <a href="#95876" class="date">27-Jan-2010 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This should be easy, but I've re-solved the problem so many times.&nbsp; Hopefully this is useful:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// Usage example to find the proper dimensions to resize an image down to 300x400 pixels maximum:
<br />
</span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);
<br />
</span><span class="default">$new_dimensions </span><span class="keyword">= </span><span class="default">resize_dimensions</span><span class="keyword">(</span><span class="default">300</span><span class="keyword">,</span><span class="default">400</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// Calculates restricted dimensions with a maximum of $goal_width by $goal_height
<br />
</span><span class="keyword">function </span><span class="default">resize_dimensions</span><span class="keyword">(</span><span class="default">$goal_width</span><span class="keyword">,</span><span class="default">$goal_height</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= array(</span><span class="string">'width' </span><span class="keyword">=&gt; </span><span class="default">$width</span><span class="keyword">, </span><span class="string">'height' </span><span class="keyword">=&gt; </span><span class="default">$height</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// If the ratio &gt; goal ratio and the width &gt; goal width resize down to goal width
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$width</span><span class="keyword">/</span><span class="default">$height </span><span class="keyword">&gt; </span><span class="default">$goal_width</span><span class="keyword">/</span><span class="default">$goal_height </span><span class="keyword">&amp;&amp; </span><span class="default">$width </span><span class="keyword">&gt; </span><span class="default">$goal_width</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'width'</span><span class="keyword">] = </span><span class="default">$goal_width</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'height'</span><span class="keyword">] = </span><span class="default">$goal_width</span><span class="keyword">/</span><span class="default">$width </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Otherwise, if the height &gt; goal, resize down to goal height
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">else if (</span><span class="default">$height </span><span class="keyword">&gt; </span><span class="default">$goal_height</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'width'</span><span class="keyword">] = </span><span class="default">$goal_height</span><span class="keyword">/</span><span class="default">$height </span><span class="keyword">* </span><span class="default">$width</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'height'</span><span class="keyword">] = </span><span class="default">$goal_height</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94933""></a>
  <div class="note">
   <strong class="user">swapnil dot nkene at gmail dot com</strong>
   <a href="#94933" class="date">03-Dec-2009 11:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simplest method to resize a image keeping the constraint proportions.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">)=</span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$imagepath</span><span class="keyword">);
<br />
</span><span class="default">$ht</span><span class="keyword">=</span><span class="default">$height</span><span class="keyword">;
<br />
</span><span class="default">$wd</span><span class="keyword">=</span><span class="default">$width</span><span class="keyword">;
<br />
if(</span><span class="default">$width</span><span class="keyword">&gt;</span><span class="default">180</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">$width</span><span class="keyword">-</span><span class="default">180</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$percnt_reduced </span><span class="keyword">= ((</span><span class="default">$diff</span><span class="keyword">/</span><span class="default">$width</span><span class="keyword">)*</span><span class="default">100</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ht </span><span class="keyword">= </span><span class="default">$height</span><span class="keyword">-((</span><span class="default">$percnt_reduced</span><span class="keyword">*</span><span class="default">$height</span><span class="keyword">)/</span><span class="default">100</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wd</span><span class="keyword">= </span><span class="default">$width</span><span class="keyword">-</span><span class="default">$diff</span><span class="keyword">;
<br />
}
<br />
if(</span><span class="default">$height</span><span class="keyword">&gt;</span><span class="default">180</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$diff </span><span class="keyword">= </span><span class="default">$height</span><span class="keyword">-</span><span class="default">180</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$percnt_reduced </span><span class="keyword">= ((</span><span class="default">$diff</span><span class="keyword">/</span><span class="default">$height</span><span class="keyword">)*</span><span class="default">100</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wd </span><span class="keyword">= </span><span class="default">$width</span><span class="keyword">-((</span><span class="default">$percnt_reduced</span><span class="keyword">*</span><span class="default">$width</span><span class="keyword">)/</span><span class="default">100</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ht</span><span class="keyword">= </span><span class="default">$height</span><span class="keyword">-</span><span class="default">$diff</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94178""></a>
  <div class="note">
   <strong class="user">geoff at spacevs dot com</strong>
   <a href="#94178" class="date">21-Oct-2009 08:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function returns the width and height of a JPEG image from a string, allowing the dimensions of images stored in a database to be retrieved without writing them to the disk first, or using "imagecreatefromstring" which is very slow in comparison.<br />
<br />
<span class="default">&lt;?PHP<br />
</span><span class="keyword">function </span><span class="default">getJPEGImageXY</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$soi </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nmagic/nmarker'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$soi</span><span class="keyword">[</span><span class="string">'magic'</span><span class="keyword">] != </span><span class="default">0xFFD8</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$marker </span><span class="keyword">= </span><span class="default">$soi</span><span class="keyword">[</span><span class="string">'marker'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$done&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch(</span><span class="default">$marker</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">0xFFC0</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nlength/Cprecision/nY/nX'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return array(</span><span class="default">$info</span><span class="keyword">[</span><span class="string">'X'</span><span class="keyword">], </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'Y'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nlength'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'length'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">'nmarker'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$marker </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'marker'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Doing this 10,000 times takes 0.43 seconds, compared with using imagecreatefromstring/imagesx/imagesy which takes around 1.52 seconds to do the same.<br />
<br />
Do not use this instead of getimagesize when dealing with files, getimagesize is much faster coming in at 0.15 seconds.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92451""></a>
  <div class="note">
   <strong class="user">mycrazydream</strong>
   <a href="#92451" class="date">24-Jul-2009 06:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had for quite some time been using getimagesize() to check for the existence of a remote image. This turned out to take way too long. The following curl solution only checks the http headers so it is much more efficient.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">checkRemoteFile</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ch </span><span class="keyword">= </span><span class="default">curl_init</span><span class="keyword">(); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_URL</span><span class="keyword">,</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// don't download content<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_NOBODY</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_FAILONERROR</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">curl_setopt</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">CURLOPT_RETURNTRANSFER</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); <br />
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">curl_exec</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">)!==</span><span class="default">FALSE</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92248""></a>
  <div class="note">
   <strong class="user">anonymous</strong>
   <a href="#92248" class="date">15-Jul-2009 10:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Well there are a lot of image scaling functions here. Here is my take on it.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">get_scaled_dim_array</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$max_w </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">, </span><span class="default">$max_h </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$max_h</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$max_h </span><span class="keyword">= </span><span class="default">$max_w</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$img_w</span><span class="keyword">,</span><span class="default">$img_h</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">(</span><span class="default">$max_w</span><span class="keyword">/</span><span class="default">$img_w</span><span class="keyword">, </span><span class="default">$max_h</span><span class="keyword">/</span><span class="default">$img_h</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$f </span><span class="keyword">* </span><span class="default">$img_w</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$h </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$f </span><span class="keyword">* </span><span class="default">$img_h</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return array(</span><span class="default">$w</span><span class="keyword">,</span><span class="default">$h</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">NULL</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88793""></a>
  <div class="note">
   <strong class="user">james dot relyea at zifiniti dot com</strong>
   <a href="#88793" class="date">08-Feb-2009 05:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As noted below, getimagesize will download the entire image before it checks for the requested information. This is extremely slow on large images that are accessed remotely. Since the width/height is in the first few bytes of the file, there is no need to download the entire file. I wrote a function to get the size of a JPEG by streaming bytes until the proper data is found to report the width and height:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Retrieve JPEG width and height without downloading/reading entire image.<br />
</span><span class="keyword">function </span><span class="default">getjpegsize</span><span class="keyword">(</span><span class="default">$img_loc</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$img_loc</span><span class="keyword">, </span><span class="string">"rb"</span><span class="keyword">) or die(</span><span class="string">"Invalid file stream."</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$new_block </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_block </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]==</span><span class="string">"\xFF" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]==</span><span class="string">"\xD8" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">]==</span><span class="string">"\xFF" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">]==</span><span class="string">"\xE0"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">]==</span><span class="string">"\x4A" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">]==</span><span class="string">"\x46" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">4</span><span class="keyword">]==</span><span class="string">"\x49" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">5</span><span class="keyword">]==</span><span class="string">"\x46" </span><span class="keyword">&amp;&amp; </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">6</span><span class="keyword">]==</span><span class="string">"\x00"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Read block size and skip ahead to begin cycling through blocks in search of SOF marker<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"H*"</span><span class="keyword">, </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$block_size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">$block_size</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_block </span><span class="keyword">.= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="default">$block_size</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]==</span><span class="string">"\xFF"</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// New block detected, check for SOF marker<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sof_marker </span><span class="keyword">= array(</span><span class="string">"\xC0"</span><span class="keyword">, </span><span class="string">"\xC1"</span><span class="keyword">, </span><span class="string">"\xC2"</span><span class="keyword">, </span><span class="string">"\xC3"</span><span class="keyword">, </span><span class="string">"\xC5"</span><span class="keyword">, </span><span class="string">"\xC6"</span><span class="keyword">, </span><span class="string">"\xC7"</span><span class="keyword">, </span><span class="string">"\xC8"</span><span class="keyword">, </span><span class="string">"\xC9"</span><span class="keyword">, </span><span class="string">"\xCA"</span><span class="keyword">, </span><span class="string">"\xCB"</span><span class="keyword">, </span><span class="string">"\xCD"</span><span class="keyword">, </span><span class="string">"\xCE"</span><span class="keyword">, </span><span class="string">"\xCF"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">], </span><span class="default">$sof_marker</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// SOF marker detected. Width and height information is contained in bytes 4-7 after this byte.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$size_data </span><span class="keyword">= </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">3</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">4</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">5</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">6</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">7</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">8</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$unpacked </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"H*"</span><span class="keyword">, </span><span class="default">$size_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$unpacked </span><span class="keyword">= </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">6</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">10</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">11</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">12</span><span class="keyword">] . </span><span class="default">$unpacked</span><span class="keyword">[</span><span class="default">13</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return array(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Skip block marker and read block size<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">+= </span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">unpack</span><span class="keyword">(</span><span class="string">"H*"</span><span class="keyword">, </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] . </span><span class="default">$new_block</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_size </span><span class="keyword">= </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$block_size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87188""></a>
  <div class="note">
   <strong class="user">anonymous</strong>
   <a href="#87188" class="date">23-Nov-2008 05:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that if you specify a remote file (via a URL) to check the size of, PHP will first download the remote file to your server.<br />
<br />
If you're using this function to check the size of user provided image links, this could constitute a security risk.&nbsp; A malicious user could potentially link to a very large image file and cause PHP to download it.&nbsp; I do not know what, if any, file size limits are in place for the download.&nbsp; But suppose the user provided a link to an image that was several gigabytes in size?<br />
<br />
It would be nice if there were a way to limit the size of the download performed by this function.&nbsp; Hopefully there is already a default with some sensible limits.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84649""></a>
  <div class="note">
   <strong class="user">user at example dot net</strong>
   <a href="#84649" class="date">23-Jul-2008 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When validating images, allways check both, image type *AND* file extension!<br />
<br />
Because most image types allow sections for comments or other irrelevant data. Those section can be used to infiltrate php code onto the server. If these files are stored as sent by the client, files with a ".php" extension can be executed and do tremendous harm.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82798""></a>
  <div class="note">
   <strong class="user">mike</strong>
   <a href="#82798" class="date">26-Apr-2008 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Great script shmohel, a bit more minified...<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">scale_image</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">,</span><span class="default">$mw</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">,</span><span class="default">$mh</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">) { </span><span class="comment">// path max_width max_height<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(list(</span><span class="default">$w</span><span class="keyword">,</span><span class="default">$h</span><span class="keyword">) = @</span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$p</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; foreach(array(</span><span class="string">'w'</span><span class="keyword">,</span><span class="string">'h'</span><span class="keyword">) as </span><span class="default">$v</span><span class="keyword">) { </span><span class="default">$m </span><span class="keyword">= </span><span class="string">"m</span><span class="keyword">{</span><span class="default">$v</span><span class="keyword">}</span><span class="string">"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(${</span><span class="default">$v</span><span class="keyword">} &gt; ${</span><span class="default">$m</span><span class="keyword">} &amp;&amp; ${</span><span class="default">$m</span><span class="keyword">}) { </span><span class="default">$o </span><span class="keyword">= (</span><span class="default">$v </span><span class="keyword">== </span><span class="string">'w'</span><span class="keyword">) ? </span><span class="string">'h' </span><span class="keyword">: </span><span class="string">'w'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= ${</span><span class="default">$m</span><span class="keyword">} / ${</span><span class="default">$v</span><span class="keyword">}; ${</span><span class="default">$v</span><span class="keyword">} = ${</span><span class="default">$m</span><span class="keyword">}; ${</span><span class="default">$o</span><span class="keyword">} = </span><span class="default">ceil</span><span class="keyword">(${</span><span class="default">$o</span><span class="keyword">} * </span><span class="default">$r</span><span class="keyword">); } }<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="string">"&lt;img src='</span><span class="keyword">{</span><span class="default">$p</span><span class="keyword">}</span><span class="string">' alt='image' width='</span><span class="keyword">{</span><span class="default">$w</span><span class="keyword">}</span><span class="string">' height='</span><span class="keyword">{</span><span class="default">$h</span><span class="keyword">}</span><span class="string">' /&gt;"</span><span class="keyword">); }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82343""></a>
  <div class="note">
   <strong class="user">devon at example dot com</strong>
   <a href="#82343" class="date">07-Apr-2008 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
***********************************<br />
Copies Source Image to Destination Image <br />
***********************************<br />
1. Copies source image<br />
2. Calculates image dimensions<br />
3. Resizes image (you specify max height/width)<br />
4. Retains aspect ratio<br />
5. Writes destination image<br />
***********************************<br />
This was created from a variety of code snippets <br />
I've found here at php.net and other places on the web.&nbsp; <br />
I take no credit for any of this code other than <br />
putting the pieces together. <br />
<br />
<span class="default">&lt;?php<br />
<br />
$source_pic </span><span class="keyword">= </span><span class="string">'images/source.jpg'</span><span class="keyword">;<br />
</span><span class="default">$destination_pic </span><span class="keyword">= </span><span class="string">'images/destination.jpg'</span><span class="keyword">;<br />
</span><span class="default">$max_width </span><span class="keyword">= </span><span class="default">500</span><span class="keyword">;<br />
</span><span class="default">$max_height </span><span class="keyword">= </span><span class="default">500</span><span class="keyword">;<br />
<br />
</span><span class="default">$src </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$source_pic</span><span class="keyword">);<br />
list(</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">)=</span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$source_pic</span><span class="keyword">);<br />
<br />
</span><span class="default">$x_ratio </span><span class="keyword">= </span><span class="default">$max_width </span><span class="keyword">/ </span><span class="default">$width</span><span class="keyword">;<br />
</span><span class="default">$y_ratio </span><span class="keyword">= </span><span class="default">$max_height </span><span class="keyword">/ </span><span class="default">$height</span><span class="keyword">;<br />
<br />
if( (</span><span class="default">$width </span><span class="keyword">&lt;= </span><span class="default">$max_width</span><span class="keyword">) &amp;&amp; (</span><span class="default">$height </span><span class="keyword">&lt;= </span><span class="default">$max_height</span><span class="keyword">) ){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">$height</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }elseif ((</span><span class="default">$x_ratio </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">) &lt; </span><span class="default">$max_height</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$x_ratio </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">$max_width</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$y_ratio </span><span class="keyword">* </span><span class="default">$width</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">$max_height</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$tmp</span><span class="keyword">=</span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$tn_width</span><span class="keyword">,</span><span class="default">$tn_height</span><span class="keyword">);<br />
</span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">,</span><span class="default">$src</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$tn_width</span><span class="keyword">, </span><span class="default">$tn_height</span><span class="keyword">,</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);<br />
<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">,</span><span class="default">$destination_pic</span><span class="keyword">,</span><span class="default">100</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82245""></a>
  <div class="note">
   <strong class="user">info at alex-lawrence dot com</strong>
   <a href="#82245" class="date">02-Apr-2008 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Could be useful (didn′t know where to post it):<br />
<br />
function getImageErrors( $filename, $type = "", $minWidth = 0, $minHeight = 0, $maxWidth = 0, $maxHeight = 0, $maxFileSize = 0 )<br />
{<br />
&nbsp;&nbsp;&nbsp; $errors = array();<br />
&nbsp;&nbsp;&nbsp; if ( file_exists( $filename ) )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $ending = substr( $filename, strpos( $filename, "." ) );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( is_array( $type ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $isTypeOf = false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( $type as $eachtype )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( $ending == $eachtype )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $isTypeOf = true;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( ! $isTypeOf )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'type' ] = $ending;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif ( $type != "" )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( $ending != $type )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'type' ] = $ending;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $size = getimagesize( $filename );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( $size[ 0 ] &lt; $minWidth )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'minWidth' ] = $size[ 0 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( $size[ 1 ] &lt; $minHeight )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'minHeight' ] = $size[ 1 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( ( $maxWidth &gt; $minWidth ) &amp;&amp; ( $size[ 0 ] &gt; $maxWidth ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'maxWidth' ] = $size[ 0 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( ( $maxHeight &gt; $minHeight ) &amp;&amp; ( $size[ 1 ] &gt; $maxHeight ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'maxHeight' ] = $size[ 1 ];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( ( $maxFileSize &gt; 0 ) &amp;&amp; ( filesize( $filename ) &gt; $maxFileSize ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'maxFileSize' ] = filesize( $filename );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $errors[ 'filename' ] = "not existing";<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return ( count( $errors ) &gt; 0 ? $errors : null );<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81380""></a>
  <div class="note">
   <strong class="user">cloned at clonedmadman dot com</strong>
   <a href="#81380" class="date">25-Feb-2008 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Well, I am making a script which will resize the image when uploaded, however, i am making a multi-uploader, so i came across with a problem: an efficient way of getting a pictures height and width and storing them in an array to resize later. This is what i came up with:<br />
<br />
<span class="default">&lt;?php<br />
$links </span><span class="keyword">= array(</span><span class="string">"test1.jpg"</span><span class="keyword">, </span><span class="string">"test2.png"</span><span class="keyword">);<br />
</span><span class="default">$sizearray </span><span class="keyword">= array();<br />
</span><span class="default">$count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$links</span><span class="keyword">);<br />
for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$links</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">$size</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sizearray</span><span class="keyword">[</span><span class="default">$links</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]] = array(</span><span class="string">"width" </span><span class="keyword">=&gt; </span><span class="default">$width</span><span class="keyword">, </span><span class="string">"height" </span><span class="keyword">=&gt; </span><span class="default">$height</span><span class="keyword">);<br />
}<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$sizearray</span><span class="keyword">);<br />
</span><span class="comment">// which will print out: Array ( [test1.jpg] =&gt; Array ( [width] =&gt; 300 [height] =&gt; 400 ) [test2.png] =&gt; Array ( [width] =&gt; 680 [height] =&gt; 100 ) )<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81043""></a>
  <div class="note">
   <strong class="user">shmohel at gmail dot com</strong>
   <a href="#81043" class="date">12-Feb-2008 03:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Rather than making a lengthy function that essentially runs twice (once as width, once as height) I came up with a helpful function that uses variable variables to set a maximum height/width. Hope someone finds this helpful.<br />
<br />
function scaleimage($location, $maxw=NULL, $maxh=NULL){<br />
&nbsp;&nbsp;&nbsp; $img = @getimagesize($location);<br />
&nbsp;&nbsp;&nbsp; if($img){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $w = $img[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $h = $img[1];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $dim = array('w','h');<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach($dim AS $val){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $max = "max{$val}";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(${$val} &gt; ${$max} &amp;&amp; ${$max}){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $alt = ($val == 'w') ? 'h' : 'w';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ratio = ${$alt} / ${$val};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ${$val} = ${$max};<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ${$alt} = ${$val} * $ratio;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return("&lt;img src='{$location}' alt='image' width='{$w}' height='{$h}' /&gt;");<br />
&nbsp;&nbsp;&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80656""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#80656" class="date">28-Jan-2008 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// A way to maintain Aspect Ratio<br />
// Here using standard aspect ratio of 4:3 for landscape and 3:4 for portrait.<br />
// example is 50% image resize <br />
<br />
//NewWidth = GivenHeight * (OriginalWidth / OriginalHeight)<br />
//NewHeight = GivenWidth * (OriginalHeight / OriginalWidth)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
$defaultImageWidth = 160; //your gallery image width<br />
$defaultImageHeight = 120; //your gallery image height<br />
<br />
$imageWidth = 462; // use getimagesize() to get image width<br />
$imageHeight = 432; // use getimagesize() to get image height<br />
&nbsp;&nbsp;&nbsp; <br />
if($imageWidth &gt; $imageHeight)<br />
{<br />
&nbsp;&nbsp;&nbsp; // landscape image<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $newWidth = $defaultImageWidth;<br />
&nbsp;&nbsp;&nbsp; $newHeight = (int)($defaultImageWidth * $imageHeight / $imageWidth);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if($newHeight &gt; $defaultImageHeight)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $newHeight = $defaultImageHeight;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $newWidth = (int)($defaultImageHeight * $imageWidth / $imageHeight);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
elseif ($imageHeight &gt; $imageWidth)<br />
{<br />
&nbsp;&nbsp;&nbsp; // portrait image<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $newHeight = $defaultImageHeight;<br />
&nbsp;&nbsp;&nbsp; $newWidth = (int)($defaultImageHeight * $imageWidth / $imageHeight);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if($newWidth &gt; $defaultImageWidth)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $newWidth = $defaultImageWidth;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $newHeight = (int)($defaultImageWidth * $imageHeight / $imageWidth);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
else <br />
{<br />
&nbsp;&nbsp;&nbsp; // square image<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $newWidth = $defaultImageWidth;<br />
&nbsp;&nbsp;&nbsp; $newHeight = $defaultImageHeight;<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
// here using Image Magick command line utility to resize image, OR you can use some other package.<br />
//@exec("/usr/local/bin/convert $sourceImageFilePath - -resize $newWidthx$newHeight\! $destinationImageFilePath");<br />
<br />
echo '&lt;b&gt;New Width:&lt;/b&gt;'.$newWidth;<br />
echo "&lt;br&gt;";<br />
echo '&lt;b&gt;New Height:&lt;/b&gt;'.$newHeight;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80346""></a>
  <div class="note">
   <strong class="user">pfarthing at hotmail dot com</strong>
   <a href="#80346" class="date">11-Jan-2008 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Correction: to find $y2 it should be...<br />
<br />
// set y side to a proportional size<br />
$y2 = $m * $x_max; // not $x1<br />
<br />
Thanks Norbert =)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80267""></a>
  <div class="note">
   <strong class="user">info at personalmis dot com</strong>
   <a href="#80267" class="date">07-Jan-2008 01:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Seems the various ways people are trying to proportionaly scale an image, up or down, could be more straight forward if one remembers ones algebra.<br />
<br />
The formula is, y = mx, where m is the slope of the line. This is the ratio of y:x or m = y/x.<br />
<br />
So if...<br />
<br />
// max values for x and y<br />
$y_max = 600;<br />
$x_max = 800;<br />
<br />
// image size<br />
$y1 = 2000;<br />
$x1 = 3000;<br />
<br />
// use width for scaling<br />
if ($x1 &gt; $x_max)<br />
{<br />
&nbsp;&nbsp;&nbsp; // find slope <br />
&nbsp;&nbsp;&nbsp; $m = $y1/$x1;<br />
&nbsp;&nbsp;&nbsp; // set x side to max<br />
&nbsp;&nbsp;&nbsp; $x2 = $x_max;<br />
&nbsp;&nbsp;&nbsp; // set y side to a proportional size<br />
&nbsp;&nbsp;&nbsp; $y2 = $m * $x1;<br />
}<br />
<br />
The new image proportionally scaled will be x2 = 800, y2 = 533 (rounded).<br />
<br />
To do it from the y side, simply reverse the x's and y's.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77006""></a>
  <div class="note">
   <strong class="user">redcore at gmail dot com</strong>
   <a href="#77006" class="date">09-Aug-2007 11:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's always good to check out an image's dimensions while attempting to upload to your server or database...especially if it's going to be displayed on a page that doesn't accomodate images beyond a particular size.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$tmpName </span><span class="keyword">= </span><span class="default">$_FILES</span><span class="keyword">[</span><span class="string">'userfile'</span><span class="keyword">][</span><span class="string">'tmp_name'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$tmpName</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$width</span><span class="keyword">&gt;</span><span class="default">275 </span><span class="keyword">|| </span><span class="default">$height</span><span class="keyword">&gt;</span><span class="default">275</span><span class="keyword">)<br />
{<br />
die(</span><span class="string">"exceeded image dimension limits."</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76882""></a>
  <div class="note">
   <strong class="user">laurens dot stoetzel at gmail dot com</strong>
   <a href="#76882" class="date">03-Aug-2007 08:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reply to John (<a href="http://de.php.net/manual/de/function.getimagesize.php#61514" rel="nofollow" target="_blank">http://de.php.net/manual/de/function.getimagesize.php#61514</a>):<br />
list will only work with numeric arrays.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">//renumber<br />
&nbsp; </span><span class="default">$my_image </span><span class="keyword">= </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">getimagesize</span><span class="keyword">(</span><span class="string">'test.jpg'</span><span class="keyword">));<br />
&nbsp; </span><span class="comment">//use list on new array<br />
&nbsp; </span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">) = </span><span class="default">$my_image</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">//view new array<br />
&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$my_image</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="comment">//spit out content<br />
&nbsp; </span><span class="keyword">echo </span><span class="string">'Attribute: '</span><span class="keyword">.</span><span class="default">$attr</span><span class="keyword">.</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp; echo </span><span class="string">'Width: '</span><span class="keyword">.</span><span class="default">$width</span><span class="keyword">.</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75856""></a>
  <div class="note">
   <strong class="user">phpnetUNDERSCOREspam at erif dot org</strong>
   <a href="#75856" class="date">19-Jun-2007 09:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
an alternative to the three options below for finding the width and height of data you know to be an image:<br />
<br />
$image = imagecreatefromstring($mydata);<br />
$width = imagesx($image);<br />
$height = imagesy($image);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70843""></a>
  <div class="note">
   <strong class="user">jens at kulmegies dot de</strong>
   <a href="#70843" class="date">31-Oct-2006 03:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In addition to thomporter's quick-reference of the output array, here's what PHP 4.4.0 does:<br />
<br />
Array[0] = Width<br />
Array[1] = Height<br />
Array[2] = Image Type Flag<br />
Array[3] = width="xxx" height="xxx"<br />
Array[bits] = bits<br />
Array[channels] = channels<br />
Array[mime] = mime-type<br />
<br />
There is no chance of getting the mime-type by accessing Array[6]...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61514""></a>
  <div class="note">
   <strong class="user">John</strong>
   <a href="#61514" class="date">06-Feb-2006 08:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was coming here to see if there was a simple way to get the height, width, and mime type of an image I have uploaded and while I thought the following code would work because it is printed above<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$attr</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="string">"img/flag.jpg"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
it didnt when I tried to echo out $type; so heres my fix, there may be a better way but it works for me!<br />
<br />
<span class="default">&lt;?php<br />
$blah </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="string">"folder/file.gif"</span><span class="keyword">);<br />
</span><span class="default">$type </span><span class="keyword">= </span><span class="default">$blah</span><span class="keyword">[</span><span class="string">'mime'</span><span class="keyword">];<br />
</span><span class="default">$width </span><span class="keyword">= </span><span class="default">$blah</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">$blah</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
</span><span class="default">?&gt;<br />
</span><br />
and then you can just echo out one of the variables about to get whichever you would desire.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58166""></a>
  <div class="note">
   <strong class="user">webmaster at WWW.ELLESSEWEB.NET</strong>
   <a href="#58166" class="date">26-Oct-2005 02:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a useful function to display a thumbnail of a whatever image.<br />
This piece of code has been lightly modified from an example found on &lt;b&gt;NYPHP.ORG&lt;/B&gt;.<br />
This function can build a thumbnail of any size you want and display it on your browser!<br />
Hope it can be useful for you guys!<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">makeThumbnail</span><span class="keyword">(</span><span class="default">$o_file</span><span class="keyword">, </span><span class="default">$t_ht </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image_info </span><span class="keyword">= </span><span class="default">getImageSize</span><span class="keyword">(</span><span class="default">$o_file</span><span class="keyword">) ; </span><span class="comment">// see EXIF for faster way<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">switch (</span><span class="default">$image_info</span><span class="keyword">[</span><span class="string">'mime'</span><span class="keyword">]) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'image/gif'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">imagetypes</span><span class="keyword">() &amp; </span><span class="default">IMG_GIF</span><span class="keyword">)&nbsp; { </span><span class="comment">// not the same as IMAGETYPE<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o_im </span><span class="keyword">= </span><span class="default">imageCreateFromGIF</span><span class="keyword">(</span><span class="default">$o_file</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ermsg </span><span class="keyword">= </span><span class="string">'GIF images are not supported&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'image/jpeg'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">imagetypes</span><span class="keyword">() &amp; </span><span class="default">IMG_JPG</span><span class="keyword">)&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o_im </span><span class="keyword">= </span><span class="default">imageCreateFromJPEG</span><span class="keyword">(</span><span class="default">$o_file</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ermsg </span><span class="keyword">= </span><span class="string">'JPEG images are not supported&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'image/png'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">imagetypes</span><span class="keyword">() &amp; </span><span class="default">IMG_PNG</span><span class="keyword">)&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o_im </span><span class="keyword">= </span><span class="default">imageCreateFromPNG</span><span class="keyword">(</span><span class="default">$o_file</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ermsg </span><span class="keyword">= </span><span class="string">'PNG images are not supported&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'image/wbmp'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">imagetypes</span><span class="keyword">() &amp; </span><span class="default">IMG_WBMP</span><span class="keyword">)&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o_im </span><span class="keyword">= </span><span class="default">imageCreateFromWBMP</span><span class="keyword">(</span><span class="default">$o_file</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ermsg </span><span class="keyword">= </span><span class="string">'WBMP images are not supported&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ermsg </span><span class="keyword">= </span><span class="default">$image_info</span><span class="keyword">[</span><span class="string">'mime'</span><span class="keyword">].</span><span class="string">' images are not supported&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (!isset(</span><span class="default">$ermsg</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o_wd </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$o_im</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o_ht </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$o_im</span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// thumbnail width = target * original width / original height<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t_wd </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$o_wd </span><span class="keyword">* </span><span class="default">$t_ht </span><span class="keyword">/ </span><span class="default">$o_ht</span><span class="keyword">) ; <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t_im </span><span class="keyword">= </span><span class="default">imageCreateTrueColor</span><span class="keyword">(</span><span class="default">$t_wd</span><span class="keyword">,</span><span class="default">$t_ht</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageCopyResampled</span><span class="keyword">(</span><span class="default">$t_im</span><span class="keyword">, </span><span class="default">$o_im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$t_wd</span><span class="keyword">, </span><span class="default">$t_ht</span><span class="keyword">, </span><span class="default">$o_wd</span><span class="keyword">, </span><span class="default">$o_ht</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageJPEG</span><span class="keyword">(</span><span class="default">$t_im</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageDestroy</span><span class="keyword">(</span><span class="default">$o_im</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imageDestroy</span><span class="keyword">(</span><span class="default">$t_im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return isset(</span><span class="default">$ermsg</span><span class="keyword">)?</span><span class="default">$ermsg</span><span class="keyword">:</span><span class="default">NULL</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Here the code to call the function:<br />
<br />
&lt;?<br />
<br />
header("Content-type: image/jpeg");<br />
makeThumbnail("<a href="http://it2.php.net/images/php.gif" rel="nofollow" target="_blank">http://it2.php.net/images/php.gif</a>", 300);<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57756""></a>
  <div class="note">
   <strong class="user">Mark at Mild Peril</strong>
   <a href="#57756" class="date">13-Oct-2005 01:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To solve the problem with using absolute site filepaths, as experienced by Brian:<br />
<br />
$size = getimagesize($_SERVER["DOCUMENT_ROOT"].$file);<br />
<br />
(where $file is something like "/rootdir/graphics/photo.jpg")</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55503""></a>
  <div class="note">
   <strong class="user">paul at goldenbakery dot nl</strong>
   <a href="#55503" class="date">05-Aug-2005 11:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the canvas of a Flash movie can not be empty for getimagesize() to read the dimensions of an SWF. Not sure if this is a bug, a feature or just a limitation of the SWF format.<br />
<br />
Flash version does not seem to matter. Also tested with Flash 8 beta.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53376""></a>
  <div class="note">
   <strong class="user">Sean</strong>
   <a href="#53376" class="date">30-May-2005 07:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I needed a quick way to make a group of images uniformly sized, but only on one page.&nbsp; So creating a new set of thumbnails was overdoing the whole thing.&nbsp; I made up this script that seems to do the trick.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; $image </span><span class="keyword">=&nbsp; </span><span class="string">"absolute/path/to/image/image.jpg"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="string">"</span><span class="default">$image</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; if (</span><span class="default">$height </span><span class="keyword">&gt; </span><span class="default">150</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">150</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$percent </span><span class="keyword">= (</span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] / </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$width </span><span class="keyword">= (</span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] / </span><span class="default">$percent</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; else if (</span><span class="default">$width </span><span class="keyword">&gt; </span><span class="default">150</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">150</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$percent </span><span class="keyword">= (</span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] / </span><span class="default">$width</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$height </span><span class="keyword">= (</span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] / </span><span class="default">$percent</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; echo </span><span class="string">"&lt;img src\"image/path/image.jpg\" height=\"</span><span class="default">$height</span><span class="string">\" width=\"</span><span class="default">$width</span><span class="string">\" /&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52099""></a>
  <div class="note">
   <strong class="user">ajreading at classixshop dot com</strong>
   <a href="#52099" class="date">21-Apr-2005 10:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple piece of code i wrote to proportionally resize an image to a max height and width then display it<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Max height and width<br />
</span><span class="default">$max_width </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
</span><span class="default">$max_height </span><span class="keyword">= </span><span class="default">100</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Path to your jpeg<br />
<br />
</span><span class="default">$upfile </span><span class="string">'/path/to/file.jpg'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">Header</span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">GetImageSize</span><span class="keyword">(</span><span class="default">$upfile</span><span class="keyword">); </span><span class="comment">// Read the size<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Proportionally resize the image to the<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // max sizes specified above<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x_ratio </span><span class="keyword">= </span><span class="default">$max_width </span><span class="keyword">/ </span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y_ratio </span><span class="keyword">= </span><span class="default">$max_height </span><span class="keyword">/ </span><span class="default">$height</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( (</span><span class="default">$width </span><span class="keyword">&lt;= </span><span class="default">$max_width</span><span class="keyword">) &amp;&amp; (</span><span class="default">$height </span><span class="keyword">&lt;= </span><span class="default">$max_height</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">$height</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ((</span><span class="default">$x_ratio </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">) &lt; </span><span class="default">$max_height</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$x_ratio </span><span class="keyword">* </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">$max_width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_width </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$y_ratio </span><span class="keyword">* </span><span class="default">$width</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$tn_height </span><span class="keyword">= </span><span class="default">$max_height</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// Increase memory limit to support larger files<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; </span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'memory_limit'</span><span class="keyword">, </span><span class="string">'32M'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">// Create the new image!<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">ImageCreateFromJpeg</span><span class="keyword">(</span><span class="default">$upfile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">ImageCreateTrueColor</span><span class="keyword">(</span><span class="default">$tn_width</span><span class="keyword">, </span><span class="default">$tn_height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">ImageCopyResized</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$tn_width</span><span class="keyword">, </span><span class="default">$tn_height</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">ImageJpeg</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">);<br />
</span><span class="comment">// Destroy the images<br />
</span><span class="default">ImageDestroy</span><span class="keyword">(</span><span class="default">$src</span><span class="keyword">);<br />
</span><span class="default">ImageDestroy</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51444""></a>
  <div class="note">
   <strong class="user">mail at soylentgreens dot com</strong>
   <a href="#51444" class="date">31-Mar-2005 03:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
How about this for cropping images...<br />
<br />
<span class="default">&lt;?php<br />
<br />
$imgfile </span><span class="keyword">= </span><span class="string">"img.jpg"</span><span class="keyword">;<br />
</span><span class="default">$cropStartX </span><span class="keyword">= </span><span class="default">300</span><span class="keyword">;<br />
</span><span class="default">$cropStartY </span><span class="keyword">= </span><span class="default">250</span><span class="keyword">;<br />
</span><span class="default">$cropW&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">200</span><span class="keyword">;<br />
</span><span class="default">$cropH&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">200</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Create two images<br />
</span><span class="default">$origimg </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$imgfile</span><span class="keyword">);<br />
</span><span class="default">$cropimg </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$cropW</span><span class="keyword">,</span><span class="default">$cropH</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Get the original size<br />
</span><span class="keyword">list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$imgfile</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Crop<br />
</span><span class="default">imagecopyresized</span><span class="keyword">(</span><span class="default">$cropimg</span><span class="keyword">, </span><span class="default">$origimg</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$cropStartX</span><span class="keyword">, </span><span class="default">$cropStartY</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
<br />
</span><span class="comment">// TODO: write code to save new image<br />
// or, just display it like this:<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/jpeg"</span><span class="keyword">);<br />
</span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$cropimg</span><span class="keyword">);<br />
<br />
</span><span class="comment">// destroy the images<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$cropimg</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50996""></a>
  <div class="note">
   <strong class="user">Coodiss at w3bbix dot net</strong>
   <a href="#50996" class="date">16-Mar-2005 06:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Heres a easy way to scale images to the &lt;td&gt; that they are in<br />
*this is broken up so anyone can understand it :)<br />
<br />
&lt;?<br />
$imageinfo = getimagesize("images/picture.jpg");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
$ix=$imageinfo[0];<br />
$iy=$imageinfo[1];<br />
<br />
$widthscale = $ix/175;&nbsp; //&lt;TD&gt; WIDTH<br />
$heightscale = $iy/175; //&lt;TD&gt; HEIGHT<br />
<br />
if($widthscale &lt; 1)<br />
$nwidth = $ix*$widthscale;<br />
else<br />
$nwidth = $ix/$widthscale;<br />
<br />
if($heightscale &lt; 1)<br />
$nheight = $iy*$heightscale;<br />
else<br />
$nheight = $iy/$heightscale;<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49930""></a>
  <div class="note">
   <strong class="user">php dot net at dannysauer dot com</strong>
   <a href="#49930" class="date">12-Feb-2005 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that, if you're going to be a good programmer and use named constatnts (IMAGETYPE_JPEG) rather than their values (2), you want to use the IMAGETYPE variants - IMAGETYPE_JPEG, IMAGETYPE GIF, IMAGETYPE_PNG, etc.&nbsp; For some reason, somebody made a horrible decision, and IMG_PNG is actually 4 in my version of PHP, while IMAGETYPE_PNG is 3.&nbsp; It took me a while to figure out why comparing the type against IMG_PNG was failing...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47785""></a>
  <div class="note">
   <strong class="user">sixzero4    at hotmail dot   com</strong>
   <a href="#47785" class="date">30-Nov-2004 05:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is just to add to the comment by robertks at hotmail dot com on <br />
05-Mar-2003 12:12 regarding trying to derive the dimensions of a video file. The package referenced (<a href="http://www.getid3.org/" rel="nofollow" target="_blank">http://www.getid3.org/</a>) had been updated, and below is a script I use to get the size. You can get many other attributes of media files as well.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// include getID3() library (can be in a different directory if full path is specified)<br />
&nbsp;</span><span class="keyword">include_once(</span><span class="string">'getid3.php'</span><span class="keyword">);<br />
&nbsp;<br />
</span><span class="comment">// Initialize getID3 engine<br />
</span><span class="default">$getID3 </span><span class="keyword">= new </span><span class="default">getID3</span><span class="keyword">;<br />
<br />
&nbsp;</span><span class="comment">// File to get info from<br />
&nbsp;</span><span class="default">$file_location </span><span class="keyword">= </span><span class="string">'./your/path/to/file.mov'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Get information from the file<br />
&nbsp;</span><span class="default">$fileinfo </span><span class="keyword">= </span><span class="default">$getID3</span><span class="keyword">-&gt;</span><span class="default">analyze</span><span class="keyword">(</span><span class="default">$file_location</span><span class="keyword">);<br />
&nbsp;</span><span class="default">getid3_lib</span><span class="keyword">::</span><span class="default">CopyTagsToComments</span><span class="keyword">(</span><span class="default">$fileinfo</span><span class="keyword">);<br />
&nbsp;<br />
&nbsp;</span><span class="comment">// Output results<br />
</span><span class="keyword">if (!empty(</span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'video'</span><span class="keyword">][</span><span class="string">'resolution_x'</span><span class="keyword">])) { echo </span><span class="string">'&lt;p&gt; video width: '</span><span class="keyword">.</span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'video'</span><span class="keyword">][</span><span class="string">'resolution_x'</span><span class="keyword">].</span><span class="string">'&lt;/p&gt;'</span><span class="keyword">; }<br />
if (!empty(</span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'video'</span><span class="keyword">][</span><span class="string">'resolution_y'</span><span class="keyword">])) { echo </span><span class="string">'&lt;p&gt; video height: '</span><span class="keyword">.</span><span class="default">$fileinfo</span><span class="keyword">[</span><span class="string">'video'</span><span class="keyword">][</span><span class="string">'resolution_y'</span><span class="keyword">].</span><span class="string">'&lt;/p&gt;'</span><span class="keyword">; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope that helps others looking for a function similar to getimagesize() for a video or media file.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44792""></a>
  <div class="note">
   <strong class="user">Joshua</strong>
   <a href="#44792" class="date">16-Aug-2004 09:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your image name has spaces in it you will need to use rawurlencode() and NOT urlencode() as this function (at least in 4.3.4) does not accept spaces as + signs.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44640""></a>
  <div class="note">
   <strong class="user">cstdenis at hotmail dot com</strong>
   <a href="#44640" class="date">11-Aug-2004 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This will not work for swf files unless zlib is compiled into php statically (not as a shared module). Bug #29611<br />
<br />
As of PHP 5.0.0 it will just return false, but that should change to a notice by the next release.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42662""></a>
  <div class="note">
   <strong class="user">diablx at hotmail dot com</strong>
   <a href="#42662" class="date">25-May-2004 11:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm sorry for they other scripts, but I made one mistake about the image resizing... here is a working script !<br />
&lt;?<br />
&nbsp;&nbsp;&nbsp; // Some configuration variables !<br />
&nbsp;&nbsp;&nbsp; $maxWidth = 90;<br />
&nbsp;&nbsp;&nbsp; $maxHeight = 90;<br />
&nbsp;&nbsp;&nbsp; $maxCols = 8;<br />
&nbsp;&nbsp;&nbsp; $webDir = "https://localhost/images/";<br />
&nbsp;&nbsp;&nbsp; $localDir = $_SERVER['DOCUMENT_ROOT']."/images/";<br />
<br />
&nbsp;&nbsp;&nbsp; $AutorisedImageType = array ("jpg", "jpeg", "gif", "png");<br />
?&gt;<br />
<br />
&lt;center&gt;<br />
&lt;table border='1' cellspacing='5' cellpadding='5' style="border-collapse:collapse; border-style: dotted"&gt;<br />
&lt;tr&gt;<br />
&nbsp;&nbsp; &lt;?<br />
&nbsp;&nbsp; // Open localDir<br />
&nbsp;&nbsp; $dh = opendir($localDir);<br />
&nbsp;&nbsp; while (false !== ($filename = readdir($dh))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; $filesArray[] = $filename;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; // Display and resize<br />
&nbsp;&nbsp; foreach ($filesArray as $images) {<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; $ext = substr($images, strpos($images, ".")+1, strlen($images));<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; if( in_array($ext, $AutorisedImageType) ) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; list($width, $height, $type, $attr) = @getimagesize( $localDir.$images );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xRatio = $maxWidth / $width; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $yRatio = $maxHeight / $height; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( ($width &lt;= $maxWidth) &amp;&amp; ($height &lt;= $maxHeight) ) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newWidth = $width; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newHeight = $height; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else if (($xRatio * $height) &lt; $maxHeight) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newHeight = ceil($xRatio * $height); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newWidth = $maxWidth; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newWidth = ceil($yRatio * $width); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $newHeight = $maxHeight; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($i == $maxCols) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;/tr&gt;&lt;tr&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $i = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; echo "&lt;td align='center' valign='middle' width='$maxWidth' height='$maxHeight'&gt;&lt;img src='".$webDir.$images."' width='$newWidth' height='$newHeight'&gt;&lt;/td&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; }<br />
?&gt;<br />
&lt;/tr&gt;<br />
&lt;/table&gt;<br />
&lt;/center&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41130""></a>
  <div class="note">
   <strong class="user">MagicalTux at FF.st</strong>
   <a href="#41130" class="date">31-Mar-2004 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
simm posted something interesting about imagick, but usually calling an external binary is not the best way.<br />
<br />
You can use the Imagick PHP module . With it, you do not even need to get the image size to generate thubnails...<br />
<br />
Here's the code I used :<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $imh</span><span class="keyword">=</span><span class="default">imagick_readimage</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagick_scale</span><span class="keyword">(</span><span class="default">$imh</span><span class="keyword">,</span><span class="default">GALLERY_THUMBNAILWIDTH</span><span class="keyword">,</span><span class="default">GALLERY_THUMBNAILHEIGHT</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagick_writeimage</span><span class="keyword">(</span><span class="default">$imh</span><span class="keyword">,</span><span class="default">$image_thumb</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
(I noticed that some hosting companies are now providing the imagick module by default. Using it allows you to accept any type of image from your visitors. Maybe it will be documented on the official PHP website one day or another? )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40661""></a>
  <div class="note">
   <strong class="user">MarioPro</strong>
   <a href="#40661" class="date">11-Mar-2004 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The Problem:<br />
I've just noticed that after upgrading to the PHP 4.3.4 version, the old GetImageSize() should get your attention on pages coded before this new version.<br />
<br />
The solutions:<br />
So, if you used GetImageSize(), you should now be using getimagesize() - attention to all lower caracters.<br />
<br />
Also, you shou certify that the image realy exists, otherwhise you'll get the following error: getimagesize(): Read error!<br />
This means that there is no image to "fill" the string and thus you're calling, for example: "images/news/" instead of calling "images/news/03102004a.jpg"<br />
<br />
One should now verify if there is an image to be called (example):<br />
if($photo1!=""){<br />
$size1=getimagesize("images/news/".$photo_news_1"]);<br />
$width1=$size1[0];<br />
$height1=$size[1];<br />
}<br />
Here, if $photo_news_1 is set and exists it will be displayed, otherwhise it will be skiped and no ERROR message will be displayed. In the PHP 4.3.3 and earlier versions, this was not necessary but it is now!&nbsp; ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39003""></a>
  <div class="note">
   <strong class="user">yohami dot com - zerodj at hotmail dot com</strong>
   <a href="#39003" class="date">14-Jan-2004 04:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A cool resize / cropping script for creating thumbnails using mogrify<br />
<br />
IMAGETEST.PHP<br />
<br />
<span class="default">&lt;?php <br />
<br />
</span><span class="keyword">include </span><span class="string">'mogrify.php'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// variables from flash (my website uses flash and php)<br />
</span><span class="default">$picture</span><span class="keyword">=</span><span class="string">"sample.jpg"</span><span class="keyword">;<br />
</span><span class="default">$fixedwidth</span><span class="keyword">=</span><span class="default">300</span><span class="keyword">;<br />
</span><span class="default">$fixedheight</span><span class="keyword">=</span><span class="default">240</span><span class="keyword">;<br />
</span><span class="comment">//<br />
<br />
</span><span class="default">cropimage</span><span class="keyword">(</span><span class="default">$picture</span><span class="keyword">,</span><span class="default">$fixedwidth</span><span class="keyword">,</span><span class="default">$fixedheight</span><span class="keyword">,</span><span class="default">$mogrify</span><span class="keyword">);<br />
<br />
&nbsp;</span><span class="default">?&gt;<br />
</span><br />
MOGRIFY.PHP<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="comment">// walking the path<br />
</span><span class="default">$mogrify</span><span class="keyword">=</span><span class="string">"C:/apache/Imagik/mogrify.exe"</span><span class="keyword">;<br />
<br />
</span><span class="comment">// ---------------------------------------- crop function<br />
<br />
</span><span class="keyword">function </span><span class="default">cropimage</span><span class="keyword">(</span><span class="default">$picture</span><span class="keyword">,</span><span class="default">$fixedwidth</span><span class="keyword">,</span><span class="default">$fixedheight</span><span class="keyword">,</span><span class="default">$mogrify</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// GET IMG<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$picture</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width</span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height</span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// CROP WIDTH <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$width</span><span class="keyword">!=</span><span class="default">$fixedwidth</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ratio </span><span class="keyword">=</span><span class="default">$fixedwidth</span><span class="keyword">/</span><span class="default">$width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NewHeight</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">$height</span><span class="keyword">*</span><span class="default">$ratio</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NewWidth</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">*</span><span class="default">$ratio</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">( </span><span class="default">$mogrify</span><span class="keyword">.</span><span class="string">" -resize "</span><span class="keyword">.</span><span class="default">$NewWidth</span><span class="keyword">.</span><span class="string">"x"</span><span class="keyword">.</span><span class="default">$NewHeight</span><span class="keyword">.</span><span class="string">"! </span><span class="default">$picture</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">( </span><span class="default">$mogrify</span><span class="keyword">.</span><span class="string">" -crop "</span><span class="keyword">.</span><span class="default">$fixedwidth</span><span class="keyword">.</span><span class="string">"x"</span><span class="keyword">.</span><span class="default">$fixedheight</span><span class="keyword">.</span><span class="string">"+0+0 </span><span class="default">$picture</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// REFRESH<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$picture</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$width</span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$height</span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// CROP HEIGHT<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$height</span><span class="keyword">!=</span><span class="default">$fixedheight</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ratio </span><span class="keyword">=</span><span class="default">$fixedheight</span><span class="keyword">/</span><span class="default">$height</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NewHeight</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">$height</span><span class="keyword">*</span><span class="default">$ratio</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$NewWidth</span><span class="keyword">=</span><span class="default">round</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">*</span><span class="default">$ratio</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">( </span><span class="default">$mogrify</span><span class="keyword">.</span><span class="string">" -resize "</span><span class="keyword">.</span><span class="default">$NewWidth</span><span class="keyword">.</span><span class="string">"x"</span><span class="keyword">.</span><span class="default">$NewHeight</span><span class="keyword">.</span><span class="string">"! </span><span class="default">$picture</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">( </span><span class="default">$mogrify</span><span class="keyword">.</span><span class="string">" -crop "</span><span class="keyword">.</span><span class="default">$fixedwidth</span><span class="keyword">.</span><span class="string">"x"</span><span class="keyword">.</span><span class="default">$fixedheight</span><span class="keyword">.</span><span class="string">"+0+0 </span><span class="default">$picture</span><span class="string">"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">ImageDestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
yeah!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37903""></a>
  <div class="note">
   <strong class="user">php (at) thejpster org uk</strong>
   <a href="#37903" class="date">02-Dec-2003 03:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to resize an image proportionally to fit within a given area, like I did, the following code might help you out.<br />
<br />
If either hscale or wscale are greater than 1 then that dimension is too big. If you then scale your image by the larger of the two values (hscale, wscale) then you guarantee that both dimensions will now fit in your specified area :)<br />
<br />
function makeImg($num) {<br />
&nbsp;&nbsp;&nbsp; global $hmax, $wmax; // max width and height<br />
&nbsp;&nbsp;&nbsp; $image = "somefile.jpg";<br />
&nbsp;&nbsp;&nbsp; list($width, $height, $type, $attr) = getimagesize($image);<br />
&nbsp;&nbsp;&nbsp; $hscale = $height / $hmax;<br />
&nbsp;&nbsp;&nbsp; $wscale = $width / $wmax;<br />
&nbsp;&nbsp;&nbsp; if (($hscale &gt; 1) || ($wscale &gt; 1)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $scale = ($hscale &gt; $wscale)?$hscale:$wscale;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $scale = 1;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $newwidth = floor($width / $scale);<br />
&nbsp;&nbsp;&nbsp; $newheight= floor($height / $scale);<br />
<br />
&nbsp;&nbsp;&nbsp; return "&lt;img width='$newwidth' height='$newheight' src='$image'&gt;&lt;br&gt;$image: $newwidth x $newheight : $width x $height";<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37531""></a>
  <div class="note">
   <strong class="user">djwishbone at hotmail dot com</strong>
   <a href="#37531" class="date">19-Nov-2003 03:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using remote files with getimagesize($URL) never worked for me.&nbsp; Except when I would grab files from the same server.&nbsp; However, I developed some code with the help from the people here that does work.&nbsp; If you are having problems give this function a shot:<br />
<br />
function getimagesize_remote($image_url) {<br />
&nbsp;&nbsp;&nbsp; $handle = fopen ($image_url, "rb");<br />
&nbsp;&nbsp;&nbsp; $contents = "";<br />
&nbsp;&nbsp;&nbsp; if ($handle) {<br />
&nbsp;&nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $count += 1;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $data = fread($handle, 8192);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (strlen($data) == 0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; $contents .= $data;<br />
&nbsp;&nbsp;&nbsp; } while(true);<br />
&nbsp;&nbsp;&nbsp; } else { return false; }<br />
&nbsp;&nbsp;&nbsp; fclose ($handle);<br />
<br />
&nbsp;&nbsp;&nbsp; $im = ImageCreateFromString($contents);<br />
&nbsp;&nbsp;&nbsp; if (!$im) { return false; }<br />
&nbsp;&nbsp;&nbsp; $gis[0] = ImageSX($im);<br />
&nbsp;&nbsp;&nbsp; $gis[1] = ImageSY($im);<br />
// array member 3 is used below to keep with current getimagesize standards<br />
&nbsp;&nbsp;&nbsp; $gis[3] = "width={$gis[0]} height={$gis[1]}";<br />
&nbsp;&nbsp;&nbsp; ImageDestroy($im);<br />
&nbsp;&nbsp;&nbsp; return $gis;<br />
}<br />
<br />
goodluck</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36452""></a>
  <div class="note">
   <strong class="user">janoma_cl</strong>
   <a href="#36452" class="date">10-Oct-2003 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to show thumbnails keeping the original proportions, with defined maximum width and height, you can use this function. This is useful when showing tables of user-uploaded images, that not necessarily are same-sized. However, for big images (like wallpapers), a better option is to create separated thumbnails with a image-editing software.<br />
<br />
If the image is smaller or equal than the defined maximums, then it's showed without resizing. If not, creates a link to a pop-up that shows the full-size image.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">show_thumbnail</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$max </span><span class="keyword">= </span><span class="default">200 </span><span class="comment">// Max. thumbnail width and height<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$size </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] &lt;= </span><span class="default">$max </span><span class="keyword">&amp;&amp; </span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] &lt;= </span><span class="default">$max </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="string">'&lt;img src="'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">'" '</span><span class="keyword">.</span><span class="default">$size</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">].</span><span class="string">' border="0"&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$k </span><span class="keyword">= ( </span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] &gt;= </span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] ) ? </span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] / </span><span class="default">$max </span><span class="keyword">: </span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] / </span><span class="default">$max</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="string">'&lt;a href="javascript:;" onClick="window.open(\'image.php?img='</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="default">$file</span><span class="keyword">.</span><span class="string">'\',\'\',\'width='</span><span class="keyword">.</span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">',height='</span><span class="keyword">.</span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">].</span><span class="string">'\')"&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">.= </span><span class="string">'&lt;img src="'</span><span class="keyword">.</span><span class="default">$file</span><span class="keyword">.</span><span class="string">'" width="'</span><span class="keyword">.</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]/</span><span class="default">$k</span><span class="keyword">).</span><span class="string">'" height="'</span><span class="keyword">.</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]/</span><span class="default">$k</span><span class="keyword">).</span><span class="string">'" border="0" alt="View full-size image"&gt;&lt;/a&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Here is the code of 'image.php':<br />
<br />
&lt;html&gt;<br />
&lt;head&gt;<br />
&lt;title&gt;Image&lt;/title&gt;<br />
&lt;/head&gt;<br />
&lt;body leftmargin="0" topmargin="0"&gt;<br />
<span class="default">&lt;?php </span><span class="keyword">echo ( </span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'img'</span><span class="keyword">]) ) ? </span><span class="string">'&lt;a href="#" onClick="window.close();"&gt;&lt;img src="'</span><span class="keyword">.</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'img'</span><span class="keyword">].</span><span class="string">'" border="0" alt="Close window"&gt;&lt;/a&gt;' </span><span class="keyword">: </span><span class="string">'Invalid image filename, or no filename entered. &lt;a href="#" onClick="window.close();"&gt;Close window&lt;/a&gt;.' </span><span class="default">?&gt;<br />
</span>&lt;/body&gt;<br />
&lt;/html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35509""></a>
  <div class="note">
   <strong class="user">simms</strong>
   <a href="#35509" class="date">03-Sep-2003 06:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
here's a nice way of resizing user-uploaded files on the fly, using ImageMagick (on linux), but no GD: <br />
<br />
&lt;?<br />
<br />
if( $image_info = getimagesize( "/upload_dir/" . $uploadName ) )<br />
{<br />
&nbsp; if( $image_info[ 0 ] &gt; $defaultImgWidth )<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; exec( "mogrify -geometry " . $defaultImgWidth . " " . "/upload_dir/" . $uploadName . " &amp;" );<br />
&nbsp; }<br />
}<br />
<br />
?&gt;<br />
<br />
$defaultImgWidth would be the target width of the image -- note that the code above resizes the image without distorting its original proportions, and only if it is wider than $defaultImgWidth.<br />
the ImageMagick syntax used above ("mogrify ..") overwrites the original file ($uploadName) with the resized image.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35449""></a>
  <div class="note">
   <strong class="user">ten tod xmg ta rotanimrev (reverse it)</strong>
   <a href="#35449" class="date">01-Sep-2003 07:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An additional note to "tightcode_nosp@m_hotmail":<br />
<br />
If that doesn't work try this instead:<br />
<br />
&lt;?<br />
&nbsp;&nbsp; &nbsp;&nbsp; $img = imagecreatefromjpeg ($filename);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $x = imagesx ($img);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $y = imagesy ($img);<br />
&nbsp;&nbsp; &nbsp;&nbsp; imagedestroy ($img);<br />
?&gt;<br />
<br />
Though keep in mind that this consumes lots of CPU. So if you're doing something like creating a page of thumbnails this is considerably slower.<br />
<br />
So what you can do is use getimagesize() and check if<br />
- the width and height are empty strings ("")<br />
- and those two values aren't too high<br />
<br />
Both indicate that getimagesize() didn't work properly. The latter may happen if getimagesize() thought that it recognized the format and therefore the size properly. I mean if you're looking at pictures that you know are max. 1024x768 and getimagesize() returns a width of e.g. 20234 then it's obvious that something went wrong. In that case use the code mentioned above. Of course if getimagesize() returned small values that are wrong you still get the wrong size. So check your pictures and priorities first.<br />
<br />
So all of this could look like as follows:<br />
<br />
&lt;?<br />
&nbsp;&nbsp;&nbsp; $picinfo = @getimagesize ($filename);<br />
&nbsp;&nbsp;&nbsp; if ($picinfo !== false) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $x = $picinfo [0];<br />
&nbsp;&nbsp; &nbsp;&nbsp; $y = $picinfo [1];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; // change this according the picture resolutions you're expecting<br />
&nbsp;&nbsp;&nbsp; if ($x &gt; 2000 || $y &gt; 2000) $x = $y = "";<br />
<br />
&nbsp;&nbsp;&nbsp; if ($x == "") {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $img = imagecreatefromjpeg ($filename);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $x = imagesx ($img);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $y = imagesy ($img);<br />
&nbsp;&nbsp; &nbsp;&nbsp; imagedestroy ($img);<br />
&nbsp;&nbsp;&nbsp; }<br />
?&gt;<br />
<br />
Note: fix syntax stuff if there's an error as I compiled this example from a few places.<br />
<br />
If you don't care about the huge load on your CPU or you have to rely on the proper size use the snippet noted at the beginning only.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35018""></a>
  <div class="note">
   <strong class="user">justin at webtekconcepts dot com</strong>
   <a href="#35018" class="date">15-Aug-2003 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those that like to go the dynamic thumbnail route, I've found that you can get warnings with getimagesize() after your loop through more than 3 to 4 images. In my case I needed 12 images on each page.<br />
<br />
Use usleep() in your loop just before you run getimagesize() otherwise you'll end up with warnings, big images and a broken page. Using usleep() lets the server recoup for X milliseconds so it will accept connections again for the image size. <br />
<br />
I've found that usleep(1500) is the best for my situation. This barely slows the page down and allows for getimagesize() to work 100% of the time for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32543""></a>
  <div class="note">
   <strong class="user">webmaster AT theparadox DOT org</strong>
   <a href="#32543" class="date">31-May-2003 02:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I figured others have wanted to scale an image to a particular height or width while preserving the height/width ratio. So here are the functions I wrote to accomplish this. Hopefully they'll save somebody else the five minutes it took to write these.<br />
<br />
You give the filename and the dimension you want to use, and these functions return the opposite dimension:<br />
<br />
function scale_to_height ($filename, $targetheight) {<br />
&nbsp;&nbsp; $size = getimagesize($filename);<br />
&nbsp;&nbsp; $targetwidth = $targetheight * ($size[0] / $size[1]);<br />
&nbsp;&nbsp; return $targetwidth;<br />
}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
function scale_to_width ($filename, $targetwidth) {<br />
&nbsp;&nbsp; $size = getimagesize($filename);<br />
&nbsp;&nbsp; $targetheight = $targetwidth * ($size[1] / $size[0]);<br />
&nbsp;&nbsp; return $targetheight;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30060""></a>
  <div class="note">
   <strong class="user">robertks at hotmail dot com</strong>
   <a href="#30060" class="date">05-Mar-2003 06:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you trying to derive the dimensions of a video file (e.g. Video for Windows AVI, Quicktime MOV, MPEG MPG, Windows Media Video WMV or ASF, etc.), you will find the getid3 library to be indispensible.&nbsp; Found at <a href="http://getid3.sourceforge.net, here" rel="nofollow" target="_blank">http://getid3.sourceforge.net, here</a>'s an example of its use in a script:<br />
<br />
include_once('getid3.php'); // or wherever you actually put the getid3 scripts<br />
$file_location = './myvideo.avi';<br />
$file_info = GetAllFileInfo($file_location) // calls getid3 function<br />
$file_width = $file_info['video']['resolution_x'];<br />
$file_height = $file_info['video']['resolution_y'];<br />
<br />
You can then use your OBJECT and EMBED tags in HTML to put the video into a web page, and make the PHP template independent of the size parameters of the particular video it happens to be loading.&nbsp; (Just remember to add pixels to the video height to accomodate the controller of the embedded player: typically, 16 pixels for Quicktime, 46 pixels for Windows Media Player 6, and 64 pixels for Windows Media Player 7.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19745""></a>
  <div class="note">
   <strong class="user">mogster at boomdesign dot no</strong>
   <a href="#19745" class="date">09-Mar-2002 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Really useful info from webmasterb@feartheclown.com and you others :-)<br />
Saved my butt...<br />
Here's a build on that, with proportional resizing of the image-upload ($newpic) to a fixed value ($maxwidth):<br />
$maxwidth = "350";<br />
$imagehw = GetImageSize($newpic);<br />
$imagewidth = $imagehw[0];<br />
$imageheight = $imagehw[1];<br />
$imgorig = $imagewidth;<br />
if ($imagewidth &gt; $maxwidth {<br />
&nbsp; $imageprop=($maxwidth*100)/$imagewidth;<br />
&nbsp; $imagevsize= ($imageheight*$imageprop)/100 ;<br />
&nbsp; $imagewidth=$maxwidth; <br />
&nbsp; $imageheight=ceil($imagevsize);<br />
}<br />
Of course this does not resize the image itself, but returns values one may use in html-code to restrain users from killing your design...<br />
<br />
knutm</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
