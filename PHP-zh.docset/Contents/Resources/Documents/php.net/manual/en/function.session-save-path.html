<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>读取/设置当前会话的保存路径</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.session-reset.html">? session_reset</a></li>
      <li style="float: right;"><a href="function.session-set-cookie-params.html">session_set_cookie_params ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.session.html">Session 函数</a></li>
    <li>读取/设置当前会话的保存路径</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.session-save-path" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_save_path</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">session_save_path</span> &mdash; <span class="dc-title">读取/设置当前会话的保存路径</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.session-save-path-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>session_save_path</strong></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$path</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>session_save_path()</strong></span> 
   返回当前会话的保存路径。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.session-save-path-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">path</code></dt>

     <dd>

      <p class="para">
       指定会话数据保存的路径。
       必须在调用 <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span> 函数之前调用
       <span class="function"><strong>session_save_path()</strong></span> 函数。
      </p>
      <p class="para">
       <blockquote class="note"><p><strong class="note">Note</strong>: 
        <p class="para">
         在某些操作系统上，建议使用可以高效处理
         大量小尺寸文件的文件系统上的路径来保存会话数据。
         例如，在 Linux 平台上，对于会话数据保存的工作而言，reiserfs 文件系统会比 ext2fs 文件系统能够提供更好的性能。
        </p>
       </p></blockquote>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.session-save-path-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回保存会话数据的路径。
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.session-save-path-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member">
     <a href="session.configuration.html#ini.session.save-path" class="link">session.save_path</a>
     配置指示。
    </li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115778""></a>
  <div class="note">
   <strong class="user">hi at chintan dot pw</strong>
   <a href="#115778" class="date">21-Sep-2014 11:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To Change the session path to a sub folder of your projects<br />
<br />
ini_set('session.save_path',getcwd(). '/tmp');<br />
<br />
saves the session in "tmp" folder.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113372""></a>
  <div class="note">
   <strong class="user">mdibbets at outlook dot nospam</strong>
   <a href="#113372" class="date">03-Oct-2013 04:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made a folder next to the public html folder and placed these lines at the very first point in index.php<br />
<br />
Location of session folder:<br />
<br />
/domains/account/session<br />
<br />
location of index.php<br />
<br />
/domains/account/public_html/index.php<br />
<br />
What I placed in index.php at line 0:<br />
<br />
<span class="default">&lt;?php <br />
ini_set</span><span class="keyword">(</span><span class="string">'session.save_path'</span><span class="keyword">,</span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">]) . </span><span class="string">'/../session'</span><span class="keyword">));<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">This is the only solution that worked </span><span class="keyword">for </span><span class="default">me</span><span class="keyword">. </span><span class="default">Hope this helps someone</span><span class="keyword">.</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98203""></a>
  <div class="note">
   <strong class="user">branislav dot ristic at gmail dot com</strong>
   <a href="#98203" class="date">01-Jun-2010 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a lot of searches, tests and pain, the only one that worked for me was this:<br />
<br />
session_save_path(realpath(dirname($_SERVER['DOCUMENT_ROOT']) . '/../session'));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98106""></a>
  <div class="note">
   <strong class="user">alvaro at demogracia dot com</strong>
   <a href="#98106" class="date">26-May-2010 12:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Debian does not use the default garbage collector for sessions. Instead, it sets session.gc_probability to zero and it runs a cron job to clean up old session data in the default directory.<br />
<br />
As a result, if your site sets a custom location with session_save_path() you also need to set a value for session.gc_probability, e.g.:<br />
<br />
<span class="default">&lt;?php<br />
session_save_path</span><span class="keyword">(</span><span class="string">'/home/example.com/sessions'</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'session.gc_probability'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Otherwise, old files in '/home/example.com/sessions' will never get removed!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96751""></a>
  <div class="note">
   <strong class="user">Matthias H. (DE)</strong>
   <a href="#96751" class="date">14-Mar-2010 12:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under PHP for Windows, you can improve the speed, when you store all session-files on ramdisk. A freeware-ramdisk you can download by <a href="http://www.techsnack.net/gavotte-ramdisk-free-virtual-hardisk . " rel="nofollow" target="_blank">http://www.techsnack.net/gavotte-ramdisk-free-virtual-hardisk . </a><br />
<br />
A other alternativ is store you session-datas to apc-user-cache (see php-apc-extension).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96358""></a>
  <div class="note">
   <strong class="user">TK</strong>
   <a href="#96358" class="date">23-Feb-2010 02:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After a search for the cause of a issue causing users to have to login twice, I've found a call to session_save_path() was the culprit.<br />
<br />
What was happening was: the session save path was set, a session was opened, some variables were set and the session was closed.&nbsp; This was resulting in an empty file in the specified session save path and of course no session data on the next page load.&nbsp; Oddly, on the second attempt the data was saved as expected.<br />
<br />
I found that removing the call to session_save_path() resolved the issue.&nbsp; My final solution was to replace the call to session_save_path($path) with an equivalent call to ini_set('session.save_path', $path).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80901""></a>
  <div class="note">
   <strong class="user">sampathperera at hotmail dot com - Sri Lanka</strong>
   <a href="#80901" class="date">06-Feb-2008 08:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Session on clustered web servers !<br />
<br />
We had problem in PHP session handling with 2 web server cluster. Problem was one servers session data was not available in other server.<br />
<br />
So I made a simple configuration in both server php.ini file. Changed session.save_path default value to shared folder on both servers (/mnt/session/).<br />
<br />
It works for me. :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45733""></a>
  <div class="note">
   <strong class="user">webmaster at gardenchemicals dot co dot uk</strong>
   <a href="#45733" class="date">16-Sep-2004 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an absolute must if you have an important login on a shared server. Without it, other users of the server can do the following to bypass login:<br />
<br />
* Visit login page, browse through cookies and grab the session id.<br />
* Create a PHP script on their account that grabs and sets session variables for a given session id.<br />
* Read and change any values for that session id (for example passwords or session keys), and therefore gain access to the protected area.<br />
<br />
All users on web hosting should choose an dir below the HTTP directory struct, but within their user area to store the session files.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="10637""></a>
  <div class="note">
   <strong class="user">a9504778 at unet dot univie dot ac dot at</strong>
   <a href="#10637" class="date">15-Jan-2001 12:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
dont forget: if you use session_save_path on the page, that registers a variable, you have also to use session_save_path on all the pages, where you access the session-variable. under win32 you can use the double \\ to specify eg "c:\\temp\\"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
