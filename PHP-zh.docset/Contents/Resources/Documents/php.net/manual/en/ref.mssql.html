<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Mssql 函数</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mssql.constants.html">? 预定义常量</a></li>
      <li style="float: right;"><a href="function.mssql-bind.html">mssql_bind ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.mssql.html">Mssql</a></li>
    <li>Mssql 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.mssql" class="reference">
  <h1 class="title">Mssql 函数</h1>



























































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.mssql-bind.html">mssql_bind</a> &mdash; Adds a parameter to a stored procedure or a remote stored procedure</li><li><a href="function.mssql-close.html">mssql_close</a> &mdash; 关闭MS SQL Server链接</li><li><a href="function.mssql-connect.html">mssql_connect</a> &mdash; 打开MS SQL server链接</li><li><a href="function.mssql-data-seek.html">mssql_data_seek</a> &mdash; Moves internal row pointer</li><li><a href="function.mssql-execute.html">mssql_execute</a> &mdash; Executes a stored procedure on a MS SQL server database</li><li><a href="function.mssql-fetch-array.html">mssql_fetch_array</a> &mdash; Fetch a result row as an associative array, a numeric array, or both</li><li><a href="function.mssql-fetch-assoc.html">mssql_fetch_assoc</a> &mdash; Returns an associative array of the current row in the result</li><li><a href="function.mssql-fetch-batch.html">mssql_fetch_batch</a> &mdash; Returns the next batch of records</li><li><a href="function.mssql-fetch-field.html">mssql_fetch_field</a> &mdash; Get field information</li><li><a href="function.mssql-fetch-object.html">mssql_fetch_object</a> &mdash; Fetch row as object</li><li><a href="function.mssql-fetch-row.html">mssql_fetch_row</a> &mdash; Get row as enumerated array</li><li><a href="function.mssql-field-length.html">mssql_field_length</a> &mdash; Get the length of a field</li><li><a href="function.mssql-field-name.html">mssql_field_name</a> &mdash; Get the name of a field</li><li><a href="function.mssql-field-seek.html">mssql_field_seek</a> &mdash; Seeks to the specified field offset</li><li><a href="function.mssql-field-type.html">mssql_field_type</a> &mdash; Gets the type of a field</li><li><a href="function.mssql-free-result.html">mssql_free_result</a> &mdash; Free result memory</li><li><a href="function.mssql-free-statement.html">mssql_free_statement</a> &mdash; Free statement memory</li><li><a href="function.mssql-get-last-message.html">mssql_get_last_message</a> &mdash; Returns the last message from the server</li><li><a href="function.mssql-guid-string.html">mssql_guid_string</a> &mdash; Converts a 16 byte binary GUID to a string</li><li><a href="function.mssql-init.html">mssql_init</a> &mdash; Initializes a stored procedure or a remote stored procedure</li><li><a href="function.mssql-min-error-severity.html">mssql_min_error_severity</a> &mdash; Sets the minimum error severity</li><li><a href="function.mssql-min-message-severity.html">mssql_min_message_severity</a> &mdash; Sets the minimum message severity</li><li><a href="function.mssql-next-result.html">mssql_next_result</a> &mdash; Move the internal result pointer to the next result</li><li><a href="function.mssql-num-fields.html">mssql_num_fields</a> &mdash; Gets the number of fields in result</li><li><a href="function.mssql-num-rows.html">mssql_num_rows</a> &mdash; Gets the number of rows in result</li><li><a href="function.mssql-pconnect.html">mssql_pconnect</a> &mdash; Open persistent MS SQL connection</li><li><a href="function.mssql-query.html">mssql_query</a> &mdash; Send MS SQL query</li><li><a href="function.mssql-result.html">mssql_result</a> &mdash; Get result data</li><li><a href="function.mssql-rows-affected.html">mssql_rows_affected</a> &mdash; Returns the number of records affected by the query</li><li><a href="function.mssql-select-db.html">mssql_select_db</a> &mdash; Select MS SQL database</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113666""></a>
  <div class="note">
   <strong class="user">amolkulkarni82 at gmail dot com</strong>
   <a href="#113666" class="date">13-Nov-2013 04:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is the changes required to connect MSSQL database using&nbsp; mssql_connect with long password (more than 30 chars)<br />
<br />
Steps to follow: <br />
<br />
1) cd /usr/local/src/freetds-0.91/<br />
<br />
2) Change the values as required in freetds src:<br />
<br />
# Default values:<br />
# Filename:&nbsp; include/sybdb.h (line 67)<br />
#define DBMAXNAME&nbsp; 30<br />
<br />
# Filename:&nbsp; include/tds.h (line 760)<br />
#define TDS_MAX_DYNID_LEN&nbsp; &nbsp; 30<br />
<br />
# Filename:&nbsp; include/tds.h (line 831)<br />
#define TDS_MAX_LOGIN_STR_SZ 30<br />
<br />
3) Modify the TDS_MAX_LOGIN_STR_SZ macro to overcome the password limitation of 30 chars<br />
<br />
4) Recompile the freetds<br />
<br />
make clean &amp;&amp; ./configure --prefix=/usr/local/freetds --with-tdsver=8.0 --enable-msdblib --enable-dbmfix --with-gnu-ld &amp;&amp; make &amp;&amp; make install<br />
<br />
5) Restart the apache<br />
/usr/local/apache2/bin/apachectl stop &amp;&amp; /usr/local/apache2/bin/apachectl start<br />
<br />
6) Export the FREETDS<br />
export FREETDSCONF=/etc/freetds.conf<br />
<br />
Test the MSSQLdatabase connection using CLI<br />
<br />
&gt; php -a<br />
Interactive mode enabled<br />
<br />
<span class="default">&lt;?php<br />
<br />
$conn </span><span class="keyword">= </span><span class="default">mssql_connect</span><span class="keyword">(</span><span class="string">'hostname'</span><span class="keyword">,</span><span class="string">'username'</span><span class="keyword">,</span><span class="string">'password'</span><span class="keyword">);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
<br />
if (!</span><span class="default">$conn</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$strerr </span><span class="keyword">= </span><span class="string">"ERROR: Failed to connect to MSSQL Server ('hostname') : "</span><span class="keyword">.</span><span class="default">mssql_get_last_message</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
CTR+D<br />
<br />
expected output:<br />
<br />
resource(1) of type (mssql link)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96947""></a>
  <div class="note">
   <strong class="user">stephan at towli dot ch</strong>
   <a href="#96947" class="date">24-Mar-2010 04:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I worked on a project with a MS SQL server 2008 containing data of NVARCHAR type in multiple languages, 
<br />
including asian characters. It is a known issue, that the PHP MSSQL functions are not able to retrieve
<br />
unicode data form NVARCHAR or NTEXT data fields.
<br />

<br />
I spent some time searching for possible solutions and finaly found a work arround, that provides correct 
<br />
display of latin and asian fonts from a NVARCHAR field.
<br />

<br />
Do a SQL query, while you convert the NVARCHAR data first to VARBINARY and then to VARCHAR
<br />

<br />
SELECT 
<br />
CONVERT(VARCHAR(MAX),CONVERT(VARBINARY(MAX),nvarchar_col)) AS x 
<br />
FROM dbo.table
<br />

<br />
While you fetch the result set in PHP, use the iconv() function to convert the data to unicode
<br />

<br />
<span class="default">&lt;?php $x </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"UCS-2LE"</span><span class="keyword">,</span><span class="string">"UTF-8"</span><span class="keyword">,</span><span class="default">$row</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">]); </span><span class="default">?&gt;
<br />
</span>
<br />
Now you can ouput the text to UTF-8 encoded page with the correct characters.
<br />

<br />
This workarround did run on IIS 6.0 with PHP 5.2.6 running as FastCGI.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96228""></a>
  <div class="note">
   <strong class="user">mista-birdy[at]hotmail.com</strong>
   <a href="#96228" class="date">16-Feb-2010 09:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm using IIS 6.0, PHP 5.2 (issapi) and MSSQL.<br />
I've had Problem to connect with PHP to MSSQL.<br />
The Errormessage was that Loginname was incorrect.<br />
<br />
My Solution is to set mssql.secure_connection = off<br />
and create an MSSQL-Account (No Windows Authentification!) and connect to MSSQL Server. It works!<br />
<br />
If you like to use Windows Authentification, you can use the Apache Service with your desired Account and set mssql.secure_connection = on. Then you can use the mssql_connect() function without user/pwd.<br />
I don't know how this works with IIS 6.0 Server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87674""></a>
  <div class="note">
   <strong class="user">David Alan</strong>
   <a href="#87674" class="date">16-Dec-2008 03:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get an error like:<br />
<br />
PHP Warning:&nbsp; mssql_query(): message: Unicode data in a Unicode-only collation or ntext data cannot be sent to clients using DB-Library (such as ISQL) or ODBC version 3.7 or earlier. (severity 16) in /var/www/html/query.php on line 29<br />
<br />
There are two solutions: one solution involves casting the data types in the query, the other solution involves changing the version number free tds is using.<br />
<br />
The first solution is mentioned all over the web and limits what you can return, the second solution will probably only be found right here.&nbsp; <br />
<br />
Open up your free tds configuration file (/etc/freetds.conf), and change:<br />
<br />
[global]<br />
tds version = 4.2<br />
<br />
to this:<br />
<br />
[global]<br />
tds version = 8.0<br />
<br />
You don't have to upgrade any packages, but by default, freetds tries to use an older version (if you installed freetds using yum or apt-get).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85912""></a>
  <div class="note">
   <strong class="user">robert dot johnson at icap dot com</strong>
   <a href="#85912" class="date">24-Sep-2008 01:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is a PHP driver for SQL Server 2005+ from Microsoft.&nbsp; You can even download the source code.<br />
<br />
Search for "SQL Server 2005 Driver for PHP" on MSDN, or try one of these links:<br />
<br />
<a href="http://msdn.microsoft.com/en-us/library/cc793139(SQL.90" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/cc793139(SQL.90</a>).aspx<br />
<br />
<a href="http://msdn.microsoft.com/en-us/library/cc296221.aspx" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/cc296221.aspx</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82005""></a>
  <div class="note">
   <strong class="user">Keith Radue, South Africa</strong>
   <a href="#82005" class="date">24-Mar-2008 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My Workstation/server:<br />
<br />
Windows 2000 Advanced Server<br />
iis<br />
PHP 5.2.5<br />
SQL server Express<br />
<br />
Could not connect using the following connect string:<br />
<br />
$sqlconn = mssql_connect "localhost,1433", "user", "password")<br />
<br />
After 2 days of frustration and reinstalling PHP + SQLEXPRESS and trying EVERYTHING I could find via Google, I found a setting in PHP.INI that I never noticed.<br />
<br />
ENABLE _dl = ON&nbsp; ---------- I changed this to OFF <br />
<br />
Problem went away and all is working as it used to on PHP4<br />
<br />
Hope this helps others with the same problem</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81594""></a>
  <div class="note">
   <strong class="user">Sander Wartenberg</strong>
   <a href="#81594" class="date">05-Mar-2008 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running on the following settings I couldn't connect to my local SQL server.<br />
<br />
- Apache 2.2.6<br />
- PHP 5.2.5<br />
- SQL Server 2005<br />
- Windows XP SP2<br />
<br />
The problem lies within the wrong dynamic library that is included in Apache and PHP. To fix this problem follow this steps:<br />
<br />
1. Download the good version of ntwdblib.dll (2000.80.194.0)&nbsp; <a href="http://webzila.com/dll/1/ntwdblib.zip" rel="nofollow" target="_blank">http://webzila.com/dll/1/ntwdblib.zip</a><br />
2. Overwrite C:\wamp\bin\apache\apache2.2.6\bin\ntwdblib.dll<br />
3. Overwrite C:\wamp\bin\php\php5.2.5\ntwdblib.dll<br />
<br />
4. Start the SQL Server Configuration Manager -&gt; Protocols<br />
5. Enable "named pipes" and "tcp/ip"<br />
6. Right-click "tcp/ip" -&gt; Properties tab "IP addresses"<br />
7. Fill in "TCP Dynamic Ports" with 1433<br />
<br />
8. Restart SQL Server AND Apache, PHP and all the other services<br />
<br />
Try the following mssql_connect:<br />
<br />
mssql_connect('localhost,1433', USERNAME, PASSWORD);<br />
<br />
Good luck!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81298""></a>
  <div class="note">
   <strong class="user">Slartibartfast</strong>
   <a href="#81298" class="date">21-Feb-2008 06:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using Apache on a windows machine to connect to a networked SQL Server I was getting the following error:<br />
<br />
Warning: mssql_connect() [function.mssql-connect]: message: Login failed for user 'DomainName\MachineName$'. (severity 14)<br />
<br />
This occurred regardless of the username and the password that I passed to mssql_connect()<br />
<br />
Apparently the username and password parameters are ignored when connecting to SQL Server with trusted connections. Instead it attempts to connect using the&nbsp; Web Server username and password instead. Under windows the default webserver account is the machine name (which is probably not set up as being a windows user).<br />
<br />
This can be solved by configuring Apache to log on as a designated user.<br />
-&nbsp; &nbsp; Open Control Panels<br />
-&nbsp; &nbsp; Double click administrative tools<br />
-&nbsp; &nbsp; Double click services<br />
-&nbsp; &nbsp; Right click on Apache and choose properties<br />
-&nbsp; &nbsp; Under the "Log On" tab choose "This Account" and type in a valid domain user account &amp; password<br />
-&nbsp; &nbsp; Restart the Apache service</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81150""></a>
  <div class="note">
   <strong class="user">jigarbe at yahoo dot com</strong>
   <a href="#81150" class="date">15-Feb-2008 05:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was able to install and configure Freetds on CENTOS 4 following the guide lines mentioned in beliw mentioned URL<br />
<br />
I advice everybody to follow the same<br />
<br />
<a href="http://members.cox.net/midian/howto/phpMSSQL.htm" rel="nofollow" target="_blank">http://members.cox.net/midian/howto/phpMSSQL.htm</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81149""></a>
  <div class="note">
   <strong class="user">jigarbe at yahoo dot com</strong>
   <a href="#81149" class="date">15-Feb-2008 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP and SQL Server <br />
<br />
Install And Configure FreeTDS<br />
The first thing you need to do is to download and install the FreeTDS driver. You can get the source and compile it yourself from <a href="http://www.freetds.org/, but I prefer RPMs. Depending on your distrobution of Linux, the version you want will vary. I" rel="nofollow" target="_blank">http://www.freetds.org/, but I prefer RPMs. Depending on your distrobution of Linux, the version you want will vary. I</a>'m running Red Hat Enterprise Linux 4 ES and CentOS 4, which are both almost identical. I installed freetds-0.62.3-1 from <a href="http://rpmforge.net/user/packages/freetds/" rel="nofollow" target="_blank">http://rpmforge.net/user/packages/freetds/</a><br />
After installing FreeTDS, you can check your driver by attempting to connect to the MSSQL Server. Of course, use the appropriate server name, username and password in your command line.<br />
# /usr/bin/tsql -S [mssql.servername.or.ip] -U [ValidUser]<br />
locale is "en-US.UTF-8"<br />
locale charset is "UTF-8"<br />
Password: [password]<br />
1&gt;<br />
Enter "quit" to exit your successful connection. If the tsql command doesn't return the 1&gt; prompt, verify that you can get to your MSSQL server with telnet [mssql.servername.or.ip] 1433 and that your username and password are valid.<br />
Next, edit your /etc/freetds.conf configuration file and add the following at the end of the file:<br />
[TDS]<br />
&nbsp;&nbsp;&nbsp; host = [mssql.servername.or.ip]<br />
&nbsp;&nbsp;&nbsp; port = 1433<br />
&nbsp;&nbsp;&nbsp; tds version = 7.0<br />
&nbsp; Setup ODBC Data Source<br />
Next, unixODBC needs to know about all ODBC drivers you intend to use. While you can use the GUI program that comes with unixODBC, you can also use the odbcinst command. First create a template file containing your FreeTDS setup information.<br />
tdsdriver.template<br />
[FreeTDS]<br />
Description = v.062 with protocol v7.0<br />
Driver = /usr/lib/libtdsodbc.so.0<br />
Run odbcinst, telling it to install a driver entry using the template we just created.<br />
# odbcinst -i -d -f tdsdriver.template<br />
odbcinst: Driver installed. Usage count increased to 1.<br />
&nbsp;&nbsp;&nbsp; Target directory is /etc<br />
This will add an entry to the end of the file /etc/odbcinst.ini<br />
[FreeTDS]<br />
Description&nbsp; &nbsp; &nbsp; &nbsp; = v0.62 with protocol v7.0<br />
Driver&nbsp; &nbsp; &nbsp;&nbsp; = /usr/lib/libtdsodbc.so.0<br />
UsageCount&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; = 1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80559""></a>
  <div class="note">
   <strong class="user">Erwin Moller</strong>
   <a href="#80559" class="date">22-Jan-2008 03:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Microsoft SQL Server 2005 and Vista.<br />
<br />
The following steps enabled MSSQL 2005 support on Vista Home Permium. (native drivers, not odbc which works out-of-the-box)<br />
<br />
1) Place ntwdblib.dll in C:\Windows\System32<br />
2) Place php_mssql.dll in C:\Windows\System32<br />
(I gave IUSR full access to these files, maybe read is enough)<br />
<br />
3) uncomment php_mssql.dll in php.ini<br />
<br />
4) Changed my default SQLSERVER 2005 install so it accepts named piped. (Do this via start-&gt; SQLServer2005-&gt;configuration tools-&gt;SQL SERVER surface area configuration.<br />
<br />
5) reboot.<br />
<br />
After that I could use the mssql_* functions.<br />
<br />
Hope that helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80534""></a>
  <div class="note">
   <strong class="user">darkelder at php dot net</strong>
   <a href="#80534" class="date">21-Jan-2008 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Microsoft do offer a SQL Server 2005 driver for PHP at <a href="http://www.microsoft.com/sql/technologies/php/default.mspx" rel="nofollow" target="_blank">http://www.microsoft.com/sql/technologies/php/default.mspx</a><br />
<br />
It can be download free of charge. Binaries are provided for Windows platform only.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79293""></a>
  <div class="note">
   <strong class="user">ahribernik _at_ blitztelecom com au</strong>
   <a href="#79293" class="date">20-Nov-2007 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FYI if you are on Linux and using FreeTDS for your drivers (you most likely are), you can get past the 255 character limit by:<br />
<br />
1. open the file freetds.conf (normally in the directory /etc)<br />
2. under [global] section change the "tds version" to "7.0" or "8.0" (depending on your version of SQL Server)<br />
3. changes should be instant!<br />
<br />
use 7.0 for Microsoft SQL Server 7.0<br />
use 8.0 for Microsoft SQL Server 2000 and above<br />
<br />
see <a href="http://www.freetds.org/userguide/choosingtdsprotocol.htm" rel="nofollow" target="_blank">http://www.freetds.org/userguide/choosingtdsprotocol.htm</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78769""></a>
  <div class="note">
   <strong class="user">nospam at gmail dot com</strong>
   <a href="#78769" class="date">26-Oct-2007 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are using mssql_bind with stored procedures on Windows and need to get around the 255 character varchar limit, one hack is to pass SQLTEXT as the data type to mssql_bind rather than SQLVARCHAR.&nbsp; <br />
<br />
You will still need to use some means to get around returning&nbsp; varchar data that's longer than 255, the simplest of which is to CAST the varchar field as text in your stored procedure itself.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77737""></a>
  <div class="note">
   <strong class="user">hadrien(dot)debris {at} gmail(dot)com</strong>
   <a href="#77737" class="date">11-Sep-2007 03:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have lost one day to understand why the MSSQL&lt;-&gt;PHP connection was no longer functioning after a PHP update (5.2.2-&gt;5.2.4).<br />
<br />
I eventually found how to solve things:<br />
BEFORE<br />
[code]$link = mssql_connect("SERVER\INST", "LOGIN", "password");[/code]<br />
<br />
Which does not work any longer.<br />
<br />
AFTER<br />
[code]$link = mssql_connect("SERVER\\INST", "LOGIN", "password");[/code]<br />
<br />
Works flawlessly.<br />
<br />
Hope that'll prevent someone to lose precious hours of exasperation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77735""></a>
  <div class="note">
   <strong class="user">michael at nospam dot onlinecity dot dk</strong>
   <a href="#77735" class="date">11-Sep-2007 11:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are experiencing that ANSI characters are being corrupted, e.g. nordic letters are showing up as invalid characters and you have SQL Server 2000 installed on the same machine as the webserver, try checking SQL Server Client Network Utility under the DB-Library Options tab.<br />
Make sure that "Automatic ANSI to OEM conversion" is NOT checked, this caused me several hours of headache.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77619""></a>
  <div class="note">
   <strong class="user">mprentice at eeicom dot com</strong>
   <a href="#77619" class="date">06-Sep-2007 05:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears ntwdblib.dll is no longer a part of SQL 2005.&nbsp; According to Microsoft the component is deprecated and they recommend using OLE DB or ODBC.&nbsp; The dll from SQL Server version 6.5, SQL Server 7.0, or SQL Server 2000 still works against 2005 if you have it.<br />
<br />
From Microsoft's site:<br />
<br />
&nbsp;Although the SQL Server 2005 Database Engine still supports connections from existing applications using the DB-Library and Embedded SQL APIs, it does not include the files or documentation needed to do programming work on applications that use these APIs. A future version of the SQL Server Database Engine will drop support for connections from DB-Library or Embedded SQL applications. Do not use DB-Library or Embedded SQL to develop new applications. Remove any dependencies on either DB-Library or Embedded SQL when modifying existing applications. Instead of these APIs, use the SQLClient namespace or an API such as OLE DB or ODBC. SQL Server 2005 does not include the DB-Library DLL required to run these applications. To run DB-Library or Embedded SQL applications you must have available the DB-Library DLL from SQL Server version 6.5, SQL Server 7.0, or SQL Server 2000.<br />
&nbsp;<br />
<a href="http://msdn2.microsoft.com/en-us/library/ms143729.aspx" rel="nofollow" target="_blank">http://msdn2.microsoft.com/en-us/library/ms143729.aspx</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77436""></a>
  <div class="note">
   <strong class="user">chop_01 at yahoo dot com</strong>
   <a href="#77436" class="date">29-Aug-2007 10:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I tried all manner of things in order to cnnect to SQLExpress aka SQL Server 2005 and was just about to walk away and move across to MySQL when it just dawned on me that after following all of the instructions from numerous people I never restarted the Apache service.<br />
<br />
This meant that the new ntwdblib.dll was never called. I restarted the service and hey presto ... I can now connect to the SQL server.<br />
<br />
The items that I did were as follows:<br />
<br />
1. Installed the SQLServer in mixed auth mode<br />
2. Checked that the mssql.secure_connection = Off was present in the php.ini<br />
3. Copied the ntwdblib.dll file into<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; o WINDOWS\SYSTEM32<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; o program files\apache2\bin<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; o php<br />
4. Started the SQL Server Browser Service<br />
5. Enabled all of the IPs in Protocols &gt; TCP/IP<br />
6. Restarted the following services:<br />
&nbsp;&nbsp; &nbsp; &nbsp; o Apache<br />
&nbsp;&nbsp; &nbsp; &nbsp; o SQL Service<br />
&nbsp;&nbsp; &nbsp; &nbsp; o SQL Browser Service<br />
<br />
This allowed me to connect with no problems using the following parameters within my mssql_connect call<br />
<br />
HOST=.\SQLEXPRESS<br />
USERNAME=sa<br />
PASSWORD=&lt;MYPASS&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76503""></a>
  <div class="note">
   <strong class="user">swaldester at gmail dot com</strong>
   <a href="#76503" class="date">18-Jul-2007 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For all of you connecting to MS SQL Server using freeTDS, having trouble to log on with a domain login:<br />
<br />
Add the line:<br />
putenv('TDSVER=70');<br />
<br />
just before calling mssql_connect()<br />
<br />
This worked for me with a MS SQL Server 2K Ent.<br />
<br />
Thank you elmer !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76168""></a>
  <div class="note">
   <strong class="user">post at wmm dot no</strong>
   <a href="#76168" class="date">03-Jul-2007 08:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Having trouble connecting to a MS SQL Server from Windows server with Apache + PHP, or some other server-configuration?
<br />

<br />
Too old MDAC in Windows may be your problem.
<br />

<br />
Here is a summary for those working on Windows-plattform:
<br />

<br />
1. Update your Microsoft MDAC (search for Microsoft Data Access Components on www.microsoft.com). Some older Microsoft servers (or workstations) contain old and crappy MDAC-installations. This solved our problem after two days of work.. 
<br />

<br />
2. Make sure ntwdblib.dll (version 8.00.194) is in the correct place(s). I only placed it in Apache bin directory and it worked fine, but apparently some Microsoft installations need it in several locations.. this is indeed very confusing!
<br />

<br />
3. You may have to set mssql.secure_connection = off in your php.ini
<br />

<br />
4. Make sure needed ports are configured in your firewall.
<br />

<br />
Hope this helps - now, back to coffee!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76004""></a>
  <div class="note">
   <strong class="user">nmax at libero dot it</strong>
   <a href="#76004" class="date">26-Jun-2007 02:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About the ntwdblib.dll, I can say that on Windows 2003 Server with Apache 2.2 and PHP 5.2.3 I have repalced the one present in PHP folder with the version 8.00.194 of the same.<br />
<br />
Putting the dll only in PHP folder and configuring in php.ini the variable mssql.secure_connection = Off mssql_connect() works!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75929""></a>
  <div class="note">
   <strong class="user">James at thetallfamily dot com</strong>
   <a href="#75929" class="date">21-Jun-2007 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
MSSQL doesn't have a real_escape_string function like MYSQL does, which can lead to error when inserting or updating data that contains a ' (single quote). <br />
<br />
To prevent this, replace all ' (single quotes) by TWO ' (single quotes) '' which SQL server will interpret as an escaped '.<br />
Also you may want to remove any \' \" escape sequences that are translated from any FORM output into the PHP $_POST variables.<br />
<br />
Hope this helps someone.<br />
James</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74990""></a>
  <div class="note">
   <strong class="user">Roy Maarssen</strong>
   <a href="#74990" class="date">07-May-2007 10:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My problem was that I've loaded the ntwdblib.dll (8.00.194) into the php directory, but it also have to be placed in the bin directory of Apache.<br />
<br />
I hope this will save you some time searching for the solution, if you encounter the same problem.<br />
<br />
I'm using SQL 2005 Express Edition on Windows Vista Enterprise with Apache.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74834""></a>
  <div class="note">
   <strong class="user">lostaircryptic at hotmail dot co dot uk</strong>
   <a href="#74834" class="date">30-Apr-2007 12:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
MAXIMUM COLUMN LENGTH OF 30 CHARACTERS....<br />
<br />
This restriction was solved by using the following techniques.<br />
<br />
First create a test which detects this to be the problem and then self correct it.<br />
<br />
For the times that this is a problem rename the columns to an unique column name which is 30 characters exactly in length.&nbsp; This column must be unique compares to the others, so use the MD5 Hashed value.&nbsp; Since MD5 hashed values are 32 character HEX values, convert this to a toggle Hex value giving an exact maximum length of 31 characters.&nbsp; Prepend a character to the start to ensure that it falls within Column naming regulations.<br />
<br />
When the data is obtained, check for the hashed values against a check array and replace where neccessary.<br />
<br />
Although complex it may sound, the method has been tried and successfully works, thus allowing columns of greater length than that of 30 characters.<br />
<br />
I had this situation within Linux as well as Windows (XAMPP), so this solution was ultimate in solving the problem.<br />
<br />
You can run the detection as a constant or automatically.&nbsp; However it is best to use a constant for efficiency reasons.<br />
<br />
Any questions, just email me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74417""></a>
  <div class="note">
   <strong class="user">Jason {at} RoundtopRiders {dot} com</strong>
   <a href="#74417" class="date">10-Apr-2007 08:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I struggled with this for a few days and finally got it figured out. I'm running Windows 2003 Server, PHP 5.2, Apache 2.2 and MSSQL Server 2005.<br />
<br />
(1) Set 'msssql.secure_connection = On' in the PHP.ini file<br />
(2) Download the correct ntwdblib.dll file (version 8.00.194)<br />
<br />
Copy this to:<br />
<br />
C:/Windows/System32<br />
&lt;server root&gt;/php<br />
&lt;server root&gt;/apache/bin<br />
<br />
(I would just do a search for this file and replace it anywhere you find it...)<br />
<br />
(3) Make sure TCP/IP and Named Pipes are enabled in the SQL Configuration tool.<br />
<br />
Hope this saves somebody a few hours.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74405""></a>
  <div class="note">
   <strong class="user">deyura at gmail dot com</strong>
   <a href="#74405" class="date">10-Apr-2007 12:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FreeTDS is work!!!<br />
<br />
But after install you shoul add in config file<br />
1. Add in freetds.conf client cahrset:<br />
[TDS_NAME_TO_CONNECT]<br />
host = 192.168.0.1<br />
port = 1433<br />
tds version = 8.0<br />
client charset = CP1251<br />
<br />
2. For datetime add in locales.conf in [default]:<br />
date format = %Y-%m-%d %I:%M:%S.%z<br />
<br />
3. restart apache<br />
<br />
4. In your php-script you should connect to [TDS_NAME_TO_CONNECT]<br />
mssql_connect('TDS_NAME_TO_CONNECT', 'php', '123');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74346""></a>
  <div class="note">
   <strong class="user">vbchris at gmail dot com</strong>
   <a href="#74346" class="date">06-Apr-2007 05:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your having problems with&nbsp; your script at random times refusing to connect to the database. Try editing php.ini and uncommenting this line.
<br />

<br />
mssql.max_procs = -1
<br />

<br />
This solved the problem for me after 3 days of pulling my hair out wondering why it kept refusing to connect!
<br />

<br />
==
<br />

<br />
[Because this may not always work,] I created a loop to create a few connections and noticed it was always the first connection that failed. So I wrote this to keep trying to connect until it eventually does.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">while(!</span><span class="default">$connection</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$connection </span><span class="keyword">= </span><span class="default">mssql_connect</span><span class="keyword">(</span><span class="default">$cfg</span><span class="keyword">[</span><span class="string">'server'</span><span class="keyword">],</span><span class="default">$cfg</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">],</span><span class="default">$cfg</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">]);
<br />
}
<br />
</span><span class="default">$db </span><span class="keyword">= </span><span class="default">mssql_select_db</span><span class="keyword">(</span><span class="default">$cfg</span><span class="keyword">[</span><span class="string">'database'</span><span class="keyword">],</span><span class="default">$connection</span><span class="keyword">) or die(</span><span class="string">"Error selecting the database"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72711""></a>
  <div class="note">
   <strong class="user">ziggurism at gmail dot com</strong>
   <a href="#72711" class="date">30-Jan-2007 07:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On *nix, of course you need to add extension=mssql.so to your php.ini.&nbsp; Obvious, but it took me a while to figure that out.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72446""></a>
  <div class="note">
   <strong class="user">tom at mazzotta dot com</strong>
   <a href="#72446" class="date">19-Jan-2007 12:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FINNALLY got PHP to connect to MS SQL Server. Even though I read through the multitue of comments about ntwdblib.dll, etc., I still couldn't get it to work. The key was to load the Microsoft MDAC (2.8) on my IIS/PHP server. If your environement does not use the web server to host SQL as well, you will probably need to install the MDAC. My guess is that an installation of SQL Server (and/or just the client tools) on the webserver will automatically include the MDAC and you would not experience this problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72229""></a>
  <div class="note">
   <strong class="user">phpnet at pginet dot com</strong>
   <a href="#72229" class="date">08-Jan-2007 09:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This took me a while to figure out, so I may as well pass it along to save somebody time.
<br />

<br />
If you are having trouble connecting with a DSNless connection using unixodbc with freetds, don't forget to specify the TDS_Version in your connection string.
<br />

<br />
Example (8.0 is for SQL Server 2000 exclusively):
<br />

<br />
<span class="default">&lt;?php
<br />
$dsn </span><span class="keyword">= </span><span class="string">"DRIVER=FreeTDS;TDS_Version=8.0; TRACE=No; SERVER=someserver; PORT=someport; DATABASE=somedb; UID=somelogin; PWD=somepassword"</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71876""></a>
  <div class="note">
   <strong class="user">be_misc_01 at flowbuzz dot com</strong>
   <a href="#71876" class="date">20-Dec-2006 10:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Couple of notes:
<br />
When setting this up, you might notice that the unixODBC isql command likes the password wrapped in single quotes:
<br />
isql -v MyDSN MyUserID 'MyPa$$W0rd'
<br />

<br />
Additionally, if you happen to have a dollar-sign in your password (or username, or DSN) -- you must avoid using double quotes.&nbsp; This is a normal PHP gotcha, but worth mentioning.
<br />
Won't work: 
<br />
<span class="default">&lt;?php $con </span><span class="keyword">= </span><span class="default">mssql_connect </span><span class="keyword">(</span><span class="string">"MyDSN"</span><span class="keyword">, </span><span class="string">"MyUserID"</span><span class="keyword">, </span><span class="string">"MyPa$</span><span class="default">$W0rd</span><span class="string">"</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
Will work (single quotes):
<br />
<span class="default">&lt;?php $con </span><span class="keyword">= </span><span class="default">mssql_connect </span><span class="keyword">(</span><span class="string">"MyDSN"</span><span class="keyword">, </span><span class="string">"MyUserID"</span><span class="keyword">, </span><span class="string">'MyPa$$W0rd'</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71602""></a>
  <div class="note">
   <strong class="user">davinel_lu_linvega at hotmail dot com</strong>
   <a href="#71602" class="date">07-Dec-2006 12:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
About using the MSSQL XML field-type, for Win32 users,&nbsp; :<br />
<br />
1. The most simple way would be to<br />
<br />
"SELECT [xmlfield] FROM [table]"<br />
<br />
But this triggers the following error :<br />
<br />
"Unicode data in a Unicode-only collation or ntext data cannot be sent to clients using DB-Library (such as ISQL) or ODBC version 3.7 or earlier. (severity 16)"<br />
<br />
2. Well, let's just read [xmlfield] as a VARCHAR.<br />
<br />
"SELECT CAST([xmlfield] AS VARCHAR(8000)) FROM [table]"<br />
<br />
will truncate to the 255 first characters, due to the API limitation. (see the marc at NOSPAM dot durdin dot net note)<br />
<br />
3. So woud not that be appropriate to use the TEXT field-type ?<br />
<br />
"SELECT CAST([xmlfield] AS TEXT) FROM [table]"<br />
<br />
triggers :<br />
<br />
"Explicit conversion from data type xml to text is not allowed. (severity 16)"<br />
<br />
4. So you cannot read the VARCHAR nor the XML, and you cannot transform the XML into TEXT. In order to finally read that XML field-type, you may use this trick :<br />
<br />
"SELECT CAST(CAST([xmlfield] AS VARCHAR(8000)) AS TEXT) FROM [table]"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71312""></a>
  <div class="note">
   <strong class="user">KamiKazie at comcast dot net</strong>
   <a href="#71312" class="date">22-Nov-2006 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have found that a Windows Webserver cannot connect to a Microsoft SQL Database if the webserver is running Microsoft SQL Server Agent.&nbsp; It gives connection and undefined function errors.&nbsp; Hope this helps some people.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71186""></a>
  <div class="note">
   <strong class="user">JinXy at skylinetop dot com</strong>
   <a href="#71186" class="date">15-Nov-2006 05:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had major problems trying to get the msssql extension loaded.&nbsp; The following fixed it for me:&nbsp; <br />
<br />
1. Make sure the ntwdblib.dll file located in system32/ on the Database server is copied to system32 on the PHP serving server.<br />
2. Uncomment the extension in the php.ini file.<br />
3. Add the following to the registry: [HKEY_LOCAL_MACHINE\SOFTWARE\PHP]<br />
"IniFilePath"="C:\\PHP"<br />
This tells PHP where to find the php.ini<br />
(This is what my resolution to my problem was - only after some time did I find some reference to it).<br />
4. Restart IIS</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70907""></a>
  <div class="note">
   <strong class="user">anders jenbo(located)pc denmark</strong>
   <a href="#70907" class="date">03-Nov-2006 09:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The 3 major headaicks I had while setting up MS SQL 2005, php 5.1.6 (apache 2.2 server) on Vista RC1 and getting them to comunicate.<br />
<br />
TCP/IP and "Named Pipes Protocol" had to be enabled in the MS SQL Server. You do this in the Surface Area Configuration tool.<br />
<br />
MS SQL 2005 should be set to mix mode login. Unless you use NT authentication in php.ini.<br />
You can do this in duing install if you select advanced options.<br />
If it's already installed you will have to use the SQL management Studio (properties-&gt;securety).<br />
<br />
At first the php_mssql.dll didn't load properly (wan't showing up under phpinfo()) and gave no error message at startup, the cause of this was the ntwdblib.dll that came with php (273KB) replacing it with the one that came with MS SQL 2005 (269KB) fixed the issuse, incase you haven't installed MS SQL on your machine you can also find it on the net.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69755""></a>
  <div class="note">
   <strong class="user">php at scrunch dot net</strong>
   <a href="#69755" class="date">19-Sep-2006 06:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With WinXP client, connecting to SQL Server 2005, via PHP on the command line (CLI).<br />
<br />
If the serverr was installed with support for multiple instances, you can not connect to it, even when attempting to connect to the default instance.<br />
<br />
Replace the ntwdblib.dll (7.00.839) provided by PHP with the one from SQL Server 2000 (8.00.194).<br />
<br />
Otherwise you will see this message, which is not very helpful:<br />
Warning: mssql_connect(): Unable to connect to server: ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66438""></a>
  <div class="note">
   <strong class="user">Bart</strong>
   <a href="#66438" class="date">22-May-2006 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another helpful hint in regards to SQL Server 2005 Express:<br />
<br />
Make sure your SQL Server is set to&nbsp; "SQL Server and Windows Authentication mode". By default it is NOT.<br />
<br />
1) Open "SQL Server Management Studio Express"<br />
2) Right-click server ("machinename\sqlexpress") and select "Properties".<br />
3) Select "Security"<br />
4) Select "SQL Server and Windows Authentication mode"<br />
5) Restart SQL Server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66355""></a>
  <div class="note">
   <strong class="user">phil at hilands dot c-spam-om</strong>
   <a href="#66355" class="date">19-May-2006 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mssql.datetimeconvert<br />
<br />
using freebsd and freetds I ran into the dates month being rolled back<br />
01 jan would be 00<br />
12 dec would be 11 nov<br />
<br />
removed<br />
ini_set('mssql.datetimeconvert',false);<br />
default setting is to 1 or true on the servers config<br />
and the date issue I ran into was resolved<br />
<br />
I don't know how the mssql.datetimeconvert setting works but if you're getting a roll back in dates might be worth making sure its on.<br />
<br />
using ini_get when dealing with scripts that like to modify ini settings will save a headache if you use phpinfo() like me<br />
<br />
*side note with the same settings in freetds php apache etc on a debian load I didn't have this issue even with mssql.datetimeconvert off</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62513""></a>
  <div class="note">
   <strong class="user">thnkloud9 at aol dot com</strong>
   <a href="#62513" class="date">02-Mar-2006 10:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had major latency problems with DB connections using php_mssql.dll without the client tools.&nbsp; I found that by default it was using TCP/IP as the default connection method.&nbsp;&nbsp; Installing the SQL Server client tools and using the Client Network Utility to change my settings to use named pipes resolved this issue.&nbsp; You can use the Client Utility to set up a named pipes server alias and reference that in your connect string.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57520""></a>
  <div class="note">
   <strong class="user">erwin_nospam_moller at xs4all dot nl</strong>
   <a href="#57520" class="date">06-Oct-2005 01:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
php5isapi / w2000 / ISS5<br />
<br />
If you use the above configuration (isapi) and follow the suggestion to deselect 'cache isapi application' to avoid 100% processor usage, you might end up with an oocasional error:<br />
<br />
The remote procedure call failed and did not execute. <br />
<br />
It happened to me every third visit to the same page.<br />
RE-enabling caching resolved the issue.<br />
<br />
M$ has an article about this in their knowledgebase, stating that this option should always be selected and is only there for developmentpurposes. (undocumented feature. :P)<br />
<br />
Deselecting this option forces IIS to reload ALL relevant dll's every time a request is received in memory, also VB/ASP.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56004""></a>
  <div class="note">
   <strong class="user">Erick Robertson</strong>
   <a href="#56004" class="date">20-Aug-2005 03:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some helpful functions.&nbsp; Pretty simple, but very useful.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">mssql_begin_transaction</span><span class="keyword">() {
<br />
&nbsp; </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"BEGIN TRANSACTION"</span><span class="keyword">);
<br />
}
<br />

<br />
function </span><span class="default">mssql_commit</span><span class="keyword">() {
<br />
&nbsp; </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"COMMIT"</span><span class="keyword">);
<br />
}
<br />

<br />
function </span><span class="default">mssql_rollback</span><span class="keyword">() {
<br />
&nbsp; </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"ROLLBACK"</span><span class="keyword">);
<br />
}
<br />

<br />
function </span><span class="default">mssql_insert_id</span><span class="keyword">() {
<br />
&nbsp; </span><span class="default">$id </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />

<br />
&nbsp; </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">mssql_query</span><span class="keyword">(</span><span class="string">"SELECT @@identity AS id"</span><span class="keyword">);
<br />
&nbsp; if (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mssql_fetch_row</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">)) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$id </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);
<br />
&nbsp; }
<br />
&nbsp; </span><span class="default">mssql_free_result</span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">);
<br />

<br />
&nbsp; return </span><span class="default">$id</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55679""></a>
  <div class="note">
   <strong class="user">vangoethem at hotmail.com</strong>
   <a href="#55679" class="date">10-Aug-2005 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had problems related to VARCHAR limitation to 255 characters (INSERT/UPDATE works, SELECT was truncated) using freetds driver (Linux platform).<br />
<br />
By upgrading the TDS protocol to 8.0 (see freetds config file), I fixed the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54201""></a>
  <div class="note">
   <strong class="user">hbzxc at 126 dot com</strong>
   <a href="#54201" class="date">27-Jun-2005 11:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am trying to connect to SQL Server 2000 from PHP<br />
I bumped to following warning:<br />
Warning: mssql_connect(): Unable to connect to server: SERVER\Portal<br />
....... on line 5<br />
<br />
on line 5 there is:<br />
$db_connect = mssql_connect('SERVER\Portal', 'sa', 'my_passwd');<br />
<br />
I did the following<br />
1.enabled php_mssql.dll extension in PHP.ini<br />
2.every dll is in proper place(System32 or PHP folder),including ntwdblib.dll<br />
<br />
I search lots of profile throught web ,but no one give me proper answer to resolve it.<br />
<br />
after a few hour ,I found the problem was caused by<br />
ntwdblib.dll ,which version is 7.00.839 ,when I replaced old ntwdblib.dll with the new ntwdblib.dll ,which version is 8.00.194 ,all problem are solved.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52811""></a>
  <div class="note">
   <strong class="user">cmeerbeek[at]ymor[.]nl</strong>
   <a href="#52811" class="date">13-May-2005 10:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
We had some, read A LOT, of problems with MSSQL under Windows 2003. <br />
We had 2 the same windows, php, php-ini, everything machines but only one could connect. Unable to connect was the error message.<br />
<br />
Finnaly we checked the version of ntwdblib.dll and the one distributed with PHP was 7.00.... and the version of the one on the SQL Server install was 8.00.... so we copied this one in the php and apache dir and it worked.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51379""></a>
  <div class="note">
   <strong class="user">boonkit at gmail dot com</strong>
   <a href="#51379" class="date">29-Mar-2005 10:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are having problems with freeTDS when trying to get access to unicode data from mssql, set 'tds version =7.0' at etc/freetds.conf</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51208""></a>
  <div class="note">
   <strong class="user">tony</strong>
   <a href="#51208" class="date">23-Mar-2005 04:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With PHP 5 on a Windows 2000/IIS platform:<br />
<br />
I have integrated authentication enabled in IIS.&nbsp; I kept getting CGI timeouts on PHP pages for everyone but local administrators of the box.&nbsp; The event log showed that PHP could not load php_mssql.dll, php_oci8.dll, and php_oracle.dll - 'Access Denied.'&nbsp; <br />
<br />
These extensions were executable by everyone, but the DLLs they depend on were not.&nbsp; Had to add exec permissions for everyone to c:\winnt\system32\ntwdblib.dll as well as the oracle bin directory.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49519""></a>
  <div class="note">
   <strong class="user">marcel at fluidleb dot com</strong>
   <a href="#49519" class="date">31-Jan-2005 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've spent the last three days wild guessing why I could not connect to MS SQLServer 2000 and so I hope this might help someone else. Microsoft has purposefully closed the 1433 tcp port and others (maybe only to external ips) of the server. You can easily check if this is the case by looking at the Event Monitor. You should see an error produced by MSSQL SERVER/MSDE that basically says what I said. It suggests downloading and installing a security patch to open up the ports (but doesn't even say which update - remember this is Microsoft). <br />
<br />
Do download Service Pack 3a (SP3a). It does indeed fix the problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49364""></a>
  <div class="note">
   <strong class="user">Salman Majid</strong>
   <a href="#49364" class="date">25-Jan-2005 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having problem in connecting Ms-SQL server with mssql_connect(srvr,uid,pwd).&nbsp; I used odbc functions to connect to Ms-SQL server. I was on a work station and server was not accessible for unknow reasons. mssql functions did not work there so I had to use odbc.&nbsp; I simply created a DSN to my Database and replaced it with "server_name". i.e. 
<br />

<br />
<span class="default">&lt;?php mssql_connect</span><span class="keyword">(</span><span class="default">dsn</span><span class="keyword">,</span><span class="default">uid</span><span class="keyword">,</span><span class="default">pwd</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
it worked well</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48341""></a>
  <div class="note">
   <strong class="user">hbinduni at hslprpol dot com</strong>
   <a href="#48341" class="date">20-Dec-2004 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i found <a href="http://odbtp.sourceforge.net working fast, easy to use and to configure, and yes, it" rel="nofollow" target="_blank">http://odbtp.sourceforge.net working fast, easy to use and to configure, and yes, it</a>'s multiplatform.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47527""></a>
  <div class="note">
   <strong class="user">marc at NOSPAM dot durdin dot net</strong>
   <a href="#47527" class="date">19-Nov-2004 05:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Buried away in the mssql_field_length documentation is an important limitation that it is certainly worth knowing about *BEFORE* you do any database design:<br />
<br />
Note to Win32 Users: Due to a limitation in the underlying API used by PHP (MS DbLib C API), the length of VARCHAR fields is limited to 255. If you need to store more data, use a TEXT field instead. <br />
<br />
SQL Server natively supports VARCHAR up to 8000 characters.&nbsp; Note that TEXT fields have substantially poorer performance (and are much more limited) than VARCHAR so you may want to design your databases accordingly...<br />
<br />
You can also work around this limitation with the following:<br />
<br />
&nbsp;&nbsp; -- for example, with MyVarCharField VARCHAR(1000)<br />
&nbsp;&nbsp; SELECT CAST(MyVarCharField AS TEXT) FROM MyTable</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46946""></a>
  <div class="note">
   <strong class="user">ASWL</strong>
   <a href="#46946" class="date">28-Oct-2004 02:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This note is for mssql under a Windows environment.<br />
<br />
If you are having problems connecting to MS SQL using the mssql PHP extension then I would suggest that you get a copy of the latest NTWDBLIB.DLL. Copy it to the directory where PHP expects to find it's dll files.<br />
<br />
I had an issuse whereby I was unable to connect to a MS SQL Cluster and this resolved my problem.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46823""></a>
  <div class="note">
   <strong class="user">Dimitri Tarassenko (mitka at mitka.us)</strong>
   <a href="#46823" class="date">24-Oct-2004 09:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To enable MS SQL functions in PHP on Fedora Core or RHEL3 without recompiling PHP and replacing the distribution PHP packages, download and install php-mssql and freetds RPMS from <br />
<br />
<a href="http://phprpms.sf.net/mssql" rel="nofollow" target="_blank">http://phprpms.sf.net/mssql</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46224""></a>
  <div class="note">
   <strong class="user">mworku at yahoo dot com</strong>
   <a href="#46224" class="date">03-Oct-2004 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to utilize the freetds.conf file db parameters within
<br />
mssql_connect() function 
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; putenv</span><span class="keyword">(</span><span class="string">'FREETDSCONF=/etc/freetds.conf'</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/*
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; mssql_connect('MSSQL_8.0' , 'user' , 'pwd'); 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ....
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; .... 
<br />
&nbsp;&nbsp;&nbsp; */
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
FreeTDS conf file
<br />

<br />
&nbsp;[MSSQL_8.0]
<br />
&nbsp;&nbsp;&nbsp; host = 10.254.254.10
<br />
&nbsp;&nbsp;&nbsp; port = 1433
<br />
&nbsp;&nbsp;&nbsp; tds version = 8.0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43143""></a>
  <div class="note">
   <strong class="user">marcos1979ar at yahoo dot com dot ar</strong>
   <a href="#43143" class="date">11-Jun-2004 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Red Hat 9.0&nbsp;&nbsp; Freetds 0.62.3&nbsp;&nbsp; Apache 2.0.49&nbsp;&nbsp; PHP 5.0.ORC3<br />
<br />
Instucction, that premit connect a server Linux with a server Windows 2000 Server with SQL Server. <br />
<br />
INSTALLING FREETDS<br />
&nbsp;<br />
1-.&nbsp; Download freetds -&gt; www.freetds.org<br />
2-.&nbsp; tar -zxvf freetds-stable-tgz<br />
3-.&nbsp; cd freetds-0.62.3<br />
4-.&nbsp; ./configure --prefix=/usr/local/freetds --with-tdsver=8.0 --enable-msdblib --enable-dbmfix --with-gnu-ld<br />
<br />
Note:&nbsp; tdsver=8.0 if you use SQL 2000, tdsver=7.0 if you use SQL 7.0<br />
<br />
5-.&nbsp; make<br />
6-.&nbsp; make install<br />
7-.&nbsp; /usr/local/freetds/bin/tsql -S &lt;ip of the server&gt; -U &lt;User SQL&gt;<br />
<br />
Note: For default User SQL is&nbsp; &nbsp; sa&nbsp; &nbsp;&nbsp; and the it have not password<br />
For example: /usr/local/freetds/bin/tsql -S 198.168.100.2 -U sa<br />
<br />
8-.&nbsp; Add the next text in freetds.conf ( /usr/local/freetds/etc )<br />
[TDS]<br />
host = &lt;ip of the Server with Sql&gt;<br />
port = 1433<br />
tds version = 8.0<br />
<br />
Note: If you use SQL 2000 then tds version = 8.0<br />
if you use SQL 7.0 then tds version = 7.0<br />
<br />
9-.&nbsp; Add the next text in the file /etc/ld.so.conf<br />
/usr/local/freetds/lib<br />
<br />
INSTALLING&nbsp; APACHE<br />
<br />
1-.&nbsp; Download apache&nbsp; www.apache.org<br />
2-.&nbsp; tar -zxvf httpd-2.0.49.tar.gz<br />
3-.&nbsp; cd httpd-2.0.49<br />
4-.&nbsp; ./configure --prefix=/etc/httpd --enable-so<br />
5-.&nbsp; make<br />
6-.&nbsp; make install<br />
7-.&nbsp; Configure the file&nbsp; -&gt; httpd.conf ( /etc/httpd/conf/httpd.conf )<br />
8-.&nbsp; Probe the apache: /etc/httpd/bin/apachectl start<br />
/etc/httpd/bin/apachectl stop<br />
<br />
INSTALLING&nbsp; PHP<br />
<br />
1-.&nbsp; Download the PHP in this site (www.php.net)<br />
2-.&nbsp; tar -zxvf php-5.0-ORC3.tar.gz<br />
3-.&nbsp; cd php-5.0-ORC3<br />
4-.&nbsp; ./configure --with-apxs2=/etc/httpd/bin/apxs --enable-versioning --with-mssql=/usr/local/freetds --disable-libxml<br />
5-.&nbsp; make<br />
6-.&nbsp; make install<br />
7-.&nbsp; cp php.ini-DIST /usr/local/lib<br />
8-.&nbsp; Add the next line in /etc/httpd/conf/httpd.conf<br />
AddType application/x-httpd-php .php<br />
<br />
TESTING<br />
<br />
&lt;html&gt;<br />
&lt;body&gt;<br />
<span class="default">&lt;?php<br />
$con </span><span class="keyword">= </span><span class="default">mssql_connect </span><span class="keyword">(</span><span class="string">"&lt;ip of the server SQL&gt;"</span><span class="keyword">, </span><span class="string">"sa"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">);<br />
</span><span class="default">mssql_select_db </span><span class="keyword">(</span><span class="string">"&lt;Data Base&gt;"</span><span class="keyword">, </span><span class="default">$con</span><span class="keyword">);<br />
</span><span class="default">$sql</span><span class="keyword">= </span><span class="string">"SELECT * FROM &lt;Table&gt;"</span><span class="keyword">;<br />
</span><span class="default">$rs</span><span class="keyword">= </span><span class="default">mssql_query </span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">, </span><span class="default">$con</span><span class="keyword">);<br />
echo </span><span class="string">"The field number one is: "</span><span class="keyword">;<br />
echo </span><span class="default">mssql_result </span><span class="keyword">(</span><span class="default">$rs</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">mssql_close </span><span class="keyword">(</span><span class="default">$con</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>&lt;/body&gt;<br />
&lt;/html&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42780""></a>
  <div class="note">
   <strong class="user">Asad Moin</strong>
   <a href="#42780" class="date">29-May-2004 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I took the following steps to make PHP talk to SQL2000:<br />
<br />
- Copy ntwdblib.dll file from your SQL server's&nbsp; \winnt\system32 folder to the \winnt\system32 folder on the PHP box.<br />
<br />
- Copy the php_mssql.dll from the 'dlls/' directory in distribution package to your windows/system (Win9.x) or winnt/system32 (WinNT, Win2000, XP) directory.<br />
<br />
- Add or uncomment the following line under Windows Extentions in your php.ini file (\winnt\php.ini): extension=php_mssql.dll<br />
<br />
Hope that helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42696""></a>
  <div class="note">
   <strong class="user">andrew at power-grid dot com</strong>
   <a href="#42696" class="date">26-May-2004 09:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Ok, this took me a few days to get right but for those of you out there having a hard time with getting PHP to talk to SQL 2000 this is for you!&nbsp; Personally for me the mssql plugin barely worked with sql 2000 and was VERY slow, here's your solution and also some good code to connect securely and quickly through ADO. I was having the worst time getting ADO to work as well, most sites do the driver part a different way.. for me the code below is the only thing that worked.
<br />

<br />
<span class="default">&lt;?php
<br />
$db </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">); 
<br />
</span><span class="default">$dsn </span><span class="keyword">= </span><span class="string">"DRIVER={SQL Server}; SERVER={SERVER};UID={USER};PWD={PASS}; DATABASE={DB}"</span><span class="keyword">; 
<br />
</span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$dsn</span><span class="keyword">);
<br />
</span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$db</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">(</span><span class="string">"SELECT * FROM table"</span><span class="keyword">);
<br />

<br />
while (!</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'column'</span><span class="keyword">]-&gt;</span><span class="default">Value</span><span class="keyword">.</span><span class="string">"&lt;BR&gt;"</span><span class="keyword">; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">(); 
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42694""></a>
  <div class="note">
   <strong class="user">Arthur W Rudd</strong>
   <a href="#42694" class="date">26-May-2004 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'm running apache 1.3.26 and php 4.3.6 on a linux server (debian), and connecting to SQL Server 2000 via php4-mssql and Freetds.<br />
<br />
I managed to get a connection to the SQL server, but found that when I used the function mssql_query() to pass in a Select statement containing datetime columns, I would get the following message in Internet Explorer - "The page cannot be displayed".&nbsp; When I removed the datetime column from the query, it worked fine, and returned a resultset.<br />
Looked in the apache error.log file, and found the error "child pid xxxxxx exit signal segmentation fault".<br />
<br />
After a lot of searching on the internet I stumbled upon an entry which was missing from my php.ini.&nbsp; I added the line "mssql.datetimeconvert = Off" to the MSSQL section of pphp.ini, restarted Apache, and the problem went away.&nbsp; Now I can select dates in SQL queries</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42157""></a>
  <div class="note">
   <strong class="user">jasenko at get2net dot dk</strong>
   <a href="#42157" class="date">05-May-2004 08:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get a crash trying to get currency from database with smallmoney datatype and big value (in my case it was 15000..), change datatype to money instead. The error is gone.<br />
<br />
I'm using php 4.2.3 and MSSQL 7.0 on windows.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41974""></a>
  <div class="note">
   <strong class="user">andrej at dairyweb dot com dot au</strong>
   <a href="#41974" class="date">28-Apr-2004 10:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you are having problems with freeTDS, or like me you are trying to get access to unicode data from mssql.<br />
<br />
try <a href="http://odbtp.sourceforge.net it is cross platform and (reportedly" rel="nofollow" target="_blank">http://odbtp.sourceforge.net it is cross platform and (reportedly</a>) faster than freeTDS. it is very stable and easy to configure.<br />
<br />
i was originally trying to solve an error message of "Unicode data in Unicode-only collation or ntext data cannot be sent to clients using DB-Library (such as ISQL) or ODBC version 3.7 or earlier" and found this solution.<br />
<br />
hope it helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41973""></a>
  <div class="note">
   <strong class="user">elmer at web-axis dot net</strong>
   <a href="#41973" class="date">28-Apr-2004 06:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's something that could save you 2-3 days research trying to figure out:<br />
<br />
<span class="default">&lt;?php<br />
putenv</span><span class="keyword">(</span><span class="string">'TDSDUMP=/tmp/tds.log'</span><span class="keyword">);<br />
</span><span class="default">putenv</span><span class="keyword">(</span><span class="string">'SYBASE=/usr/lib/freetds'</span><span class="keyword">);<br />
</span><span class="default">putenv</span><span class="keyword">(</span><span class="string">'TDSVER=70'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
If you have problems getting the mssql functions to work try these varibles. MSSQL/PHP has problems dealing with different tds versions. 7.0 seems to work well with our server version, maybe a different version would work better with yours.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41949""></a>
  <div class="note">
   <strong class="user">pmfa at versenet dot com</strong>
   <a href="#41949" class="date">27-Apr-2004 06:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're going to use freeTDS just to access mssql databases, supply the "--enable-msdblib" switch to the freeTDS configure script when building the library. This will fix some obscure problems, like the month in a date not being displayed correctly, more information in <a href="http://www.freetds.org/userguide/config.htm." rel="nofollow" target="_blank">http://www.freetds.org/userguide/config.htm.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41674""></a>
  <div class="note">
   <strong class="user">gentiboard2002 at yahoo dot de</strong>
   <a href="#41674" class="date">19-Apr-2004 03:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
there's no documentation of the php.ini option mssql.secure_connection.<br />
<br />
so i have here a MS SQL 2000 Server with Windows Authentication and a Windows 2003 Server with IIS 6. So it is clear that i cannot use the usual handling of a mssql_connect. <br />
I turned the mssql.secure_connection on.<br />
I let the Windows IIS to run under an Service Account(normal user account without any special rights) in a Windows Domain, so i do have a authenticated connection to the SQL Server...<br />
<br />
Everything works fine without any rewrite of the code...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40922""></a>
  <div class="note">
   
   <a href="#40922" class="date">19-Mar-2004 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note: DBLib is obsolete and only supports SQL Server 4.x, 6.5, 7.0 and 8.x.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38175""></a>
  <div class="note">
   <strong class="user">jholland at cs dot selu dot edu</strong>
   <a href="#38175" class="date">10-Dec-2003 10:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To enable mssql in php 4.3.3 and above on linux/unix boxes, you must put this line in php.ini<br />
<br />
extension=mssql.so</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
