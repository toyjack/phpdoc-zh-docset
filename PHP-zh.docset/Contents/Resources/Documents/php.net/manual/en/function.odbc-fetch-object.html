<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Fetch a result row as an object</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.odbc-fetch-into.html">? odbc_fetch_into</a></li>
      <li style="float: right;"><a href="function.odbc-fetch-row.html">odbc_fetch_row ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.uodbc.html">ODBC 函数</a></li>
    <li>Fetch a result row as an object</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.odbc-fetch-object" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_fetch_object</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">odbc_fetch_object</span> &mdash; <span class="dc-title">Fetch a result row as an object</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.odbc-fetch-object-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">object</span> <span class="methodname"><strong>odbc_fetch_object</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$rownumber</code></span>
  ] )</div>

  <p class="para rdfs-comment">
   Fetch an <span class="type"><a href="language.types.object.html" class="type object">object</a></span> from an ODBC query.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.odbc-fetch-object-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">result</code></dt>

     <dd>

      <p class="para">
       The result resource from <span class="function"><a href="function.odbc-exec.html" class="function">odbc_exec()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">rownumber</code></dt>

     <dd>

      <p class="para">
       Optionally choose which row number to retrieve.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-fetch-object-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an object that corresponds to the fetched row, or <strong><code>FALSE</code></strong> if there 
   are no more rows.
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.odbc-fetch-object-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    This function exists when compiled with DBMaker, IBM DB2 or UnixODBC support.
   </span>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.odbc-fetch-object-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.odbc-fetch-row.html" class="function" rel="rdfs-seeAlso">odbc_fetch_row()</a> - Fetch a row</span></li>
    <li class="member"><span class="function"><a href="function.odbc-fetch-array.html" class="function" rel="rdfs-seeAlso">odbc_fetch_array()</a> - Fetch a result row as an associative array</span></li>
    <li class="member"><span class="function"><a href="function.odbc-num-rows.html" class="function" rel="rdfs-seeAlso">odbc_num_rows()</a> - Number of rows in a result</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="51153""></a>
  <div class="note">
   <strong class="user">philip</strong>
   <a href="#51153" class="date">22-Mar-2005 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function requires one of the following to exist: Windows, DB2, or UNIXODBC.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36566""></a>
  <div class="note">
   <strong class="user">thorsten at rinne dot info</strong>
   <a href="#36566" class="date">15-Oct-2003 11:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
odbc_fetch_object() works nice with PHP 4.3.3 under W2K with IBM DB2 V.7.2 and V.8.1:<br />
<br />
<span class="default">&lt;?php<br />
$conn </span><span class="keyword">= </span><span class="default">odbc_connect</span><span class="keyword">(</span><span class="default">$db_name</span><span class="keyword">, </span><span class="default">$username</span><span class="keyword">, </span><span class="default">$password</span><span class="keyword">) or die(</span><span class="default">odbc_error_msg</span><span class="keyword">()); <br />
</span><span class="default">$sql </span><span class="keyword">= </span><span class="string">"SELECT * FROM TABLE"</span><span class="keyword">; <br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">$sql</span><span class="keyword">);<br />
while (</span><span class="default">$rows </span><span class="keyword">= </span><span class="default">odbc_fetch_object</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)) { <br />
&nbsp;&nbsp;&nbsp; print </span><span class="default">$rows</span><span class="keyword">-&gt;</span><span class="default">COLUMNNAME</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">odbc_close</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">); <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="31699""></a>
  <div class="note">
   <strong class="user">j dot a dot z at bluewin dot ch</strong>
   <a href="#31699" class="date">30-Apr-2003 10:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
hey "general at maccrafters dot com"<br />
<br />
thank you very much for your code. it saved me time!<br />
however i extended it a bit!<br />
---------------------------------------------<br />
&nbsp;&nbsp;&nbsp; function __odbc_fetch_object($res)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( function_exists("odbc_fetch_object") )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return odbc_fetch_object($res);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $rs = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $rs_obj = false;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( odbc_fetch_into($res, &amp;$rs) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( $rs as $key=&gt;$value )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $fkey = odbc_field_name($res, $key+1);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $rs_obj-&gt;$fkey = trim($value);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $rs_obj;<br />
&nbsp;&nbsp;&nbsp; }<br />
---------------------------------------------<br />
cheers, jaz</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30221""></a>
  <div class="note">
   <strong class="user">h4 at locked dot org</strong>
   <a href="#30221" class="date">11-Mar-2003 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
my 2 cents:<br />
<br />
function data($res) {<br />
&nbsp;&nbsp;&nbsp; $obj = new stdClass();<br />
&nbsp;&nbsp;&nbsp; $data_array = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (!odbc_fetch_into($res, $data_array)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return 0;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $num_fields = odbc_num_fields($res);<br />
<br />
&nbsp;&nbsp;&nbsp; for ($i = 0;$i &lt; $num_fields; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $name = odbc_field_name($res, $i + 1);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!$name) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $obj-&gt;{$name} = $data_array[$i];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return $obj;<br />
}<br />
<br />
works fine for me (PHP 4.3.1)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28777""></a>
  <div class="note">
   <strong class="user">charlesk at netgaintechnology dot com</strong>
   <a href="#28777" class="date">23-Jan-2003 07:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I asked one of the developers to enable this function in the CVS.&nbsp; I tried it and it worked.&nbsp; I didnt do anything special.&nbsp; I was using a Microsoft Access ODBC driver that came with my Windows XP Pro Install. <br />
<br />
I was using the Apache web server.<br />
<br />
Charles</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26577""></a>
  <div class="note">
   <strong class="user">general at maccrafters dot com</strong>
   <a href="#26577" class="date">05-Nov-2002 08:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a bit of code I came up with tha behaves just like mysql_fetch_object()<br />
<br />
&nbsp;&nbsp;&nbsp; function odbc_fetch_object($result)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $rs=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(odbc_fetch_into($result,&amp;$rs))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach($rs as $key=&gt;$value)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; $fkey=strtoupper(odbc_field_name($result,$key+1));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $rs_obj-&gt;$fkey = trim($value);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return($rs_obj);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
Special thanks to previous posters for giving me a starting point for this code.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24933""></a>
  <div class="note">
   <strong class="user">kynaston at yahoo dot com</strong>
   <a href="#24933" class="date">05-Sep-2002 02:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're using Masoud's code in PHP4.2+, change the fifth line to:<br />
<br />
odbc_fetch_into($result,&amp;$rs);<br />
<br />
(the order of arguments have changed)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20987""></a>
  <div class="note">
   <strong class="user">Marcus dot Karlsson at usa dot net</strong>
   <a href="#20987" class="date">24-Apr-2002 07:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It' possible to get both odbc_fetch_object() and odbc_fetch_array() to work just by removing #ifdef HAVE_DBMAKER/#endif in php_odbc.h line 216 (219) and the same in php_odbc.c line 87 (90) and 1229 (1380).<br />
<br />
I've done this sucessfully in the PHP 4.2.0 release using ODBC towards a MySQL database.<br />
<br />
I really can't understand why the #ifdef is there from the beginning, but they do have their reasons.<br />
<br />
These were the files i "patched"<br />
/* $Id: php_odbc.c,v 1.120.2.1 2002/04/08 22:21:30 sniper Exp $ */<br />
/* $Id: php_odbc.h,v 1.45.2.1 2002/03/12 02:27:47 sniper Exp $ */</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19308""></a>
  <div class="note">
   <strong class="user">masuod_a at hotmail dot com</strong>
   <a href="#19308" class="date">22-Feb-2002 09:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function not availible in PHP 4.1.1 , you can try this : <br />
<br />
if (function_exists(odbc_fetch_object))<br />
&nbsp;return;<br />
function odbc_fetch_object($result, $rownumber=1) {<br />
&nbsp;$rs=array();<br />
&nbsp;odbc_fetch_into($result, $rownumber,$rs);<br />
&nbsp;foreach ($rs as $key =&gt; $value) {<br />
&nbsp;&nbsp; $fkey=strtolower(odbc_field_name($result, $key+1));&nbsp; <br />
&nbsp;&nbsp; $rs_obj-&gt;$fkey = $value;<br />
&nbsp;}<br />
&nbsp;return $rs_obj;<br />
}<br />
if you wanna use this function in a loop&nbsp; you must set rownumber parameter<br />
you can't use this function like :<br />
&nbsp;while ($myobj=odbc_fetch_object($res)) {<br />
&nbsp;....<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
