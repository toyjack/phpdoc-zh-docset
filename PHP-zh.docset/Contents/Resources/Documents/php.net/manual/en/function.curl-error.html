<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>返回一个保护当前会话最近一次错误的字符串</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.curl-errno.html">? curl_errno</a></li>
      <li style="float: right;"><a href="function.curl-escape.html">curl_escape ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.curl.html">cURL 函数</a></li>
    <li>返回一个保护当前会话最近一次错误的字符串</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.curl-error" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">curl_error</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.3, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">curl_error</span> &mdash; <span class="dc-title">返回一个保护当前会话最近一次错误的字符串</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.curl-error-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>curl_error</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$ch</code></span>
   )</div>

  <p class="para rdfs-comment">
   返回一条最近一次cURL操作明确的文本的错误信息。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.curl-error-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">ch</code>
</dt>
<dd>
<p class="para">由 <span class="function"><a href="function.curl-init.html" class="function">curl_init()</a></span> 返回的 cURL 句柄。</p></dd>

   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.curl-error-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回错误信息或 <em>&#039;&#039;</em> (空字符串) 如果没有任何错误发生。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.curl-error-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-4638">
    <p><strong>Example #1 <span class="function"><strong>curl_error()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;创建一个指向一个不存在的位置的cURL句柄<br /></span><span style="color: #0000BB">$ch&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_init</span><span style="color: #007700">(</span><span style="color: #DD0000">'http://404.php.net/'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_RETURNTRANSFER</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br />if(</span><span style="color: #0000BB">curl_exec</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">)&nbsp;===&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Curl&nbsp;error:&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">curl_error</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br />}<br />else<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'操作完成没有任何错误'</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;关闭句柄<br /></span><span style="color: #0000BB">curl_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.curl-error-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.curl-errno.html" class="function" rel="rdfs-seeAlso">curl_errno()</a> - 返回最后一次的错误号</span></li>
    <li class="member"><a href="http://curl.haxx.se/libcurl/c/libcurl-errors.html" class="link external" title="Link : http://curl.haxx.se/libcurl/c/libcurl-errors.html">&raquo;&nbsp;Curl error codes</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="118980""></a>
  <div class="note">
   <strong class="user">Additional information</strong>
   <a href="#118980" class="date">11-Mar-2016 08:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that periodically the developers go through the notes and may incorporate information from them into the documentation. This means that any note submitted here becomes the property of the PHP Documentation Group and will be available under the same license as the documentation.<br />
<br />
Your IP Address will be logged with the submitted note and made public on the PHP manual user notes mailing list. The IP address is logged as part of the notes moderation process, and won't be shown within the PHP manual itself.<br />
<br />
It may take up to an hour for your note to appear in the documentation.<br />
<br />
The SPAM challenge requires numbers to written out in English, so, an appropriate answer may be nine but not 9.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112101""></a>
  <div class="note">
   <strong class="user">patrick at ibuildings dot nl</strong>
   <a href="#112101" class="date">03-May-2013 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to fetch the error message, make sure you fetch it before you close the current cURL session or the error message will be reset to an empty string.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90403""></a>
  <div class="note">
   <strong class="user">mail at erwindoornbos dot nl</strong>
   <a href="#90403" class="date">20-Apr-2009 09:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
While working with curl i got the following error: "empty reply from server".<br />
<br />
Searching Google gave no solutions. So i just tried to replace the spaces from the url to %20 and it worked!<br />
<br />
Hope this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87212""></a>
  <div class="note">
   <strong class="user">paul at paulmcgarry dot com</strong>
   <a href="#87212" class="date">25-Nov-2008 02:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For a 404 response to actually trigger an error as the example seems to be trying to demonstrate the following option should be set:<br />
<br />
curl_setopt($ch,CURLOPT_FAILONERROR,true);<br />
<br />
As per <a href="http://curl.haxx.se/libcurl/c/libcurl-errors.html" rel="nofollow" target="_blank">http://curl.haxx.se/libcurl/c/libcurl-errors.html</a><br />
<br />
CURLE_HTTP_RETURNED_ERROR (22)<br />
This is returned if CURLOPT_FAILONERROR is set TRUE and the HTTP server returns an error code that is &gt;= 400. (This error code was formerly known as CURLE_HTTP_NOT_FOUND.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
