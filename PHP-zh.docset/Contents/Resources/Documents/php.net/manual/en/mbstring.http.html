<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>HTTP 输入和输出</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mbstring.ja-basic.html">? 日文字符多字节编码基础</a></li>
      <li style="float: right;"><a href="mbstring.supported-encodings.html">支持的字符编码 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.mbstring.html">多字节字符串</a></li>
    <li>HTTP 输入和输出</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mbstring.http" class="chapter">
 <h1>HTTP 输入和输出</h1>

 <p class="para">
  HTTP 输入/输出字符编码转换同样也适用于二进制数据。
  如果 HTTP 输入/输出用到了二进制数据，用户应当控制字符的编码转换。
 </p>
 <blockquote class="note"><p><strong class="note">Note</strong>: 
  <p class="para">
   在 PHP 4.3.2 或更早的版本里该功能存在一个限制：当 <em>form</em> 表单元素的 <em>enctype</em> 属性设置为 <em>multipart/form-data</em> 时，<em>mbstring</em>不会对 POST 数据执行字符编码的转换。
   所以在这种情况下，必要时需要你自己转换传入的数据。
  </p>
  <p class="para">
   自 PHP 4.3.3 起，如果 HTML 表单的 <em>enctype</em> 属性设置为 <em>multipart/form-data</em>，并且 <var class="filename">php.ini</var> 里的 <em>mbstring.encoding_translation</em> 设置为 On，
   POST 的变量以及上传文件的名称也将会被转换到内部字符编码。
   不过，转换不会应用于查询（query）的键。
  </p>
 </p></blockquote>
 <p class="para">
  <ul class="itemizedlist">
   <li class="listitem">
    <span class="simpara">
     HTTP 输入
    </span>
    <p class="para"> 
     在 PHP 脚本里无法控制 HTTP 输入字符的转换。
     要禁用 HTTP 输入字符的转换，必须要在 <var class="filename">php.ini</var> 里设置。
     <div class="example" id="example-2896">
      <p><strong>Example #1 
       在 <var class="filename">php.ini</var> 中禁用 HTTP 输入转换
      </strong></p>
      <div class="example-contents">
<div class="php.inicode"><pre class="php.inicode">;; 禁用 HTTP 输入转换
mbstring.http_input = pass
;;禁用 HTTP 输入转换 （PHP 4.3.0 或更高版本）
mbstring.encoding_translation = Off</pre>
</div>
      </div>

     </div>
    </p>
    <p class="para">
     当 PHP 以 Apache 模块运行。这些设置还可以通过 <var class="filename">httpd.conf</var> 内每个虚拟主机（Virtual Host）指令或每个目录下的 <var class="filename">.htaccess</var> 来覆盖（override）。
     详情参见<a href="configuration.html" class="link">配置</a>这一节，以及 Apache 手册。
    </p>
   </li>
   <li class="listitem">
    <span class="simpara">
     HTTP 输出
    </span>
    <p class="para">
     输出字符编码转换的使用有几种方式。
     一种是使用 <var class="filename">php.ini</var>，另一种是使用 <span class="function"><a href="function.ob-start.html" class="function">ob_start()</a></span>，以 <span class="function"><a href="function.mb-output-handler.html" class="function">mb_output_handler()</a></span> 作为 <em>ob_start</em> 的回调函数。
    </p>
   </li>
  </ul>
 </p>
 <p class="para">
  <div class="example" id="example-2897">
   <p><strong>Example #2 <var class="filename">php.ini</var> 设置例子</strong></p>
   <div class="example-contents">
<div class="cdata"><pre>
;; 为所有 PHP 页面启用输出字符编码的转换

;; 启用输出缓冲
output_buffering    = On

;; 设置 mb_output_handler 来进行输出的转换
output_handler      = mb_output_handler
</pre></div>
   </div>

  </div>
 </p>
 <p class="para">
  <div class="example" id="example-2898">
   <p><strong>Example #3 脚本例子</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">//&nbsp;仅为此页面启用输出字符编码的转换<br /><br />//&nbsp;设置&nbsp;HTTP&nbsp;输出字符编码为&nbsp;SJIS<br /></span><span style="color: #0000BB">mb_http_output</span><span style="color: #007700">(</span><span style="color: #DD0000">'SJIS'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;开始缓冲并指定&nbsp;"mb_output_handler"&nbsp;为回调函数<br /></span><span style="color: #0000BB">ob_start</span><span style="color: #007700">(</span><span style="color: #DD0000">'mb_output_handler'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

  </div>
 </p>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
 <div class="note">There are no user contributed notes for this page.</div>
</div>
</div></div></body></html>
