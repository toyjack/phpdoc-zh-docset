<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Verifies that a password matches a hash</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.password-needs-rehash.html">? password_needs_rehash</a></li>
      <li style="float: right;"><a href="refs.database.html">数据库扩展 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.password.html">Password Hashing 函数</a></li>
    <li>Verifies that a password matches a hash</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.password-verify" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">password_verify</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.5.0)</p><p class="refpurpose"><span class="refname">password_verify</span> &mdash; <span class="dc-title">Verifies that a password matches a hash</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.password-verify-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">boolean</span> <span class="methodname"><strong>password_verify</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$password</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$hash</code></span>
   )</div>

  <p class="para rdfs-comment">
   Verifies that the given hash matches the given password.
  </p>
  <p class="para">
   Note that <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> returns the algorithm, cost and salt 
   as part of the returned hash. Therefore, all information that&#039;s needed to verify
   the hash is included in it. This allows the verify function to verify the hash
   without needing separate storage for the salt or algorithm information.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.password-verify-parameters">
  <h3 class="title">参数</h3>
  <dl>

   
    <dt>
<code class="parameter">password</code></dt>

    <dd>

     <p class="para">
      用户的密码。
     </p>
    </dd>

   
   
    <dt>
<code class="parameter">hash</code></dt>

    <dd>

     <p class="para">
      一个由 <span class="function"><a href="function.password-hash.html" class="function">password_hash()</a></span> 创建的散列值。
     </p>
    </dd>

   
  </dl>

 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.password-verify-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns <strong><code>TRUE</code></strong> if the password and hash match, or <strong><code>FALSE</code></strong> otherwise.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.password-verify-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-899">
    <p><strong>Example #1 <span class="function"><strong>password_verify()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;See&nbsp;the&nbsp;password_hash()&nbsp;example&nbsp;to&nbsp;see&nbsp;where&nbsp;this&nbsp;came&nbsp;from.<br /></span><span style="color: #0000BB">$hash&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'$2y$07$BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq'</span><span style="color: #007700">;<br /><br />if&nbsp;(</span><span style="color: #0000BB">password_verify</span><span style="color: #007700">(</span><span style="color: #DD0000">'rasmuslerdorf'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$hash</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Password&nbsp;is&nbsp;valid!'</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">'Invalid&nbsp;password.'</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Password is valid!
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.password-verify-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.password-hash.html" class="function" rel="rdfs-seeAlso">password_hash()</a> - Creates a password hash</span></li>
    <li class="member"><a href="https://github.com/ircmaxell/password_compat" class="link external" title="Link : https://github.com/ircmaxell/password_compat">&raquo;&nbsp;userland implementation</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115120""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#115120" class="date">29-May-2014 10:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get incorrect false responses from password_verify when manually including the hash variable (eg. for testing) and you know it should be correct, make sure you are enclosing the hash variable in single quotes (') and not double quotes (").
<br />

<br />
PHP parses anything that starts with a $ inside double quotes as a variable:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// this will result in 'Invalid Password' as the hash is parsed into 3 variables of
<br />
// $2y, $07 and $BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq
<br />
// due to it being enclosed inside double quotes
<br />
</span><span class="default">$hash </span><span class="keyword">= </span><span class="string">"$2y$07</span><span class="default">$BCryptRequires22Chrcte</span><span class="string">/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// this will result in 'Password is valid' as variables are not parsed inside single quotes
<br />
</span><span class="default">$hash </span><span class="keyword">= </span><span class="string">'$2y$07$BCryptRequires22Chrcte/VlQH0piJtjXl.0t1XkA8pw9dMXTpOq'</span><span class="keyword">;
<br />

<br />
if (</span><span class="default">password_verify</span><span class="keyword">(</span><span class="string">'rasmuslerdorf'</span><span class="keyword">, </span><span class="default">$hash</span><span class="keyword">)) {
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Password is valid!'</span><span class="keyword">;
<br />
} else {
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Invalid password.'</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113493""></a>
  <div class="note">
   <strong class="user">suit at rebell dot at</strong>
   <a href="#113493" class="date">19-Oct-2013 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As Vasil Toshkov stated, password_verify() can be used to verify a password created by crypt() or password_hash()<br />
<br />
That is because passwords created by password_hash() also use the C crypt sheme<br />
<br />
If you want to verify older plain MD5-Hashes you just need to prefix them with $1$<br />
<br />
See https://en.wikipedia.org/wiki/Crypt_(C) for more information.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113455""></a>
  <div class="note">
   <strong class="user">Vasil Toshkov</strong>
   <a href="#113455" class="date">13-Oct-2013 06:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function can be used to verify hashes created with other functions like crypt(). For example:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$hash </span><span class="keyword">= </span><span class="string">'$1$toHVx1uW$KIvW9yGZZSU/1YOidHeqJ/'</span><span class="keyword">;<br />
<br />
if (</span><span class="default">password_verify</span><span class="keyword">(</span><span class="string">'rasmuslerdorf'</span><span class="keyword">, </span><span class="default">$hash</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Password is valid!'</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Invalid password.'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// Output: Password is valid!<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
