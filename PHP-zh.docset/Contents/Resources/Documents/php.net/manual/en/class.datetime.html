<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>The DateTime class</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="datetime.constants.html">? 预定义常量</a></li>
      <li style="float: right;"><a href="datetime.add.html">DateTime::add ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.datetime.html">日期/时间</a></li>
    <li>The DateTime class</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.datetime" class="reference">

 <h1 class="title">The DateTime class</h1>
 

 <div class="partintro"><p class="verinfo">(PHP 5 &gt;= 5.2.0)</p>


  <div class="section" id="datetime.intro">
   <h2 class="title">简介</h2>
   <p class="para">
    Representation of date and time.
   </p>
  </div>


  <div class="section" id="datetime.synopsis">
   <h2 class="title">类摘要</h2>


   <div class="classsynopsis">
    <div class="ooclass"></div>


    <div class="classsynopsisinfo">
     <span class="ooclass">
      <strong class="classname">DateTime</strong>
     </span>
     <span class="oointerface">implements 
      <span class="interfacename"><a href="class.datetimeinterface.html" class="interfacename">DateTimeInterface</a></span>
     </span>
     {</div>

    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 常量 */</div>
    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.atom"><var class="varname">ATOM</var></a></var>
     <span class="initializer"> = &quot;Y-m-d\TH:i:sP&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.cookie"><var class="varname">COOKIE</var></a></var>
     <span class="initializer"> = &quot;l, d-M-Y H:i:s T&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.iso8601"><var class="varname">ISO8601</var></a></var>
     <span class="initializer"> = &quot;Y-m-d\TH:i:sO&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.rfc822"><var class="varname">RFC822</var></a></var>
     <span class="initializer"> = &quot;D, d M y H:i:s O&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.rfc850"><var class="varname">RFC850</var></a></var>
     <span class="initializer"> = &quot;l, d-M-y H:i:s T&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.rfc1036"><var class="varname">RFC1036</var></a></var>
     <span class="initializer"> = &quot;D, d M y H:i:s O&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.rfc1123"><var class="varname">RFC1123</var></a></var>
     <span class="initializer"> = &quot;D, d M Y H:i:s O&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.rfc2822"><var class="varname">RFC2822</var></a></var>
     <span class="initializer"> = &quot;D, d M Y H:i:s O&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.rfc3339"><var class="varname">RFC3339</var></a></var>
     <span class="initializer"> = &quot;Y-m-d\TH:i:sP&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.rss"><var class="varname">RSS</var></a></var>
     <span class="initializer"> = &quot;D, d M Y H:i:s O&quot;</span>
    ;</div>

    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">string</span>
      <var class="fieldsynopsis_varname"><a href="class.datetime.html#datetime.constants.w3c"><var class="varname">W3C</var></a></var>
     <span class="initializer"> = &quot;Y-m-d\TH:i:sP&quot;</span>
    ;</div>

    
    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 方法 */</div>
    <div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="datetime.construct.html" class="methodname">__construct</a></span>
    ([ <span class="methodparam"><span class="type">string</span> <code class="parameter">$time</code><span class="initializer"> = &quot;now&quot;</span></span>
   [, <span class="methodparam"><span class="type"><a href="class.datetimezone.html" class="type DateTimeZone">DateTimeZone</a></span> <code class="parameter">$timezone</code><span class="initializer"> = <strong><code>NULL</code></strong></span></span>
  ]] )</div>

    
    <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.add.html" class="methodname">add</a></span>
    ( <span class="methodparam"><span class="type"><a href="class.dateinterval.html" class="type DateInterval">DateInterval</a></span> <code class="parameter">$interval</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="modifier">static</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.createfromformat.html" class="methodname">createFromFormat</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$format</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$time</code></span>
   [, <span class="methodparam"><span class="type"><a href="class.datetimezone.html" class="type DateTimeZone">DateTimeZone</a></span> <code class="parameter">$timezone</code></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="modifier">static</span> <span class="type">array</span> <span class="methodname"><a href="datetime.getlasterrors.html" class="methodname">getLastErrors</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.modify.html" class="methodname">modify</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$modify</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="modifier">static</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.set-state.html" class="methodname">__set_state</a></span>
    ( <span class="methodparam"><span class="type">array</span> <code class="parameter">$array</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.setdate.html" class="methodname">setDate</a></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$year</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$month</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$day</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.setisodate.html" class="methodname">setISODate</a></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$year</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$week</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$day</code><span class="initializer"> = 1</span></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.settime.html" class="methodname">setTime</a></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$hour</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$minute</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$second</code><span class="initializer"> = 0</span></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.settimestamp.html" class="methodname">setTimestamp</a></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$unixtimestamp</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.settimezone.html" class="methodname">setTimezone</a></span>
    ( <span class="methodparam"><span class="type"><a href="class.datetimezone.html" class="type DateTimeZone">DateTimeZone</a></span> <code class="parameter">$timezone</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTime</span> <span class="methodname"><a href="datetime.sub.html" class="methodname">sub</a></span>
    ( <span class="methodparam"><span class="type"><a href="class.dateinterval.html" class="type DateInterval">DateInterval</a></span> <code class="parameter">$interval</code></span>
   )</div>

    
    <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateInterval</span> <span class="methodname"><a href="datetime.diff.html" class="methodname">diff</a></span>
    ( <span class="methodparam"><span class="type"><a href="class.datetimeinterface.html" class="type DateTimeInterface">DateTimeInterface</a></span> <code class="parameter">$datetime2</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$absolute</code><span class="initializer"> = false</span></span>
  ] )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">string</span> <span class="methodname"><a href="datetime.format.html" class="methodname">format</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$format</code></span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">int</span> <span class="methodname"><a href="datetime.getoffset.html" class="methodname">getOffset</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">int</span> <span class="methodname"><a href="datetime.gettimestamp.html" class="methodname">getTimestamp</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTimeZone</span> <span class="methodname"><a href="datetime.gettimezone.html" class="methodname">getTimezone</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="datetime.wakeup.html" class="methodname">__wakeup</a></span>
    ( <span class="methodparam">void</span>
   )</div>


   }</div>


  </div>
  

  <div class="section" id="datetime.constants.types">
   <h2 class="title">预定义常量</h2>
   <dl>

    
     <dt id="datetime.constants.atom"><strong><code>DateTime::ATOM</code></strong></dt>

     <dt>
<strong><code>DATE_ATOM</code></strong></dt>

     <dd>

      <span class="simpara">
       Atom (example: 2005-08-15T15:52:01+00:00)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.cookie"><strong><code>DateTime::COOKIE</code></strong></dt>

     <dt>
<strong><code>DATE_COOKIE</code></strong></dt>

     <dd>

      <span class="simpara">
       HTTP Cookies (example: Monday, 15-Aug-2005 15:52:01 UTC)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.iso8601"><strong><code>DateTime::ISO8601</code></strong></dt>

     <dt>
<strong><code>DATE_ISO8601</code></strong></dt>

     <dd>

      <span class="simpara">
       ISO-8601 (example: 2005-08-15T15:52:01+0000)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.rfc822"><strong><code>DateTime::RFC822</code></strong></dt>

     <dt>
<strong><code>DATE_RFC822</code></strong></dt>

     <dd>

      <span class="simpara">
       RFC 822 (example: Mon, 15 Aug 05 15:52:01 +0000)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.rfc850"><strong><code>DateTime::RFC850</code></strong></dt>

     <dt>
<strong><code>DATE_RFC850</code></strong></dt>

     <dd>

      <span class="simpara">
       RFC 850 (example: Monday, 15-Aug-05 15:52:01 UTC)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.rfc1036"><strong><code>DateTime::RFC1036</code></strong></dt>

     <dt>
<strong><code>DATE_RFC1036</code></strong></dt>

     <dd>

      <span class="simpara">
       RFC 1036 (example: Mon, 15 Aug 05 15:52:01 +0000)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.rfc1123"><strong><code>DateTime::RFC1123</code></strong></dt>

     <dt>
<strong><code>DATE_RFC1123</code></strong></dt>

     <dd>

      <span class="simpara">
       RFC 1123 (example: Mon, 15 Aug 2005 15:52:01 +0000)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.rfc2822"><strong><code>DateTime::RFC2822</code></strong></dt>

     <dt>
<strong><code>DATE_RFC2822</code></strong></dt>

     <dd>

      <span class="simpara">
       RFC 2822 (example: Mon, 15 Aug 2005 15:52:01 +0000)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.rfc3339"><strong><code>DateTime::RFC3339</code></strong></dt>

     <dt>
<strong><code>DATE_RFC3339</code></strong></dt>

     <dd>

      <span class="simpara">
       Same as <strong><code>DATE_ATOM</code></strong> (since PHP 5.1.3)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.rss"><strong><code>DateTime::RSS</code></strong></dt>

     <dt>
<strong><code>DATE_RSS</code></strong></dt>

     <dd>

      <span class="simpara">
       RSS (example: Mon, 15 Aug 2005 15:52:01 +0000)
      </span>
     </dd>

    

    
     <dt id="datetime.constants.w3c"><strong><code>DateTime::W3C</code></strong></dt>

     <dt>
<strong><code>DATE_W3C</code></strong></dt>

     <dd>

      <span class="simpara">
       World Wide Web Consortium (example: 2005-08-15T15:52:01+00:00)
      </span>
     </dd>

    

   </dl>

  </div>



 <div class="section" id="datetime.changelog">
  <h2 class="title">更新日志</h2>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.5.0</td>
       <td>
        The class now implements <a href="class.datetimeinterface.html" class="classname">DateTimeInterface</a>.
       </td>
      </tr>

      <tr>
       <td>5.4.24</td>
       <td>
        The COOKIE constant was changed to reflect RFC 1036 using a four digit 
        year rather than a two digit year (RFC 850) as prior versions.
       </td>
      </tr>

      <tr>
       <td>5.2.2</td>
       <td>
        DateTime object comparison with the
        <a href="language.operators.comparison.html" class="link">comparison operators</a>
        changed to work as expected. Previously, all DateTime objects were
        considered equal (using <em>==</em>).
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 </div>

 





















































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="datetime.add.html">DateTime::add</a> &mdash; Adds an amount of days, months, years, hours, minutes and seconds to a
   DateTime object</li><li><a href="datetime.construct.html">DateTime::__construct</a> &mdash; Returns new DateTime object</li><li><a href="datetime.createfromformat.html">DateTime::createFromFormat</a> &mdash; Returns new DateTime object formatted according to the specified format</li><li><a href="datetime.getlasterrors.html">DateTime::getLastErrors</a> &mdash; Returns the warnings and errors</li><li><a href="datetime.modify.html">DateTime::modify</a> &mdash; Alters the timestamp</li><li><a href="datetime.set-state.html">DateTime::__set_state</a> &mdash; The __set_state handler</li><li><a href="datetime.setdate.html">DateTime::setDate</a> &mdash; Sets the date</li><li><a href="datetime.setisodate.html">DateTime::setISODate</a> &mdash; Sets the ISO date</li><li><a href="datetime.settime.html">DateTime::setTime</a> &mdash; Sets the time</li><li><a href="datetime.settimestamp.html">DateTime::setTimestamp</a> &mdash; Sets the date and time based on an Unix timestamp</li><li><a href="datetime.settimezone.html">DateTime::setTimezone</a> &mdash; Sets the time zone for the DateTime object</li><li><a href="datetime.sub.html">DateTime::sub</a> &mdash; Subtracts an amount of days, months, years, hours, minutes and seconds from
   a DateTime object</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116549""></a>
  <div class="note">
   <strong class="user">tdp</strong>
   <a href="#116549" class="date">21-Jan-2015 08:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware of this behaviour:<br />
<br />
<span class="default">&lt;?php<br />
$dt1 </span><span class="keyword">= new \</span><span class="default">DateTime</span><span class="keyword">( </span><span class="string">'2014/12/31' </span><span class="keyword">);<br />
</span><span class="default">$dt1</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">( </span><span class="string">'-1 month' </span><span class="keyword">);<br />
</span><span class="default">$m </span><span class="keyword">= (int) </span><span class="default">$dt1</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">( </span><span class="string">'m' </span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">( </span><span class="default">$m </span><span class="keyword">); </span><span class="comment">// still 12 !!!<br />
<br />
</span><span class="default">$dt2 </span><span class="keyword">= new \</span><span class="default">DateTime</span><span class="keyword">( </span><span class="string">'2014/12/30' </span><span class="keyword">);<br />
</span><span class="default">$dt2</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">( </span><span class="string">'-1 month' </span><span class="keyword">);<br />
</span><span class="default">$m </span><span class="keyword">= (int) </span><span class="default">$dt2</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">( </span><span class="string">'m' </span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">( </span><span class="default">$m </span><span class="keyword">); </span><span class="comment">// 11<br />
</span><span class="default">?&gt;<br />
</span><br />
The method modify( '-1 month' ) appear to remove 30 days, not to subtract 1 from the month and adjust the day (if needed).<br />
<br />
In my opinion, the former date should be adjusted to 2014/11/30, that is, the last day in the previous month.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116085""></a>
  <div class="note">
   <strong class="user">lcf</strong>
   <a href="#116085" class="date">07-Nov-2014 11:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
"2005-08-15T15:52:01+0000" is NOT a valid ISO 8601 format.<br />
<br />
You can use either basic format "20050815T155201+0000" or extended format "2005-08-15T15:52:01+00:00", but those can't be mixed.<br />
<br />
Use date("c", $timestamp) until DateTime::ISO8601 gets fixed.<br />
<br />
See ISO 8601:2004, 4.3.2 Complete representations for reference.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114254""></a>
  <div class="note">
   <strong class="user">julie at earthshod dot co dot uk</strong>
   <a href="#114254" class="date">30-Jan-2014 01:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It isn't obvious from the above, but you can insert a letter of the alphabet directly into the date string by escaping it with a backslash in the format string.&nbsp; Note that if you are using "double" speech marks around the format string, you will have to further escape each backslash with another backslash!&nbsp; If you are using 'single' speech marks around the format string, then you only need one backslash.<br />
<br />
For instance, to create a string like "Y2014M01D29T1633", you *could* use string concatenation like so:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $dtstring </span><span class="keyword">= </span><span class="string">"Y" </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Y"</span><span class="keyword">, </span><span class="default">$when</span><span class="keyword">) . </span><span class="string">"M" </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"m"</span><span class="keyword">, </span><span class="default">$when</span><span class="keyword">) . </span><span class="string">"D" </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"d"</span><span class="keyword">, </span><span class="default">$when</span><span class="keyword">) . </span><span class="string">"T" </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">"Hi"</span><span class="keyword">, </span><span class="default">$when</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
but you could also escape the letters with backslashes like so:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $dtstring1 </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">'\YY\Mm\Dd\THi'</span><span class="keyword">, </span><span class="default">$when</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dtstring2 </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"\\YY\\Mm\\Dd\\THi"</span><span class="keyword">, </span><span class="default">$when</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This method involves fewer function calls, so probably is slightly quicker; and also is immune to race conditions if you are not specifying the second argument.&nbsp; [It's possible that you could evaluate date("d") just *before* midnight and date("H") just *after* midnight.&nbsp; This will not give you the result you were expecting.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114093""></a>
  <div class="note">
   <strong class="user">stevenmattera at gmail dot com</strong>
   <a href="#114093" class="date">10-Jan-2014 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This caused some confusion with a blog I was working on and just wanted to make other people aware of this. If you use createFromFormat to turn a date into a timestamp it will include the current time. For example:<br />
<br />
<span class="default">&lt;?php<br />
$publishDate </span><span class="keyword">= </span><span class="default">DateTime</span><span class="keyword">::</span><span class="default">createFromFormat</span><span class="keyword">(</span><span class="string">'m/d/Y'</span><span class="keyword">, </span><span class="string">'1/10/2014'</span><span class="keyword">);<br />
echo </span><span class="default">$publishDate</span><span class="keyword">-&gt;</span><span class="default">getTimestamp</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
Would not output the expected "1389312000" instead it would output something more like "1389344025". To fix this you would want to do:<br />
<br />
<span class="default">&lt;?php<br />
$publishDate </span><span class="keyword">= </span><span class="default">DateTime</span><span class="keyword">::</span><span class="default">createFromFormat</span><span class="keyword">(</span><span class="string">'m/d/Y'</span><span class="keyword">, </span><span class="string">'1/10/2014'</span><span class="keyword">);<br />
</span><span class="default">$publishDate</span><span class="keyword">-&gt;</span><span class="default">setTime</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
echo </span><span class="default">$publishDate</span><span class="keyword">-&gt;</span><span class="default">getTimestamp</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
I hope this helps someone!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113428""></a>
  <div class="note">
   <strong class="user">James</strong>
   <a href="#113428" class="date">10-Oct-2013 12:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be aware that DateTime may ignore fractional seconds for some formats, but not when using the ISO 8601 time format, as documented by this bug:<br />
<br />
https://bugs.php.net/bug.php?id=51950<br />
<br />
$dateTime = DateTime::createFromFormat(<br />
&nbsp;&nbsp;&nbsp; DateTime::ISO8601,<br />
&nbsp;&nbsp;&nbsp; '2009-04-16T12:07:23.596Z'<br />
);<br />
// bool(false)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111532""></a>
  <div class="note">
   <strong class="user">tim at timfennis dot com</strong>
   <a href="#111532" class="date">02-Mar-2013 12:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is a subtle difference between the following two statments which causes JavaScript's Date object on iPhones to fail.<br />
<br />
<span class="default">&lt;?php<br />
$objDateTime </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">'NOW'</span><span class="keyword">);<br />
echo </span><span class="default">$objDateTime</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'c'</span><span class="keyword">); </span><span class="comment">// ISO8601 formated datetime<br />
</span><span class="keyword">echo </span><span class="default">$objDateTime</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="default">DateTime</span><span class="keyword">::</span><span class="default">ISO8601</span><span class="keyword">); </span><span class="comment">// Another way to get an ISO8601 formatted string<br />
<br />
/**<br />
On my local machine this results in: <br />
<br />
2013-03-01T16:15:09+01:00<br />
2013-03-01T16:15:09+0100<br />
<br />
Both of these strings are valid ISO8601 datetime strings, but the latter is not accepted by the constructor of JavaScript's date object on iPhone. (Possibly other browsers as well)<br />
*/<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Our solution was to create the following constant on our DateHelper object.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">DateHelper<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * An ISO8601 format string for PHP's date functions that's compatible with JavaScript's Date's constructor method<br />
&nbsp;&nbsp; &nbsp; * Example: 2013-04-12T16:40:00-04:00<br />
&nbsp;&nbsp; &nbsp; * <br />
&nbsp;&nbsp; &nbsp; * PHP's ISO8601 constant doesn't add the colon to the timezone offset which is required for iPhone<br />
&nbsp;&nbsp;&nbsp; **/<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">const </span><span class="default">ISO8601 </span><span class="keyword">= </span><span class="string">'Y-m-d\TH:i:sP'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108970""></a>
  <div class="note">
   <strong class="user">php at keith tyler dot com</strong>
   <a href="#108970" class="date">09-Jun-2012 02:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
DateTime does not support split seconds (microseconds or milliseconds etc.)<br />
I don't know why this isn't documented.<br />
The class constructor will accept them without complaint, but they are discarded.<br />
There does not appear to be a way to take a string like "2012-07-08 11:14:15.638276" and store it in an objective form in a complete way.<br />
<br />
So you cannot do date math on two strings such as:<br />
<br />
<span class="default">&lt;?php<br />
$d1</span><span class="keyword">=new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">"2012-07-08 11:14:15.638276"</span><span class="keyword">);<br />
</span><span class="default">$d2</span><span class="keyword">=new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="string">"2012-07-08 11:14:15.889342"</span><span class="keyword">);<br />
</span><span class="default">$diff</span><span class="keyword">=</span><span class="default">$d2</span><span class="keyword">-&gt;</span><span class="default">diff</span><span class="keyword">(</span><span class="default">$d1</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$diff </span><span class="keyword">) ;<br />
<br />
</span><span class="comment">/* returns:<br />
<br />
DateInterval Object<br />
(<br />
&nbsp;&nbsp;&nbsp; [y] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [m] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [d] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [h] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [i] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [s] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [invert] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [days] =&gt; 0<br />
)<br />
<br />
*/<br />
</span><span class="default">?&gt;<br />
</span><br />
You get back 0 when you actually want to get 0.251066 seconds.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108019""></a>
  <div class="note">
   <strong class="user">marcio dot barbado at bdslabs dot com dot br</strong>
   <a href="#108019" class="date">23-Mar-2012 03:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
DateTime class does not use locales so here I test and compare its formating with strftime() function's one:<br />
<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Under UNIX, command "$ locale -a" should provide you with your server's options.<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$data_do_mysql&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="string">"2011-09-29 23:50:26"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;strong&gt;' </span><span class="keyword">. </span><span class="string">"\$data_do_mysql" </span><span class="keyword">. </span><span class="string">'&lt;/strong&gt;' </span><span class="keyword">. </span><span class="string">":" </span><span class="keyword">. </span><span class="default">$data_do_mysql </span><span class="keyword">. </span><span class="string">"." </span><span class="keyword">. </span><span class="string">'&lt;br /&gt;' </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$dataInicial&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$data_do_mysql</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// setlocale() used with strftime().<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$meu_locale&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_ALL</span><span class="keyword">, </span><span class="string">"pt_BR.utf8"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$data_inicial&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">strftime</span><span class="keyword">(</span><span class="string">"%d de %b de %Y"</span><span class="keyword">, </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$data_do_mysql</span><span class="keyword">)));<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Outputs:<br />
&nbsp;&nbsp; &nbsp;&nbsp; // $data_do_mysql formatada com a classe DateTime:29-Sep-2011.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'&lt;strong&gt;' </span><span class="keyword">. </span><span class="string">"\$data_do_mysql" </span><span class="keyword">. </span><span class="string">'&lt;/strong&gt;' </span><span class="keyword">. </span><span class="string">" formatada com a classe DateTime:" </span><span class="keyword">. </span><span class="default">$dataInicial</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'d-M-Y'</span><span class="keyword">) . </span><span class="string">"." </span><span class="keyword">. </span><span class="string">'&lt;br /&gt;' </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Outputs:<br />
&nbsp;&nbsp; &nbsp;&nbsp; // $data_do_mysql formatada com a fun??o strftime():29 de Set de 2011.<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">'&lt;strong&gt;' </span><span class="keyword">. </span><span class="string">"\$data_do_mysql" </span><span class="keyword">. </span><span class="string">'&lt;/strong&gt;' </span><span class="keyword">. </span><span class="string">" formatada com a fun&amp;ccedil;&amp;atilde;o strftime():" </span><span class="keyword">. </span><span class="default">$data_inicial </span><span class="keyword">. </span><span class="string">"." </span><span class="keyword">. </span><span class="string">'&lt;br /&gt;' </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// setlocale() fails :-(<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$meu_locale</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Prefiro usar DateTime."</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Yay setlocale() :-D<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="keyword">else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Prefiro usar strftime()."</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; exit();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104966""></a>
  <div class="note">
   <strong class="user">nodweber at gmail dot com</strong>
   <a href="#104966" class="date">19-Jul-2011 11:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IF You want to create clone of $time, use clone..<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; $now&nbsp;&nbsp; </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$clone </span><span class="keyword">= </span><span class="default">$now</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//this doesnot clone so:<br />
&nbsp; </span><span class="default">$clone</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">( </span><span class="string">'-1 day' </span><span class="keyword">);<br />
&nbsp;<br />
&nbsp; echo </span><span class="default">$now</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">( </span><span class="string">'d-m-Y' </span><span class="keyword">), </span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$clone</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">( </span><span class="string">'d-m-Y' </span><span class="keyword">);<br />
&nbsp; echo </span><span class="string">'----'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="comment">// will print same.. if you want to clone make like this:<br />
&nbsp; </span><span class="default">$now&nbsp;&nbsp; </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$clone </span><span class="keyword">= clone </span><span class="default">$now</span><span class="keyword">;&nbsp; &nbsp; <br />
&nbsp; </span><span class="default">$clone</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">( </span><span class="string">'-1 day' </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp; echo </span><span class="default">$now</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">( </span><span class="string">'d-m-Y' </span><span class="keyword">), </span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$clone</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">( </span><span class="string">'d-m-Y' </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Results:<br />
18-07-2011<br />
18-07-2011<br />
----<br />
19-07-2011<br />
18-07-2011</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99386""></a>
  <div class="note">
   <strong class="user">giorgio dot liscio at email dot it</strong>
   <a href="#99386" class="date">14-Aug-2010 07:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
please note that using
<br />

<br />
setTimezone
<br />
setTimestamp
<br />
setDate
<br />
setTime
<br />
etc..
<br />

<br />
will modify the original object, and the return value is $this
<br />

<br />
$original = new DateTime("now");
<br />

<br />
$modified = $original-&gt;setTimezone(new DateTimezone("europe/rome"));
<br />

<br />
echo $original === $modified ? "THE OBJECT IS THE SAME" : "OBJECTS ARE DIFFERENT";
<br />

<br />
so a datetime object is mutable
<br />

<br />
(Editors note: PHP 5.5 adds DateTimeImmutable which does not modify the original object, instead creating a new instance.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99309""></a>
  <div class="note">
   <strong class="user">bf at tbwb dot nl</strong>
   <a href="#99309" class="date">10-Aug-2010 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have timezone information in the time string you construct the DateTime object with, you cannot add an extra timezone in the constructor. It will ignore the timezone information in the time string:<br />
<br />
$date = new DateTime("2010-07-05T06:00:00Z", new DateTimeZone("Europe/Amsterdam"));<br />
<br />
will create a DateTime object set to "2010-07-05 06:00:00+0200" (+2 being the TZ offset for Europe/Amsterdam)<br />
<br />
To get this done, you will need to set the timezone separately:<br />
<br />
$date = new DateTime("2010-07-05T06:00:00Z");<br />
$date-&gt;setTimeZone(new DateTimeZone("Europe/Amsterdam");<br />
<br />
This will create a DateTime object set to "2010-07-05 08:00:00+0200"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96875""></a>
  <div class="note">
   <strong class="user">ediathome</strong>
   <a href="#96875" class="date">20-Mar-2010 10:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need DateTime::createFromFormat functionality in versions &lt;5.3.0 releases you might use the following basic class which can also be combined with Tom's class. It should work for most basic formats, however you should improve this function if you need more complex formats.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">DateClass </span><span class="keyword">extends </span><span class="default">DateTime</span><span class="keyword">{<br />
<br />
public function </span><span class="default">getTimestamp</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format </span><span class="keyword">(</span><span class="string">"U"</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">/**<br />
*&nbsp; &nbsp; This function calculates the number of days between the first and the second date. Arguments must be subclasses of DateTime<br />
**/<br />
</span><span class="keyword">static function </span><span class="default">differenceInDays </span><span class="keyword">(</span><span class="default">$firstDate</span><span class="keyword">, </span><span class="default">$secondDate</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$firstDateTimeStamp </span><span class="keyword">= </span><span class="default">$firstDate</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">"U"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$secondDateTimeStamp </span><span class="keyword">= </span><span class="default">$secondDate</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">"U"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rv </span><span class="keyword">= </span><span class="default">round </span><span class="keyword">(((</span><span class="default">$firstDateTimeStamp </span><span class="keyword">- </span><span class="default">$secondDateTimeStamp</span><span class="keyword">))/</span><span class="default">86400</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$rv</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/**<br />
* This function returns an object of DateClass from $time in format $format. See date() for possible values for $format<br />
**/<br />
</span><span class="keyword">static function </span><span class="default">createFromFormat </span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">, </span><span class="default">$time</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">assert </span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">!=</span><span class="string">""</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$time</span><span class="keyword">==</span><span class="string">""</span><span class="keyword">){ <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return new </span><span class="default">DateClass</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'Y'</span><span class="keyword">] = </span><span class="string">"(?P&lt;Y&gt;19|20\d\d)"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'m'</span><span class="keyword">] = </span><span class="string">"(?P&lt;m&gt;0[1-9]|1[012])"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'d'</span><span class="keyword">] = </span><span class="string">"(?P&lt;d&gt;0[1-9]|[12][0-9]|3[01])"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'-'</span><span class="keyword">] = </span><span class="string">"[-]"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'.'</span><span class="keyword">] = </span><span class="string">"[\. /.]"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">':'</span><span class="keyword">] = </span><span class="string">"[:]"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'space'</span><span class="keyword">] = </span><span class="string">"[\s]"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'H'</span><span class="keyword">] = </span><span class="string">"(?P&lt;H&gt;0[0-9]|1[0-9]|2[0-3])"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'i'</span><span class="keyword">] = </span><span class="string">"(?P&lt;i&gt;[0-5][0-9])"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'s'</span><span class="keyword">] = </span><span class="string">"(?P&lt;s&gt;[0-5][0-9])"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$formatArray </span><span class="keyword">= </span><span class="default">str_split </span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regex </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// create the regular expression<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$formatArray </span><span class="keyword">as </span><span class="default">$character</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$character</span><span class="keyword">==</span><span class="string">" "</span><span class="keyword">) </span><span class="default">$regex </span><span class="keyword">= </span><span class="default">$regex</span><span class="keyword">.</span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="string">'space'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$character</span><span class="keyword">, </span><span class="default">$regexpArray</span><span class="keyword">)) </span><span class="default">$regex </span><span class="keyword">= </span><span class="default">$regex</span><span class="keyword">.</span><span class="default">$regexpArray</span><span class="keyword">[</span><span class="default">$character</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regex </span><span class="keyword">= </span><span class="string">"/"</span><span class="keyword">.</span><span class="default">$regex</span><span class="keyword">.</span><span class="string">"/"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// get results for regualar expression<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match </span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">, </span><span class="default">$time</span><span class="keyword">, </span><span class="default">$result</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// create the init string for the new DateTime<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$initString </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">[</span><span class="string">'Y'</span><span class="keyword">].</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'m'</span><span class="keyword">].</span><span class="string">"-"</span><span class="keyword">.</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'d'</span><span class="keyword">];<br />
<br />
</span><span class="comment">// if no value for hours, minutes and seconds was found add 00:00:00<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (isset(</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'H'</span><span class="keyword">])) </span><span class="default">$initString </span><span class="keyword">= </span><span class="default">$initString</span><span class="keyword">.</span><span class="string">" "</span><span class="keyword">.</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'H'</span><span class="keyword">].</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'i'</span><span class="keyword">].</span><span class="string">":"</span><span class="keyword">.</span><span class="default">$result</span><span class="keyword">[</span><span class="string">'s'</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; else {</span><span class="default">$initString </span><span class="keyword">= </span><span class="default">$initString</span><span class="keyword">.</span><span class="string">" 00:00:00"</span><span class="keyword">;}<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newDate </span><span class="keyword">= new </span><span class="default">DateClass </span><span class="keyword">(</span><span class="default">$initString</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$newDate</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; <br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95830""></a>
  <div class="note">
   <strong class="user">gmblar+php at gmail dot com</strong>
   <a href="#95830" class="date">24-Jan-2010 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Small but powerful extension to DateTime<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Blar_DateTime </span><span class="keyword">extends </span><span class="default">DateTime </span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Return Date in ISO8601 format<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @return String<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">__toString</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'Y-m-d H:i'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Return difference between $this and $now<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param Datetime|String $now<br />
&nbsp;&nbsp; &nbsp; * @return DateInterval<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">diff</span><span class="keyword">(</span><span class="default">$now </span><span class="keyword">= </span><span class="string">'NOW'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!(</span><span class="default">$now </span><span class="keyword">instanceOf </span><span class="default">DateTime</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$now </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">(</span><span class="default">$now</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">parent</span><span class="keyword">::</span><span class="default">diff</span><span class="keyword">(</span><span class="default">$now</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Return Age in Years<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param Datetime|String $now<br />
&nbsp;&nbsp; &nbsp; * @return Integer<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">getAge</span><span class="keyword">(</span><span class="default">$now </span><span class="keyword">= </span><span class="string">'NOW'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">diff</span><span class="keyword">(</span><span class="default">$now</span><span class="keyword">)-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'%y'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Usage:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$birthday </span><span class="keyword">= new </span><span class="default">Blar_DateTime</span><span class="keyword">(</span><span class="string">'1879-03-14'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Example 1<br />
</span><span class="keyword">echo </span><span class="default">$birthday</span><span class="keyword">;<br />
</span><span class="comment">// Result: 1879-03-14 00:00<br />
<br />
// Example 2<br />
</span><span class="keyword">echo </span><span class="string">'&lt;p&gt;Albert Einstein would now be '</span><span class="keyword">, </span><span class="default">$birthday</span><span class="keyword">-&gt;</span><span class="default">getAge</span><span class="keyword">(), </span><span class="string">' years old.&lt;/p&gt;'</span><span class="keyword">;<br />
</span><span class="comment">// Result: &lt;p&gt;Albert Einstein would now be 130 years old.&lt;/p&gt;<br />
<br />
// Example 3<br />
</span><span class="keyword">echo </span><span class="string">'&lt;p&gt;Albert Einstein would now be '</span><span class="keyword">, </span><span class="default">$birthday</span><span class="keyword">-&gt;</span><span class="default">diff</span><span class="keyword">()-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">'%y Years, %m Months, %d Days'</span><span class="keyword">), </span><span class="string">' old.&lt;/p&gt;'</span><span class="keyword">;<br />
</span><span class="comment">// Result: &lt;p&gt;Albert Einstein would now be 130 Years, 10 Months, 10 Days old.&lt;/p&gt;<br />
<br />
// Example 4<br />
</span><span class="keyword">echo </span><span class="string">'&lt;p&gt;Albert Einstein was on 2010-10-10 '</span><span class="keyword">, </span><span class="default">$birthday</span><span class="keyword">-&gt;</span><span class="default">getAge</span><span class="keyword">(</span><span class="string">'2010-10-10'</span><span class="keyword">), </span><span class="string">' years old.&lt;/p&gt;'</span><span class="keyword">;<br />
</span><span class="comment">// Result: &lt;p&gt;Albert Einstein was on 2010-10-10 131 years old.&lt;/p&gt;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91450""></a>
  <div class="note">
   <strong class="user">tom at r dot je</strong>
   <a href="#91450" class="date">10-Jun-2009 05:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're stuck on a PHP 5.1 system (unfortunately one of my clients is on a rather horrible webhost who claims they cannot upgrade php) you can use this as a quick workaround:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">class_exists</span><span class="keyword">(</span><span class="string">'DateTime'</span><span class="keyword">)) {<br />
class </span><span class="default">DateTime </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$date</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">date </span><span class="keyword">= </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$date</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setTimeZone</span><span class="keyword">(</span><span class="default">$timezone</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">__getDate</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">date</span><span class="keyword">(</span><span class="default">DATE_ATOM</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">date</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">modify</span><span class="keyword">(</span><span class="default">$multiplier</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">date </span><span class="keyword">= </span><span class="default">strtotime</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">__getDate</span><span class="keyword">() . </span><span class="string">' ' </span><span class="keyword">. </span><span class="default">$multiplier</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">format</span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">date</span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">date</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
it is NOT perfect. Timezones and DST are not supported, but if you just need compatible basic functions this works. Feel free to complete this so it's compatible with the 5.2 datetime object.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
