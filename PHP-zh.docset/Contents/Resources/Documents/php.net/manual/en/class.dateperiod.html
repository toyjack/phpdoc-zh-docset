<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>The DatePeriod class</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="dateinterval.format.html">? DateInterval::format</a></li>
      <li style="float: right;"><a href="dateperiod.construct.html">DatePeriod::__construct ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.datetime.html">日期/时间</a></li>
    <li>The DatePeriod class</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.dateperiod" class="reference">

 <h1 class="title">The DatePeriod class</h1>
 

 <div class="partintro"><p class="verinfo">(PHP 5 &gt;= 5.3.0, PHP 7)</p>


  <div class="section" id="dateperiod.intro">
   <h2 class="title">简介</h2>
   <p class="para">
    Represents a date period.
   </p>
   <p class="para">
    A date period allows iteration over a set of dates and times, recurring at
    regular intervals, over a given period.
   </p>
  </div>


  <div class="section" id="dateperiod.synopsis">
   <h2 class="title">类摘要</h2>


   <div class="classsynopsis">
    <div class="ooclass"></div>


    <div class="classsynopsisinfo">
     <span class="ooclass">
      <strong class="classname">DatePeriod</strong>
     </span>
     
     <span class="oointerface">implements 
      <span class="interfacename"><strong class="interfacename">Traversable</strong></span>
     </span>
     {</div>

    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 常量 */</div>
    <div class="fieldsynopsis">
     <span class="modifier">const</span>
     <span class="type">integer</span>
      <var class="fieldsynopsis_varname"><a href="class.dateperiod.html#dateperiod.constants.exclude-start-date"><var class="varname">EXCLUDE_START_DATE</var></a></var>
     <span class="initializer"> = 1</span>
    ;</div>

    
    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 方法 */</div>
    <div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="dateperiod.construct.html" class="methodname">__construct</a></span>
    ( <span class="methodparam"><span class="type"><a href="class.datetimeinterface.html" class="type DateTimeInterface">DateTimeInterface</a></span> <code class="parameter">$start</code></span>
   , <span class="methodparam"><span class="type"><a href="class.dateinterval.html" class="type DateInterval">DateInterval</a></span> <code class="parameter">$interval</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$recurrences</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code></span>
  ] )</div>
<div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="dateperiod.construct.html" class="methodname">__construct</a></span>
    ( <span class="methodparam"><span class="type"><a href="class.datetimeinterface.html" class="type DateTimeInterface">DateTimeInterface</a></span> <code class="parameter">$start</code></span>
   , <span class="methodparam"><span class="type"><a href="class.dateinterval.html" class="type DateInterval">DateInterval</a></span> <code class="parameter">$interval</code></span>
   , <span class="methodparam"><span class="type"><a href="class.datetimeinterface.html" class="type DateTimeInterface">DateTimeInterface</a></span> <code class="parameter">$end</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code></span>
  ] )</div>
<div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="dateperiod.construct.html" class="methodname">__construct</a></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$isostr</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$options</code></span>
  ] )</div>

    
    <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateInterval</span> <span class="methodname"><a href="dateperiod.getdateinterval.html" class="methodname">getDateInterval</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTimeInterface</span> <span class="methodname"><a href="dateperiod.getenddate.html" class="methodname">getEndDate</a></span>
    ( <span class="methodparam">void</span>
   )</div>
<div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">DateTimeInterface</span> <span class="methodname"><a href="dateperiod.getstartdate.html" class="methodname">getStartDate</a></span>
    ( <span class="methodparam">void</span>
   )</div>


   }</div>


  </div>
  

  <div class="section" id="dateperiod.constants">
   <h2 class="title">预定义常量</h2>
   <dl>

    
     <dt id="dateperiod.constants.exclude-start-date"><strong><code>DatePeriod::EXCLUDE_START_DATE</code></strong></dt>

     <dd>

      <p class="para">Exclude start date, used in <span class="function"><a href="dateperiod.construct.html" class="function">DatePeriod::__construct()</a></span>.</p>
     </dd>

    

   </dl>

  </div>



 </div>

 





























<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="dateperiod.construct.html">DatePeriod::__construct</a> &mdash; Creates a new DatePeriod object</li><li><a href="dateperiod.getdateinterval.html">DatePeriod::getDateInterval</a> &mdash; Gets the interval</li><li><a href="dateperiod.getenddate.html">DatePeriod::getEndDate</a> &mdash; Gets the end date</li><li><a href="dateperiod.getstartdate.html">DatePeriod::getStartDate</a> &mdash; Gets the start date</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="117515""></a>
  <div class="note">
   <strong class="user">php at karlsruler dot de</strong>
   <a href="#117515" class="date">22-Jun-2015 09:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The iterator seems to check the time as well, it excludes the end element if its time is 00:00:00. So the slightly safer version (to compare it against joshs suggestion) is to use $date-&gt;setTime(23, 59, 59) instead of $date-&gt;modify("+1 day").</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114188""></a>
  <div class="note">
   <strong class="user">patrick at adrichem dot nu</strong>
   <a href="#114188" class="date">22-Jan-2014 08:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
DatePeriod is not compatible with negative intervals.<br />
<br />
To do so you can simply use DateInterval and loop through it yourself like this: (not start should be ahead of end if you use a negative interval<br />
<br />
&nbsp;&nbsp;&nbsp; class DateRange extends ArrayIterator<br />
&nbsp;&nbsp;&nbsp; {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; protected $oDate = null;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; protected $oStartDate = null;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; protected $oEndDate = null;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; protected $oInterval = null;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function __construct( DateTime $oStartDate, DateTime $oEndDate, DateInterval $oInterval = null )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;oStartDate = $oStartDate;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;oDate = clone $oStartDate;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;oEndDate = $oEndDate;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;oInterval = $oInterval;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function next()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;oDate-&gt;add($this-&gt;oInterval);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;oDate;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function current()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;oDate;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; public function valid()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($this-&gt;oStartDate &gt; $this-&gt;oEndDate)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;oDate &gt;= $this-&gt;oEndDate;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $this-&gt;oDate &lt;= $this-&gt;oEndDate;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
$oRange = new DateRange(new DateTime("2013-10-01"), new DateTime("2013-01-01"), DateInterval::createFromDateString("-1 month") );<br />
&nbsp;&nbsp;&nbsp; foreach ($oRange as $oDate)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo $oDate-&gt;format("Y-m-d") . "&lt;br /&gt;";<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109846""></a>
  <div class="note">
   <strong class="user">josh dot love at verizon dot net</strong>
   <a href="#109846" class="date">27-Aug-2012 11:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just an example to include the end date using the DateTime method 'modify'<br />
<br />
<span class="default">&lt;?php<br />
<br />
$begin </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">( </span><span class="string">'2012-08-01' </span><span class="keyword">);<br />
</span><span class="default">$end </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">( </span><span class="string">'2012-08-31' </span><span class="keyword">);<br />
</span><span class="default">$end </span><span class="keyword">= </span><span class="default">$end</span><span class="keyword">-&gt;</span><span class="default">modify</span><span class="keyword">( </span><span class="string">'+1 day' </span><span class="keyword">); <br />
<br />
</span><span class="default">$interval </span><span class="keyword">= new </span><span class="default">DateInterval</span><span class="keyword">(</span><span class="string">'P1D'</span><span class="keyword">);<br />
</span><span class="default">$daterange </span><span class="keyword">= new </span><span class="default">DatePeriod</span><span class="keyword">(</span><span class="default">$begin</span><span class="keyword">, </span><span class="default">$interval </span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">);<br />
<br />
foreach(</span><span class="default">$daterange </span><span class="keyword">as </span><span class="default">$date</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$date</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">"Ymd"</span><span class="keyword">) . </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109315""></a>
  <div class="note">
   <strong class="user">logos-php at kith dot org</strong>
   <a href="#109315" class="date">06-Jul-2012 04:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks much to those of you who supplied sample code; that helps a lot.<br />
<br />
I wanted to mention another thing that helped me: when you do that foreach ( $period as $dt ), the $dt values are DateTime objects.<br />
<br />
That may be obvious to those of you with more experience, but I wasn't sure until I looked it up on Stack Overflow. So I figured it was worth posting here to help others like me who might've been confused or uncertain.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102841""></a>
  <div class="note">
   <strong class="user">Aurelien Marchand</strong>
   <a href="#102841" class="date">09-Mar-2011 09:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning About DatePeriod for Some Versions of PHP<br />
*****************************************<br />
<br />
Some versions of PHP had a bug so that caused DatePeriod to act strangely. For instance, the following code:<br />
<br />
<span class="default">&lt;?php<br />
$start </span><span class="keyword">= </span><span class="default">DateTime</span><span class="keyword">::</span><span class="default">createFromFormat</span><span class="keyword">(</span><span class="string">"Y-m-d H:i:s"</span><span class="keyword">,</span><span class="string">"2011-01-01 00:00:00"</span><span class="keyword">,new </span><span class="default">DateTimeZone</span><span class="keyword">(</span><span class="string">"America/Toronto"</span><span class="keyword">));<br />
</span><span class="default">$interval </span><span class="keyword">= new </span><span class="default">DateInterval</span><span class="keyword">(</span><span class="string">"P1M"</span><span class="keyword">); </span><span class="comment">// 1 month<br />
</span><span class="default">$occurrences </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
</span><span class="default">$period </span><span class="keyword">= new </span><span class="default">DatePeriod</span><span class="keyword">(</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$interval</span><span class="keyword">,</span><span class="default">$occurrences</span><span class="keyword">);<br />
foreach(</span><span class="default">$period </span><span class="keyword">as </span><span class="default">$dt</span><span class="keyword">){<br />
&nbsp; echo </span><span class="default">$dt</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">"Y-m-d H:i:s"</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
foreach(</span><span class="default">$period </span><span class="keyword">as </span><span class="default">$dt</span><span class="keyword">){<br />
&nbsp; echo </span><span class="default">$dt</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">(</span><span class="string">"Y-m-d H:i:s"</span><span class="keyword">) . </span><span class="string">"\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Would produce the following text:<br />
2011-01-01 00:00:00<br />
2011-02-01 00:00:00<br />
2011-03-01 00:00:00<br />
2011-04-01 00:00:00<br />
2011-05-01 00:00:00<br />
2011-06-01 00:00:00<br />
2011-07-01 00:00:00<br />
2011-08-01 00:00:00<br />
<br />
Instead of:<br />
2011-01-01 00:00:00<br />
2011-02-01 00:00:00<br />
2011-03-01 00:00:00<br />
2011-04-01 00:00:00<br />
2011-01-01 00:00:00<br />
2011-02-01 00:00:00<br />
2011-03-01 00:00:00<br />
2011-04-01 00:00:00<br />
<br />
5.3.2 fails<br />
5.3.3 fails<br />
5.3.4 -??-<br />
5.3.5 works</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102629""></a>
  <div class="note">
   <strong class="user">Memori</strong>
   <a href="#102629" class="date">25-Feb-2011 09:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to include the end-date, add one day to it:<br />
<br />
<span class="default">&lt;?php<br />
$startDate </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">();<br />
</span><span class="default">$endDate </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">();<br />
<br />
</span><span class="default">$startDateInt </span><span class="keyword">= new </span><span class="default">DateInterval</span><span class="keyword">( </span><span class="string">"P1Y" </span><span class="keyword">);<br />
</span><span class="default">$endDateInt </span><span class="keyword">= new </span><span class="default">DateInterval</span><span class="keyword">( </span><span class="string">"P1D" </span><span class="keyword">);<br />
<br />
</span><span class="default">$startDate</span><span class="keyword">-&gt;</span><span class="default">sub</span><span class="keyword">( </span><span class="default">$startDateInt </span><span class="keyword">);<br />
</span><span class="default">$endDate</span><span class="keyword">-&gt;</span><span class="default">add</span><span class="keyword">( </span><span class="default">$endDateInt </span><span class="keyword">);<br />
<br />
</span><span class="default">$periodInt </span><span class="keyword">= new </span><span class="default">DateInterval</span><span class="keyword">( </span><span class="string">"P1M" </span><span class="keyword">);<br />
</span><span class="default">$period </span><span class="keyword">= new </span><span class="default">DatePeriod</span><span class="keyword">( </span><span class="default">$startDate</span><span class="keyword">, </span><span class="default">$periodInt</span><span class="keyword">, </span><span class="default">$endDate </span><span class="keyword">);<br />
<br />
</span><span class="comment">// At februari 2011:<br />
// $period = (8,9,10,11,12,1,2)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92130""></a>
  <div class="note">
   <strong class="user">jkaatz at gmx dot de</strong>
   <a href="#92130" class="date">10-Jul-2009 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Nice example from PHP Spring Conference (thanks to Johannes Schlüter and David Zülke)<br />
<br />
<span class="default">&lt;?php<br />
$begin </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">( </span><span class="string">'2007-12-31' </span><span class="keyword">);<br />
</span><span class="default">$end </span><span class="keyword">= new </span><span class="default">DateTime</span><span class="keyword">( </span><span class="string">'2009-12-31 23:59:59' </span><span class="keyword">);<br />
<br />
</span><span class="default">$interval </span><span class="keyword">= </span><span class="default">DateInterval</span><span class="keyword">::</span><span class="default">createFromDateString</span><span class="keyword">(</span><span class="string">'last thursday of next month'</span><span class="keyword">);<br />
</span><span class="default">$period </span><span class="keyword">= new </span><span class="default">DatePeriod</span><span class="keyword">(</span><span class="default">$begin</span><span class="keyword">, </span><span class="default">$interval</span><span class="keyword">, </span><span class="default">$end</span><span class="keyword">, </span><span class="default">DatePeriod</span><span class="keyword">::</span><span class="default">EXCLUDE_START_DATE</span><span class="keyword">);<br />
<br />
foreach ( </span><span class="default">$period </span><span class="keyword">as </span><span class="default">$dt </span><span class="keyword">)<br />
&nbsp; echo </span><span class="default">$dt</span><span class="keyword">-&gt;</span><span class="default">format</span><span class="keyword">( </span><span class="string">"l Y-m-d H:i:s\n" </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
DateInterval specs could be found at <a href="http://en.wikipedia.org/wiki/ISO_8601#Time_intervals" rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/ISO_8601#Time_intervals</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
