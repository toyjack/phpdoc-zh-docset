<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>检测变量是否为资源类型</title>

  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.is-real.html">? is_real</a></li>
      <li style="float: right;"><a href="function.is-scalar.html">is_scalar ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.var.html">Variable handling 函数</a></li>
    <li>检测变量是否为资源类型</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.is-resource" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">is_resource</h1>
    <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">is_resource</span> &mdash; <span class="dc-title">
     检测变量是否为资源类型
    </span></p>

   </div>
   <div class="refsect1 unknown-unknown-unknown-unknown-unknown-unknown-unknown-unknown-unknown-unknown-seealsy" id="refsect1-function.is-resource-unknown-unknown-unknown-unknown-unknown-unknown-unknown-unknown-unknown-unknown-seealsy">
    <h3 class="title">描述</h3>
     <div class="methodsynopsis dc-description">
      <span class="type">bool</span> <span class="methodname"><strong>is_resource</strong></span>
       ( <span class="methodparam"><span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span> <code class="parameter">$var</code></span>
      )</div>

    <p class="para rdfs-comment">
     如果给出的参数 <code class="parameter">var</code> 是 <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> 类型，<span class="function"><strong>is_resource()</strong></span>
     返回 <strong><code>TRUE</code></strong>，否则返回 <strong><code>FALSE</code></strong>。
    </p>
    <p class="para">
     查看 <span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> 类型文档获取更多的信息。
    </p>
   </div>

  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="114154""></a>
  <div class="note">
   <strong class="user">CertaiN</strong>
   <a href="#114154" class="date">17-Jan-2014 02:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Try this to know behavior:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">resource_test</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">$name</span><span class="keyword">. </span><span class="string">']'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">PHP_EOL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'(bool)$resource =&gt; '</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$resource </span><span class="keyword">? </span><span class="string">'TRUE' </span><span class="keyword">: </span><span class="string">'FALSE'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">PHP_EOL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'get_resource_type($resource) =&gt; '</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">get_resource_type</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">) ?: </span><span class="string">'FALSE'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">PHP_EOL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'is_resoruce($resource) =&gt; '</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">) ? </span><span class="string">'TRUE' </span><span class="keyword">: </span><span class="string">'FALSE'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">PHP_EOL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">PHP_EOL<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">;<br />
}<br />
&nbsp;<br />
</span><span class="default">$resource </span><span class="keyword">= </span><span class="default">tmpfile</span><span class="keyword">();<br />
</span><span class="default">resource_test</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">, </span><span class="string">'Check Valid Resource'</span><span class="keyword">);<br />
&nbsp;<br />
</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">);<br />
</span><span class="default">resource_test</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">, </span><span class="string">'Check Released Resource'</span><span class="keyword">);<br />
&nbsp;<br />
</span><span class="default">$resource </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">resource_test</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">, </span><span class="string">'Check NULL'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
It will be shown as...<br />
<br />
[Check Valid Resource]<br />
(bool)$resource =&gt; TRUE<br />
get_resource_type($resource) =&gt; stream<br />
is_resoruce($resource) =&gt; TRUE<br />
<br />
[Check Released Resource]<br />
(bool)$resource =&gt; TRUE<br />
get_resource_type($resource) =&gt; Unknown<br />
is_resoruce($resource) =&gt; FALSE<br />
<br />
[Check NULL]<br />
(bool)$resource =&gt; FALSE<br />
get_resource_type($resource) =&gt; FALSE<br />
Warning:&nbsp; get_resource_type() expects parameter 1 to be resource, null given in ... on line 10<br />
is_resoruce($resource) =&gt; FALSE</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103942""></a>
  <div class="note">
   <strong class="user">btleffler [AT] gmail [DOT] com</strong>
   <a href="#103942" class="date">12-May-2011 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was recently trying to loop through some objects and convert them to arrays so that I could encode them to json strings.<br />
<br />
I was running into issues when an element of one of my objects was a SoapClient. As it turns out, json_encode() doesn't like any resources to be passed to it. My simple fix was to use is_resource() to determine whether or not the variable I was looking at was a resource.<br />
<br />
I quickly realized that is_resource() returns false for two out of the 3 resources that are typically in a SoapClient object. If the resource type is 'Unknown' according to var_dump() and get_resource_type(), is_resource() doesn't think that the variable is a resource!<br />
<br />
My work around for this was to use get_resource_type() instead of is_resource(), but that function throws an error if the variable you're checking isn't a resource.<br />
<br />
So how are you supposed to know when a variable is a resource if is_resource() is unreliable, and get_resource_type() gives errors if you don't pass it a resource?<br />
<br />
I ended up doing something like this:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">isResource </span><span class="keyword">(</span><span class="default">$possibleResource</span><span class="keyword">) { return !</span><span class="default">is_null</span><span class="keyword">(@</span><span class="default">get_resource_type</span><span class="keyword">(</span><span class="default">$possibleResource</span><span class="keyword">)); }<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
The @ operator suppresses the errors thrown by get_resource_type() so it returns null if $possibleResource isn't a resource.<br />
<br />
I spent way too long trying to figure this stuff out, so I hope this comment helps someone out if they run into the same problem I did.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
