<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>解码会话数据</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.session-create-id.html">? session_create_id</a></li>
      <li style="float: right;"><a href="function.session-destroy.html">session_destroy ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.session.html">Session 函数</a></li>
    <li>解码会话数据</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.session-decode" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_decode</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">session_decode</span> &mdash; <span class="dc-title">解码会话数据</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.session-decode-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>session_decode</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$data</code></span>
   ) : <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>session_decode()</strong></span> 对 <code class="parameter">$data</code>
   参数中的已经序列化的会话数据进行解码，
   并且使用解码后的数据填充 $_SESSION 超级全局变量。
  </p>
  <p class="para">
   请注意，这里的反序列化方法不同于 <span class="function"><a href="function.unserialize.html" class="function">unserialize()</a></span> 函数。
   序列化方法是 PHP 内置的，并且可以通过
   <a href="session.configuration.html#ini.session.serialize-handler" class="link">session.serialize_handler</a> 配置项进行修改。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.session-decode-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">data</code></dt>

     <dd>

      <p class="para">
       编码后的数据
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.session-decode-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>TRUE</code></strong>， 或者在失败时返回 <strong><code>FALSE</code></strong>。
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.session-decode-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.session-encode.html" class="function" rel="rdfs-seeAlso">session_encode()</a> - 将当前会话数据编码为一个字符串</span></li>
    <li class="member"><a href="session.configuration.html#ini.session.serialize-handler" class="link">session.serialize_handler</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="113523""></a>
  <div class="note">
   <strong class="user">frank at interactinet dot com</strong>
   <a href="#113523" class="date">24-Oct-2013 03:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found this to be the simplest solution:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// if session is not started<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="comment">// store our current session<br />
</span><span class="default">$my_sess </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />
<br />
</span><span class="comment">// decode $data (the encoded session data, either from a file or database). Remember, decoded data is put directly into $_SESSION<br />
</span><span class="default">session_decode</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
<br />
</span><span class="comment">// restore our own session<br />
</span><span class="default">$_SESSION </span><span class="keyword">= </span><span class="default">$my_sess</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108037""></a>
  <div class="note">
   <strong class="user">Frits dot vanCampen at moxio dot com</strong>
   <a href="#108037" class="date">23-Mar-2012 05:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I noticed that the posted solutions for manually decoding sessions are not perfect, so I've contributed a more robust solution.<br />
<br />
The preg_match solution can never work. It's not so hard to find a case that might break unserialization.<br />
In the case of jason-joeymail is breaks on:<br />
<br />
<span class="default">&lt;?php<br />
$_SESSION</span><span class="keyword">[</span><span class="string">"test"</span><span class="keyword">] = </span><span class="string">";oops|"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Below you can find my solution. It doesn't use a regular expression but rather the reversibility of the serialize operation and the 'feature' that serialize ignores all further input when it thinks it's done. It's by no means a beautiful or particularly fast solution but it is a more robust solution.<br />
I've added a deserializer for "php" and "php_binary". It should be trivial to add one for "wddx".<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Session </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public static function </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$method </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">"session.serialize_handler"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$method</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"php"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">unserialize_php</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">"php_binary"</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">self</span><span class="keyword">::</span><span class="default">unserialize_phpbinary</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Unsupported session.serialize_handler: " </span><span class="keyword">. </span><span class="default">$method </span><span class="keyword">. </span><span class="string">". Supported: php, php_binary"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; private static function </span><span class="default">unserialize_php</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return_data </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">), </span><span class="string">"|"</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"invalid data, remaining: " </span><span class="keyword">. </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="string">"|"</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num </span><span class="keyword">= </span><span class="default">$pos </span><span class="keyword">- </span><span class="default">$offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$varname </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">, </span><span class="default">$num</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">$num </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return_data</span><span class="keyword">[</span><span class="default">$varname</span><span class="keyword">] = </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$return_data</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; private static function </span><span class="default">unserialize_phpbinary</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return_data </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$offset </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$num </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">[</span><span class="default">$offset</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$varname </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">, </span><span class="default">$num</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">$num</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$session_data</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return_data</span><span class="keyword">[</span><span class="default">$varname</span><span class="keyword">] = </span><span class="default">$data</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$return_data</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Usage:<br />
<br />
<span class="default">&lt;?php<br />
Session</span><span class="keyword">::</span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">session_encode</span><span class="keyword">());<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101687""></a>
  <div class="note">
   <strong class="user">jason at joeymail dot net</strong>
   <a href="#101687" class="date">04-Jan-2011 04:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Yet another attempt a wheel re-invention, using match with offsets rather than split...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">unserializesession</span><span class="keyword">( </span><span class="default">$data </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(&nbsp; </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return array();<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// match all the session keys and offsets<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/(^|;|\})([a-zA-Z0-9_]+)\|/i'</span><span class="keyword">, </span><span class="default">$data</span><span class="keyword">, </span><span class="default">$matchesarray</span><span class="keyword">, </span><span class="default">PREG_OFFSET_CAPTURE</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$returnArray </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lastOffset </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$currentKey </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$matchesarray</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] as </span><span class="default">$value </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_null</span><span class="keyword">( </span><span class="default">$lastOffset</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$valueText </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$lastOffset</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">- </span><span class="default">$lastOffset </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$currentKey</span><span class="keyword">] = </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$valueText</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currentKey </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastOffset </span><span class="keyword">= </span><span class="default">$offset </span><span class="keyword">+ </span><span class="default">strlen</span><span class="keyword">( </span><span class="default">$currentKey </span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$valueText </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$lastOffset </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$returnArray</span><span class="keyword">[</span><span class="default">$currentKey</span><span class="keyword">] = </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$valueText</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$returnArray</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101428""></a>
  <div class="note">
   <strong class="user">davyvandenbremt at gmail dot com</strong>
   <a href="#101428" class="date">16-Dec-2010 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's what we are using to unserialize the session.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">unserialize_session</span><span class="keyword">(</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// prefixing with semicolon to make it easier to write the regular expression<br />
&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="string">';' </span><span class="keyword">. </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// regularexpression to find the keys<br />
&nbsp; </span><span class="default">$keyreg </span><span class="keyword">= </span><span class="string">'/;([^|{}"]+)\|/'</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// find all keys<br />
&nbsp; </span><span class="default">$matches </span><span class="keyword">= array();<br />
&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="default">$keyreg</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br />
&nbsp; <br />
&nbsp; </span><span class="comment">// only go further if we found some keys<br />
&nbsp; </span><span class="keyword">if (isset(</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">])) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$keys </span><span class="keyword">= </span><span class="default">$matches</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// find the values by splitting the input on the key regular expression<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="default">$keyreg</span><span class="keyword">, </span><span class="default">$val</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// unshift the first value since it's always empty (due to our semicolon prefix)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">) &gt; </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$values</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// combine the $keys and $values<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">array_combine</span><span class="keyword">(</span><span class="default">$keys</span><span class="keyword">, </span><span class="default">$values</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; <br />
&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79244""></a>
  <div class="note">
   <strong class="user">deminy at deminy dot net</strong>
   <a href="#79244" class="date">16-Nov-2007 01:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
1. Reply to ac's post:<br />
<br />
As I mentioned at <a href="http://us.php.net/manual/en/function.unserialize.php#76977 , the regular expression used to unserialize a PHP session data won" rel="nofollow" target="_blank">http://us.php.net/manual/en/function.unserialize.php#76977 , the regular expression used to unserialize a PHP session data won</a>'t work if the session data contains string variable which contains character '|'.<br />
<br />
Here is a simple example I just come up with to show when the function unserializesession() won't work.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">unserializesession</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$vars</span><span class="keyword">=</span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">'/([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff^|]*)\|/'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">,-</span><span class="default">1</span><span class="keyword">,</span><span class="default">PREG_SPLIT_NO_EMPTY </span><span class="keyword">| </span><span class="default">PREG_SPLIT_DELIM_CAPTURE</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$vars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]; </span><span class="default">$i</span><span class="keyword">++) </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$vars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">++]]=</span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">$vars</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">session_start</span><span class="keyword">();<br />
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'var'</span><span class="keyword">] = </span><span class="string">'a|b'</span><span class="keyword">; <br />
</span><span class="default">$str </span><span class="keyword">= </span><span class="default">session_encode</span><span class="keyword">();<br />
</span><span class="default">$arr </span><span class="keyword">= </span><span class="default">unserializesession</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">);<br />
echo </span><span class="string">"&lt;br /&gt;\n"</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
2. Reply to bmorel's post:<br />
<br />
Your function session_real_decode() is very nice to decode session data without involving with session functions. It works in most cases, but when dealing with reference variables, there is another case which should also be handled:<br />
<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php </span><span class="keyword">case </span><span class="string">'r'</span><span class="keyword">: </span><span class="comment">/* reference&nbsp; */ // R in lowercase </span><span class="default">?&gt;<br />
</span><br />
I found this bug on PHP 5.1.6 several months ago, but don't know if it exsits in other version of PHP or not. Also, I am not sure if similiar bugs exist when handling other data types.<br />
<br />
So here is my suggestion to revise the function, <br />
2.1. <br />
&nbsp;&nbsp;&nbsp; change the switch statement from<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php </span><span class="keyword">switch (</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$q</span><span class="keyword">]) { </span><span class="default">?&gt;<br />
</span>&nbsp; &nbsp; to<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php </span><span class="keyword">switch (</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$q</span><span class="keyword">])) { </span><span class="default">?&gt;<br />
</span>2.2. <br />
&nbsp;&nbsp;&nbsp; In all case statements, use lowercase characters only for character comparison. For example,<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php </span><span class="keyword">case </span><span class="string">'R'</span><span class="keyword">: </span><span class="comment">/* reference&nbsp; */ </span><span class="default">?&gt;<br />
</span>&nbsp; &nbsp; should be be written as <br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php </span><span class="keyword">case </span><span class="string">'r'</span><span class="keyword">: </span><span class="comment">/* reference&nbsp; */ </span><span class="default">?&gt;<br />
</span><br />
(I don't want to put long code here, so just leave pieces of code to save spaces)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78640""></a>
  <div class="note">
   <strong class="user">ac</strong>
   <a href="#78640" class="date">20-Oct-2007 07:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this solved my |&nbsp;problem:<br />
<br />
function unserializesession($data) {<br />
&nbsp;&nbsp;&nbsp; $vars=preg_split('/([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff^|]*)\|/',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $data,-1,PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);<br />
&nbsp;&nbsp;&nbsp; for($i=0; $vars[$i]; $i++) $result[$vars[$i++]]=unserialize($vars[$i]);<br />
&nbsp;&nbsp;&nbsp; return $result;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69111""></a>
  <div class="note">
   <strong class="user">leon dot pegg at gmail dot com</strong>
   <a href="#69111" class="date">23-Aug-2006 08:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i have found this to be a better way to restore session data while keeping your current session.<br />
<br />
function decode_session($session_string){<br />
&nbsp;&nbsp;&nbsp; $current_session = session_encode();<br />
&nbsp;&nbsp;&nbsp; foreach ($_SESSION as $key =&gt; $value){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($_SESSION[$key]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; session_decode($session_string);<br />
&nbsp;&nbsp;&nbsp; $restored_session = $_SESSION;<br />
&nbsp;&nbsp;&nbsp; foreach ($_SESSION as $key =&gt; $value){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($_SESSION[$key]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; session_decode($current_session);<br />
&nbsp;&nbsp;&nbsp; return $restored_session;<br />
}<br />
<br />
enjoy</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68155""></a>
  <div class="note">
   <strong class="user">xueron at gmail dot com</strong>
   <a href="#68155" class="date">15-Jul-2006 09:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a perl reg:<br />
<br />
$s = session_encoded_value;<br />
%res = $s =~ /([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)\|([^\|]*[\;\}])/g;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61177""></a>
  <div class="note">
   <strong class="user">nero321 at zmail dot sk</strong>
   <a href="#61177" class="date">27-Jan-2006 05:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another solution for decoding session string to "$_SESSION"-like array:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// returns decoded string as arrays of variables<br />
//&nbsp;&nbsp; or false on error (when session_decode returns false)<br />
</span><span class="keyword">function </span><span class="default">DecodeSession</span><span class="keyword">(</span><span class="default">$sess_string</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// save current session data<br />
&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp; and flush $_SESSION array<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$old </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// try to decode passed string<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">session_decode</span><span class="keyword">(</span><span class="default">$sess_string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$ret</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if passed string is not session data,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //&nbsp;&nbsp; retrieve saved (old) session data<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //&nbsp;&nbsp; and return false<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= </span><span class="default">$old</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// save decoded session data to sess_array<br />
&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp; and flush $_SESSION array<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sess_array </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// restore old session data<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= </span><span class="default">$old</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// return decoded session data<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$sess_array</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Example of use:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$sarr </span><span class="keyword">= </span><span class="default">DecodeSession</span><span class="keyword">(</span><span class="default">$sess_str</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$sarr</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
But I have not tested performance.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57897""></a>
  <div class="note">
   <strong class="user">erwinmoller at xs4all dot nl</strong>
   <a href="#57897" class="date">18-Oct-2005 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The regExp-method describe earlier doesn't work under all conditions.<br />
<br />
If I feed this:<br />
voornaam|s:8:"Ai|;\'\"";achternaam|s:6:"werrwe";leeftijd|i:44;<br />
<br />
I get this:<br />
array(4) {<br />
&nbsp; ["voornaam"]=&gt;<br />
&nbsp; bool(false)<br />
&nbsp; ["Ai"]=&gt;<br />
&nbsp; bool(false)<br />
&nbsp; ["achternaam"]=&gt;<br />
&nbsp; string(6) "werrwe"<br />
&nbsp; ["leeftijd"]=&gt;<br />
&nbsp; int(44)<br />
}<br />
<br />
while I expected:<br />
array(3) {<br />
&nbsp; ["voornaam"]=&gt;<br />
&nbsp; string(8) "Ai|;\'\""<br />
&nbsp; ["achternaam"]=&gt;<br />
&nbsp; string(6) "werrwe"<br />
&nbsp; ["leeftijd"]=&gt;<br />
&nbsp; int(44)<br />
}<br />
<br />
I think the | is messing things up. :-/</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55307""></a>
  <div class="note">
   <strong class="user">brett at brettbrewer dot com</strong>
   <a href="#55307" class="date">29-Jul-2005 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have made a minor change to fabrizio's (et all) version of the unserializesession function because it was choking on underscores in my variable names.&nbsp; Here is the correct version which should account for ALL possible PHP variable names:<br />
<br />
function unserializesession($data) {<br />
&nbsp;&nbsp; $vars=preg_split(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '/([a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*)\|/',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $data,-1,PREG_SPLIT_NO_EMPTY |&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; PREG_SPLIT_DELIM_CAPTURE<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br />
&nbsp;&nbsp; for($i=0; $vars[$i]; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; $result[$vars[$i++]]=unserialize($vars[$i]);&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return $result;<br />
}<br />
<br />
Please note that I had to split the preg_split function call above into 4 lines due to the limitations of this forum. This version changes the regex used to find variable names so that it complies with the specs for&nbsp; variable names as specified in the PHP manual at <a href="http://us3.php.net/manual/en/language.variables.php. I just took the regex directly from the PHP manual pages where they give the regex equivalent for a valid variable name as: " rel="nofollow" target="_blank">http://us3.php.net/manual/en/language.variables.php. I just took the regex directly from the PHP manual pages where they give the regex equivalent for a valid variable name as: </a><br />
<br />
[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*<br />
<br />
Anyway, this seems to work great for me now, even on gigantic strings of encoded session data.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53232""></a>
  <div class="note">
   <strong class="user">vesely at tana dot it</strong>
   <a href="#53232" class="date">26-May-2005 03:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using this function to manage sessions, it is MUCH<br />
better to have register_globals turned off. Then one can<br />
examine the session content given its id.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $fname </span><span class="keyword">= </span><span class="default">session_save_path</span><span class="keyword">() . </span><span class="string">"/sess_" </span><span class="keyword">. </span><span class="default">$the_sid</span><span class="keyword">;<br />
&nbsp;&nbsp; if (</span><span class="default">session_decode</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$fname</span><span class="keyword">)))<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$vars </span><span class="keyword">= </span><span class="default">$_SESSION</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// examine $vars...<br />
&nbsp;&nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
Depending on PHP version, you may need to have a dummy<br />
session started for the code above to work. I reset the<br />
$_SESSION immediately in order to avoid writing the<br />
dummy session: that's needed while testing the code!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52874""></a>
  <div class="note">
   <strong class="user">fabrizio dot messina at gmail dot com</strong>
   <a href="#52874" class="date">16-May-2005 06:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this function _really_ split and decode session data:<br />
<br />
function unserializesession($data) {<br />
&nbsp;&nbsp; $vars=preg_split('/([a-zA-Z0-9]+)\|/',$data,-1,PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);<br />
&nbsp;&nbsp; for($i=0; $vars[$i]; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; $result[$vars[$i++]]=unserialize($vars[$i]);&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; return $result;<br />
}<br />
<br />
the difference from previously posted 'unserializesession' function is the regular expression inside function preg_split ('[a-zA-Z0-9]+' vs&nbsp; '[a-z,A-Z]+' )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42945""></a>
  <div class="note">
   <strong class="user">sco at postmaster dot co dot uk</strong>
   <a href="#42945" class="date">04-Jun-2004 07:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're trying to access your session data from outside the regular php session functions, you might want to use WDDX as your serializer, as opposed to the normal php serializer. When your data is serialized as XML, obviously it's easy to unserialize as you please.<br />
<br />
WDDX seems to be a little slower, and the text string it creates is much bigger than that created by the normal php serializer, but it provides the functionality with minimal hassle.<br />
<br />
Donal</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41187""></a>
  <div class="note">
   <strong class="user">forum at orthanc dot co dot nz</strong>
   <a href="#41187" class="date">02-Apr-2004 12:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Becarful using this if you are trying to switch out of an existing session rather than load one into a clean slate.<br />
<br />
session_decode doesn't destroy the existing session data, it will over write it if there is a session variable of the same name, but if the names don't clash the existing session variables will hang around.<br />
<br />
I have yet to find a better solution than<br />
<br />
session_destroy()<br />
session_start()<br />
session_decode(....);<br />
<br />
-----------------------------------------<br />
To explain what I'm talking about<br />
<br />
&lt;?<br />
&nbsp;&nbsp;&nbsp; session_start();<br />
&nbsp;&nbsp;&nbsp; $a = 5;<br />
&nbsp;&nbsp;&nbsp; session_register('a');<br />
&nbsp;&nbsp;&nbsp; session_decode("&lt;session that doesn't have a as a session variable&gt;");<br />
&nbsp;&nbsp;&nbsp; print (session_is_registered('a') ? $a : 'Not Registered' );<br />
?&gt;<br />
<br />
The above code will print '5' as $a hasn't been destroyed or even unregistered by the session_decode</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38221""></a>
  <div class="note">
   <strong class="user">njail</strong>
   <a href="#38221" class="date">12-Dec-2003 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?PHP<br />
</span><span class="comment">// Get Session Content<br />
</span><span class="default">$varsess </span><span class="keyword">= Array(</span><span class="string">'SESSION'</span><span class="keyword">);<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$varsess</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />
{<br />
&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(${</span><span class="string">"_</span><span class="keyword">{</span><span class="default">$varsess</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">}))<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; foreach (${</span><span class="string">"_</span><span class="keyword">{</span><span class="default">$varsess</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">} as </span><span class="default">$var</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; $</span><span class="default">$var </span><span class="keyword">= </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// print "Var :".$var." -- Value :".$val."\n&lt;br&gt;";<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp; }<br />
&nbsp; unset(${</span><span class="string">"_</span><span class="keyword">{</span><span class="default">$varsess</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]}</span><span class="string">"</span><span class="keyword">});<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35147""></a>
  <div class="note">
   <strong class="user">petej*shaman_ca</strong>
   <a href="#35147" class="date">21-Aug-2003 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Seems like there was a change in the behavior of this function somewhere between 4.1.2 and 4.3.3.&nbsp; In 4.1.2 session_decode() didn't care whether the session was started, and would just decode the string into the _SESSION array.&nbsp; In my 4.3.3 install, session_decode() wouldn't work unless I explicitly started the session with session_start().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
