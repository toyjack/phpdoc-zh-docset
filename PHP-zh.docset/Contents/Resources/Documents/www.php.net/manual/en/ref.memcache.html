<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Memcache 函数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="memcache.setserverparams.html">? Memcache::setServerParams</a></li>
      <li style="float: right;"><a href="function.memcache-debug.html">memcache_debug ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.memcache.html">Memcache</a></li>
    <li>Memcache 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.memcache" class="reference">
 <h1 class="title">Memcache 函数</h1>
 







<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.memcache-debug.html">memcache_debug</a> &mdash; 转换调试输出的开/关</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="94689""></a>
  <div class="note">
   <strong class="user">dweller at devonweller dot com</strong>
   <a href="#94689" class="date">18-Nov-2009 09:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In the memcache PECL extension version 2.2.5, the delete function does not work with memcached 1.4.3.&nbsp; To work around this, here is a version of the memcache PECL extension with a patch provided by harv at pringo dot com applied:
<br />

<br />
<a href="http://code.google.com/p/phpmemcachepatch/downloads/list" rel="nofollow" target="_blank">http://code.google.com/p/phpmemcachepatch/downloads/list</a>
<br />

<br />
To install: download 
<br />

<br />
<a href="http://phpmemcachepatch.googlecode.com/files/memcache-2.2.5b.tgz " rel="nofollow" target="_blank">http://phpmemcachepatch.googlecode.com/files/memcache-2.2.5b.tgz </a>
<br />

<br />
and do:
<br />

<br />
pecl install memcache-2.2.5b.tgz</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81240""></a>
  <div class="note">
   <strong class="user">restlessmind at I dot gmail dot HATE dot com dot SPAM</strong>
   <a href="#81240" class="date">19-Feb-2008 01:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying install this module for PHP 5.2 under Windows but it won't load on startup, make sure you have all your dependencies including the correct thread-safety build of PHP.<br />
<br />
For hours I tried to track down why I couldn't load php_memcache.dll, and finally used Dependency Walker (from <a href="http://www.dependencywalker.com" rel="nofollow" target="_blank">http://www.dependencywalker.com</a>) on the .dll file.&nbsp; This made me realize that while I was using the version of PHP 5.2.5 that was non-thread safe, the .dll offered by pecl4win was expecting the thread safe version of PHP.&nbsp; Once I rectified this, everything worked fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80747""></a>
  <div class="note">
   <strong class="user">contact at codeassembly dot com</strong>
   <a href="#80747" class="date">30-Jan-2008 06:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that there is no way to have your own hashing mechanism, the best way to group a set of objects to a server is to manually select the server to use.<br />
<br />
I want to keep all objects for a certain user on the same server.<br />
<br />
user_54_description<br />
user_54_info<br />
user_54_comments<br />
user_54_etc<br />
.<br />
.<br />
<br />
If I have all these objects on the same server I can get all data with only one call to memcache -&gt; get (get_multi), so this improves performance a lot.<br />
<br />
The way I do this is by hashing the User/Object id to to the number of servers.<br />
<br />
<span class="default">&lt;?php<br />
$memcache_hosts </span><span class="keyword">= array<br />
(<br />
</span><span class="string">'192.168.1.1'</span><span class="keyword">,<br />
</span><span class="string">'192.168.1.2'</span><span class="keyword">,<br />
</span><span class="string">'192.168.1.3'</span><span class="keyword">,<br />
</span><span class="string">'192.168.1.4'</span><span class="keyword">,<br />
</span><span class="string">'192.168.1.5'</span><span class="keyword">,<br />
);<br />
<br />
</span><span class="default">$server </span><span class="keyword">= </span><span class="default">$id </span><span class="keyword">% </span><span class="default">count</span><span class="keyword">(</span><span class="default">$memcache_hosts</span><span class="keyword">);<br />
<br />
</span><span class="default">$memcache </span><span class="keyword">= new </span><span class="default">Memcache</span><span class="keyword">;<br />
</span><span class="default">$memcache</span><span class="keyword">-&gt;</span><span class="default">connect</span><span class="keyword">(</span><span class="default">$memcache_hosts</span><span class="keyword">[</span><span class="default">$server</span><span class="keyword">], </span><span class="default">11211</span><span class="keyword">);<br />
<br />
</span><span class="comment">//get or set your objects here<br />
</span><span class="default">?&gt;<br />
</span><br />
You can leave other objects that you don't want to group to memcache extension to hash and select the appropiate server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78156""></a>
  <div class="note">
   <strong class="user">mogmios at gmail dot com</strong>
   <a href="#78156" class="date">30-Sep-2007 09:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When installing the memcache module for Apache/PHP with a non-standard location it seems like there is no way to define the location when configuring for build. You'll get an error complaining about being unable to find php_session.h. I modified configure to try the PREFIX location too and that seems to have worked fine.<br />
<br />
&nbsp;&nbsp;&nbsp; if test -f "${prefix}/include/php/ext/session/php_session.h"; then<br />
&nbsp;&nbsp; &nbsp;&nbsp; session_inc_path="${prefix}/include/php"<br />
&nbsp;&nbsp;&nbsp; elif test -f "$abs_srcdir/include/php/ext/session/php_session.h"; then<br />
&nbsp;&nbsp; &nbsp;&nbsp; session_inc_path="$abs_srcdir/include/php"<br />
&nbsp;&nbsp;&nbsp; elif test -f "$abs_srcdir/ext/session/php_session.h"; then<br />
&nbsp;&nbsp; &nbsp;&nbsp; session_inc_path="$abs_srcdir"<br />
&nbsp;&nbsp;&nbsp; elif test -f "$phpincludedir/ext/session/php_session.h"; then<br />
&nbsp;&nbsp; &nbsp;&nbsp; session_inc_path="$phpincludedir"<br />
&nbsp;&nbsp;&nbsp; fi</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77296""></a>
  <div class="note">
   <strong class="user">Colin Guthrie</strong>
   <a href="#77296" class="date">23-Aug-2007 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have noticed a bug/documentation error:<br />
<br />
The above docs say the following about the session.save_path arguement:<br />
"Each url may contain parameters which are applied to that server, they are the same as for the Memcache::addServer() method. "<br />
<br />
addServer method's docs say:<br />
"port<br />
<br />
&nbsp;&nbsp;&nbsp; Point to the port where memcached is listening for connections. This parameter is optional and its default value is 11211. Set this parameter to 0 when using UNIX domain sockets. "<br />
<br />
However when specifying the save_path, I have found that with PHP 5.2.3 and memcache 2.1.2 that the port is a *required* part of the string.<br />
<br />
Hope that helps some people scratching their heads.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75997""></a>
  <div class="note">
   <strong class="user">markfrawley at gmail dot com</strong>
   <a href="#75997" class="date">26-Jun-2007 01:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a PHP4 backport of the above MemcacheAggregator class:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MemcachedAggregator </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$connections</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$_servers</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">MemcachedAggregator</span><span class="keyword">(</span><span class="default">$servers</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_servers </span><span class="keyword">= </span><span class="default">$servers</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Attempt to establish/retrieve persistent connections to all servers.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // If any of them fail, they just don't get put into our list of active<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // connections.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$servers</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$n</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$server </span><span class="keyword">= </span><span class="default">$servers</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$con </span><span class="keyword">= </span><span class="default">memcache_connect</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//memcache_debug(1); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //$memcache = &amp;new Memcache;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //$con = $memcache-&gt;connect($server['host']);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!(</span><span class="default">$con </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[] = &amp;</span><span class="default">$con</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hashCode </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hashCode </span><span class="keyword">= (int)((</span><span class="default">$hashCode</span><span class="keyword">*</span><span class="default">33</span><span class="keyword">)+</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) &amp; </span><span class="default">0x7fffffff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ((</span><span class="default">$ns </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">)) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[</span><span class="default">$hashCode</span><span class="keyword">%</span><span class="default">$ns</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//return $this-&gt;connections[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">debug</span><span class="keyword">(</span><span class="default">$on_off</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]-&gt;</span><span class="default">debug</span><span class="keyword">(</span><span class="default">$on_off</span><span class="keyword">)) </span><span class="default">$result </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">flush</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]-&gt;</span><span class="default">flush</span><span class="keyword">()) </span><span class="default">$result </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/// The following are not implemented:<br />
&nbsp;&nbsp;&nbsp; ///getStats()<br />
&nbsp;&nbsp;&nbsp; ///getVersion()<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dest </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$key </span><span class="keyword">as </span><span class="default">$subkey</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">get</span><span class="keyword">(</span><span class="default">$subkey</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!(</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)) </span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$subkey</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$dest</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">add</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">add</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">replace</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">replace</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">delete</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">delete</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">increment</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">increment</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">decrement</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= &amp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">decrement</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">showStats</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stats_out </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$server </span><span class="keyword">== </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections </span><span class="keyword">as </span><span class="default">$conn</span><span class="keyword">) {&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$server </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_servers</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stats_array </span><span class="keyword">= </span><span class="default">memcache_get_stats</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stats_out </span><span class="keyword">.= </span><span class="string">"&lt;/br&gt;&lt;b&gt;Server: "</span><span class="keyword">.</span><span class="default">$server</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">].</span><span class="string">": &lt;/b&gt;&lt;br/&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$stats_array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$stats_out </span><span class="keyword">.= </span><span class="string">"</span><span class="default">$key</span><span class="string"> =&gt; </span><span class="default">$val</span><span class="string"> &lt;br/&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$stats_out</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75232""></a>
  <div class="note">
   <strong class="user">moazzamk at gmail dot com</strong>
   <a href="#75232" class="date">18-May-2007 03:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can't call parent::__construct() in the constructor of your class if you are extending the memcache class. However, not running the constructor still initiates it and works fine. <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// wrong<br />
<br />
</span><span class="keyword">class </span><span class="default">a </span><span class="keyword">extends </span><span class="default">Memcache </span><span class="keyword">{<br />
&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
</span><span class="comment">//correct<br />
</span><span class="keyword">class </span><span class="default">a </span><span class="keyword">extends </span><span class="default">Memcache </span><span class="keyword">{<br />
&nbsp; function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connect</span><span class="keyword">(</span><span class="default">$host</span><span class="keyword">, </span><span class="default">$port</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I am guessing this applies to all native/PECL classes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74418""></a>
  <div class="note">
   <strong class="user">gil at squidoo dot com</strong>
   <a href="#74418" class="date">10-Apr-2007 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is a tiny bug in the Aggregator class when using the flush() function. The reference to $connections should be $this-&gt;connections.<br />
<br />
Change:<br />
<br />
public function flush() {<br />
&nbsp; $result = false;<br />
&nbsp; for ($i = 0; $i &lt; count($connections); $i++) {<br />
&nbsp;&nbsp;&nbsp; if ($this-&gt;connections[$i]-&gt;flush()) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $result = true;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return $result;<br />
}<br />
<br />
To:<br />
<br />
public function flush() {<br />
&nbsp; $result = false;<br />
&nbsp; for ($i = 0; $i &lt; count($this-&gt;connections); $i++) {<br />
&nbsp;&nbsp;&nbsp; if ($this-&gt;connections[$i]-&gt;flush()) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $result = true;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; return $result;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72239""></a>
  <div class="note">
   <strong class="user">jcastromail at yahoo dot es</strong>
   <a href="#72239" class="date">08-Jan-2007 05:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi there:
<br />

<br />
For run memcached in a windows box: (tested with latest php,apache and memcache in xp sp2)
<br />

<br />
a) download the php_memcache.dll it can be found in the pecl file.
<br />

<br />
b) put the dll in the extension folder (c:/php/extension for example). You cannot miss this folder because they are filled with php*.dll files.&nbsp; In some cases the extension folder used is the system32, a non-standard way to put dll but still works.
<br />

<br />
c)configure the php.ini
<br />
; i put this like the latest extension
<br />
extension=php_memcache.dll
<br />

<br />
; i'm not sure about this but don't hurts..
<br />
[Memcache]
<br />
memcache.allow_failover = 1 
<br />
memcache.max_failover_attempts=20 
<br />
memcache.chunk_size =8192
<br />
memcache.default_port = 11211
<br />

<br />
d)This is important, memcached works with a EXTERNAL service. This service must be downloaded and installed prior to use the memcache.&nbsp; I use:&nbsp; <a href="http://jehiah.cz/projects/memcached-win32/" rel="nofollow" target="_blank">http://jehiah.cz/projects/memcached-win32/</a>
<br />

<br />
e)Remember to install the service and to start the service memcached.exe -d install for install and run services.msc for start the memcached service (or restart the system).
<br />

<br />
f) check the firewall ports.
<br />

<br />
Finally restart the apache/iis and runs some test. At least in phpinfo must show some info about the memcache.
<br />

<br />
Final notes :The "awe" about memcache is not only can help for speed some process (or reduce the cpu use), also can be used like a global session for store a whole object also this "global session" is shared among all the users, like APPLICATION used in ASP.&nbsp; So (for example) it's possible to do a user counter without needing of database or writing a file.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70760""></a>
  <div class="note">
   <strong class="user">ed at me3inc dot com</strong>
   <a href="#70760" class="date">26-Oct-2006 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re. Installing the memcache extension:<br />
<br />
I had all kinds of troubles getting it hooked up, because in all of the instructions I read I never got the last, most important step - you must have a php.ini and have in it "extension=memcache.so." <br />
<br />
So, the steps:<br />
First - ./configure with --enable-memcache. This should show in your phpinfo() at the top (even though nothing of the memcache extension works yet).<br />
<br />
Second:<br />
either pecl install memcache<br />
OR<br />
download the source<br />
tar -xzvf [thesourcetarball]<br />
phpize<br />
./configure<br />
make<br />
make install<br />
<br />
Finally: Add extension=memcache.so to your php.ini. (If you don't have one, it should go in the root of where php is called ie., /usr/local/lib)<br />
<br />
Call phpinfo() and you should see a memcache section.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60901""></a>
  <div class="note">
   <strong class="user">iliya at pisem dot net</strong>
   <a href="#60901" class="date">19-Jan-2006 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
one more "intelligent" cache aggregator:<br />
https://svn.shadanakar.org/onPHP/ trunk/core/Cache/AggregateCache.class.php<br />
can be used with several cache connectors - memcached, filesystem, etc.<br />
(remove whitespace manually)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56771""></a>
  <div class="note">
   <strong class="user">Ron</strong>
   <a href="#56771" class="date">14-Sep-2005 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An improvement to the above:<br />
<br />
The above class will cause an error if all cache servers are down.&nbsp; The preferred behavior is to just have a cache miss (or take no action in the case of write operations) and return false, so the app can run in non-cached mode if all cache servers are down.<br />
<br />
To make this happen, simply change the connection usage to look something like this in each affected function.&nbsp; This code is for the get() function:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $con = $this-&gt;_getConForKey($key);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($con === false) return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $con-&gt;get($key);<br />
<br />
Similarly, the affected code in the set() function would look like this:<br />
&nbsp;&nbsp;&nbsp; $con = $this-&gt;_getConForKey($key);<br />
&nbsp;&nbsp;&nbsp; if ($con === false) return false;<br />
&nbsp;&nbsp;&nbsp; return $con-&gt;set($key, $var, $compress, $expire);<br />
<br />
Modify each function accordingly, and if all of your cache servers are down, you can still function (although more slowly due to the 100% cache miss rate).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56765""></a>
  <div class="note">
   <strong class="user">Ron</strong>
   <a href="#56765" class="date">14-Sep-2005 10:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a simple memcached aggregator class which distributes the cache among multiple cache servers.&nbsp; If a server fails, the load is redistributed automatically.&nbsp; It uses persistent connections.<br />
<br />
The constructor takes an array of arrays, with each inner array representing a server, with a 'server' (string) attribute that is the IP addres or host name of the memcached server, and a 'port' (int) attribute that is the port number on which memcached is running on the server.<br />
<br />
All of the existing memcached API functions are implemented except getStats() and getVersion(), which are server-specific.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">MemcachedAggregator </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$connections</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$servers</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Attempt to establish/retrieve persistent connections to all servers.<br />
&nbsp;&nbsp;&nbsp; // If any of them fail, they just don't get put into our list of active<br />
&nbsp;&nbsp;&nbsp; // connections.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$n </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$servers</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$n</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$server </span><span class="keyword">= </span><span class="default">$servers</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$con </span><span class="keyword">= </span><span class="default">memcache_pconnect</span><span class="keyword">(</span><span class="default">$server</span><span class="keyword">[</span><span class="string">'host'</span><span class="keyword">], </span><span class="default">$server</span><span class="keyword">[</span><span class="string">'port'</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!(</span><span class="default">$con </span><span class="keyword">== </span><span class="default">false</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[] = </span><span class="default">$con</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; private function </span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$hashCode </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hashCode </span><span class="keyword">= (int)((</span><span class="default">$hashCode</span><span class="keyword">*</span><span class="default">33</span><span class="keyword">)+</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">])) &amp; </span><span class="default">0x7fffffff</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ((</span><span class="default">$ns </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">)) &gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[</span><span class="default">$hashCode</span><span class="keyword">%</span><span class="default">$ns</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">debug</span><span class="keyword">(</span><span class="default">$on_off</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$connections</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]-&gt;</span><span class="default">debug</span><span class="keyword">(</span><span class="default">$on_off</span><span class="keyword">)) </span><span class="default">$result </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">flush</span><span class="keyword">() {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$connections</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">connections</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]-&gt;</span><span class="default">flush</span><span class="keyword">()) </span><span class="default">$result </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="comment">/// The following are not implemented:<br />
///getStats()<br />
///getVersion()<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dest </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$key </span><span class="keyword">as </span><span class="default">$subkey</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$val </span><span class="keyword">= </span><span class="default">get</span><span class="keyword">(</span><span class="default">$subkey</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!(</span><span class="default">$val </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">)) </span><span class="default">$dest</span><span class="keyword">[</span><span class="default">$subkey</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$dest</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)-&gt;</span><span class="default">get</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)-&gt;</span><span class="default">set</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">add</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)-&gt;</span><span class="default">add</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">replace</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)-&gt;</span><span class="default">replace<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$var</span><span class="keyword">, </span><span class="default">$compress</span><span class="keyword">, </span><span class="default">$expire</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">delete</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)-&gt;</span><span class="default">delete</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">increment</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)-&gt;</span><span class="default">increment</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">decrement</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_getConForKey</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">)-&gt;</span><span class="default">decrement</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
