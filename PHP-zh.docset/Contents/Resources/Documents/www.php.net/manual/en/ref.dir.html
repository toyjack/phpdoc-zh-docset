<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>目录函数函数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="directory.rewind.html">? Directory::rewind</a></li>
      <li style="float: right;"><a href="function.chdir.html">chdir ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.dir.html">目录</a></li>
    <li>目录函数函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.dir" class="reference">
 <h1 class="title">目录函数函数</h1>

 <div class="partintro">
  <h1 class="title">参见</h1>
  <p class="para">
   相关函数，例如：<span class="function"><a href="function.dirname.html" class="function">dirname()</a></span>、
   <span class="function"><a href="function.is-dir.html" class="function">is_dir()</a></span>、 <span class="function"><a href="function.mkdir.html" class="function">mkdir()</a></span> 和
   <span class="function"><a href="function.rmdir.html" class="function">rmdir()</a></span>，
   请查看<a href="ref.filesystem.html" class="link">文件系统</a>章节。
  </p>
 </div>

 












































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.chdir.html">chdir</a> &mdash; 改变目录</li><li><a href="function.chroot.html">chroot</a> &mdash; 改变根目录</li><li><a href="function.closedir.html">closedir</a> &mdash; 关闭目录句柄</li><li><a href="function.dir.html">dir</a> &mdash; 返回一个 Directory 类实例</li><li><a href="function.getcwd.html">getcwd</a> &mdash; 取得当前工作目录</li><li><a href="function.opendir.html">opendir</a> &mdash; 打开目录句柄</li><li><a href="function.readdir.html">readdir</a> &mdash; 从目录句柄中读取条目</li><li><a href="function.rewinddir.html">rewinddir</a> &mdash; 倒回目录句柄</li><li><a href="function.scandir.html">scandir</a> &mdash; 列出指定路径中的文件和目录</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="77500""></a>
  <div class="note">
   <strong class="user">Jean-Paul Wattiaux</strong>
   <a href="#77500" class="date">31-Aug-2007 08:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Mine works as long as the samba volume is actually mounted. Having it listed in the "My Computer" window doesn't warrant that.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77225""></a>
  <div class="note">
   <strong class="user">adrian</strong>
   <a href="#77225" class="date">20-Aug-2007 02:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Samba mounts under a Windows environment are not accessible using the mounted drive letter. For instance, if you have drive X: in Windows mounted to //example.local/shared_dir (where example.local is a *nix box running Samba), the following constructs<br />
<br />
$dir = "X:\\data\\";<br />
$handle = opendir( $dir );<br />
or<br />
$d = dir( $dir );<br />
<br />
will return a warning message "failed to open dir: No error"<br />
<br />
On the other hand, using the underlying mapping info works just fine. For example:<br />
<br />
$dir = "//example.local/shared_dir/data";<br />
$handle = opendir( $dir );<br />
or<br />
$d = dir( $dir );<br />
<br />
Both cases do what they're expected to.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74160""></a>
  <div class="note">
   <strong class="user">phdwight at yahoo dot com</strong>
   <a href="#74160" class="date">27-Mar-2007 07:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have posted this same observation in scandir, and found out that it is not limited to scandir alone but to ALL directory functions.<br />
<br />
Directory functions DOES NOT currently supports Japanese characters.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69680""></a>
  <div class="note">
   <strong class="user">dkflbk at nm dot ru</strong>
   <a href="#69680" class="date">14-Sep-2006 04:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a simple backup script which puts all files in his folder (and all of the sub-folders) in one TAR archive...<br />
(It's classic TAR format not USTAR, so filename and path to it can't be longer then 99 chars)<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/***********************************************************<br />
&nbsp;*&nbsp;&nbsp; Title:&nbsp; Classic-TAR based backup script v0.0.1-dev<br />
&nbsp; **********************************************************/<br />
<br />
</span><span class="keyword">Class </span><span class="default">Tar_by_Vladson </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$tar_file</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$fp</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">Tar_by_Vladson</span><span class="keyword">(</span><span class="default">$tar_file</span><span class="keyword">=</span><span class="string">'backup.tar'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">tar_file </span><span class="keyword">= </span><span class="default">$tar_file</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">tar_file</span><span class="keyword">, </span><span class="string">"wb"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tree </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">build_tree</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">process_tree</span><span class="keyword">(</span><span class="default">$tree</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fp</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"a512"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fp</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">build_tree</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">=</span><span class="string">'.'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">false </span><span class="keyword">!== (</span><span class="default">$readdir </span><span class="keyword">= </span><span class="default">readdir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">))){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$readdir </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$readdir </span><span class="keyword">!= </span><span class="string">'..'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">= </span><span class="default">$dir</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$readdir</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output</span><span class="keyword">[] = </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">)).</span><span class="string">'/'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">build_tree</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closedir</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$output</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">process_tree</span><span class="keyword">(</span><span class="default">$tree</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$tree </span><span class="keyword">as </span><span class="default">$pathfile </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">'/'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fp</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">build_header</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif (</span><span class="default">$pathfile </span><span class="keyword">!= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">tar_file</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$filesize </span><span class="keyword">= </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$block_len </span><span class="keyword">= </span><span class="default">512</span><span class="keyword">*</span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$filesize</span><span class="keyword">/</span><span class="default">512</span><span class="keyword">)-</span><span class="default">$filesize</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fp</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">build_header</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fp</span><span class="keyword">, </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fputs</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fp</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"a"</span><span class="keyword">.</span><span class="default">$block_len</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">build_header</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">) &gt; </span><span class="default">99 </span><span class="keyword">) die(</span><span class="string">'Error'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">stat</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">) ) </span><span class="default">$info</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">] = </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(</span><span class="string">"a100a8a8a8a12A12a8a1a100a255"</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pathfile</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%6s "</span><span class="keyword">, </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">])),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%6s "</span><span class="keyword">, </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">])),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%6s "</span><span class="keyword">, </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">])),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%11s "</span><span class="keyword">,</span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">7</span><span class="keyword">])),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%11s"</span><span class="keyword">, </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">9</span><span class="keyword">])),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%8s"</span><span class="keyword">, </span><span class="string">" "</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">is_dir</span><span class="keyword">(</span><span class="default">$pathfile</span><span class="keyword">) ? </span><span class="string">"5" </span><span class="keyword">: </span><span class="string">"0"</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">""</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">""<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">clearstatcache</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$checksum </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">512</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$checksum </span><span class="keyword">+= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$header</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$checksum_data </span><span class="keyword">= </span><span class="default">pack</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">"a8"</span><span class="keyword">, </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">"%6s "</span><span class="keyword">, </span><span class="default">decoct</span><span class="keyword">(</span><span class="default">$checksum</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$j</span><span class="keyword">=</span><span class="default">148</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">7</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++, </span><span class="default">$j</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">$checksum_data</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$header</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: text/plain'</span><span class="keyword">);<br />
</span><span class="default">$start_time </span><span class="keyword">= </span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">32</span><span class="keyword">), </span><span class="default">microtime</span><span class="keyword">()));<br />
</span><span class="default">$tar </span><span class="keyword">= &amp; new </span><span class="default">Tar_by_Vladson</span><span class="keyword">();<br />
</span><span class="default">$finish_time </span><span class="keyword">= </span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">explode</span><span class="keyword">(</span><span class="default">chr</span><span class="keyword">(</span><span class="default">32</span><span class="keyword">), </span><span class="default">microtime</span><span class="keyword">()));<br />
</span><span class="default">printf</span><span class="keyword">(</span><span class="string">"The time taken: %f seconds"</span><span class="keyword">, (</span><span class="default">$finish_time </span><span class="keyword">- </span><span class="default">$start_time</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61372""></a>
  <div class="note">
   <strong class="user">engin bzzzt biz</strong>
   <a href="#61372" class="date">01-Feb-2006 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To join directory and file names in a cross-platform manner you can use the following function.<br />
<br />
function join_path()<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $num_args = func_num_args();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $args = func_get_args();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $path = $args[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( $num_args &gt; 1 )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ($i = 1; $i &lt; $num_args; $i++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $path .= DIRECTORY_SEPARATOR.$args[$i];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $path;<br />
}<br />
<br />
It should do the following:<br />
$src = join_path( '/foo', 'bar', 'john.jpg' );<br />
echo $src; // On *nix -&gt; /foo/bar/john.jpg<br />
<br />
$src = join_path( 'C:\www', 'domain.com', 'foo.jpg' );<br />
echo $src; // On win32 -&gt; C:\\www\\domain.com\\foo.jpg</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61285""></a>
  <div class="note">
   <strong class="user">msh at onliners dot dk</strong>
   <a href="#61285" class="date">30-Jan-2006 03:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I would like to present these two simple functions for generating a complete directory listing - as I feel the other examples are to restrictive in terms of usage.<br />
<br />
function dirTree($dir) {<br />
&nbsp;&nbsp;&nbsp; $d = dir($dir);<br />
&nbsp;&nbsp;&nbsp; while (false !== ($entry = $d-&gt;read())) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if($entry != '.' &amp;&amp; $entry != '..' &amp;&amp; is_dir($dir.$entry))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $arDir[$entry] = dirTree($dir.$entry.'/');<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $d-&gt;close();<br />
&nbsp;&nbsp;&nbsp; return $arDir;<br />
}<br />
<br />
function printTree($array, $level=0) {<br />
&nbsp;&nbsp;&nbsp; foreach($array as $key =&gt; $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "&lt;div class='dir' style='width: ".($level*20)."px;'&gt;&amp;nbsp;&lt;/div&gt;".$key."&lt;br/&gt;\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(is_array($value))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; printTree($value, $level+1);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
Usage is as simple as this:<br />
$dir = "&lt;any directory you like&gt;";<br />
$arDirTree = dirTree($dir);<br />
printTree($arDirTree);<br />
<br />
It is easy to add files to the tree also - so enjoy.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60982""></a>
  <div class="note">
   <strong class="user">Nicolas Merlet - admin(at)merletn.org</strong>
   <a href="#60982" class="date">22-Jan-2006 07:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a very similar function to *scandir*, if you are still using PHP4...<br />
<br />
This recursive function will return an indexed array containing all directories or files or both (depending on parameters). You can specify the depth you want, as explained below.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// $path : path to browse<br />
// $maxdepth : how deep to browse (-1=unlimited)<br />
// $mode : "FULL"|"DIRS"|"FILES"<br />
// $d : must not be defined<br />
&nbsp; <br />
</span><span class="keyword">function </span><span class="default">searchdir </span><span class="keyword">( </span><span class="default">$path </span><span class="keyword">, </span><span class="default">$maxdepth </span><span class="keyword">= -</span><span class="default">1 </span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">= </span><span class="string">"FULL" </span><span class="keyword">, </span><span class="default">$d </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; if ( </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$path </span><span class="keyword">, </span><span class="default">strlen </span><span class="keyword">( </span><span class="default">$path </span><span class="keyword">) - </span><span class="default">1 </span><span class="keyword">) != </span><span class="string">'/' </span><span class="keyword">) { </span><span class="default">$path </span><span class="keyword">.= </span><span class="string">'/' </span><span class="keyword">; }&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; </span><span class="default">$dirlist </span><span class="keyword">= array () ;<br />
&nbsp;&nbsp; if ( </span><span class="default">$mode </span><span class="keyword">!= </span><span class="string">"FILES" </span><span class="keyword">) { </span><span class="default">$dirlist</span><span class="keyword">[] = </span><span class="default">$path </span><span class="keyword">; }<br />
&nbsp;&nbsp; if ( </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">opendir </span><span class="keyword">( </span><span class="default">$path </span><span class="keyword">) )<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; while ( </span><span class="default">false </span><span class="keyword">!== ( </span><span class="default">$file </span><span class="keyword">= </span><span class="default">readdir </span><span class="keyword">( </span><span class="default">$handle </span><span class="keyword">) ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'.' </span><span class="keyword">&amp;&amp; </span><span class="default">$file </span><span class="keyword">!= </span><span class="string">'..' </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$file </span><span class="keyword">= </span><span class="default">$path </span><span class="keyword">. </span><span class="default">$file </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if ( ! </span><span class="default">is_dir </span><span class="keyword">( </span><span class="default">$file </span><span class="keyword">) ) { if ( </span><span class="default">$mode </span><span class="keyword">!= </span><span class="string">"DIRS" </span><span class="keyword">) { </span><span class="default">$dirlist</span><span class="keyword">[] = </span><span class="default">$file </span><span class="keyword">; } }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif ( </span><span class="default">$d </span><span class="keyword">&gt;=</span><span class="default">0 </span><span class="keyword">&amp;&amp; (</span><span class="default">$d </span><span class="keyword">&lt; </span><span class="default">$maxdepth </span><span class="keyword">|| </span><span class="default">$maxdepth </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">searchdir </span><span class="keyword">( </span><span class="default">$file </span><span class="keyword">. </span><span class="string">'/' </span><span class="keyword">, </span><span class="default">$maxdepth </span><span class="keyword">, </span><span class="default">$mode </span><span class="keyword">, </span><span class="default">$d </span><span class="keyword">+ </span><span class="default">1 </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$dirlist </span><span class="keyword">= </span><span class="default">array_merge </span><span class="keyword">( </span><span class="default">$dirlist </span><span class="keyword">, </span><span class="default">$result </span><span class="keyword">) ;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">closedir </span><span class="keyword">( </span><span class="default">$handle </span><span class="keyword">) ;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; if ( </span><span class="default">$d </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) { </span><span class="default">natcasesort </span><span class="keyword">( </span><span class="default">$dirlist </span><span class="keyword">) ; }<br />
&nbsp;&nbsp; return ( </span><span class="default">$dirlist </span><span class="keyword">) ;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
