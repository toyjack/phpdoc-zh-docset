<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>使用传递的数组递归替换第一个数组的元素</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.array-reduce.html">? array_reduce</a></li>
      <li style="float: right;"><a href="function.array-replace.html">array_replace ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.array.html">数组 函数</a></li>
    <li>使用传递的数组递归替换第一个数组的元素</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.array-replace-recursive" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">array_replace_recursive</h1>
  <p class="verinfo">(PHP 5 &gt;= 5.3.0, PHP 7)</p><p class="refpurpose"><span class="refname">array_replace_recursive</span> &mdash; <span class="dc-title">使用传递的数组递归替换第一个数组的元素</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.array-replace-recursive-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>array_replace_recursive</strong></span>
    ( <span class="methodparam"><span class="type">array</span> <code class="parameter">$array1</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$...</code></span>
  ] ) : <span class="type">array</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>array_replace_recursive()</strong></span> 使用后面数组元素的值替换数组 <code class="parameter">array1</code> 的值。
   如果一个键存在于第一个数组同时也存在于第二个数组，它的值将被第二个数组中的值替换。
   如果一个键存在于第二个数组，但是不存在于第一个数组，则会在第一个数组中创建这个元素。
   如果一个键仅存在于第一个数组，它将保持不变。
  如果传递了多个替换数组，它们将被按顺序依次处理，后面的数组将覆盖之前的值。
  </p>
  <p class="para"> <span class="function"><strong>array_replace_recursive()</strong></span> 是递归的：它将遍历数组并将相同的处理应用到数组的内部值。
  </p>
  <p class="para">
   如果第一个数组中的值是标量，它的值将被第二个数组中的值替换，它可能是一个标量或者数组。如果第一个数组和第二个数组中的值都是数组，<span class="function"><strong>array_replace_recursive()</strong></span> 函数将递归地替换它们各自的值。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.array-replace-recursive-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">array1</code></dt>

     <dd>

      <p class="para">
       替换该数组的值。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">...</code></dt>

     <dd>

      <p class="para">
       可选项。包含要提取元素的数组。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.array-replace-recursive-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回一个<span class="type"><span class="type 数组">数组</span></span>。如果发生错误，将返回 <strong><code>NULL</code></strong>。
  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.array-replace-recursive-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-6103">
    <p><strong>Example #1 <span class="function"><strong>array_replace_recursive()</strong></span> 范例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$base&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'citrus'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(&nbsp;</span><span style="color: #DD0000">"orange"</span><span style="color: #007700">)&nbsp;,&nbsp;</span><span style="color: #DD0000">'berries'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">"blackberry"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"raspberry"</span><span style="color: #007700">),&nbsp;);<br /></span><span style="color: #0000BB">$replacements&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'citrus'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'pineapple'</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'berries'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'blueberry'</span><span style="color: #007700">));<br /><br /></span><span style="color: #0000BB">$basket&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_replace_recursive</span><span style="color: #007700">(</span><span style="color: #0000BB">$base</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacements</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$basket</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$basket&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$base</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacements</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$basket</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [citrus] =&gt; Array
        (
            [0] =&gt; pineapple
        )

    [berries] =&gt; Array
        (
            [0] =&gt; blueberry
            [1] =&gt; raspberry
        )

)
Array
(
    [citrus] =&gt; Array
        (
            [0] =&gt; pineapple
        )

    [berries] =&gt; Array
        (
            [0] =&gt; blueberry
        )

)

</pre></div>
    </div>
   </div>
   <div class="example" id="example-6104">
    <p><strong>Example #2 <span class="function"><strong>array_replace_recursive()</strong></span> 及其递归表现</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$base&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'citrus'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">"orange"</span><span style="color: #007700">)&nbsp;,&nbsp;</span><span style="color: #DD0000">'berries'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">"blackberry"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"raspberry"</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'others'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'banana'&nbsp;</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$replacements&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'citrus'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'pineapple'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'berries'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'blueberry'</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'others'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'litchis'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">$replacements2&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'citrus'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'pineapple'</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'berries'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;array(</span><span style="color: #DD0000">'blueberry'</span><span style="color: #007700">),&nbsp;</span><span style="color: #DD0000">'others'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'litchis'</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$basket&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">array_replace_recursive</span><span style="color: #007700">(</span><span style="color: #0000BB">$base</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacements</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$replacements2</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$basket</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [citrus] =&gt; Array
        (
            [0] =&gt; pineapple
        )

    [berries] =&gt; Array
        (
            [0] =&gt; blueberry
            [1] =&gt; raspberry
        )

    [others] =&gt; litchis
)
</pre></div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.array-replace-recursive-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.array-replace.html" class="function" rel="rdfs-seeAlso">array_replace()</a> - 使用传递的数组替换第一个数组的元素</span></li>
    <li class="member"><span class="function"><a href="function.array-merge-recursive.html" class="function" rel="rdfs-seeAlso">array_merge_recursive()</a> - 递归地合并一个或多个数组</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="124705""></a>
  <div class="note">
   <strong class="user">Pau Prat Torrella</strong>
   <a href="#124705" class="date">10-Feb-2020 05:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that function will NOT replace a sub-tree from you $array1 if its value in $array2 is an empty array. <br />
Even tho the key for this dimension is technically 'set'. <br />
<br />
(I suppose it treats it as just another recursive level to dive in, finding no key to compare, backtracking while leaving this sub-tree alone)<br />
<br />
For example:<br />
<br />
$array1&nbsp; = ['first' =&gt; ['second' =&gt; 'hello']];<br />
$array2&nbsp; = ['first' =&gt; []];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
$result = array_replace_recursive($array1, $array2);<br />
<br />
$result is still: ['first' =&gt; ['second' =&gt; 'hello']].</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123491""></a>
  <div class="note">
   <strong class="user">Uther</strong>
   <a href="#123491" class="date">04-Jan-2019 06:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the use of the word "replace" in the function's description is a bit misleading... as none of the parameters are passed by reference, it does not actually replace anything... this simply describes from which parameter the resulting values come.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116228""></a>
  <div class="note">
   <strong class="user">oliver dot coleman at gmail dot com</strong>
   <a href="#116228" class="date">25-Nov-2014 08:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you came here looking for a function to recursively find and replace (scalar) values in an array (also recurses through objects):<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'RECURSIVE_REPLACE_MARKER'</span><span class="keyword">, </span><span class="string">'recursive_replace_r47yr74yr7623t74r3645236rtvghdcbnsgxbt67g5e21873891'</span><span class="keyword">);<br />
</span><span class="comment">/**<br />
&nbsp;* Recursively replaces scalar values in objects and arrays. The passed array or object is altered in place.<br />
&nbsp;* @param mixed $data An object or array.<br />
&nbsp;* @param mixed $find The scalar value to find.<br />
&nbsp;* @param mixed $replace The value to replace with (need not be a scalar).<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">recursive_replace</span><span class="keyword">(&amp;</span><span class="default">$data</span><span class="keyword">, </span><span class="default">$find</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">){<br />
&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; if (!isset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">RECURSIVE_REPLACE_MARKER</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">RECURSIVE_REPLACE_MARKER</span><span class="keyword">] = </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) || </span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">recursive_replace</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$find</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] === </span><span class="default">$find</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$replace</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; unset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">RECURSIVE_REPLACE_MARKER</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; elseif (</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; if (!isset(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">RECURSIVE_REPLACE_MARKER</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">RECURSIVE_REPLACE_MARKER </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">$key</span><span class="keyword">) || </span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">$key</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">recursive_replace</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$find</span><span class="keyword">, </span><span class="default">$replace</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">$key </span><span class="keyword">=== </span><span class="default">$find</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">$key </span><span class="keyword">= </span><span class="default">$replace</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; unset(</span><span class="default">$data</span><span class="keyword">-&gt;</span><span class="default">RECURSIVE_REPLACE_MARKER</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109390""></a>
  <div class="note">
   <strong class="user">msahagian at dotink dot org</strong>
   <a href="#109390" class="date">13-Jul-2012 11:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a fairly concise version which does not rely on traditional recursion:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">array_replace_recursive</span><span class="keyword">(</span><span class="default">$base</span><span class="keyword">, </span><span class="default">$replacements</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">func_get_args</span><span class="keyword">(), </span><span class="default">1</span><span class="keyword">) as </span><span class="default">$replacements</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bref_stack </span><span class="keyword">= array(&amp;</span><span class="default">$base</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head_stack </span><span class="keyword">= array(</span><span class="default">$replacements</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; do {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">end</span><span class="keyword">(</span><span class="default">$bref_stack</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bref </span><span class="keyword">= &amp;</span><span class="default">$bref_stack</span><span class="keyword">[</span><span class="default">key</span><span class="keyword">(</span><span class="default">$bref_stack</span><span class="keyword">)];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head </span><span class="keyword">= </span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$head_stack</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$bref_stack</span><span class="keyword">[</span><span class="default">key</span><span class="keyword">(</span><span class="default">$bref_stack</span><span class="keyword">)]);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$head</span><span class="keyword">) as </span><span class="default">$key</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$bref</span><span class="keyword">) &amp;&amp; </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$bref</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) &amp;&amp; </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$head</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bref_stack</span><span class="keyword">[] = &amp;</span><span class="default">$bref</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$head_stack</span><span class="keyword">[] = </span><span class="default">$head</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bref</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$head</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } while(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$head_stack</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$base</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92574""></a>
  <div class="note">
   <strong class="user">Gregor at der-meyer dot de</strong>
   <a href="#92574" class="date">29-Jul-2009 06:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Nice that this function finally found its was to the PHP core! If you want to use it also with older PHP versions before 5.3.0, you can define it this way:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'array_replace_recursive'</span><span class="keyword">))<br />
{<br />
&nbsp; function </span><span class="default">array_replace_recursive</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$array1</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">recurse</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$array1</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$array1 </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// create new key in $array, if it is empty or not an array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (!isset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) || (isset(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]) &amp;&amp; !</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// overwrite the value in the base array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">recurse</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// handle the arguments, merge one by one<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$args </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">$args</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$args</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">recurse</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
I called this function array_merge_recursive_overwrite() in my older projects, but array_replace_recursive() sounds quite better while they do the same.<br />
<br />
If you implemented such a compatible function before and don't want to refactor all your code, you can update it with the following snippet to use the native (and hopefully faster) implementation of PHP 5.3.0, if available. Just start your function with these lines:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">// as of PHP 5.3.0 array_replace_recursive() does the work for us<br />
&nbsp; </span><span class="keyword">if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'array_replace_recursive'</span><span class="keyword">))<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="string">'array_replace_recursive'</span><span class="keyword">, </span><span class="default">func_get_args</span><span class="keyword">());<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92224""></a>
  <div class="note">
   <strong class="user">kyle [dot] florence [@t] gmail [dot] com</strong>
   <a href="#92224" class="date">14-Jul-2009 04:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might help out people who don't have 5.3 running: 
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="comment">// Joins two or more arrays together recursively; key/value pairs of the first
<br />
// array are replaced with key/value pairs from the subsequent arrays.&nbsp; Any
<br />
// key/value pair not present in the first array is added to the final array
<br />
</span><span class="keyword">function </span><span class="default">array_join</span><span class="keyword">()
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Get array arguments
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arrays </span><span class="keyword">= </span><span class="default">func_get_args</span><span class="keyword">();
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Define the original array
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$original </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$arrays</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Loop through arrays
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$arrays </span><span class="keyword">as </span><span class="default">$array</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Loop through array key/value pairs
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Value is an array
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Traverse the array; replace or add result to original array
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$original</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">array_join</span><span class="keyword">(</span><span class="default">$original</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">], </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Value is not an array
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Replace or add current value to original array
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$original</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Return the joined array
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$original</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
