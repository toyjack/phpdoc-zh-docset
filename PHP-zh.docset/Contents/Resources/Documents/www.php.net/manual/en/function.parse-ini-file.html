<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>解析一个配置文件</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.move-uploaded-file.html">? move_uploaded_file</a></li>
      <li style="float: right;"><a href="function.parse-ini-string.html">parse_ini_string ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.filesystem.html">文件系统函数</a></li>
    <li>解析一个配置文件</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.parse-ini-file" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">parse_ini_file</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">parse_ini_file</span> &mdash; <span class="dc-title">解析一个配置文件</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.parse-ini-file-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>parse_ini_file</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   , <span class="methodparam"><span class="type">bool</span> <code class="parameter">$process_sections</code><span class="initializer"> = false</span></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$scanner_mode</code><span class="initializer"> = INI_SCANNER_NORMAL</span></span>
   ) : <span class="type">array</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>parse_ini_file()</strong></span> 载入一个由
   <code class="parameter">filename</code> 指定的 ini
   文件，并将其中的设置作为一个联合数组返回。
  </p>
  <p class="para">
   ini 文件的结构和 <var class="filename">php.ini</var> 的相似。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.parse-ini-file-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       要解析的 ini 文件的文件名。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">process_sections</code></dt>

     <dd>

      <p class="para">
       如果将最后的
   <code class="parameter">process_sections</code> 参数设为
   <strong><code>true</code></strong>，将得到一个多维数组，包括了配置文件中每一节的名称和设置。<code class="parameter">process_sections</code>
   的默认值是 <strong><code>false</code></strong>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">scanner_mode</code></dt>

     <dd>

      <p class="para">
       Can either be <strong><code>INI_SCANNER_NORMAL</code></strong> (default) or 
       <strong><code>INI_SCANNER_RAW</code></strong>. If <strong><code>INI_SCANNER_RAW</code></strong> 
       is supplied, then option values will not be parsed.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.parse-ini-file-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时以关联数组 <span class="type">array</span> 返回设置，失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.parse-ini-file-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2589">
    <p><strong>Example #1 <var class="filename">sample.ini</var> 的内容</strong></p>
    <div class="example-contents">
<div class="cdata"><pre>
; This is a sample configuration file
; Comments start with &#039;;&#039;, as in php.ini

[first_section]
one = 1
five = 5
animal = BIRD

[second_section]
path = &quot;/usr/local/bin&quot;
URL = &quot;http://www.example.com/~username&quot;

[third_section]
phpversion[] = &quot;5.0&quot;
phpversion[] = &quot;5.1&quot;
phpversion[] = &quot;5.2&quot;
phpversion[] = &quot;5.3&quot;
</pre></div>
    </div>

   </div>
   <div class="example" id="example-2590">
    <p><strong>Example #2 <span class="function"><strong>parse_ini_file()</strong></span> 例子</strong></p>
    <div class="example-contents"><p>
      <a href="language.constants.html" class="link">常量</a>也可以在 ini
   文件中被解析，因此如果在运行 <span class="function"><strong>parse_ini_file()</strong></span>
   之前定义了常量作为 ini 的值，将会被集成到结果中去。只有 ini
   的值会被求值。例如：
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />define</span><span style="color: #007700">(</span><span style="color: #DD0000">'BIRD'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'Dodo&nbsp;bird'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;without&nbsp;sections<br /></span><span style="color: #0000BB">$ini_array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #DD0000">"sample.ini"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_array</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;with&nbsp;sections<br /></span><span style="color: #0000BB">$ini_array&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #DD0000">"sample.ini"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_array</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [one] =&gt; 1
    [five] =&gt; 5
    [animal] =&gt; Dodo bird
    [path] =&gt; /usr/local/bin
    [URL] =&gt; http://www.example.com/~username
    [phpversion] =&gt; Array
        (
            [0] =&gt; 5.0
            [1] =&gt; 5.1
            [2] =&gt; 5.2
            [3] =&gt; 5.3
        )

)
Array
(
    [first_section] =&gt; Array
        (
            [one] =&gt; 1
            [five] =&gt; 5
            [animal] =&gt; Dodo bird
        )

    [second_section] =&gt; Array
        (
            [path] =&gt; /usr/local/bin
            [URL] =&gt; http://www.example.com/~username
        )

    [third_section] =&gt; Array
        (
            [phpversion] =&gt; Array
                (
                    [0] =&gt; 5.0
                    [1] =&gt; 5.1
                    [2] =&gt; 5.2
                    [3] =&gt; 5.3
                )

        )

)
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2591">
    <p><strong>Example #3 <span class="function"><strong>parse_ini_file()</strong></span> parsing a php.ini file</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;A&nbsp;simple&nbsp;function&nbsp;used&nbsp;for&nbsp;comparing&nbsp;the&nbsp;results&nbsp;below<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">$expression</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return(</span><span style="color: #0000BB">$expression&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #DD0000">'Yes'&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #DD0000">'No'</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Get&nbsp;the&nbsp;path&nbsp;to&nbsp;php.ini&nbsp;using&nbsp;the&nbsp;php_ini_loaded_file()&nbsp;<br />//&nbsp;function&nbsp;available&nbsp;as&nbsp;of&nbsp;PHP&nbsp;5.2.4<br /></span><span style="color: #0000BB">$ini_path&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">php_ini_loaded_file</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;Parse&nbsp;php.ini<br /></span><span style="color: #0000BB">$ini&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">parse_ini_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini_path</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Print&nbsp;and&nbsp;compare&nbsp;the&nbsp;values,&nbsp;note&nbsp;that&nbsp;using&nbsp;get_cfg_var()<br />//&nbsp;will&nbsp;give&nbsp;the&nbsp;same&nbsp;results&nbsp;for&nbsp;parsed&nbsp;and&nbsp;loaded&nbsp;here<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">'(parsed)&nbsp;magic_quotes_gpc&nbsp;=&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">$ini</span><span style="color: #007700">[</span><span style="color: #DD0000">'magic_quotes_gpc'</span><span style="color: #007700">])&nbsp;.&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #DD0000">'(loaded)&nbsp;magic_quotes_gpc&nbsp;=&nbsp;'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">yesno</span><span style="color: #007700">(</span><span style="color: #0000BB">get_cfg_var</span><span style="color: #007700">(</span><span style="color: #DD0000">'magic_quotes_gpc'</span><span style="color: #007700">))&nbsp;.&nbsp;</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
(parsed) magic_quotes_gpc = Yes
(loaded) magic_quotes_gpc = Yes
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.parse-ini-file-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    本函数和 <var class="filename">php.ini</var>
    文件没有关系，该文件在运行脚本时就已经处理过了。本函数可以用来读取你自己的应用程序的配置文件。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    如果 ini 文件中的值包含任何非字母数字的字符，需要将其括在双引号中（&quot;）。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    有些保留字不能作为 ini 文件中的键名，包括：null，yes，no，true 和 false。值为
    null，no 和 false 等效于 &quot;&quot;，值为 yes 和 true 等效于 &quot;1&quot;。字符
    <code class="literal">{}|&amp;~![()&quot;</code> 也不能用在键名的任何地方，而且这些字符在选项值中有着特殊的意义。
   </span>
  </p></blockquote>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.parse-ini-file-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.parse-ini-string.html" class="function" rel="rdfs-seeAlso">parse_ini_string()</a> - 解析配置字符串</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="122946""></a>
  <div class="note">
   <strong class="user">Rubn Martnez</strong>
   <a href="#122946" class="date">15-Jul-2018 01:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The parse_ini_file function does have trouble loading valid Windows ini files like, for example, nternet shortcuts (.url files).<br />
<br />
This is due to the function reading the URLs as a value, and failing when it finds that valid URL characters like '=' appear unescaped or the value unquoted as a whole. Since Windows does not escape them anyway, the solution is to scan it in raw mode, where it will read unparsed the value after the first '='. Since = only appears in URLs with parameters, this mistake may is not be obvious at a first glance.<br />
<br />
An example<br />
<br />
<span class="default">&lt;?php<br />
<br />
$links </span><span class="keyword">= array();<br />
<br />
</span><span class="comment">// ...<br />
<br />
</span><span class="default">$files </span><span class="keyword">= </span><span class="default">scandir</span><span class="keyword">(</span><span class="default">$directory</span><span class="keyword">);<br />
foreach( </span><span class="default">$files </span><span class="keyword">as </span><span class="default">$filename </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">strToLower</span><span class="keyword">(</span><span class="default">pathinfo</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">PATHINFO_EXTENSION</span><span class="keyword">)) === </span><span class="string">'url'</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortcut </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">( </span><span class="default">$directory</span><span class="keyword">.</span><span class="default">DIRECTORY_SEPARATOR</span><span class="keyword">.</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">,&nbsp; </span><span class="default">INI_SCANNER_RAW</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$shortcut </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) die(</span><span class="string">'Syntax Error'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$url </span><span class="keyword">= </span><span class="default">$shortcut</span><span class="keyword">[</span><span class="string">'InternetShortcut'</span><span class="keyword">][</span><span class="string">'URL'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$links </span><span class="keyword">[]= </span><span class="default">$url</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120341""></a>
  <div class="note">
   <strong class="user">info () gaj ! design</strong>
   <a href="#120341" class="date">16-Dec-2016 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Not mentioned in the documentation, this function acts like include:<br />
<br />
"Files are included based on the file path given or, if none is given, the include_path specified. If the file isn't found in the include_path, include will finally check in the calling script's own directory and the current working directory before failing."<br />
<br />
(At least for PHP 7; have not checked PHP 5.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119543""></a>
  <div class="note">
   <strong class="user">YAPs</strong>
   <a href="#119543" class="date">03-Jul-2016 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function for save ini files
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">array_to_ini</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">,</span><span class="default">$out</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$q</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$c</span><span class="keyword">=&gt;</span><span class="default">$d</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">))</span><span class="default">$t</span><span class="keyword">.=</span><span class="default">array_to_ini</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$c</span><span class="keyword">===</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!empty(</span><span class="default">$out</span><span class="keyword">))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t</span><span class="keyword">.=</span><span class="string">"\r\n"</span><span class="keyword">.</span><span class="default">$out</span><span class="keyword">.</span><span class="string">" = \""</span><span class="keyword">.</span><span class="default">$d</span><span class="keyword">.</span><span class="string">"\""</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$q</span><span class="keyword">!=</span><span class="default">2</span><span class="keyword">)</span><span class="default">$q</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$t</span><span class="keyword">.=</span><span class="string">"\r\n"</span><span class="keyword">.</span><span class="default">$d</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t</span><span class="keyword">.=</span><span class="string">"\r\n"</span><span class="keyword">.</span><span class="default">$c</span><span class="keyword">.</span><span class="string">" = \""</span><span class="keyword">.</span><span class="default">$d</span><span class="keyword">.</span><span class="string">"\""</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$q</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$q</span><span class="keyword">!=</span><span class="default">true </span><span class="keyword">&amp;&amp; !empty(</span><span class="default">$out</span><span class="keyword">)) return </span><span class="string">"["</span><span class="keyword">.</span><span class="default">$out</span><span class="keyword">.</span><span class="string">"]\r\n"</span><span class="keyword">.</span><span class="default">$t</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; if(!empty(</span><span class="default">$out</span><span class="keyword">)) return&nbsp; </span><span class="default">$t</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$t</span><span class="keyword">);
<br />
}
<br />

<br />
function </span><span class="default">save_ini_file</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">,</span><span class="default">$file</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">=</span><span class="default">array_to_ini</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ffl</span><span class="keyword">=</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="string">"w"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$ffl</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$ffl</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118969""></a>
  <div class="note">
   <strong class="user">dschnepper at box dot com</strong>
   <a href="#118969" class="date">09-Mar-2016 09:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The documentation states:<br />
Characters ?{}|&amp;~!()^" must not be used anywhere in the key and have a special meaning in the value.<br />
<br />
Here's the results of my experiments on what they mean:<br />
<br />
; | is used for bitwise OR<br />
three = 2|3<br />
<br />
; &amp; is used for bitwise AND<br />
four = 6&amp;5<br />
<br />
; ^ is used for bitwise XOR<br />
five = 3^6<br />
<br />
; ~ is used for bitwise negate<br />
negative_two = ~1<br />
<br />
; () is used for grouping<br />
seven = (8|7)&amp;(6|5)<br />
<br />
; ${...} is used for grabbing values from the environment, or previously defined values.<br />
path = ${PATH}<br />
also = ${five}<br />
<br />
; ? I have no guess for<br />
; ! I have no guess for</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118151""></a>
  <div class="note">
   <strong class="user">jbricci at ya-right dot com</strong>
   <a href="#118151" class="date">15-Oct-2015 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This core function won't handle ini key[][] = value(s), (multidimensional arrays), so if you need to support that kind of setup you will need to write your own function. one way to do it is to convert all the key = value(s) to array string [key][][]=value(s), then use parse_str() to convert all those [key][][]=value(s) that way you just read the ini file line by line, instead of doing crazy foreach() loops to handle those (multidimensional arrays) in each section, example...<br />
<br />
ini file...... config.php<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">; </span><span class="default">This is a sample configuration file<br />
</span><span class="keyword">; </span><span class="default">Comments start with </span><span class="string">';'</span><span class="keyword">, as </span><span class="default">in php</span><span class="keyword">.</span><span class="default">ini<br />
<br />
</span><span class="keyword">[</span><span class="default">first_section</span><span class="keyword">]<br />
</span><span class="default">one </span><span class="keyword">= </span><span class="default">1<br />
five </span><span class="keyword">= </span><span class="default">5<br />
animal </span><span class="keyword">= </span><span class="default">BIRD<br />
<br />
</span><span class="keyword">[</span><span class="default">second_section</span><span class="keyword">]<br />
</span><span class="default">path </span><span class="keyword">= </span><span class="string">"/usr/local/bin"<br />
</span><span class="default">URL </span><span class="keyword">= </span><span class="string">"<a href="http://www.example.com/~username" rel="nofollow" target="_blank">http://www.example.com/~username</a>"<br />
<br />
</span><span class="keyword">[</span><span class="default">third_section</span><span class="keyword">]<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.0"<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.1"<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.2"<br />
</span><span class="default">phpversion</span><span class="keyword">[] = </span><span class="string">"5.3"<br />
<br />
</span><span class="default">urls</span><span class="keyword">[</span><span class="default">svn</span><span class="keyword">] = </span><span class="string">"<a href="http://svn.php.net" rel="nofollow" target="_blank">http://svn.php.net</a>"<br />
</span><span class="default">urls</span><span class="keyword">[</span><span class="default">git</span><span class="keyword">] = </span><span class="string">"<a href="http://git.php.net" rel="nofollow" target="_blank">http://git.php.net</a>"<br />
<br />
</span><span class="keyword">[</span><span class="default">fourth_section</span><span class="keyword">]<br />
<br />
</span><span class="default">a</span><span class="keyword">[][][] = </span><span class="default">b<br />
a</span><span class="keyword">[][][][] = </span><span class="default">c<br />
a</span><span class="keyword">[</span><span class="default">test_test</span><span class="keyword">][][] = </span><span class="default">d<br />
test</span><span class="keyword">[</span><span class="default">one</span><span class="keyword">][</span><span class="default">two</span><span class="keyword">][</span><span class="default">three</span><span class="keyword">] = </span><span class="default">true<br />
<br />
?&gt;<br />
</span><br />
echo parse_ini_file ( "C:\\services\\www\\docs\\config.php" );<br />
<br />
results in...<br />
<br />
// PHP Warning:&nbsp; syntax error, unexpected TC_SECTION, expecting '=' line 27 -&gt; a[][][] = b<br />
<br />
Here it simple function that handles (multidimensional arrays) without looping each key[][]= value(s)<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">getIni </span><span class="keyword">( </span><span class="default">$file</span><span class="keyword">, </span><span class="default">$sections </span><span class="keyword">= </span><span class="default">FALSE </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= array ();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$keeper </span><span class="keyword">= array ();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$config </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">( </span><span class="default">$file</span><span class="keyword">, </span><span class="string">'r' </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; while ( ! </span><span class="default">feof </span><span class="keyword">( </span><span class="default">$config </span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim </span><span class="keyword">( </span><span class="default">fgets </span><span class="keyword">( </span><span class="default">$config</span><span class="keyword">, </span><span class="default">1024 </span><span class="keyword">) );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= ( </span><span class="default">$line </span><span class="keyword">== </span><span class="string">'' </span><span class="keyword">) ? </span><span class="string">' ' </span><span class="keyword">: </span><span class="default">$line</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch ( </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">' '</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'#'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'/'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">';'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'&lt;'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'?'</span><span class="keyword">:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'['</span><span class="keyword">:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$sections </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="string">'config[' </span><span class="keyword">. </span><span class="default">trim </span><span class="keyword">( </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">) ) . </span><span class="string">']'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$header </span><span class="keyword">= </span><span class="string">'config'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; default:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv </span><span class="keyword">= </span><span class="default">array_map </span><span class="keyword">( </span><span class="string">'trim'</span><span class="keyword">, </span><span class="default">explode </span><span class="keyword">( </span><span class="string">'='</span><span class="keyword">, </span><span class="default">$line </span><span class="keyword">) );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">str_replace </span><span class="keyword">( </span><span class="string">' '</span><span class="keyword">, </span><span class="string">'+'</span><span class="keyword">, </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = </span><span class="default">str_replace </span><span class="keyword">( </span><span class="string">' '</span><span class="keyword">, </span><span class="string">'+'</span><span class="keyword">, </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( ( </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="string">'[' </span><span class="keyword">) ) !== </span><span class="default">FALSE </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">) . </span><span class="string">']' </span><span class="keyword">. </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$pos </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="string">'[' </span><span class="keyword">. </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] . </span><span class="string">']'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bt </span><span class="keyword">= </span><span class="default">strtolower </span><span class="keyword">( </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] );<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">in_array </span><span class="keyword">( </span><span class="default">$bt</span><span class="keyword">, array ( </span><span class="string">'true'</span><span class="keyword">, </span><span class="string">'false'</span><span class="keyword">, </span><span class="string">'on'</span><span class="keyword">, </span><span class="string">'off' </span><span class="keyword">) ) )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] = ( </span><span class="default">$bt </span><span class="keyword">== </span><span class="string">'true' </span><span class="keyword">|| </span><span class="default">$bt </span><span class="keyword">== </span><span class="string">'on' </span><span class="keyword">) ? </span><span class="default">TRUE </span><span class="keyword">: </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$keeper</span><span class="keyword">[] = </span><span class="default">$header </span><span class="keyword">. </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] . </span><span class="string">'=' </span><span class="keyword">. </span><span class="default">$kv</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose </span><span class="keyword">( </span><span class="default">$config </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">parse_str </span><span class="keyword">( </span><span class="default">implode </span><span class="keyword">( </span><span class="string">'&amp;'</span><span class="keyword">, </span><span class="default">$keeper </span><span class="keyword">), </span><span class="default">$return </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">[</span><span class="string">'config'</span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">// usage...<br />
<br />
</span><span class="default">$sections </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
<br />
</span><span class="default">print_r </span><span class="keyword">( </span><span class="default">$config</span><span class="keyword">-&gt;</span><span class="default">getIni </span><span class="keyword">( </span><span class="string">"C:\\services\\www\\docs\\config.php" </span><span class="keyword">),&nbsp; </span><span class="default">$sections </span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114842""></a>
  <div class="note">
   <strong class="user">Rekam</strong>
   <a href="#114842" class="date">13-Apr-2014 09:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You may want, in some very special cases, to parse multi-dimensional array with N levels in your ini file. Something like setting[data][config][debug] = true will result in an error (expected "=").<br />
<br />
Here's a little function to match this, using dots (customizable).<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_ini_file_multi</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$process_sections </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">, </span><span class="default">$scanner_mode </span><span class="keyword">= </span><span class="default">INI_SCANNER_NORMAL</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$explode_str </span><span class="keyword">= </span><span class="string">'.'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$escape_char </span><span class="keyword">= </span><span class="string">"'"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// load ini file the normal way<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$process_sections</span><span class="keyword">, </span><span class="default">$scanner_mode</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$process_sections</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= array(</span><span class="default">$data</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$section_key </span><span class="keyword">=&gt; </span><span class="default">$section</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// loop inside the section<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$section </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$explode_str</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) !== </span><span class="default">$escape_char</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// key has a dot. Explode on it, then parse each subkeys<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // and set value at the right place thanks to references<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sub_keys </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$explode_str</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs </span><span class="keyword">=&amp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$sub_keys </span><span class="keyword">as </span><span class="default">$sub_key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$subs</span><span class="keyword">[</span><span class="default">$sub_key</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs</span><span class="keyword">[</span><span class="default">$sub_key</span><span class="keyword">] = [];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs </span><span class="keyword">=&amp; </span><span class="default">$subs</span><span class="keyword">[</span><span class="default">$sub_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// set the value at the right place<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$subs </span><span class="keyword">= </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// unset the dotted key, we don't need it anymore<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">unset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// we have escaped the key, so we keep dots as they are<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$new_key </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$key</span><span class="keyword">, </span><span class="default">$escape_char</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">][</span><span class="default">$new_key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$data</span><span class="keyword">[</span><span class="default">$section_key</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$process_sections</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">$data</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The following file:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
[normal]<br />
foo = bar<br />
; use quotes to keep your key as it is<br />
'foo.with.dots' = true<br />
<br />
[array]<br />
foo[] = 1<br />
foo[] = 2<br />
<br />
[dictionary]<br />
foo[debug] = false<br />
foo[path] = /some/path<br />
<br />
[multi]<br />
foo.data.config.debug = true<br />
foo.data.password = 123456<br />
*/<br />
</span><span class="default">?&gt;<br />
</span><br />
will result in:<br />
<span class="default">&lt;?php<br />
parse_ini_file_multi</span><span class="keyword">(</span><span class="string">'file.ini'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">normal</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; </span><span class="default">bar<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">[</span><span class="default">foo</span><span class="keyword">.</span><span class="default">with</span><span class="keyword">.</span><span class="default">dots</span><span class="keyword">] =&gt; </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; [array] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">0</span><span class="keyword">] =&gt; </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] =&gt; </span><span class="default">2<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">dictionary</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">debug</span><span class="keyword">] =&gt; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">path</span><span class="keyword">] =&gt; /</span><span class="default">some</span><span class="keyword">/</span><span class="default">path<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">multi</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">foo</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">data</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">config</span><span class="keyword">] =&gt; Array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">debug</span><span class="keyword">] =&gt; </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [</span><span class="default">password</span><span class="keyword">] =&gt; </span><span class="default">123456<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )<br />
)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111459""></a>
  <div class="note">
   <strong class="user">simon dot riget at gmail dot com</strong>
   <a href="#111459" class="date">21-Feb-2013 07:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
.ini files or JSON file format as it is also known as, are very useful format to store stuff in. Especially large arrays. <br />
<br />
Strangely enough there is this nice function to read the file, but no function to write it.<br />
<br />
So here is one.<br />
<br />
Use it as:&nbsp; put_ini_file(string $file, array $array)<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">function </span><span class="default">put_ini_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$array</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){<br />
&nbsp; </span><span class="default">$str</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;<br />
&nbsp; foreach (</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$k </span><span class="keyword">=&gt; </span><span class="default">$v</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">).</span><span class="string">"[</span><span class="default">$k</span><span class="string">]"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">put_ini_file</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$v</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }else<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str</span><span class="keyword">.=</span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">).</span><span class="string">"</span><span class="default">$k</span><span class="string"> = </span><span class="default">$v</span><span class="string">"</span><span class="keyword">.</span><span class="default">PHP_EOL</span><span class="keyword">; <br />
&nbsp; }<br />
&nbsp;if(</span><span class="default">$file</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp; else<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90624""></a>
  <div class="note">
   <strong class="user">jeremygiberson at gmail dot com</strong>
   <a href="#90624" class="date">30-Apr-2009 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a quick parse_ini_file wrapper to add extend support to save typing and redundancy.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Parses INI file adding extends functionality via ":base" postfix on namespace.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param string $filename<br />
&nbsp;&nbsp; &nbsp; * @return array<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">parse_ini_file_extended</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p_ini </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$p_ini </span><span class="keyword">as </span><span class="default">$namespace </span><span class="keyword">=&gt; </span><span class="default">$properties</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$extends</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">':'</span><span class="keyword">, </span><span class="default">$namespace</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$extends </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$extends</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// create namespace if necessary<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(!isset(</span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">])) </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// inherit base namespace<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(isset(</span><span class="default">$p_ini</span><span class="keyword">[</span><span class="default">$extends</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$p_ini</span><span class="keyword">[</span><span class="default">$extends</span><span class="keyword">] as </span><span class="default">$prop </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][</span><span class="default">$prop</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// overwrite / set current namespace values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$properties </span><span class="keyword">as </span><span class="default">$prop </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$config</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">][</span><span class="default">$prop</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$config</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Treats this ini:<br />
<span class="default">&lt;?php <br />
</span><span class="comment">/*<br />
[base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=default<br />
<br />
[users:base]<br />
database=users<br />
<br />
[archive : base]<br />
database=archive<br />
*/<br />
</span><span class="default">?&gt;<br />
</span>As if it were like this:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
[base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=default<br />
<br />
[users:base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=users<br />
<br />
[archive : base]<br />
host=localhost<br />
user=testuser<br />
pass=testpass<br />
database=archive<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78815""></a>
  <div class="note">
   <strong class="user">goulven.ch AT gmail DOT com</strong>
   <a href="#78815" class="date">29-Oct-2007 06:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: parse_ini_files cannot cope with values containing the equal sign (=).<br />
<br />
The following function supports sections, comments, arrays, and key-value pairs outside of any section.<br />
Beware that similar keys will overwrite one another (unless in different sections).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">parse_ini </span><span class="keyword">( </span><span class="default">$filepath </span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">( </span><span class="default">$filepath </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">count</span><span class="keyword">( </span><span class="default">$ini </span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">) { return array(); }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$sections </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$values </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$globals </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$ini </span><span class="keyword">as </span><span class="default">$line </span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$line </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Comments<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">$line </span><span class="keyword">== </span><span class="string">'' </span><span class="keyword">|| </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">';' </span><span class="keyword">) { continue; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Sections<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">$line</span><span class="keyword">{</span><span class="default">0</span><span class="keyword">} == </span><span class="string">'[' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$sections</span><span class="keyword">[] = </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Key-value pair<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">list( </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$value </span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">( </span><span class="string">'='</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$key </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">( </span><span class="default">$value </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$i </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Array values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) == </span><span class="string">'[]' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$globals</span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$globals</span><span class="keyword">[ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Array values<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ( </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$line</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) == </span><span class="string">'[]' </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1 </span><span class="keyword">][ </span><span class="default">$key </span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1 </span><span class="keyword">][ </span><span class="default">$key </span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for( </span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$i</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++ ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[ </span><span class="default">$sections</span><span class="keyword">[ </span><span class="default">$j </span><span class="keyword">] ] = </span><span class="default">$values</span><span class="keyword">[ </span><span class="default">$j </span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result </span><span class="keyword">+ </span><span class="default">$globals</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example usage:<br />
<span class="default">&lt;?php<br />
$stores </span><span class="keyword">= </span><span class="default">parse_ini</span><span class="keyword">(</span><span class="string">'stores.ini'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">( </span><span class="default">$stores </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
An example ini file:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
;Commented line start with ';'<br />
global_value1 = a string value<br />
global_value1 = another string value<br />
<br />
; empty lines are discarded<br />
[Section1]<br />
key = value<br />
; whitespace around keys and values is discarded too<br />
otherkey=other value<br />
otherkey=yet another value<br />
; this key-value pair will overwrite the former.<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78723""></a>
  <div class="note">
   <strong class="user">www.onphp5.com</strong>
   <a href="#78723" class="date">24-Oct-2007 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Looks like in PHP 5.3.0 special characters like \n are extrapolated into real newlines. Gotta use \\n.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76082""></a>
  <div class="note">
   <strong class="user">yarco dot w at gmail dot com</strong>
   <a href="#76082" class="date">29-Jun-2007 01:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
parse_ini_file can't deal with const which cancate a string. For example, if test.ini file is<br />
<br />
classPath = ROOT/lib<br />
<br />
If you:<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'ROOT'</span><span class="keyword">, </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">));<br />
<br />
</span><span class="default">$buf </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'test.ini'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
const ROOT would't be parsed.<br />
<br />
But my version could work find.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// array parse_ini_file ( string $filename [, bool $process_sections] )<br />
</span><span class="keyword">function </span><span class="default">parse_ini</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$process_sections </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp; function </span><span class="default">replace_process</span><span class="keyword">(&amp; </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$key</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$item </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$consts</span><span class="keyword">), </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">$consts</span><span class="keyword">), </span><span class="default">$item</span><span class="keyword">);<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="default">$buf </span><span class="keyword">= </span><span class="default">get_defined_constants</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">); </span><span class="comment">// PHP version &gt; 5.0<br />
&nbsp; </span><span class="default">$consts </span><span class="keyword">= </span><span class="default">$buf</span><span class="keyword">[</span><span class="string">'user'</span><span class="keyword">];<br />
&nbsp; </span><span class="default">$ini </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$process_sections</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">array_walk_recursive</span><span class="keyword">(</span><span class="default">$ini</span><span class="keyword">, </span><span class="string">'replace_process'</span><span class="keyword">, </span><span class="default">$consts</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$ini</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'ROOT'</span><span class="keyword">, </span><span class="string">'/test'</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">parse_ini</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">).</span><span class="string">'/test.ini'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70847""></a>
  <div class="note">
   <strong class="user">Justin Hall</strong>
   <a href="#70847" class="date">31-Oct-2006 11:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a simple (but slightly hackish) way of avoiding the character limitations (in values):<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">'QUOTE'</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">);<br />
</span><span class="default">$test </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="string">'test.ini'</span><span class="keyword">);<br />
<br />
echo </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
contents of test.ini:<br />
<br />
park yesterday = "I (walked) | {to} " QUOTE"the"QUOTE " park yesterday &amp; saw ~three~ dogs!"<br />
<br />
output:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">park yesterday</span><span class="keyword">] =&gt; </span><span class="default">I </span><span class="keyword">(</span><span class="default">walked</span><span class="keyword">) | {</span><span class="default">to</span><span class="keyword">} </span><span class="string">"the" </span><span class="default">park yesterday </span><span class="keyword">&amp; </span><span class="default">saw </span><span class="keyword">~</span><span class="default">three</span><span class="keyword">~ </span><span class="default">dogs</span><span class="keyword">!<br />
)<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54737""></a>
  <div class="note">
   <strong class="user">dimk at pisem dot net</strong>
   <a href="#54737" class="date">13-Jul-2005 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Class to access ini values at format "section_name.property", for example $myconf-&gt;get("system.name") returns a property "name" in section "system":
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">Settings </span><span class="keyword">{
<br />

<br />
var </span><span class="default">$properties </span><span class="keyword">= array();
<br />

<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">Settings</span><span class="keyword">() {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">properties </span><span class="keyword">= </span><span class="default">parse_ini_file</span><span class="keyword">(</span><span class="default">_SETTINGS_FILE</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">get</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="string">"."</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; list(</span><span class="default">$section_name</span><span class="keyword">, </span><span class="default">$property</span><span class="keyword">) = </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">=&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">properties</span><span class="keyword">[</span><span class="default">$section_name</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$property</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$section </span><span class="keyword">=&amp; </span><span class="default">$properties</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$section</span><span class="keyword">) &amp;&amp; isset(</span><span class="default">$section</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$section</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37293""></a>
  <div class="note">
   <strong class="user">waikeatNOSPAM at archerlogic dot com</strong>
   <a href="#37293" class="date">09-Nov-2003 06:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found that this function will not work on remote files.
<br />
I tried 
<br />

<br />
$someArray = parse_ini_file("<a href="http://www.example.com/setting.ini" rel="nofollow" target="_blank">http://www.example.com/setting.ini</a>");
<br />

<br />
and it reports
<br />

<br />
Cannot Open '<a href="http://www.example.com/setting.ini" rel="nofollow" target="_blank">http://www.example.com/setting.ini</a>' for reading ...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28261""></a>
  <div class="note">
   <strong class="user">kieran dot huggins at rogers dot com</strong>
   <a href="#28261" class="date">07-Jan-2003 10:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick note for all those running into trouble escaping double quotes:<br />
<br />
I got around this by "base64_encode()"-ing my content on the way in to the ini file, and "base64_decode()"-ing on the way out.<br />
<br />
Because base64 uses the "=" sign, you will have to encapsulate the entire value in double quotes so the line looks like this:<br />
<br />
&nbsp;&nbsp;&nbsp; varname = "TmlhZ2FyYSBGYWxscywgT04="<br />
<br />
When base64'd, your strings will retain all \n, \t...etc...&nbsp; URL's retain everything perfectly :-)<br />
<br />
I hope some of you find this useful!<br />
<br />
Cheers, Kieran</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
