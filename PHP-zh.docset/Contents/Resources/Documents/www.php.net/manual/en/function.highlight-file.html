<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>语法高亮一个文件</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.halt-compiler.html">? __halt_compiler</a></li>
      <li style="float: right;"><a href="function.highlight-string.html">highlight_string ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.misc.html">杂项 函数</a></li>
    <li>语法高亮一个文件</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.highlight-file" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">highlight_file</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">highlight_file</span> &mdash; <span class="dc-title">语法高亮一个文件</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.highlight-file-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>highlight_file</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$filename</code></span>
   [, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$return</code><span class="initializer"> = false</span></span>
  ] ) : <span class="type"><a href="language.pseudo-types.html#language.types.mixed" class="type mixed">mixed</a></span></div>

  <p class="para rdfs-comment">
   使用PHP内置的语法高亮器所定义的颜色，打印输出或者返回 <code class="parameter">filename</code> 文件中语法高亮版本的代码。
  </p>
  <p class="para">
   许多服务器配置了自动高亮 <em class="emphasis">phps</em> 扩展的文件。
   比如，访问 <var class="filename">example.phps</var> 会显示语法高亮后的文件。
   添加以下一行代码到 <var class="filename">httpd.conf</var> 使此生效：
  </p>
  <div class="example-contents screen">
<div class="descriptioncode"><pre class="descriptioncode">AddType application/x-httpd-php-source .phps</pre>
</div>
  </div>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.highlight-file-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">filename</code></dt>

     <dd>

      <p class="para">
       欲高亮文件的路径。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">return</code></dt>

     <dd>

      <p class="para">
       设置该参数为 <strong><code>TRUE</code></strong> 使函数返回高亮后的代码。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.highlight-file-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
     如果 <code class="parameter">return</code> 设置为 <strong><code>TRUE</code></strong>，高亮后的代码不会被打印输出，而是以字符串的形式返回。
     高亮成功返回 <strong><code>TRUE</code></strong>，否则返回 <strong><code>FALSE</code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.highlight-file-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>4.2.1</td>
       <td>
       该函数现在也受 <a href="ini.sect.safe-mode.html#ini.safe-mode" class="link">safe_mode</a> 和 <a href="ini.core.html#ini.open-basedir" class="link">open_basedir</a> 的限制和影响。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.highlight-file-notes">
  <h3 class="title">注释</h3>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">
    应当注意在使用 <span class="function"><strong>highlight_file()</strong></span> 时，确认没有在不经意间泄漏敏感信息，类似密码或者其他任何具有潜在安全风险的信息。
   </p>
  </div>
  <blockquote class="note"><p><strong class="note">Note</strong>: <p class="para">当使用了<code class="parameter">return</code>
参数时，本函数使用其内部输出缓冲，因此不能在
<span class="function"><a href="function.ob-start.html" class="function">ob_start()</a></span> 回调函数的内部使用。</p></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.highlight-file-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.highlight-string.html" class="function" rel="rdfs-seeAlso">highlight_string()</a> - 字符串的语法高亮</span></li>
        <li class="member"><a href="misc.configuration.html#ini.syntax-highlighting" class="link">Highlighting INI 指令</a></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120931""></a>
  <div class="note">
   <strong class="user">tony at tonybaldwin dot me</strong>
   <a href="#120931" class="date">04-Apr-2017 11:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a practical application: <a href="http://wiki.tonybaldwin.me/doku.php/hax/misc/today" rel="nofollow" target="_blank">http://wiki.tonybaldwin.me/doku.php/hax/misc/today</a><br />
I pipe output of the old bsdcalendar script to a file with cron, on the daily, and then use this function to display "Today in History" data on a page.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93274""></a>
  <div class="note">
   <strong class="user">design at joelalejandro dot com dot ar</strong>
   <a href="#93274" class="date">31-Aug-2009 04:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just my two cents - a function that takes PHP source code from a file and decodes it to text/plain MIME-type. 
<br />

<br />
Cheers,
<br />
Joel A. Villarreal Bertoldi
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">phps2array</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\r"</span><span class="keyword">, </span><span class="default">html_entity_decode</span><span class="keyword">(</span><span class="default">strip_tags</span><span class="keyword">(</span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$fileName</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">))));
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Example:
<br />
####################################
<br />

<br />
samplefile.php:
<br />
<span class="default">&lt;?php
<br />
$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />

<br />
</span><span class="comment">/* This is my file*/
<br />
</span><span class="keyword">echo </span><span class="default">$a</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
parser.php:
<br />
<span class="default">&lt;?php
<br />
header</span><span class="keyword">(</span><span class="string">"Content-Type: text/plain"</span><span class="keyword">);
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">parse_php_file</span><span class="keyword">(</span><span class="string">"samplefile.php"</span><span class="keyword">));
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
####################################
<br />
Results:
<br />
####################################
<br />

<br />
Array
<br />
(
<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; <span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] =&gt; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">2</span><span class="keyword">] =&gt; 
<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">3</span><span class="keyword">] =&gt; </span><span class="comment">/* This is my file*/
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] =&gt; echo </span><span class="default">$a</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; [</span><span class="default">5</span><span class="keyword">] =&gt; </span><span class="default">?&gt;
<br />
</span>)
<br />

<br />
####################################</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92697""></a>
  <div class="note">
   <strong class="user">dynamicflurry [at] gmail dot com</strong>
   <a href="#92697" class="date">04-Aug-2009 07:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a great function I found to add numbers to your highlighted code:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">highlight_num</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)
<br />
{
<br />
&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="default">range</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">))), </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$content </span><span class="keyword">= </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />

<br />
&nbsp; 
<br />
&nbsp; echo </span><span class="string">'
<br />
&nbsp;&nbsp;&nbsp; &lt;style type="text/css"&gt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; .num {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; float: left;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; color: gray;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; font-size: 13px;&nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; font-family: monospace;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; text-align: right;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; margin-right: 6pt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; padding-right: 6pt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; border-right: 1px solid gray;}
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; body {margin: 0px; margin-left: 5px;}
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; td {vertical-align: top;}
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; code {white-space: nowrap;}
<br />
&nbsp;&nbsp;&nbsp; &lt;/style&gt;'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"&lt;table&gt;&lt;tr&gt;&lt;td class=\"num\"&gt;\n</span><span class="default">$lines</span><span class="string">\n&lt;/td&gt;&lt;td&gt;\n</span><span class="default">$content</span><span class="string">\n&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">highlight_num</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92449""></a>
  <div class="note">
   <strong class="user">afugit at imavex dot com</strong>
   <a href="#92449" class="date">24-Jul-2009 08:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function will not only echo out the code but will add line numbers.&nbsp; The extra code is for the multi-line and single-line comments using /* and */ and making sure they are highlighted appropriately.&nbsp; If not used, the multi-line comments will not be displayed in orange (or the default comment color).
<br />

<br />
Anthony
<br />

<br />
=============
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">renderFile</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) &amp;&amp; </span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$code </span><span class="keyword">= </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$counter </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$arr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;table border="0" cellpadding="0" cellspacing="0" width="100%" style="font-family: monospace;"&gt;' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;tr&gt;' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;td width="65px" nowrap style="color: #666;"&gt;' </span><span class="keyword">. </span><span class="default">$counter </span><span class="keyword">. </span><span class="string">':&lt;/td&gt;' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// fix multi-line comment bug
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if((</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">'&lt;span style="color: #FF8000"&gt;/*'</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) &amp;&amp; (</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">'*/'</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">)) { </span><span class="comment">// single line comment using /* */ 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$comments </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startcolor </span><span class="keyword">= </span><span class="string">"orange"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif(</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">'&lt;span style="color: #FF8000"&gt;/*'</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) { </span><span class="comment">// multi line comment using /* */
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startcolor </span><span class="keyword">= </span><span class="string">"orange"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$comments </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else { </span><span class="comment">// no comment marks found
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startcolor </span><span class="keyword">= </span><span class="string">"green"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$comments</span><span class="keyword">) { </span><span class="comment">// continuation of multi line comment
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">'*/'</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$comments </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startcolor </span><span class="keyword">= </span><span class="string">"orange"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$comments </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else { </span><span class="comment">// normal line&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$comments </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$startcolor </span><span class="keyword">= </span><span class="string">"green"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// end fix multi-line comment bug
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$comments</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;td width="100%" nowrap style="color: orange;"&gt;' </span><span class="keyword">. </span><span class="default">$line </span><span class="keyword">. </span><span class="string">'&lt;/td&gt;' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;td width="100%" nowrap style="color: ' </span><span class="keyword">. </span><span class="default">$startcolor </span><span class="keyword">. </span><span class="string">';"&gt;' </span><span class="keyword">. </span><span class="default">$line </span><span class="keyword">. </span><span class="string">'&lt;/td&gt;' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/tr&gt;' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$counter</span><span class="keyword">++;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/table&gt;' </span><span class="keyword">. </span><span class="string">"\r\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"&lt;p&gt;The file &lt;i&gt;</span><span class="default">$filename</span><span class="string">&lt;/i&gt; could not be opened.&lt;/p&gt;\r\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92160""></a>
  <div class="note">
   <strong class="user">nospam  at  mbeulens dot nl</strong>
   <a href="#92160" class="date">12-Jul-2009 12:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is my try on linenumbers<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">highlight_file_with_line_numbers</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">) { <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Strip code and first span<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$code </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">), </span><span class="default">36</span><span class="keyword">, -</span><span class="default">15</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Split lines<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Count<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lineCount </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Calc pad length<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$padLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$lineCount</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Re-Print the code and span again<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;code&gt;&lt;span style=\"color: #000000\"&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Loop lines<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$lines </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Create line number<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lineNumber </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$i </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">,&nbsp; </span><span class="default">$padLength</span><span class="keyword">, </span><span class="string">'0'</span><span class="keyword">, </span><span class="default">STR_PAD_LEFT</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Print line<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'&lt;br&gt;&lt;span style="color: #999999"&gt;%s | &lt;/span&gt;%s'</span><span class="keyword">, </span><span class="default">$lineNumber</span><span class="keyword">, </span><span class="default">$line</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Close span<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"&lt;/span&gt;&lt;/code&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90229""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#90229" class="date">11-Apr-2009 03:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I get linenumbers this way... cause I don't like tables :p
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="keyword">function </span><span class="default">highlight_linenumbers </span><span class="keyword">(</span><span class="default">$page</span><span class="keyword">)
<br />
{
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// remove &lt;code&gt; and global &lt;span&gt;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$code </span><span class="keyword">= </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$page</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) ,</span><span class="default">36</span><span class="keyword">,-</span><span class="default">15</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;ol style="font-family:monospace; color:'</span><span class="keyword">, </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'highlight.{default}'</span><span class="keyword">) , </span><span class="string">';"&gt;'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&lt;br /&gt;'</span><span class="keyword">, </span><span class="default">$code</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$line </span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// removing newline
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//empty lines
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'`^(&amp;nbsp;)*$`'</span><span class="keyword">,</span><span class="default">$line</span><span class="keyword">) ) </span><span class="default">$line </span><span class="keyword">= </span><span class="string">'&amp;nbsp;'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// add colour from the previous line
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( !empty(</span><span class="default">$last_colour</span><span class="keyword">) ) </span><span class="default">$s </span><span class="keyword">= </span><span class="string">'&lt;span style="color:'</span><span class="keyword">.</span><span class="default">$last_colour </span><span class="keyword">.</span><span class="string">'"&gt;'</span><span class="keyword">. </span><span class="default">$s</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Supposing we open more spans on a line than closing... let's do this properly
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // We have at most one currently opened span
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">'&lt;span'</span><span class="keyword">) - </span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">'&lt;/span'</span><span class="keyword">) &gt; </span><span class="default">0 </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$line </span><span class="keyword">.= </span><span class="string">'&lt;/span&gt;'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Grab colour to report it on next line
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last_colour </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'&lt;span '</span><span class="keyword">,</span><span class="default">$line</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last_colour </span><span class="keyword">= </span><span class="default">$last_colour</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$last_colour</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last_colour </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$last_colour</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$last_colour</span><span class="keyword">,</span><span class="string">'#'</span><span class="keyword">),</span><span class="default">7</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$last_colour </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;li&gt;'</span><span class="keyword">,</span><span class="default">$line</span><span class="keyword">,</span><span class="string">"&lt;/li&gt;\r"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'&lt;/ol&gt;'</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85644""></a>
  <div class="note">
   <strong class="user">SneakyWho_am_i</strong>
   <a href="#85644" class="date">10-Sep-2008 04:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
From W on 20 August 2008:<br />
YES! I do it too, on many of my things! I love to be able to share my code (when I have the right to do it) with friends who aren't working on the project.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">if (isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'code'</span><span class="keyword">])) { die(</span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)); }<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I like to do it like this. The benefit is minimal but personally for such a small thing I would like to keep it down to one line. Maybe there is a shorter way, I don't know.. But the magic constant __FILE__ saves the day!<br />
<br />
To access this one would be <a href="http://example.com/path/to/script.php?code" rel="nofollow" target="_blank">http://example.com/path/to/script.php?code</a><br />
the parameter just has to be set (? or &amp;) and you don't need the equals sign.<br />
This way I don't generate any errors in E_ALL (because I'm likely in development), and I don't have to remember if the value was supposed to be "true" or "1" or "abacus" or whatever (I mean you're never going to specifically ask to NOT show the code, right?)<br />
<br />
Anyway I've gone on long enough. It's nice to not be the only one who does this :D</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85207""></a>
  <div class="note">
   <strong class="user">W</strong>
   <a href="#85207" class="date">20-Aug-2008 02:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Normally I add highlighting for files like so:<br />
<br />
In every file that should be higlighted:<br />
<span class="default">&lt;?php<br />
$tool_file</span><span class="keyword">=</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_FILENAME'</span><span class="keyword">]; </span><span class="default">$tool_file</span><span class="keyword">=</span><span class="default">basename</span><span class="keyword">(</span><span class="default">$tool_file</span><span class="keyword">);<br />
include_once(</span><span class="string">'highlight.inc.php'</span><span class="keyword">);<br />
</span><span class="default">showCode</span><span class="keyword">();<br />
</span><span class="default">?&gt;<br />
</span><br />
And in highlight.inc.php (or your init file):<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">showCode</span><span class="keyword">() {<br />
if (</span><span class="default">$_REQUEST</span><span class="keyword">[</span><span class="string">'codeShow'</span><span class="keyword">] == </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$codeName</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit ();<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
When a user will open the sourcecode (or you'll link to it) he just adds ?codeShow=1 to the filename.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83088""></a>
  <div class="note">
   <strong class="user">mmcloughlin at gmail dot com</strong>
   <a href="#83088" class="date">09-May-2008 06:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can trick this function to apply additional css rules to parts of the source code.<br />
<br />
For example, if you wanted comments to appear in bold you could do the following<br />
<br />
<span class="default">&lt;?php<br />
ini_set</span><span class="keyword">(</span><span class="string">'highlight.comment'</span><span class="keyword">, </span><span class="string">'#CCCCCC; font-weight: bold;'</span><span class="keyword">);<br />
</span><span class="default">highlight_file</span><span class="keyword">(</span><span class="string">'file.php'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This works because when highlight_file() writes out a comment it wraps it in &lt;span style="color: {contents of hightlight.comment ini variable}"&gt;...&lt;/span&gt;. Therefore as long as your ini value for highlight.comment starts with a color, you can put in whatever style declarations you like.<br />
<br />
This applies to all of the other relavent ini values: highlight.default, highlight.html, highlight.keyword, highlight.string.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82624""></a>
  <div class="note">
   <strong class="user">comperr dot extra at gmail dot com</strong>
   <a href="#82624" class="date">18-Apr-2008 11:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is what I use<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* array() ensures that ok[] cannot have paths inserted if register globals is enabled */<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ok </span><span class="keyword">= array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'f1.php'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'f2.php'<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'f'</span><span class="keyword">], </span><span class="default">$ok</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; die (</span><span class="string">'Not allowed to view this page'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'f'</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78558""></a>
  <div class="note">
   <strong class="user">moisadoru at gmail dot com</strong>
   <a href="#78558" class="date">17-Oct-2007 05:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function which parses the output of highlight file and replaces &amp;lt;span&amp;gt; wits &amp;lt;a&amp;gt;, replaces the style="color: #XXXXXX" part with class="cX", storing the colors in some css rules; that way you get a smaller output size (ratio is about about 1.2 ~ 1.4):<br />
&lt;code&gt;<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">highlight_file2</span><span class="keyword">(</span><span class="default">$fl</span><span class="keyword">,</span><span class="default">$ret</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(!isset(</span><span class="default">$ret</span><span class="keyword">)) </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$fl</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">"/\&lt;span style=\"color: #([\d|A|B|C|D|E|F]{6})\"\&gt;.*?\&lt;\/span\&gt;/"</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">,</span><span class="default">$mtch</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$m </span><span class="keyword">= </span><span class="default">array_unique</span><span class="keyword">(</span><span class="default">$mtch</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cls </span><span class="keyword">= </span><span class="string">'&lt;style type="text/css"&gt;'</span><span class="keyword">.</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rpl </span><span class="keyword">= array(</span><span class="string">"&lt;/a&gt;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mtc </span><span class="keyword">= array(</span><span class="string">"&lt;/span&gt;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$m </span><span class="keyword">as </span><span class="default">$clr</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cls </span><span class="keyword">.= </span><span class="string">"a.c"</span><span class="keyword">.</span><span class="default">$i</span><span class="keyword">.</span><span class="string">"{color: #"</span><span class="keyword">.</span><span class="default">$clr</span><span class="keyword">.</span><span class="string">";}\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rpl</span><span class="keyword">[] = </span><span class="string">"&lt;a class=\"c"</span><span class="keyword">.</span><span class="default">$i</span><span class="keyword">++.</span><span class="string">"\"&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mtc</span><span class="keyword">[] = </span><span class="string">"&lt;span style=\"color: #"</span><span class="keyword">.</span><span class="default">$clr</span><span class="keyword">.</span><span class="string">"\"&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cls </span><span class="keyword">.= </span><span class="string">"&lt;/style&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str2 </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$mtc</span><span class="keyword">,</span><span class="default">$rpl</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$ret</span><span class="keyword">) return </span><span class="default">$str2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else echo </span><span class="default">$str2</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>&lt;/code&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74018""></a>
  <div class="note">
   <strong class="user">management at twilightus dot net</strong>
   <a href="#74018" class="date">20-Mar-2007 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a better take at highlighting a file with line numbers:
<br />

<br />
&lt;style type="text/css"&gt;
<br />
.num {
<br />
float: left;
<br />
color: gray;
<br />
text-align: right;
<br />
margin-right: 6pt;
<br />
padding-right: 6pt;
<br />
border-right: 1px solid gray;}
<br />
&lt;/style&gt;
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">highlight_num</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)
<br />
{
<br />
&nbsp; echo </span><span class="string">'&lt;code class="num"&gt;'</span><span class="keyword">, </span><span class="default">implode</span><span class="keyword">(</span><span class="default">range</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">count</span><span class="keyword">(</span><span class="default">file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">))), </span><span class="string">'&lt;br /&gt;'</span><span class="keyword">), </span><span class="string">'&lt;/code&gt;'</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);
<br />
}
<br />

<br />
</span><span class="default">highlight_num</span><span class="keyword">(</span><span class="string">'file.php'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Thanks for the implode() part from Arevos at programmingforums.org</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69045""></a>
  <div class="note">
   <strong class="user">paul at cheddar dot vaughany dot com</strong>
   <a href="#69045" class="date">21-Aug-2006 04:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's a basic idea but one maybe worth sharing.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">switch(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">]) {<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">1</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="string">"file1.php"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">2</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="string">"file2.php"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; case </span><span class="default">3</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="string">"file3.php"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Location: "</span><span class="keyword">.</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">"PHP_SELF"</span><span class="keyword">]);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Save the script as showfile.php and access it like this:<br />
<br />
&lt;a href="showfile.php?file=1"&gt;Click here to see file 1 source code&lt;/a&gt;<br />
<br />
The default case is for people editing the URL to try to access further files. Just don't add any files you don't want users to see, and maybe hard-code in large, random numbers or MD5 hashes.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64123""></a>
  <div class="note">
   <strong class="user">showsource at gmail dot com</strong>
   <a href="#64123" class="date">07-Apr-2006 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please, be aware of just using marlon at mbwp dot nl example to show the sourcecode<br />
Do as told in this manual, "CAUTION", do some check on what code to highlight.<br />
Simply just using $_GET["file"] is very bad.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62617""></a>
  <div class="note">
   <strong class="user">marlon at mbwp dot nl</strong>
   <a href="#62617" class="date">05-Mar-2006 05:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use the folowing code to highlight a file with line numbers:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">"&lt;table bgcolor=#EEEEEE&gt;&lt;tr&gt;&lt;td width=30&gt;"</span><span class="keyword">;<br />
for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">count</span><span class="keyword">(</span><span class="default">file</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">])); </span><span class="default">$i</span><span class="keyword">++) echo </span><span class="default">$i</span><span class="keyword">.</span><span class="string">".&lt;br&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"&lt;/td&gt;&lt;td&gt;"</span><span class="keyword">;<br />
</span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">]);<br />
echo </span><span class="string">"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62362""></a>
  <div class="note">
   <strong class="user">msn at toolskyn dot nl</strong>
   <a href="#62362" class="date">26-Feb-2006 01:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use this (simple and dirty) function in my tutorials to add linenumbers. I let all the linenumbers in one table cell so it is easier for people to copy and paste the code (so they don't have to remove all the linenumbers):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">highlight_with_linenum</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//open handle, set vars<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$count </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//look line ends<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">while (</span><span class="default">$thisone </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">, </span><span class="string">"1"</span><span class="keyword">)) <br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$thisone </span><span class="keyword">== </span><span class="string">"\n"</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//add number<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">.= </span><span class="default">$count </span><span class="keyword">. </span><span class="string">"&lt;br /&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$count</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//close handle<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$handle</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//highlight contents<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$contents </span><span class="keyword">= </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//print output (you could as well return now)<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">print </span><span class="string">'&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;' </span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">. </span><span class="string">'&lt;/code&gt;&lt;/td&gt;&lt;td&gt;' </span><span class="keyword">. <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$contents </span><span class="keyword">. </span><span class="string">'&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;'</span><span class="keyword">;&nbsp; &nbsp; <br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Maybe it's of use to someone</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60422""></a>
  <div class="note">
   <strong class="user">venski at gmail dot com</strong>
   <a href="#60422" class="date">06-Jan-2006 05:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think it will be better if the variable contains the files that are allowed to be viewed. There can always befound a way to pass the name of a forbiddedn file that is not in the prohibited array.<br />
<br />
Thus the code will be:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//array with files to allow<br />
</span><span class="default">$allowed </span><span class="keyword">= array(</span><span class="string">'index.php'</span><span class="keyword">, </span><span class="string">'menu.php'</span><span class="keyword">, </span><span class="string">'about.php'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// get the filename<br />
</span><span class="default">$file </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="default">file</span><span class="keyword">];<br />
if(</span><span class="default">file_Exists</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">in_array</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$allowed</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// check if it is part of the allowed list<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">highlight_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">); </span><span class="comment">//highlight file<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// not allowed. just die. do not warn ;)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">die(</span><span class="string">""</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
else{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// file doesnt exist<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="string">"The file does not exist."</span><span class="keyword">;&nbsp; &nbsp; &nbsp;&nbsp; <br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46009""></a>
  <div class="note">
   <strong class="user">aidan at php dot net</strong>
   <a href="#46009" class="date">26-Sep-2004 08:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To add line numbers to source code, with optional function linking, use the below function:
<br />

<br />
<a href="http://aidanlister.com/repos/v/function.highlight_file_linenum.php" rel="nofollow" target="_blank">http://aidanlister.com/repos/v/function.highlight_file_linenum.php</a>
<br />

<br />
A much more thorough and smarter, though slower version is here:
<br />

<br />
<a href="http://aidanlister.com/repos/v/PHP_Highlight.php" rel="nofollow" target="_blank">http://aidanlister.com/repos/v/PHP_Highlight.php</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="44699""></a>
  <div class="note">
   <strong class="user">csst0266 at cs dot uoi dot gr</strong>
   <a href="#44699" class="date">13-Aug-2004 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a simple, yet useful, tip... Issuing the following command under a Unix-like OS:<br />
<br />
ln -s your_script.php your_script.phps<br />
<br />
Will result in the creation of a symbolic link (called your_script.phps) to the source code (your_script.php). This way you have (apart from the source code .php) the highlighted version of your script (.phps) accessible via your web browser.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
