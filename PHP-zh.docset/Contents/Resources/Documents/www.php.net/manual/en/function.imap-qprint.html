<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Convert a quoted-printable string to an 8 bit string</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imap-ping.html">? imap_ping</a></li>
      <li style="float: right;"><a href="function.imap-rename.html">imap_rename ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.imap.html">IMAP 函数</a></li>
    <li>Convert a quoted-printable string to an 8 bit string</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imap-qprint" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imap_qprint</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imap_qprint</span> &mdash; <span class="dc-title">Convert a quoted-printable string to an 8 bit string</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imap-qprint-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>imap_qprint</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Convert a quoted-printable string to an 8 bit string according to <a href="http://www.faqs.org/rfcs/rfc2045" class="link external" title="Link : http://www.faqs.org/rfcs/rfc2045">&raquo;&nbsp;RFC2045</a>, section 6.7.
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imap-qprint-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       A quoted-printable string
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imap-qprint-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an 8 bits string,  或者在失败时返回 <strong><code>false</code></strong>.
  </p>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imap-qprint-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imap-8bit.html" class="function" rel="rdfs-seeAlso">imap_8bit()</a> - Convert an 8bit string to a quoted-printable string</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="86939""></a>
  <div class="note">
   <strong class="user">wese at gmx dot at</strong>
   <a href="#86939" class="date">11-Nov-2008 06:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just got rid of the loops using a regex.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">decode_qprint</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/\=([A-F][A-F0-9])/"</span><span class="keyword">,</span><span class="string">"%$1"</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Thanks for sharing!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74145""></a>
  <div class="note">
   <strong class="user">tonitester at gmx dot net</strong>
   <a href="#74145" class="date">27-Mar-2007 06:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you don't have access to the imap_qprint function and you have to encode URL Decoded and Quoted Printable Strings you receive by Mail try this simple function. But if you don't receive URL Decoded data and the string doesn't contain an = you better use <a href="http://www.php.net/manual/en/function.quoted-printable-decode.php" rel="nofollow" target="_blank">http://www.php.net/manual/en/function.quoted-printable-decode.php</a><br />
<br />
function decode_qprint($str){<br />
$arr= array("A","B","C","D","E","F");<br />
while (list(, $var) = each($arr)) {&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; $i=0;<br />
&nbsp;&nbsp;&nbsp; while ($i &lt;=9){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $str=str_replace("=".$var.$i,"%".$var.$i,$str);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $i++;}<br />
&nbsp;&nbsp;&nbsp; $arr2 = array("A","B","C","D","E","F");<br />
&nbsp;&nbsp;&nbsp; while (list(, $val) = each($arr2)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $str=str_replace("=".$var.$val,"%".$var.$val,$str);}}<br />
$str = urldecode($str);<br />
$str = utf8_encode($str);<br />
return $str;}<br />
<br />
$s2d='=F6=D6=DF=C4=E4=DC=FC=A9=AE';<br />
$2s2d='%F6';<br />
<br />
$output = decode_qprint($s2d);<br />
$output2 = decode_qprint($2s2d);<br />
<br />
echo $output;<br />
echo $output2;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56230""></a>
  <div class="note">
   <strong class="user">bletous at yahoo dot fr</strong>
   <a href="#56230" class="date">27-Aug-2005 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some mails are encoded in bad quoted printable format:<br />
I use this function to decode the qprint:<br />
<br />
for($i=0;$i&lt;256;$i++)<br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp; $c1=dechex($i);<br />
&nbsp;&nbsp;&nbsp; if(strlen($c1)==1){$c1="0".$c1;} <br />
&nbsp;&nbsp;&nbsp; $c1="=".$c1;<br />
&nbsp;&nbsp;&nbsp; $myqprinta[]=$c1;<br />
&nbsp;&nbsp;&nbsp; $myqprintb[]=chr($i);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
function decode($data,$code)<br />
{&nbsp; <br />
if(!$code){return imap_utf7_decode($data);}<br />
if($code==0){return imap_utf7_decode($data);}<br />
if($code==1){return imap_utf8($data);}<br />
if($code==2){return ($data);}<br />
if($code==3){return imap_base64($data);}<br />
if($code==4){return imap_qprint(str_replace($myqprinta,$myqprintb,($data)));}<br />
if($code==5){return ($data);}<br />
<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="4009""></a>
  <div class="note">
   <strong class="user">bernard at bmpsystems dot com</strong>
   <a href="#4009" class="date">26-Feb-2000 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function seems to have a bug, when the quoted-printable string contains a "=" without the HEX code of a Character.
<br />
I use the regular quoted_printable_decode instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
