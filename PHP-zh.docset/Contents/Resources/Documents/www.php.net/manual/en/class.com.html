<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>The com class</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="com.examples.arrays.html">? Arrays and Array-style COM properties</a></li>
      <li style="float: right;"><a href="com.construct.html">com::__construct ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.com.html">COM</a></li>
    <li>The com class</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="class.com" class="reference">
 
 <h1 class="title">The com class</h1>
 <div class="partintro"><p class="verinfo">(PHP 4 &gt;= 4.1.0, PHP 5, PHP 7, PHP 8)</p>


  <div class="section" id="com.intro">
   <h2 class="title">简介</h2>
   <p class="para">
    The com class allows you to instantiate an OLE compatible COM object and
    call its methods and access its properties.
   </p>
  </div>


  <div class="section" id="com.synopsis">
   <h2 class="title">类摘要</h2>


   <div class="classsynopsis">
    <div class="ooclass">
     
    </div>

    <div class="classsynopsisinfo">
     <span class="ooclass">
      <span class="modifier">class</span> <strong class="classname">com</strong>
     </span>

     <span class="ooclass">
      <span class="modifier">extends</span>
       <a href="class.variant.html" class="classname">variant</a>
     </span>
     {</div>

    <div class="classsynopsisinfo classsynopsisinfo_comment">/* 方法 */</div>
    <div class="constructorsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><a href="com.construct.html" class="methodname">__construct</a></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$module_name</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">string</span>|<span class="type">null</span></span> <code class="parameter">$server_name</code><span class="initializer"> = <strong><code>null</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$codepage</code><span class="initializer"> = <strong><code>CP_ACP</code></strong></span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$typelib</code><span class="initializer"> = &quot;&quot;</span></span><br>)</div>

   }</div>


  </div>

  <div class="section" id="class.com.overloadedmethods">
   <h2 class="title">Overloaded Methods</h2>
   <p class="para">
    The returned object is an overloaded object, which means that PHP does
    not see any fixed methods as it does with regular classes; instead, any
    property or method accesses are passed through to COM.
   </p>
   <p class="para">
    PHP will automatically detect methods that accept
    parameters by reference, and will automatically convert regular PHP
    variables to a form that can be passed by reference.  This means that you
    can call the method very naturally; you needn&#039;t go to any extra effort in
    your code.
   </p>
  </div>

  <div class="section" id="class.com.examples">
   <h2 class="title">com examples</h2>
   <p class="para">
    <div class="example" id="example.com1">
     <p><strong>Example #1 com example (1)</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;starting&nbsp;word<br /></span><span style="color: #0000BB">$word&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">com</span><span style="color: #007700">(</span><span style="color: #DD0000">"word.application"</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Unable&nbsp;to&nbsp;instantiate&nbsp;Word"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"Loaded&nbsp;Word,&nbsp;version&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Version</span><span style="color: #007700">}</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//bring&nbsp;it&nbsp;to&nbsp;front<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Visible&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//open&nbsp;an&nbsp;empty&nbsp;document<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Documents</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Add</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//do&nbsp;some&nbsp;weird&nbsp;stuff<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Selection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">TypeText</span><span style="color: #007700">(</span><span style="color: #DD0000">"This&nbsp;is&nbsp;a&nbsp;test..."</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Documents</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">SaveAs</span><span style="color: #007700">(</span><span style="color: #DD0000">"Useless&nbsp;test.doc"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//closing&nbsp;word<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Quit</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//free&nbsp;the&nbsp;object<br /></span><span style="color: #0000BB">$word&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    </div>
   </p>
   <p class="para">
    <div class="example" id="example.com2">
     <p><strong>Example #2 com example (2)</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">com</span><span style="color: #007700">(</span><span style="color: #DD0000">"ADODB.Connection"</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Cannot&nbsp;start&nbsp;ADO"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Open</span><span style="color: #007700">(</span><span style="color: #DD0000">"Provider=SQLOLEDB;&nbsp;Data&nbsp;Source=localhost;<br />Initial&nbsp;Catalog=database;&nbsp;User&nbsp;ID=user;&nbsp;Password=password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$rs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Execute</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;sometable"</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Recordset<br /><br /></span><span style="color: #0000BB">$num_columns&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Fields</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Count</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #0000BB">$num_columns&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br />for&nbsp;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$num_columns</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$fld</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Fields</span><span style="color: #007700">(</span><span style="color: #0000BB">$i</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$rowcount&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />while&nbsp;(!</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">EOF</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$num_columns</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$fld</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">value&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\t"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rowcount</span><span style="color: #007700">++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;increments&nbsp;rowcount<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">MoveNext</span><span style="color: #007700">();<br />}<br /><br /></span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Close</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Close</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$rs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
  </div>

 </div>

 






<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="com.construct.html">com::__construct</a> &mdash; com class constructor</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125212""></a>
  <div class="note">
   <strong class="user">info at ensostudio dot ru</strong>
   <a href="#125212" class="date">26-Jul-2020 09:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Complete example of using WScript.Shell:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp; * Methods &amp; properties<br />
&nbsp; * @link https://msdn.microsoft.com/en-us/library/2f38xsxe(v=vs.84).aspx<br />
&nbsp; */<br />
</span><span class="default">$shell </span><span class="keyword">= new </span><span class="default">com</span><span class="keyword">(</span><span class="string">'WScript.Shell'</span><span class="keyword">, </span><span class="default">null</span><span class="keyword">, </span><span class="default">CP_UTF8</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">CurrentDirectory</span><span class="keyword">);<br />
foreach (</span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">Environment </span><span class="keyword">as </span><span class="default">$value</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
}<br />
</span><span class="comment">// check file 'Test.php'<br />
</span><span class="default">$process </span><span class="keyword">= </span><span class="default">$shell</span><span class="keyword">-&gt;</span><span class="default">Exec</span><span class="keyword">(</span><span class="string">'.../php.exe --syntax-check --file=".../src/Test.php"'</span><span class="keyword">);<br />
</span><span class="comment">// wait complete: 1 - done<br />
</span><span class="keyword">while (! </span><span class="default">$process</span><span class="keyword">-&gt;</span><span class="default">Status</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">5000</span><span class="keyword">);<br />
}<br />
</span><span class="comment">// results: -1 - syntax error, 0 - no error<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$process</span><span class="keyword">-&gt;</span><span class="default">ExitCode</span><span class="keyword">);<br />
</span><span class="comment">// show responce<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$process</span><span class="keyword">-&gt;</span><span class="default">StdOut</span><span class="keyword">-&gt;</span><span class="default">ReadAll</span><span class="keyword">());<br />
</span><span class="comment">// show errors<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$process</span><span class="keyword">-&gt;</span><span class="default">StdErr</span><span class="keyword">-&gt;</span><span class="default">ReadAll</span><span class="keyword">());<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123033""></a>
  <div class="note">
   <strong class="user">Danil_lll</strong>
   <a href="#123033" class="date">14-Aug-2018 10:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hello. There is a code c# which works with the COM-library (written on C++) - hybrid.dll.<br />
I need to rewrite this code from C# to PHP (that is connect the COM-library to the PHP code)<br />
<br />
Here is the function that is called inside C#:<br />
Gr = HybridLib.Hybrid_Color.GREEN;<br />
<br />
And here is the list of "Hybrid_Color"which in the library: <br />
enum Hybrid_Color<br />
{<br />
&nbsp;&nbsp;&nbsp; GREEN = 0x00000001,<br />
&nbsp;&nbsp;&nbsp; BLACK = 0x00000002,<br />
&nbsp;&nbsp;&nbsp; BLUE = 0x00000004,<br />
};<br />
<br />
The library itself was launched in PHP:<br />
$PHP_Lib = new COM("HybridLib.Hybrid");<br />
<br />
Can not assign value:<br />
$gr = $PHP_Lib -&gt; ..... ?????<br />
<br />
What I write next, I don't know... <br />
Tell me, please, who knows...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120322""></a>
  <div class="note">
   <strong class="user">IceNV</strong>
   <a href="#120322" class="date">13-Dec-2016 02:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Under PHP7(.x) 64-bit, there is a documentation error (on the MSDN side, already reported) causing problems if you try to manipulate the registry (StdRegProv) through COM.<br />
<br />
Indeed, MSDN reports that the registry hive/root must be reported as a uint32, which means that, in PHP 64-bit, one would create a new Variant($root,VT_UI4).<br />
<br />
This would throw a type mismatch error.<br />
It seems internally and contrary to what MSDN says (as of now, 2016-12-13), the root parameter must actually be passed as an int32.<br />
<br />
So you have to :<br />
1. convert your root number to a negative int to avoid out-of-bounds exceptions when creating the variant below (basically the integer being &gt;= 2^31, you have to wrap it around the 32-bit signed integer maximum yourself) ;<br />
2. create a new Variant($root,VT_I4) ;<br />
3. pass that Variant to your COM API call.<br />
<br />
This did not happen before PHP 7.0 as it always used VT_I4 internally before (see https://bugs.php.net/bug.php?id=73605), but now it respects (and is right to do so) the real integer length, so without an explicit conversion, PHP7 would now output a VT_I8 on x64, versus VT_I4 for PHP5.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118286""></a>
  <div class="note">
   <strong class="user">juan156_elias at gmail dot com</strong>
   <a href="#118286" class="date">08-Nov-2015 03:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an example of using .Net using the NetPhp library that is based on the COM/DOTNET classes.<br />
<br />
You can use any .dll file,&nbsp; wether it is or not COM decorated and any of the .Net framework types out of the box. You can also target any version of the .Net framework.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$runtime </span><span class="keyword">= new \</span><span class="default">NetPhp</span><span class="keyword">\</span><span class="default">Core</span><span class="keyword">\</span><span class="default">NetPhpRuntime</span><span class="keyword">(</span><span class="string">'COM'</span><span class="keyword">, </span><span class="string">'netutilities.NetPhpRuntime'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Add both SpreadsheetLight and the OpenXML it depends on.<br />
</span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">RegisterAssemblyFromFile</span><span class="keyword">(</span><span class="string">'/binaries/SpreadsheetLight.dll'</span><span class="keyword">, </span><span class="string">'SpreadsheetLight'</span><span class="keyword">);<br />
</span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">RegisterAssemblyFromFile</span><span class="keyword">(</span><span class="string">'/binaries/DocumentFormat.OpenXml.dll'</span><span class="keyword">, </span><span class="string">'DocumentFormat.OpenXml'</span><span class="keyword">);<br />
</span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">RegisterAssemblyFromFile</span><span class="keyword">(</span><span class="string">'/binaries/AjaxMin.dll'</span><span class="keyword">, </span><span class="string">'AjaxMin'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Using the FullName of a type that belongs to an assembly that has already been registered.<br />
</span><span class="default">$datetime </span><span class="keyword">= </span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">TypeFromName</span><span class="keyword">(</span><span class="string">"System.DateTime"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Using the FullName of a type that has not been registered yet (from a file)<br />
</span><span class="default">$minifier </span><span class="keyword">= </span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">TypeFromFile</span><span class="keyword">(</span><span class="string">"Microsoft.Ajax.Utilities.Minifier"</span><span class="keyword">, </span><span class="default">APPLICATION_ROOT </span><span class="keyword">. </span><span class="string">'/binaries/AjaxMin.dll'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Using the FullName of a type that has not been registered yet (autodiscoverable)<br />
</span><span class="default">$datetime2 </span><span class="keyword">= </span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">TypeFromAssembly</span><span class="keyword">(</span><span class="string">"System.DateTime"</span><span class="keyword">, </span><span class="string">"mscorlib, ...."</span><span class="keyword">);<br />
<br />
</span><span class="default">$datetime</span><span class="keyword">-&gt;</span><span class="default">Instantiate</span><span class="keyword">();<br />
echo </span><span class="default">$datetime</span><span class="keyword">-&gt;</span><span class="default">ToShortDateString</span><span class="keyword">()-&gt;</span><span class="default">Val</span><span class="keyword">(); </span><span class="comment">// Outputs 01/01/0001<br />
<br />
// We can only use Int32 from native PHP, so parse<br />
// an Int64 that is equivalent to (long) in the DateTime constructor.<br />
</span><span class="default">$ticks </span><span class="keyword">= </span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">TypeFromName</span><span class="keyword">(</span><span class="string">"System.Int64"</span><span class="keyword">)-&gt;</span><span class="default">Parse</span><span class="keyword">(</span><span class="string">'98566569856565656'</span><span class="keyword">);<br />
<br />
</span><span class="default">$datetime</span><span class="keyword">-&gt;</span><span class="default">Instantiate</span><span class="keyword">(</span><span class="default">$ticks</span><span class="keyword">);<br />
echo </span><span class="default">$datetime</span><span class="keyword">-&gt;</span><span class="default">ToShortDateString</span><span class="keyword">()-&gt;</span><span class="default">Val</span><span class="keyword">(); </span><span class="comment">// Outputs 07/05/0313<br />
<br />
// We can only use Int32 from native PHP, so parse<br />
// an Int64 that is equivalent to (long) in the DateTime constructor.<br />
</span><span class="default">$ticks </span><span class="keyword">= </span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">TypeFromName</span><span class="keyword">(</span><span class="string">"System.Int64"</span><span class="keyword">)-&gt;</span><span class="default">Parse</span><span class="keyword">(</span><span class="string">'98566569856565656'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Dump a .Net System.Timers.Timer object!<br />
</span><span class="default">$data </span><span class="keyword">= </span><span class="default">$timer</span><span class="keyword">-&gt;</span><span class="default">GetPhpFromJson</span><span class="keyword">();<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Outputs:<br />
&nbsp;&nbsp;&nbsp; //&nbsp; object(stdClass)[38]<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp;&nbsp; public 'AutoReset' =&gt; boolean true<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp;&nbsp; public 'Enabled' =&gt; boolean false<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp;&nbsp; public 'Interval' =&gt; int 100<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp;&nbsp; public 'Site' =&gt; null<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp;&nbsp; public 'SynchronizingObject' =&gt; null<br />
&nbsp;&nbsp;&nbsp; //&nbsp; &nbsp;&nbsp; public 'Container' =&gt; null<br />
<br />
// Check if today is monday<br />
</span><span class="default">$IsMonday </span><span class="keyword">= </span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">TypeFromName</span><span class="keyword">(</span><span class="string">"System.DateTime"</span><span class="keyword">)-&gt;</span><span class="default">Now</span><span class="keyword">-&gt;</span><span class="default">DayOfWeek</span><span class="keyword">-&gt;<br />
</span><span class="default">Equals</span><span class="keyword">(</span><span class="default">$runtime</span><span class="keyword">-&gt;</span><span class="default">TypeFromName</span><span class="keyword">(</span><span class="string">"System.DayOfWeek"</span><span class="keyword">)-&gt;</span><span class="default">Enum</span><span class="keyword">(</span><span class="string">'Monday'</span><span class="keyword">));<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114365""></a>
  <div class="note">
   <strong class="user">Eion Robb</strong>
   <a href="#114365" class="date">12-Feb-2014 09:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
All the examples here show<br />
<span class="default">&lt;?php $var </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Whatever.Something'</span><span class="keyword">) or die(); </span><span class="default">?&gt;<br />
</span>however the 'or die()' bit is redundant as a fatal 'com_exception' exception will be thrown, killing your script.&nbsp; If you want to handle the 'or' condition you need to catch the exception, eg<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">try {<br />
</span><span class="default">$var </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Whatever.Something'</span><span class="keyword">);<br />
} catch (</span><span class="default">com_exception $e</span><span class="keyword">) {<br />
&nbsp;</span><span class="comment">//couldn't load, do something else like register<br />
</span><span class="default">exec</span><span class="keyword">(</span><span class="string">'regsvr32 /s whatever.dll'</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106337""></a>
  <div class="note">
   <strong class="user">rogier</strong>
   <a href="#106337" class="date">28-Oct-2011 10:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Took me a while to figure this out by trial and error:<br />
<br />
If your frustrated when getting a com-exception like "Error [0x80004002] ..." (with a message nagging you about an unsupported interface), and you're calling a class method through COM that expects a char as an argument, you should NOT call the method with a single-character string.<br />
<br />
The correct way of calling a method like this is to use a VARIANT with a type of VT_UI1.<br />
<br />
COM enabled method definition: <br />
<br />
public bool DoSomething(char arg);<br />
<br />
<span class="default">&lt;?php<br />
<br />
$com </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Some.Class.Name'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// This will fail<br />
</span><span class="default">$var </span><span class="keyword">= </span><span class="string">'a'</span><span class="keyword">;<br />
</span><span class="default">$com</span><span class="keyword">-&gt;</span><span class="default">DoSomething</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">);<br />
<br />
</span><span class="comment">// This works correctly<br />
</span><span class="default">$var </span><span class="keyword">= new </span><span class="default">VARIANT</span><span class="keyword">(</span><span class="default">ord</span><span class="keyword">(</span><span class="string">'a'</span><span class="keyword">), </span><span class="default">VT_UI1</span><span class="keyword">);<br />
</span><span class="default">$com</span><span class="keyword">-&gt;</span><span class="default">DoSomething</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
I hope this helps some people</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100886""></a>
  <div class="note">
   <strong class="user">sparrowstail at googlemail dot com</strong>
   <a href="#100886" class="date">12-Nov-2010 11:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This script reports all Windows drives, drive type, status (if not available), free space and total drive size:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
&nbsp;&nbsp;&nbsp; $fso </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'Scripting.FileSystemObject'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$D </span><span class="keyword">= </span><span class="default">$fso</span><span class="keyword">-&gt;</span><span class="default">Drives</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$type </span><span class="keyword">= array(</span><span class="string">"Unknown"</span><span class="keyword">,</span><span class="string">"Removable"</span><span class="keyword">,</span><span class="string">"Fixed"</span><span class="keyword">,</span><span class="string">"Network"</span><span class="keyword">,</span><span class="string">"CD-ROM"</span><span class="keyword">,</span><span class="string">"RAM Disk"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$D </span><span class="keyword">as </span><span class="default">$d </span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dO </span><span class="keyword">= </span><span class="default">$fso</span><span class="keyword">-&gt;</span><span class="default">GetDrive</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">DriveType </span><span class="keyword">== </span><span class="default">3</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">Sharename</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; }else if(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">IsReady</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">VolumeName</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">file_size</span><span class="keyword">(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">FreeSpace</span><span class="keyword">) . </span><span class="string">" free of: " </span><span class="keyword">. </span><span class="default">file_size</span><span class="keyword">(</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">TotalSize</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; }else{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="string">"[Drive not ready]"</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; } 
<br />
&nbsp;&nbsp; echo </span><span class="string">"Drive " </span><span class="keyword">. </span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">DriveLetter </span><span class="keyword">. </span><span class="string">": - " </span><span class="keyword">. </span><span class="default">$type</span><span class="keyword">[</span><span class="default">$dO</span><span class="keyword">-&gt;</span><span class="default">DriveType</span><span class="keyword">] . </span><span class="string">" - " </span><span class="keyword">. </span><span class="default">$n </span><span class="keyword">. </span><span class="string">" - " </span><span class="keyword">. </span><span class="default">$s </span><span class="keyword">. </span><span class="string">"&lt;br&gt;"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp;&nbsp; function </span><span class="default">file_size</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$filesizename </span><span class="keyword">= array(</span><span class="string">" Bytes"</span><span class="keyword">, </span><span class="string">" KB"</span><span class="keyword">, </span><span class="string">" MB"</span><span class="keyword">, </span><span class="string">" GB"</span><span class="keyword">, </span><span class="string">" TB"</span><span class="keyword">, </span><span class="string">" PB"</span><span class="keyword">, </span><span class="string">" EB"</span><span class="keyword">, </span><span class="string">" ZB"</span><span class="keyword">, </span><span class="string">" YB"</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">$size </span><span class="keyword">? </span><span class="default">round</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">/</span><span class="default">pow</span><span class="keyword">(</span><span class="default">1024</span><span class="keyword">, (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">log</span><span class="keyword">(</span><span class="default">$size</span><span class="keyword">, </span><span class="default">1024</span><span class="keyword">)))), </span><span class="default">2</span><span class="keyword">) . </span><span class="default">$filesizename</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] : </span><span class="string">'0 Bytes'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
There are a number of other properties of the drive object which can be called this way - see:
<br />

<br />
<a href="http://msdn.microsoft.com/en-us/library/ts2t8ybh%28VS.85%29.aspx" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/ts2t8ybh%28VS.85%29.aspx</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93737""></a>
  <div class="note">
   <strong class="user">z3n at overflow dot biz</strong>
   <a href="#93737" class="date">24-Sep-2009 08:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On a query reply using ADODB.Connection object, all my $rs-&gt;Fields['field_name']-&gt;Value returned `variable Object` when inserted into a array, like this:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">for (</span><span class="default">$rl</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">]=array(),</span><span class="default">_qm</span><span class="keyword">(</span><span class="default">$_query</span><span class="keyword">);!</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">;</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">()) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rl</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">][]=</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">]-&gt;</span><span class="default">Value</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
I figured out that converting the value into a INT fixed the issue:
<br />

<br />
<span class="default">&lt;?php $rl</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">][]=</span><span class="default">intval</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'x'</span><span class="keyword">]-&gt;</span><span class="default">Value</span><span class="keyword">); </span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91574""></a>
  <div class="note">
   <strong class="user">pavanphp Gudipati</strong>
   <a href="#91574" class="date">17-Jun-2009 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here I Am describing a Program from which you can connect any exe(software) using COM component. 
<br />
pdf2swf is a software for converting PDf to SWF files.
<br />

<br />
This is best example for&nbsp; WScript.Shell
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">#code for pdf to swf using pdf2swf software
<br />
#this codeworks in windows environment.
<br />
&nbsp;
<br />

<br />
## Important Parameters
<br />
</span><span class="default">$software_path&nbsp; </span><span class="keyword">=</span><span class="string">"C:\\SWFTools\\pdf2swf" </span><span class="keyword">;
<br />
</span><span class="default">$pdf_path&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=</span><span class="string">"C:\\SWFTools\\abcd.pdf" </span><span class="keyword">;
<br />
</span><span class="default">$argument&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="string">"-o"</span><span class="keyword">;
<br />
</span><span class="default">$swf_output&nbsp; &nbsp;&nbsp; </span><span class="keyword">=</span><span class="string">"C:\\SWFTools\\abcd.swf" </span><span class="keyword">;
<br />

<br />
&nbsp;
<br />

<br />
</span><span class="comment">#actual code
<br />
</span><span class="default">$cmd&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">=</span><span class="string">" </span><span class="default">$software_path</span><span class="string"> </span><span class="default">$pdf_path</span><span class="string">&nbsp; </span><span class="default">$argument</span><span class="string"> </span><span class="default">$swf_output</span><span class="string">"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$WshShell&nbsp;&nbsp; </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);
<br />
</span><span class="default">$oExec&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">$WshShell</span><span class="keyword">-&gt;</span><span class="default">Run</span><span class="keyword">(</span><span class="string">"cmd /C </span><span class="default">$cmd</span><span class="string"> "</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); 
<br />

<br />
</span><span class="comment"># 0 for command prompt invisible mode
<br />
# 3 for visible
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90814""></a>
  <div class="note">
   <strong class="user">tsintra at humansoft dot pt</strong>
   <a href="#90814" class="date">11-May-2009 08:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
After one week of trying to understand what was wrong with my PHP communication with MS Word, i finally got it working...<br />
It seems that if you're running IIS, the COM object are invoked with restricted privileges.<br />
If you're having permission problems like not being able to opening or saving a document and you're getting errors like:<br />
<br />
&nbsp;- This command is not available because no document is open<br />
or<br />
&nbsp;- Command failed<br />
<br />
try this (if you're running IIS):<br />
<br />
- Execute "dcomcnfg"<br />
- Open Component Services &gt; Computers &gt; My Computer &gt; DCOM Config<br />
- Search for Microsoft Office Word 97-2003 Document (it will be something like this translated to your language, so take a while and search for it)<br />
- Right-Click on it and open the properties<br />
- Choose "Identity" tab<br />
- Normally this is set to "the launching user". You have to change this to "the interactive user" or a admin user of your choice.<br />
- Apply these new settings and test your COM application. It should work fine now.<br />
<br />
I hope I save lots and lots of hours of headaches to some of you :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89911""></a>
  <div class="note">
   <strong class="user">dpchiesa at hotmail dot com</strong>
   <a href="#89911" class="date">27-Mar-2009 09:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a way to create an AES-Encrypted ZIP file in PHP, using DotNetZip via the COM class. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">try<br />
{<br />
&nbsp; </span><span class="default">$fname </span><span class="keyword">= </span><span class="string">"zip-generated-from-php-" </span><span class="keyword">. </span><span class="default">date</span><span class="keyword">(</span><span class="string">'Y-m-d-His'</span><span class="keyword">) . </span><span class="string">".zip"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$zipOutput </span><span class="keyword">= </span><span class="string">"c:\\temp\\" </span><span class="keyword">. </span><span class="default">$fname</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$zip </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"Ionic.Zip.ZipFile"</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Name </span><span class="keyword">= </span><span class="default">$zipOutput</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$dirToZip</span><span class="keyword">= </span><span class="string">"c:\\temp\\psh"</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">#$dirToZip= "c:\\dinoch\\webs\\php";<br />
&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Encryption </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Password </span><span class="keyword">= </span><span class="string">"AES-Encryption-Is-Secure"</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">AddDirectory</span><span class="keyword">(</span><span class="default">$dirToZip</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Save</span><span class="keyword">();<br />
&nbsp; </span><span class="default">$zip</span><span class="keyword">-&gt;</span><span class="default">Dispose</span><span class="keyword">();<br />
<br />
&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">))<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Cache-Control: no-cache, must-revalidate'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Type: application/x-zip'</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Disposition: attachment; filename=' </span><span class="keyword">. </span><span class="default">$fname</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-Length: ' </span><span class="keyword">. </span><span class="default">filesize</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">readfile</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$zipOutput</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; else <br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;html&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;head&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;title&gt;Calling DotNetZip from PHP through COM&lt;/title&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;link rel="stylesheet" href="basic.css"/&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;/head&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;body&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;h2&gt;Whoops!&lt;/h2&gt;' </span><span class="keyword">. </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;p&gt;The file was not successfully generated.&lt;/p&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;/body&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;/html&gt;'</span><span class="keyword">;<br />
&nbsp; } <br />
}<br />
catch (</span><span class="default">Exception $e</span><span class="keyword">) <br />
{<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;html&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;head&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;title&gt;Calling DotNetZip from PHP through COM&lt;/title&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;link rel="stylesheet" href="basic.css"/&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&nbsp; &lt;/head&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;body&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;h2&gt;Whoops!&lt;/h2&gt;' </span><span class="keyword">. </span><span class="string">"&lt;br/&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;p&gt;The file was not successfully generated.&lt;/p&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;p&gt;Caught exception: '</span><span class="keyword">,&nbsp; </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getMessage</span><span class="keyword">(), </span><span class="string">'&lt;/p&gt;'</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;pre&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$e</span><span class="keyword">-&gt;</span><span class="default">getTraceAsString</span><span class="keyword">(), </span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;/pre&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;/body&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'&lt;/html&gt;'</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88040""></a>
  <div class="note">
   <strong class="user">james dot m dot love at gmail dot com</strong>
   <a href="#88040" class="date">07-Jan-2009 03:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're using COM to create a DSN Less connection to an MS Access 2007 database, you'll find through Googling that you need to use an updated version of Jet, so the connection string I've found looks like this:
<br />

<br />
<span class="default">&lt;?php
<br />
$databaselocation </span><span class="keyword">= </span><span class="string">"C:\Path\to\db.accdb"</span><span class="keyword">;
<br />
</span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'ADODB.Connection'</span><span class="keyword">) or exit(</span><span class="string">'Cannot start ADO.'</span><span class="keyword">);
<br />
</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=</span><span class="default">$databaselocation</span><span class="string">"</span><span class="keyword">) or die(</span><span class="string">'Cannot start with Jet'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
However, on my setup (WinVista, Access 2007, PHP526) I found that it always 'dies' with "Cannot start with Jet", even if the connection was successful ($conn-&gt;State reads "1").
<br />

<br />
I figured to just drop the die() command on $conn-&gt;Open(). If something catastrophic happens with the ADO connection then it's own error handling engine passes stack traces, etc back to the console/standard output.
<br />

<br />
Therefore, my Open() command looks like this:
<br />

<br />
<span class="default">&lt;?php
<br />
$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=</span><span class="default">$databaselocation</span><span class="string">"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87848""></a>
  <div class="note">
   <strong class="user">casanoteva at yahoo dot com</strong>
   <a href="#87848" class="date">26-Dec-2008 01:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi, just wanna share to everyone after tried and tested many many times to create report in PDF format from Crystal Report.<br />
Finally I can do it without any error.<br />
&nbsp;Here is my system; PHP 5.1.6, MSSQL2005 and Crystal Report Server XI RL2<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//- Variables - for your RPT and PDF<br />
</span><span class="keyword">echo </span><span class="string">"Print Report Test"</span><span class="keyword">;<br />
</span><span class="default">$my_report </span><span class="keyword">= </span><span class="string">"D:\\Folder1\\SubFolder1\\Report.rpt"</span><span class="keyword">; </span><span class="comment">// <br />
</span><span class="default">rpt source file<br />
$my_pdf </span><span class="keyword">= </span><span class="string">"D:\\Folder1\\SubFolder1\\Report.pdf"</span><span class="keyword">; </span><span class="comment">// RPT export to pdf file<br />
//-Create new COM object-depends on your Crystal Report version<br />
</span><span class="default">$ObjectFactory</span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"CrystalReports115.ObjectFactory.1"</span><span class="keyword">) or die (</span><span class="string">"Error on load"</span><span class="keyword">); </span><span class="comment">// call COM port<br />
</span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">$ObjectFactory</span><span class="keyword">-&gt; </span><span class="default">CreateObject</span><span class="keyword">(</span><span class="string">"CrystalDesignRunTime.Application"</span><span class="keyword">); </span><span class="comment">// create an instance for Crystal<br />
</span><span class="default">$creport </span><span class="keyword">= </span><span class="default">$crapp</span><span class="keyword">-&gt;</span><span class="default">OpenReport</span><span class="keyword">(</span><span class="default">$my_report</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// call rpt report<br />
<br />
// to refresh data before<br />
<br />
//- Set database logon info - must have<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Database</span><span class="keyword">-&gt;</span><span class="default">Tables</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">SetLogOnInfo</span><span class="keyword">(</span><span class="string">"servername"</span><span class="keyword">, </span><span class="string">"DBname"</span><span class="keyword">, </span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"password"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//- field prompt or else report will hang - to get through<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">EnableParameterPrompting </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
</span><span class="comment">//- DiscardSavedData - to refresh then read records<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">DiscardSavedData</span><span class="keyword">;<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ReadRecords</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="comment">//export to PDF process<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DiskFileName</span><span class="keyword">=</span><span class="default">$my_pdf</span><span class="keyword">; </span><span class="comment">//export to pdf<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">PDFExportAllPages</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">;<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DestinationType</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">; </span><span class="comment">// export to file<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">FormatType</span><span class="keyword">=</span><span class="default">31</span><span class="keyword">; </span><span class="comment">// PDF type<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Export</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
<br />
</span><span class="comment">//------ Release the variables ------<br />
</span><span class="default">$creport </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$ObjectFactory </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
<br />
</span><span class="comment">//------ Embed the report in the webpage ------<br />
</span><span class="keyword">print </span><span class="string">"&lt;embed src=\"D:\\Folder1\\SubFolder1\\Report.pdf\" width=\"100%\" height=\"100%\"&gt;"<br />
<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;<br />
</span><br />
&nbsp;That's all for me, anyway in Crystal Report I have to check DisCardSavedData, Save data with report and AutoSave (1 min) in Option Tab and also in Report Options I have to check save dat with report, too.<br />
<br />
Hope this should be help to anybody<br />
<br />
Casanoteva</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85253""></a>
  <div class="note">
   <strong class="user">johnno1985 at gmail dot com</strong>
   <a href="#85253" class="date">21-Aug-2008 11:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I couldn't find an example anywhere on what I was trying to do.&nbsp; After taking bits from everyone I ended up with something that worked.<br />
<br />
Im using Crystal Reports 10, MS SQL Server 2005, Apache2, and PHP5.<br />
<br />
My report uses an SQL Store Procedure and passes some parameter to get the report data, so our PHP must set the database logon info and pass the parameters.<br />
<br />
Below is the solution I came up with:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">//------&nbsp; Variables ------<br />
</span><span class="default">$my_report </span><span class="keyword">= </span><span class="string">"C:\\Apache2\htdocs\\test\\MyReport.rpt"</span><span class="keyword">;&nbsp; </span><span class="comment">//This must be the full path to the file<br />
</span><span class="default">$my_pdf </span><span class="keyword">= </span><span class="string">"C:\\Apache2\htdocs\\test\\MyReport.pdf"</span><span class="keyword">;<br />
<br />
</span><span class="comment">//------ Create a new COM Object of Crytal Reports 10 ------<br />
</span><span class="default">$ObjectFactory</span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"CrystalReports10.ObjectFactory.1"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//------ Create a instance of library Application -------<br />
</span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">$ObjectFactory</span><span class="keyword">-&gt;</span><span class="default">CreateObject</span><span class="keyword">(</span><span class="string">"CrystalDesignRunTime.Application.10"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//------ Open your rpt file ------<br />
</span><span class="default">$creport </span><span class="keyword">= </span><span class="default">$crapp</span><span class="keyword">-&gt;</span><span class="default">OpenReport</span><span class="keyword">(</span><span class="default">$my_report</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="comment">//------ Set database logon info ------<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Database</span><span class="keyword">-&gt;</span><span class="default">Tables</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">SetLogOnInfo</span><span class="keyword">(</span><span class="string">"MYSERVER"</span><span class="keyword">, </span><span class="string">"Database"</span><span class="keyword">, </span><span class="string">"user"</span><span class="keyword">, </span><span class="string">"password"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//------ Suppress the Parameter field prompt or else report will hang ------<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">EnableParameterPrompting </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
</span><span class="comment">//------ DiscardSavedData make a Refresh in your data -------<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">DiscardSavedData</span><span class="keyword">;<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ReadRecords</span><span class="keyword">();<br />
<br />
</span><span class="comment">//------ Pass formula fields --------<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">FormulaFields</span><span class="keyword">-&gt;</span><span class="default">Item</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">Text </span><span class="keyword">= (</span><span class="string">"'My Report Title'"</span><span class="keyword">);<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ParameterFields</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)-&gt;</span><span class="default">AddCurrentValue </span><span class="keyword">(</span><span class="string">"FirstParameter"</span><span class="keyword">);<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ParameterFields</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">)-&gt;</span><span class="default">AddCurrentValue </span><span class="keyword">(</span><span class="default">2000</span><span class="keyword">);<br />
<br />
</span><span class="comment">//------ Export to PDF -------<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DiskFileName</span><span class="keyword">=</span><span class="default">$my_pdf</span><span class="keyword">;<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">FormatType</span><span class="keyword">=</span><span class="default">31</span><span class="keyword">;<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">ExportOptions</span><span class="keyword">-&gt;</span><span class="default">DestinationType</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
</span><span class="default">$creport</span><span class="keyword">-&gt;</span><span class="default">Export</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">);<br />
<br />
</span><span class="comment">//------ Release the variables ------<br />
</span><span class="default">$creport </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$crapp </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
</span><span class="default">$ObjectFactory </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
<br />
</span><span class="comment">//------ Embed the report in the webpage ------<br />
</span><span class="keyword">print </span><span class="string">"&lt;embed src=\"MyReport.pdf\" width=\"100%\" height=\"100%\"&gt;"<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Obviously there's plenty of room for refinement in there, but it works and should get you going on the right track.&nbsp; I also found that during testing, the script was hanging before supressing the parameter prompt. Once this had happened, some exports that had been working earlier stopped completely and wouldn't work again untill I restarted Apache.&nbsp; This might be something worth doing if you keep having issues after a script has hung.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83821""></a>
  <div class="note">
   <strong class="user">mastrboy.servebeer.com</strong>
   <a href="#83821" class="date">13-Jun-2008 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
quick wmi query example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $obj </span><span class="keyword">= new </span><span class="default">COM </span><span class="keyword">( </span><span class="string">'winmgmts://localhost/root/CIMV2' </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wmi_computersystem </span><span class="keyword">=&nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">ExecQuery</span><span class="keyword">(</span><span class="string">"Select * from Win32_ComputerSystem"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wmi_bios&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">=&nbsp; &nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">ExecQuery</span><span class="keyword">(</span><span class="string">"Select * from Win32_BIOS"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$wmi_computersystem </span><span class="keyword">as </span><span class="default">$wmi_call </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$model </span><span class="keyword">= </span><span class="default">$wmi_call</span><span class="keyword">-&gt;</span><span class="default">Model</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$wmi_bios </span><span class="keyword">as </span><span class="default">$wmi_call </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$serial </span><span class="keyword">= </span><span class="default">$wmi_call</span><span class="keyword">-&gt;</span><span class="default">SerialNumber</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bios_version </span><span class="keyword">= </span><span class="default">$wmi_call</span><span class="keyword">-&gt;</span><span class="default">SMBIOSBIOSVersion</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Bios version&nbsp;&nbsp; : </span><span class="default">$bios_version</span><span class="string">\n"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Serial number&nbsp; : </span><span class="default">$serial</span><span class="string">\n"</span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"Hardware Model : </span><span class="default">$model</span><span class="string">\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83698""></a>
  <div class="note">
   <strong class="user">mbirth at webwriters dot de</strong>
   <a href="#83698" class="date">08-Jun-2008 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using the DynamicWrapper from <a href="http://freenet-homepage.de/gborn/WSHBazaar/WSHDynaCall.htm and after registering it via " rel="nofollow" target="_blank">http://freenet-homepage.de/gborn/WSHBazaar/WSHDynaCall.htm and after registering it via </a>"regsvr32 dynwrap.dll", you can easily set output colors to make colorful CLI scripts even on Windows.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$dw </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'DynamicWrapper'</span><span class="keyword">);&nbsp; </span><span class="comment">// needs dynwrap.dll (regsvr32 dynwrap.dll)<br />
<br />
// register needed features<br />
</span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">Register</span><span class="keyword">(</span><span class="string">'kernel32.dll'</span><span class="keyword">, </span><span class="string">'GetStdHandle'</span><span class="keyword">, </span><span class="string">'i=h'</span><span class="keyword">, </span><span class="string">'f=s'</span><span class="keyword">, </span><span class="string">'r=l'</span><span class="keyword">);<br />
</span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">Register</span><span class="keyword">(</span><span class="string">'kernel32.dll'</span><span class="keyword">, </span><span class="string">'SetConsoleTextAttribute'</span><span class="keyword">, </span><span class="string">'i=hl'</span><span class="keyword">, </span><span class="string">'f=s'</span><span class="keyword">, </span><span class="string">'r=t'</span><span class="keyword">);<br />
</span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">Register</span><span class="keyword">(</span><span class="string">'kernel32.dll'</span><span class="keyword">, </span><span class="string">'SetConsoleTitle'</span><span class="keyword">, </span><span class="string">'i=s'</span><span class="keyword">, </span><span class="string">'f=s'</span><span class="keyword">, </span><span class="string">'r=l'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// get console handle<br />
</span><span class="default">$ch </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">GetStdHandle</span><span class="keyword">(-</span><span class="default">11</span><span class="keyword">);&nbsp; </span><span class="comment">// -11 = STD_OUTPUT_HANDLE<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
After these initialization steps, you can set the console output color using:<br />
<br />
<span class="default">&lt;?php<br />
$dw</span><span class="keyword">-&gt;</span><span class="default">SetConsoleTextAttribute</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">14</span><span class="keyword">);<br />
echo </span><span class="string">'This is yellow text!'</span><span class="keyword">;<br />
</span><span class="default">$dw</span><span class="keyword">-&gt;</span><span class="default">SetConsoleTextAttribute</span><span class="keyword">(</span><span class="default">$ch</span><span class="keyword">, </span><span class="default">7</span><span class="keyword">);<br />
echo </span><span class="string">'Back to normal gray!'</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Using SetConsoleTitle you can even set the title displayed in the console window.<br />
<br />
Color values are 0..7 for dark colors and 8..15 for light colors. Sequence is (black/silver, blue, green, cyan, red, magenta, yellow/brown, white/gray). I also found that if you add 16384 to the value, it should be inverse. 32768 added should get underlined text. But these latter two didn't work for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81548""></a>
  <div class="note">
   <strong class="user">amenthes at NOSPAM dot gmail dot com</strong>
   <a href="#81548" class="date">03-Mar-2008 10:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you ever want to save an Excel(.xls) file into the Office Excel 2003 XML format, just use<br />
<br />
$excel-&gt;Workbooks[1]-&gt;SaveAs('new_file_name.xml', 46);<br />
<br />
That's the number you need, 46.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75914""></a>
  <div class="note">
   <strong class="user">halfer</strong>
   <a href="#75914" class="date">21-Jun-2007 05:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks to paul at completewebservices who added a note earlier; I have used his code to solve a particularly difficult issue with the Crystal 9 runtime component. For some reason, VBA/VBS can pass a native Date type as a parameter to a Crystal Report requiring a date, but in PHP I've tried all manner of strings, unix timestamps, COM variant dates etc and all of these resulted in a com_exception.<br />
<br />
My solution was to employ VBScript to borrow the CDate function, which works correctly. Not the most elegant of solutions, but this parameterised approach is to be preferred to search-n-replacing the RecordSelectionFormula string. Of course if anyone here has an even better approach, do post it here - I am sure it would be of use.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// $rptParam is a report parameter object having a type of date<br />
</span><span class="default">$oScript </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MSScriptControl.ScriptControl"</span><span class="keyword">);<br />
</span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Language </span><span class="keyword">= </span><span class="string">"VBScript"</span><span class="keyword">;<br />
</span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AllowUI </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
</span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AddObject</span><span class="keyword">(</span><span class="string">'rptParam'</span><span class="keyword">, </span><span class="default">$rptParam</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AddCode</span><span class="keyword">(</span><span class="string">'Function SetDateParameter(strDate)<br />
rptParam.AddCurrentValue(CDate(strDate))<br />
End Function'</span><span class="keyword">);<br />
</span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Run</span><span class="keyword">(</span><span class="string">"SetDateParameter"</span><span class="keyword">, </span><span class="string">"25 April 2006"</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66424""></a>
  <div class="note">
   <strong class="user">hwcshirley at gmail dot com</strong>
   <a href="#66424" class="date">21-May-2006 10:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Reply to: djogopatrao at gmail dot com<br />
I have change little bit your code. Its work.<br />
<br />
$COM_Object = "CrystalDesignRunTime.Application";<br />
$my_report = "C:\\appserv\\www\\mc\\test.rpt";<br />
$my_pdf = "C:\\appserv\www\\mc\\test.pdf";<br />
<br />
$crapp= New COM($COM_Object) or die("Unable to Create Object");<br />
$creport = $crapp-&gt;OpenReport($my_report, 1);<br />
$creport-&gt;ReadRecords(); // attention!<br />
<br />
$creport-&gt;ExportOptions-&gt;DiskFileName=$my_pdf;<br />
$creport-&gt;ExportOptions-&gt;PDFExportAllPages=true;<br />
$creport-&gt;ExportOptions-&gt;DestinationType=1; // Export to File<br />
$creport-&gt;ExportOptions-&gt;FormatType=31; // Type: PDF<br />
$creport-&gt;Export(false);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64022""></a>
  <div class="note">
   <strong class="user">djogopatrao at gmail dot com</strong>
   <a href="#64022" class="date">05-Apr-2006 12:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My previous notes about Crystal Reports have vanished away, but anyway I was up to correct them.<br />
<br />
The code above connects to COM (beware of the version number! search on the Registry Editor for the correct name to put in $COM_Object), opens a report from a file ($my_report), reload records from database and then exports it to a PDF file ($my_pdf).<br />
<br />
* IMPORTANT * this code, when invoked from the browser (I'm using Apache) AND with a report that connects to a ODBC database, does not work (the problem is specificly the line ReadRecords(), but may arise without it too when data is not saved into the report file).<br />
<br />
But when you run this code by PHP-CLI (that is, by the command line), it works ok! I bug-reported this, but have no answer till now ( give it a vote, if you thing it's important: <a href="http://bugs.php.net/bug.php?id=36959 " rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=36959 </a>).<br />
<br />
Also, exceptions may arise, so put it on a try_catch block.<br />
<br />
--------------------------<br />
<br />
// by dfcp '06 (djogopatrao@gmail.com)<br />
<br />
$COM_Object = "CrystalReports11.ObjectFactory.1";<br />
$my_report = "C:\\report.rpt";<br />
$my_pdf = "C:\\report.pdf";<br />
<br />
$ObjectFactory= New COM($COM_Object);<br />
$crapp = $ObjectFactory-&gt;CreateObject("CrystalDesignRunTime.Application");<br />
$creport = $crapp-&gt;OpenReport($my_report, 1);<br />
$creport-&gt;ReadRecords(); // attention!<br />
<br />
$creport-&gt;ExportOptions-&gt;DiskFileName=$my_pdf;<br />
$creport-&gt;ExportOptions-&gt;PDFExportAllPages=true;<br />
$creport-&gt;ExportOptions-&gt;DestinationType=1; // Export to File<br />
$creport-&gt;ExportOptions-&gt;FormatType=31; // Type: PDF<br />
$creport-&gt;Export(false);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62599""></a>
  <div class="note">
   <strong class="user">djogopatrao at gmail dot com</strong>
   <a href="#62599" class="date">04-Mar-2006 07:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found somewhere (<a href="http://www.recrystallize.com/merchant/supportfaq/supportfaq0003.htm" rel="nofollow" target="_blank">http://www.recrystallize.com/merchant/supportfaq/supportfaq0003.htm</a>) a list relating each version of Crystal Reports to its respective progID - it may help some fellows out there.<br />
<br />
7&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Crystal.CRPE.Application<br />
<br />
8.0&nbsp; &nbsp; &nbsp; &nbsp; CrystalRuntime.Application or CrystalRuntime.Application.8<br />
<br />
8.5&nbsp; &nbsp; &nbsp; &nbsp; CrystalRuntime.Application or CrystalRuntime.Application.8.5<br />
<br />
9 (RDC)&nbsp; &nbsp; CrystalRuntime.Application.9<br />
9 (RAS)&nbsp; &nbsp; CrystalReports.ObjectFactory.2<br />
10 (RDC)&nbsp;&nbsp; CrystalRuntime.Application.11<br />
10 (CEE)&nbsp;&nbsp; CrystalReports10.ObjectFactory.1<br />
<br />
&nbsp;<br />
XI (RDC)&nbsp;&nbsp; CrystalRuntime.Application.11<br />
XI (RAS)&nbsp;&nbsp; CrystalReports11.ObjectFactory.1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61232""></a>
  <div class="note">
   <strong class="user">paul at completewebservices dot com dot au</strong>
   <a href="#61232" class="date">28-Jan-2006 03:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It seems that PHP does not support setting of properties with arguments.&nbsp; This is how I got around the problem:<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Object with method I want to set<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $auth = new COM("AUTHXOCX.AuthXOCXCtrl.1");<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // ScriptControl <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $oScript = new COM("MSScriptControl.ScriptControl");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $oScript-&gt;Language = "VBScript";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $oScript-&gt;AllowUI = TRUE;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Add out object to the control<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $oScript-&gt;AddObject('auth', $auth, true);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Create a VBScript function that allow me to set them<br />
&nbsp;&nbsp; &nbsp; &nbsp; $oScript-&gt;AddCode(<br />
'Function fixAccess(accessname)<br />
&nbsp;&nbsp;&nbsp; auth.AuthDataReferrerEnabled(accessname) = 1<br />
&nbsp;&nbsp;&nbsp; auth.AuthDataAuthentiXDBEnabled(accessname) = 0<br />
End Function');<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Execute function<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $oScript-&gt;Run("fixAccess", $dir);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57552""></a>
  <div class="note">
   <strong class="user">volker at kybs dot de</strong>
   <a href="#57552" class="date">07-Oct-2005 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To use the windows speech system install the "Speech SDK 5.1 for Windows? applications" from the Microsoft homepage (free download).<br />
Then you can do Text2Speech like this:<br />
<br />
$voice = new COM("SAPI.SpVoice");<br />
$voice-&gt;Speak("Hello, lets have a conversation");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57516""></a>
  <div class="note">
   <strong class="user">sadi at unicornsoftbd dot com</strong>
   <a href="#57516" class="date">06-Oct-2005 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your PHP is configured as ISAPI module then the COM object you create in ur php page will use the same memory space as the web server. If your COM object takes too much memory then this may force some COM error as PHP does not handle the memory usage of COM itself. And also Web server doesnt know what do to free COM memory. But if you use PHP as CGI then PHP itself handle the memory usage of COM. Once in a script where i used COM and PHP as ISAPI module i got unknown COM error.But when i used PHP as CGI there was no error. So those who want to use COM object in your application please be careful about it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56801""></a>
  <div class="note">
   <strong class="user">deletethis@bjoern(at)syltonline(doot)de</strong>
   <a href="#56801" class="date">15-Sep-2005 07:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you can get the old "TaskScheduler.dll" and register it, it is quite simple to handle and start Windows tasks from PHP.<br />
This is extremely useful when you got things to do which must be run in a different user context. Prepare a task with the user and use PHP &amp; Com to build a webinterface for it.<br />
<br />
Here is an example how to start a Windows task:<br />
<br />
&nbsp; function start_task ($taskname) {<br />
&nbsp;&nbsp;&nbsp; $SchedObj = new COM("Scheduler.SchedulingAgent.1");<br />
&nbsp;&nbsp;&nbsp; foreach ($SchedObj-&gt;Tasks as $task) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (strtolower( (string) $task) == strtolower( $taskname.".job" )) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $task-&gt;Run();<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
<br />
I'm also working on a class to handle infos, adding and removing of tasks via PHP. If you are interested drop me a line.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50587""></a>
  <div class="note">
   <strong class="user">csaba at alum dot mit dot edu</strong>
   <a href="#50587" class="date">03-Mar-2005 05:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Getting IE to the foreground<br />
If you are using a command line (CLI) version of PHP on a Win32 platform (e.g. XP Pro, SP2), you might want to have output directed to IE (perhaps you'll want to work with the output there) when Popup does not suffice (see my earlier post, below).<br />
<br />
It's easy enough to get an instance of IE using $ie = new COM("InternetExplorer.Application");.&nbsp; The problem is, you don't necessarily see it in the foreground (especially if you already have one open) and who wants to waste keystrokes getting to it?&nbsp; The code below has been working for me (If you want to do other adjustments (e.g. $ie-&gt;Document-&gt;ParentWindow-&gt;resizeTo(800,500); or $ie-&gt;Document-&gt;Body-&gt;bgColor = "yellow";), doing them before the $ie-&gt;Visible = true; line will avoid screen distractions):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">newIEtoForeground</span><span class="keyword">(</span><span class="default">$title</span><span class="keyword">, </span><span class="default">$evtPrefix</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// brings new instance of IE to foreground with title $title<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">$extPrefix</span><span class="keyword">) </span><span class="default">$ie </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"InternetExplorer.Application"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; else </span><span class="default">$ie </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"InternetExplorer.Application"</span><span class="keyword">, </span><span class="default">$evtPrefix</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Navigate2</span><span class="keyword">(</span><span class="string">"about:blank"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$oWSH </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">ReadyState</span><span class="keyword">!=</span><span class="default">4</span><span class="keyword">) </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">10000</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Document</span><span class="keyword">-&gt;</span><span class="default">Title </span><span class="keyword">= (</span><span class="default">$tmpTitle </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">());&nbsp; </span><span class="comment">//unique title<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while (!</span><span class="default">$oWSH</span><span class="keyword">-&gt;</span><span class="default">AppActivate</span><span class="keyword">(</span><span class="string">"</span><span class="default">$tmpTitle</span><span class="string"> - M"</span><span class="keyword">)) </span><span class="default">usleep</span><span class="keyword">(</span><span class="default">10000</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Document</span><span class="keyword">-&gt;</span><span class="default">Title </span><span class="keyword">= </span><span class="default">$title</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ie</span><span class="keyword">-&gt;</span><span class="default">Document</span><span class="keyword">-&gt;</span><span class="default">ParentWindow</span><span class="keyword">-&gt;</span><span class="default">opener</span><span class="keyword">=</span><span class="string">"me"</span><span class="keyword">;&nbsp; </span><span class="comment">// allows self.close()<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$ie</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Csaba Gabor from Vienna</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49988""></a>
  <div class="note">
   <strong class="user">csaba at alum dot mit dot edu</strong>
   <a href="#49988" class="date">14-Feb-2005 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Basic Windows IO<br />
If you are using a command line (CLI) version of PHP on a Win32 platform, you might like to have a simple graphical interface to get input and output.&nbsp; The following gives an illustration for both.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// first we get some input<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$oScript </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"MSScriptControl.ScriptControl"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Language </span><span class="keyword">= </span><span class="string">"VBScript"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$title </span><span class="keyword">= </span><span class="string">"I/O Demo: Input half"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$initial </span><span class="keyword">= </span><span class="string">"Change this value"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$prompt </span><span class="keyword">= </span><span class="string">"Please enter a value"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$code </span><span class="keyword">= &lt;&lt;&lt;EOF<br />
</span><span class="string">Function getInput()<br />
&nbsp;&nbsp;&nbsp; inVal = InputBox("</span><span class="default">$prompt</span><span class="string">", "</span><span class="default">$title</span><span class="string">", "</span><span class="default">$initial</span><span class="string">")<br />
&nbsp;&nbsp;&nbsp; getInput = inVal&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'how return values are assigned in VB<br />
End Function<br />
</span><span class="keyword">EOF;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">AddCode</span><span class="keyword">(</span><span class="default">$code</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$input </span><span class="keyword">= </span><span class="default">$oScript</span><span class="keyword">-&gt;</span><span class="default">Eval</span><span class="keyword">(</span><span class="string">"getInput()"</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">)==</span><span class="string">"NULL"</span><span class="keyword">) </span><span class="default">$input </span><span class="keyword">= </span><span class="string">"Input box was cancelled"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// now we show some output<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$oWSH </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"WScript.Shell"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$title </span><span class="keyword">= </span><span class="string">"I/O Demo: Output half"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$timeout </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// 0 for no timeout<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$style </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">+ </span><span class="default">48</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">// buttons to show + alert symbol<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$oWSH</span><span class="keyword">-&gt;</span><span class="default">Popup</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$timeout</span><span class="keyword">, </span><span class="default">$title</span><span class="keyword">, </span><span class="default">$style</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This is example is overblown for illustrative purposes.&nbsp; The whole input part collapses if the amount of code used is a single statement.&nbsp; So, this would have sufficed:<br />
$code = "InputBox(\"$prompt\", \"$title\", \"$initial\")";<br />
$input = $oScript-&gt;Eval($code);<br />
<br />
This technique exposes quite a bit of scripting power tied into the Windows operating system and VBScript.&nbsp; However, you should have a really specific reason for using it since VBScript tends to be dog slow when compared to PHP in my tests.&nbsp; Simple IO like this is good, however, and the popup size can be quite large.&nbsp; Furthermore, this could be a viable route to go for accessing WinAPI's.<br />
<br />
<a href="http://www.ss64.com/wsh/popup.html shows some documentation for $oWSH-&gt;Popup" rel="nofollow" target="_blank">http://www.ss64.com/wsh/popup.html shows some documentation for $oWSH-&gt;Popup</a><br />
<br />
Csaba Gabor from Vienna</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47347""></a>
  <div class="note">
   <strong class="user">phpguy _from_ toshpro _dot_ com</strong>
   <a href="#47347" class="date">12-Nov-2004 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you ever need to connect to an access database (on the server, using the IIS or APACHE user account), here is code below that can help to ease the process.&nbsp; It is written like this because we have a MySQL as well as an Access database and need to be able to switch back and forth.&nbsp; The runQuery function will return a 2 dimensional array and can use column names or numbers for the index of the internal arrays.&nbsp; External arrays are always integer-indexed.&nbsp; We also have found issues with Access staying open and growing from 7MB to 2.5GB within two hours, so we open and close it each time we run a query.&nbsp; If it is not a select query it will return TRUE.&nbsp; if it fails with errors, it will return false.<br />
<br />
There is a showErr flag that we mostly only use for MySQL, since you can output MySQL errors without PHP errors.&nbsp; Access doesn't appear to be that friendly.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">runQuery</span><span class="keyword">(&amp;</span><span class="default">$conn</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$strSQL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$associative</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$debug</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$showSQL</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$showErr</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">runMSQuery</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">,</span><span class="default">$strSQL</span><span class="keyword">,</span><span class="default">$associative</span><span class="keyword">,</span><span class="default">$debug</span><span class="keyword">,</span><span class="default">$showSQL</span><span class="keyword">,</span><span class="default">$showErr</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//return runMyQuery($conn,$strSQL,$associative,$debug,$showSQL,$showErr); <br />
</span><span class="keyword">}<br />
<br />
function </span><span class="default">openMSDB</span><span class="keyword">(</span><span class="default">$dbfile</span><span class="keyword">=</span><span class="string">"c:/path/and/filename.mdb"</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (!@</span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">)) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; exit(</span><span class="string">"Unable to create an ADODB connection&lt;br&gt;"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$strConn </span><span class="keyword">= </span><span class="string">"DRIVER={Microsoft Access Driver (*.mdb)}; DBQ="</span><span class="keyword">.</span><span class="default">$dbfile</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="default">$strConn</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">State </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$conn</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">closeMSDB</span><span class="keyword">(&amp;</span><span class="default">$conn</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$conn </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">runMSQuery</span><span class="keyword">(&amp;</span><span class="default">$conn</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$strSQL</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$associative</span><span class="keyword">=</span><span class="default">true</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$debug</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$showSQL</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$showErr</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">)) if(!</span><span class="default">$conn</span><span class="keyword">=</span><span class="default">openMSDB</span><span class="keyword">()) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$showSQL </span><span class="keyword">|| </span><span class="default">$debug </span><span class="keyword">) echo </span><span class="default">$strSQL</span><span class="keyword">.</span><span class="string">"\n&lt;br&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rtn </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$debug</span><span class="keyword">) </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$strSQL</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; else </span><span class="default">$rs </span><span class="keyword">= @</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$strSQL</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$rs</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$showErr</span><span class="keyword">) echo </span><span class="string">"Error running SQL.&lt;br&gt;\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closeMSDB</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">State </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">closeMSDB</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rows</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(!</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rsf </span><span class="keyword">= </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$associative</span><span class="keyword">) </span><span class="default">$rtn</span><span class="keyword">[</span><span class="default">$rows</span><span class="keyword">][</span><span class="default">$rsf</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">] = </span><span class="default">$rsf</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$rtn</span><span class="keyword">[</span><span class="default">$rows</span><span class="keyword">][</span><span class="default">$i</span><span class="keyword">] = </span><span class="default">$rsf</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rows</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">State </span><span class="keyword">!= </span><span class="default">0</span><span class="keyword">) </span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rs </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$debug</span><span class="keyword">) </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$rtn</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">closeMSDB</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$rtn</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47006""></a>
  <div class="note">
   <strong class="user">sodeh at dana dot ir</strong>
   <a href="#47006" class="date">30-Oct-2004 03:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
for connection to sql server and know the utf-8 code<br />
use this method to connect the database<br />
<br />
$db = new COM("ADODB.Connection",NULL, 65001 );</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37972""></a>
  <div class="note">
   <strong class="user">jon at jonroig dot com</strong>
   <a href="#37972" class="date">03-Dec-2003 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple example of printing formatted templates with MS Word.
<br />

<br />
To begin with, I've already built my invoice in Word and saved it as an RTF file.
<br />
In this case, I'm using "sampleInvoice.php" 
<br />

<br />
Fields that will be replaced have been marked as ||CUSTOMER ID|| and so on. 
<br />

<br />
<span class="default">&lt;?php
<br />
$dataText </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// open the file
<br />
</span><span class="keyword">if(!(</span><span class="default">$fp</span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="string">"C:\wordTest\sampleInvoice.rtf"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">))) die (</span><span class="string">"Can't open"</span><span class="keyword">);
<br />
</span><span class="default">$dataText </span><span class="keyword">= </span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">2000000</span><span class="keyword">);
<br />
</span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// replace the template fields
<br />
</span><span class="default">$dataText </span><span class="keyword">= </span><span class="default">str_replace </span><span class="keyword">(</span><span class="string">"||CUSTOMER ID||"</span><span class="keyword">,</span><span class="default">$customerIDValue</span><span class="keyword">, </span><span class="default">$dataText</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// save the file as an rtf
<br />
</span><span class="default">$timeStamp </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();
<br />
</span><span class="default">$saveFile </span><span class="keyword">= </span><span class="string">"C:/wordTemp/"</span><span class="keyword">.</span><span class="default">$timeStamp</span><span class="keyword">.</span><span class="string">"-invoice-"</span><span class="keyword">.</span><span class="default">$customerIDValue</span><span class="keyword">.</span><span class="string">".rtf"</span><span class="keyword">;
<br />
if(!(</span><span class="default">$fq</span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="default">$saveFile</span><span class="keyword">, </span><span class="string">"w+"</span><span class="keyword">))) die (</span><span class="string">"Can't open"</span><span class="keyword">);
<br />
</span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$fq</span><span class="keyword">, </span><span class="default">$dataText</span><span class="keyword">);
<br />
</span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$fq</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// initialize the word components
<br />
</span><span class="default">$word </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instantiate Word"</span><span class="keyword">); 
<br />

<br />
print </span><span class="string">"Loaded word version (</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="string">)\n"</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">visible </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">();
<br />

<br />
</span><span class="comment">// open the file
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"</span><span class="default">$saveFile</span><span class="string">"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// output the file to the default printer
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">PrintOut</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);
<br />

<br />
</span><span class="comment">// shutdown word
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37525""></a>
  <div class="note">
   <strong class="user">drich at nea-online dot net</strong>
   <a href="#37525" class="date">18-Nov-2003 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Changing Fields (Not FORMFIELDS) In MS Word....
<br />

<br />
Searched most of the afternoon for this, as it is something needed here for our projects.&nbsp; Maybe this can help someone else as well.
<br />

<br />
<span class="default">&lt;?php
<br />
$input </span><span class="keyword">= </span><span class="string">"x:\\path\\to\\test.doc"</span><span class="keyword">;
<br />
</span><span class="default">$word </span><span class="keyword">= @new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"word.application"</span><span class="keyword">) or die(</span><span class="string">"Unable to instantiate Word"</span><span class="keyword">); 
<br />
print </span><span class="string">"Loaded Word, version </span><span class="keyword">{</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Version</span><span class="keyword">}</span><span class="string">\n&lt;br&gt;"</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Visible </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;
<br />
print </span><span class="string">"Set Word To Visible&lt;br&gt;"</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Documents</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">);
<br />
print </span><span class="string">"Opened </span><span class="default">$input</span><span class="string">&lt;br&gt;"</span><span class="keyword">;
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Activate</span><span class="keyword">;
<br />
print </span><span class="string">"Activated Word&lt;br&gt;"</span><span class="keyword">;
<br />

<br />
print </span><span class="string">"Editing Fields&lt;br&gt;"</span><span class="keyword">;
<br />
</span><span class="default">$Field </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">ActiveDocument</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">);
<br />
</span><span class="default">$fieldData </span><span class="keyword">= </span><span class="default">$Field</span><span class="keyword">-&gt;</span><span class="default">Result</span><span class="keyword">;
<br />
</span><span class="default">$fieldData</span><span class="keyword">-&gt;</span><span class="default">Text </span><span class="keyword">= </span><span class="string">"Testing"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// Print the document.
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Printout</span><span class="keyword">();
<br />

<br />
</span><span class="comment">// closing word
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br />

<br />
</span><span class="comment">// free the object
<br />
</span><span class="default">$word</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
</span><span class="default">$word </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="35960""></a>
  <div class="note">
   <strong class="user">admin at CdnDomainRegistry dot ca</strong>
   <a href="#35960" class="date">20-Sep-2003 03:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's an example/comparison of VBScript vs PHP's COM component to connect to an IIS Webserver.
<br />
The examples backup the IIS MetaBase (your server's website(s) configuration) in IIS.
<br />

<br />
VBScript:
<br />
&nbsp; Dim obj, iFlags 
<br />
&nbsp; Set obj = GetObject("IIS://LocalHost") 
<br />
&nbsp; ' Backup to next available version number. 
<br />
&nbsp; ' Set flags to save the metabase first and 
<br />
&nbsp; ' force the backup even if save fails. 
<br />
&nbsp; iFlags = (MD_BACKUP_SAVE_FIRST or MD_BACKUP_FORCE_BACKUP)
<br />
&nbsp; obj.Backup "MyBackups", MD_BACKUP_NEXT_VERSION, iFlags
<br />
&nbsp; ' Note: The above was copied from Microbucks.
<br />
&nbsp; ' This is how you would have to do it.
<br />
&nbsp; ' i.e. use the actual constant's value.
<br />
&nbsp; iFlags = (2 or 4)&nbsp; 
<br />
&nbsp; obj.Backup "MyBackups", &amp;HFFFFFFFF, iFlags
<br />

<br />
PHP:
<br />
&nbsp; <span class="default">&lt;?php
<br />
&nbsp; $obj </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"IIS://LocalHost"</span><span class="keyword">)or die(</span><span class="string">"Unable to instantiate IIS"</span><span class="keyword">);&nbsp; 
<br />
&nbsp; </span><span class="default">$err </span><span class="keyword">= </span><span class="default">com_invoke </span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">, </span><span class="string">"Backup"</span><span class="keyword">, </span><span class="string">"MyBackups"</span><span class="keyword">, </span><span class="string">"&amp;HFFFFFFFF"</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">|</span><span class="default">4 </span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$obj </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
&nbsp; print </span><span class="string">"err="</span><span class="keyword">.</span><span class="default">$err</span><span class="keyword">; </span><span class="comment">// returns 0 on success
<br />
&nbsp; </span><span class="default">?&gt;
<br />
</span>
<br />
Glen</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33864""></a>
  <div class="note">
   <strong class="user">rickardsjoquist at hotmail dot com</strong>
   <a href="#33864" class="date">09-Jul-2003 10:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use a DSN-less connection to a database (access for example) and return the results of a query as a multidimensional array with the fieldnames as identifier try this. Hope it helps someone :-)
<br />
--------------------------------------------------------
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">db</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">"ADODB.Connection"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=' </span><span class="keyword">. </span><span class="default">realpath</span><span class="keyword">(</span><span class="string">"relative_path/db.mdb"</span><span class="keyword">));
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">execute</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$num_fields </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; while (!</span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$num_fields</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">(</span><span class="default">$j</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r_items</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">] = </span><span class="default">$key</span><span class="keyword">-&gt;</span><span class="default">value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">(); 
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$r </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$r_items</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
--------------------------------------------------------
<br />
use it like this:
<br />
--------------------------------------------------------
<br />
<span class="default">&lt;?php
<br />
$results </span><span class="keyword">= </span><span class="default">db</span><span class="keyword">(</span><span class="string">"SELECT field_a, field_b FROM table"</span><span class="keyword">);
<br />
foreach(</span><span class="default">$result </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$item</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'field_a'</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">$item</span><span class="keyword">[</span><span class="string">'field_b'</span><span class="keyword">];
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>--------------------------------------------------------
<br />
You can also use: print_r($result); if you want the structure of the array to be printed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33090""></a>
  <div class="note">
   <strong class="user">info at sharedprojects dot nl</strong>
   <a href="#33090" class="date">16-Jun-2003 09:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment">// An other way to connect
<br />
// this connect to a ODBC-datasourced added in the 
<br />
// ODBC Data Source Administrator under System DSN
<br />

<br />
</span><span class="default">$odbcname </span><span class="keyword">= </span><span class="string">"northwind"</span><span class="keyword">;
<br />
</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"DSN=</span><span class="default">$odbcname</span><span class="string">"</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27024""></a>
  <div class="note">
   <strong class="user">eguan1ao_at_yahoo_dot_com</strong>
   <a href="#27024" class="date">20-Nov-2002 01:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
An example of connecting to a Microsoft Access database, executing an SQL query, and displaying the results in HTML.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$db </span><span class="keyword">= </span><span class="string">'C:\\Program Files\\Microsoft Office\\Office\\Samples\\Northwind.mdb'</span><span class="keyword">;<br />
<br />
</span><span class="default">$conn </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'ADODB.Connection'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Two ways to connect. Choose one.<br />
</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Open</span><span class="keyword">(</span><span class="string">"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=</span><span class="default">$db</span><span class="string">"</span><span class="keyword">);<br />
</span><span class="comment">//$conn-&gt;Open("DRIVER={Microsoft Access Driver (*.mdb)}; DBQ=$db");<br />
<br />
</span><span class="default">$sql </span><span class="keyword">= </span><span class="string">'SELECT&nbsp;&nbsp; ProductName, QuantityPerUnit, UnitPrice<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; FROM&nbsp; &nbsp;&nbsp; Products<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ORDER BY ProductName'</span><span class="keyword">;<br />
</span><span class="default">$rs </span><span class="keyword">= </span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Execute</span><span class="keyword">(</span><span class="default">$sql</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
&lt;table&gt;<br />
&lt;tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;th&gt;Product Name&lt;/th&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &lt;th&gt;Quantity Per Unit&lt;/th&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &lt;th&gt;Unit Price&lt;/th&gt;<br />
&lt;/tr&gt;<br />
<span class="default">&lt;?php </span><span class="keyword">while (!</span><span class="default">$rs</span><span class="keyword">-&gt;</span><span class="default">EOF</span><span class="keyword">): </span><span class="default">?&gt;<br />
</span>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;<span class="default">&lt;?= $rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'ProductName'</span><span class="keyword">]-&gt;</span><span class="default">Value ?&gt;</span>&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;td&gt;<span class="default">&lt;?= $rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'QuantityPerUnit'</span><span class="keyword">]-&gt;</span><span class="default">Value ?&gt;</span>&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;td&gt;<span class="default">&lt;?= $rs</span><span class="keyword">-&gt;</span><span class="default">Fields</span><span class="keyword">[</span><span class="string">'UnitPrice'</span><span class="keyword">]-&gt;</span><span class="default">Value ?&gt;</span>&lt;/td&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &lt;/tr&gt;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <span class="default">&lt;?php $rs</span><span class="keyword">-&gt;</span><span class="default">MoveNext</span><span class="keyword">() </span><span class="default">?&gt;<br />
&lt;?php </span><span class="keyword">endwhile </span><span class="default">?&gt;<br />
</span>&lt;/table&gt;<br />
<br />
<span class="default">&lt;?php<br />
<br />
$rs</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
</span><span class="default">$conn</span><span class="keyword">-&gt;</span><span class="default">Close</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20526""></a>
  <div class="note">
   <strong class="user">yinon at xacct dot com</strong>
   <a href="#20526" class="date">06-Apr-2002 12:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to get the Word exaple running, do the following on the server side.<br />
Worked for me...<br />
1. Click START--&gt;RUN and enter "dcomcnfg"<br />
2. In the "Applications" tab, go down to "Microsoft Word Document"<br />
3. Click PROPERTIES button<br />
4. Go to the "Security" Tab<br />
5. Click "Use custom access permissions", and then click EDIT<br />
6. Click ADD and then click SHOW USERS<br />
7. Highlight the IIS anonymous user account (usually IUSR_&lt;machinename&gt;), click ADD<br />
8. Go back to the "Security" tab by hitting OK <br />
9. Click "Use custom launch permissions", and the click EDIT<br />
10. Click ADD and then click SHOW USERS<br />
11. Highlight the IIS anonymous user account (usually IUSR_&lt;machinename&gt;), click ADD<br />
12. Hit OK, and then hit APPLY. <br />
<br />
Also, you should look at the "Identity" tab in the Microsoft Word Document PROPERTIES and see that it is set to "Interactive User" <br />
&nbsp; <br />
<br />
ALSO, log into the machine AS the IUSR_&lt;machinename&gt; account, start word, and make sure to click through the dialog boxes that Word shows the first time it is run for a certain user.&nbsp; In other words, make sure Word opens cleanly for the IUSR_ user. <br />
<br />
More useful information could be found here:<br />
<a href="http://www.email-screen.com/support-doc2txt.html" rel="nofollow" target="_blank">http://www.email-screen.com/support-doc2txt.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="18460""></a>
  <div class="note">
   <strong class="user">mstaiger at informatik dot uni-siegen dot de</strong>
   <a href="#18460" class="date">23-Jan-2002 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The example above (MS Word) is quiet unsatisfying, as I find. Especially since I couldn't find anybody who actually got it running, including myself. 
<br />

<br />
You might therefore give this Powerpoint-example a chance:
<br />
----------------------------------
<br />
#Instantiate a PowerPoint object.
<br />
$ppoint = new COM("PowerPoint.application") or die("Unable to instantiate PowerPoint");
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">#Create a new presentation
<br />
</span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">() or die (</span><span class="string">"Could not create presentation"</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//Add a slide
<br />
</span><span class="default">$slide</span><span class="keyword">=</span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Slides</span><span class="keyword">-&gt;</span><span class="default">Add</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//Get the name of this slide
<br />
</span><span class="default">$slidename </span><span class="keyword">= </span><span class="default">$slide</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">();
<br />
echo</span><span class="string">"&lt;br&gt;slidename : </span><span class="default">$slidename</span><span class="string">"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//Change the name of this new slide
<br />
</span><span class="default">$slide</span><span class="keyword">-&gt;</span><span class="default">Name </span><span class="keyword">= </span><span class="string">"New Slidename"</span><span class="keyword">;
<br />
</span><span class="default">$slidename </span><span class="keyword">= </span><span class="default">$slide</span><span class="keyword">-&gt;</span><span class="default">Name</span><span class="keyword">();
<br />
echo</span><span class="string">"&lt;br&gt;NEW slidename : </span><span class="default">$slidename</span><span class="string">"</span><span class="keyword">;
<br />

<br />
</span><span class="comment">//Save the presentation
<br />
</span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">SaveAs</span><span class="keyword">(</span><span class="string">"c:/InetPub/www/test.ppt"</span><span class="keyword">);
<br />
</span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Presentations</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]-&gt;</span><span class="default">Close</span><span class="keyword">();
<br />

<br />
</span><span class="comment">//closing powerpoint
<br />
</span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Quit</span><span class="keyword">();
<br />

<br />
</span><span class="comment">//free the object
<br />
</span><span class="default">$ppoint</span><span class="keyword">-&gt;</span><span class="default">Release</span><span class="keyword">();
<br />
</span><span class="default">$ppoint </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;
<br />
-----------------------
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
the config is : 
<br />
w2k-server/office2k/iis5/php 4.1.1 isapi
<br />

<br />
If you happen to run into a working word2k-example, please let me know.
<br />

<br />
Marc</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
