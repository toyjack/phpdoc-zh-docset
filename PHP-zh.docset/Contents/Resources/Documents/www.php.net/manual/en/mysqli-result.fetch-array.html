<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Fetch the next row of a result set as an associative, a numeric array, or both</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="mysqli-result.fetch-all.html">? mysqli_result::fetch_all</a></li>
      <li style="float: right;"><a href="mysqli-result.fetch-assoc.html">mysqli_result::fetch_assoc ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.mysqli-result.html">mysqli_result</a></li>
    <li>Fetch the next row of a result set as an associative, a numeric array, or both</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="mysqli-result.fetch-array" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysqli_result::fetch_array</h1>
  <h1 class="refname">mysqli_fetch_array</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mysqli_result::fetch_array</span> -- <span class="refname">mysqli_fetch_array</span> &mdash; <span class="dc-title">Fetch the next row of a result set as an associative, a numeric array, or both</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-mysqli-result.fetch-array-description">
  <h3 class="title">说明</h3>
  <p class="para">面向对象风格</p>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>mysqli_result::fetch_array</strong></span>(<span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code><span class="initializer"> = <strong><code>MYSQLI_BOTH</code></strong></span></span>): <span class="type"><span class="type">array</span>|<span class="type">null</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">过程化风格</p>
  <div class="methodsynopsis dc-description"><span class="methodname"><strong>mysqli_fetch_array</strong></span>(<span class="methodparam"><span class="type"><a href="class.mysqli-result.html" class="type mysqli_result">mysqli_result</a></span> <code class="parameter">$result</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$mode</code><span class="initializer"> = <strong><code>MYSQLI_BOTH</code></strong></span></span>): <span class="type"><span class="type">array</span>|<span class="type">null</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Fetches one row of data from the result set and returns it as an array.
   Each subsequent call to this function will return the next row within the
   result set, or <strong><code>null</code></strong> if there are no more rows.
  </p>
  <p class="para">
   In addition to storing the data in the numeric indices of the result array, 
   this function can also store the data in associative indices 
   by using the field names of the result set as keys.
  </p>
  <p class="para">
   If two or more columns of the result have the same name, the last
   column will take precedence and overwrite any previous data. To
   access multiple columns with the same name, the numerically indexed
   version of the row must be used.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数返回的字段名<em class="emphasis">大小写敏感</em>。</span></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数将 NULL 字段设置为 PHP <strong><code>null</code></strong> 值。</span></p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-mysqli-result.fetch-array-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    <dt>

<code class="parameter">result</code></dt>
<dd>
<p class="para">仅以过程化样式：由
<span class="function"><a href="mysqli.query.html" class="function">mysqli_query()</a></span>、<span class="function"><a href="mysqli.store-result.html" class="function">mysqli_store_result()</a></span>、
<span class="function"><a href="mysqli.use-result.html" class="function">mysqli_use_result()</a></span>、<span class="function"><a href="mysqli-stmt.get-result.html" class="function">mysqli_stmt_get_result()</a></span> 返回的 <span class="classname"><a href="class.mysqli-result.html" class="classname">mysqli_result</a></span> 对象。</p></dd>

    
     <dt>
<code class="parameter">mode</code></dt>

     <dd>

      <p class="para">
       This optional parameter is a constant indicating what type of array
       should be produced from the current row data. The possible values for
       this parameter are the constants <strong><code>MYSQLI_ASSOC</code></strong>,
       <strong><code>MYSQLI_NUM</code></strong>, or <strong><code>MYSQLI_BOTH</code></strong>.
      </p>
      <p class="para">
       By using the <strong><code>MYSQLI_ASSOC</code></strong> constant this function
       will behave identically to the <span class="function"><a href="mysqli-result.fetch-assoc.html" class="function">mysqli_fetch_assoc()</a></span>,
       while <strong><code>MYSQLI_NUM</code></strong> will behave identically to the
       <span class="function"><a href="mysqli-result.fetch-row.html" class="function">mysqli_fetch_row()</a></span> function. The final option 
       <strong><code>MYSQLI_BOTH</code></strong> will create a single array with the
       attributes of both.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mysqli-result.fetch-array-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an array representing the fetched row, <strong><code>null</code></strong> if there
   are no more rows in the result set,  或者在失败时返回 <strong><code>false</code></strong>.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-mysqli-result.fetch-array-examples">
  <h3 class="title">范例</h3>
  <div class="example" id="example-1490">
   <p><strong>Example #1 <span class="methodname"><strong>mysqli_result::fetch_array()</strong></span> example</strong></p>
   <div class="example-contents"><p>面向对象风格</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">mysqli</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;Name,&nbsp;CountryCode&nbsp;FROM&nbsp;City&nbsp;ORDER&nbsp;BY&nbsp;ID&nbsp;LIMIT&nbsp;3"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;numeric&nbsp;array&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_NUM</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s&nbsp;(%s)\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]);<br /><br /></span><span style="color: #FF8000">/*&nbsp;associative&nbsp;array&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_ASSOC</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s&nbsp;(%s)\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"Name"</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"CountryCode"</span><span style="color: #007700">]);<br /><br /></span><span style="color: #FF8000">/*&nbsp;associative&nbsp;and&nbsp;numeric&nbsp;array&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$result</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_BOTH</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s&nbsp;(%s)\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"CountryCode"</span><span style="color: #007700">]);</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>过程化风格</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />mysqli_report</span><span style="color: #007700">(</span><span style="color: #0000BB">MYSQLI_REPORT_ERROR&nbsp;</span><span style="color: #007700">|&nbsp;</span><span style="color: #0000BB">MYSQLI_REPORT_STRICT</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$mysqli&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"localhost"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"my_password"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"world"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;Name,&nbsp;CountryCode&nbsp;FROM&nbsp;City&nbsp;ORDER&nbsp;by&nbsp;ID&nbsp;LIMIT&nbsp;3"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$mysqli</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;numeric&nbsp;array&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">MYSQLI_NUM</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s&nbsp;(%s)\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]);<br /><br /></span><span style="color: #FF8000">/*&nbsp;associative&nbsp;array&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">MYSQLI_ASSOC</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s&nbsp;(%s)\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"Name"</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"CountryCode"</span><span style="color: #007700">]);<br /><br /></span><span style="color: #FF8000">/*&nbsp;associative&nbsp;and&nbsp;numeric&nbsp;array&nbsp;*/<br /></span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysqli_fetch_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">MYSQLI_BOTH</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">printf</span><span style="color: #007700">(</span><span style="color: #DD0000">"%s&nbsp;(%s)\n"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">[</span><span style="color: #DD0000">"CountryCode"</span><span style="color: #007700">]);</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>以上例程的输出类似于：</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
Kabul (AFG)
Qandahar (AFG)
Herat (AFG)
</pre></div>
   </div>
  </div>
 </div>


 <div class="refsect1 seealso" id="refsect1-mysqli-result.fetch-array-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli-result.fetch-assoc.html" class="function" rel="rdfs-seeAlso">mysqli_fetch_assoc()</a> - Fetch the next row of a result set as an associative array</span></li>
    <li class="member"><span class="function"><a href="mysqli-result.fetch-column.html" class="function" rel="rdfs-seeAlso">mysqli_fetch_column()</a> - Fetch a single column from the next row of a result set</span></li>
    <li class="member"><span class="function"><a href="mysqli-result.fetch-row.html" class="function" rel="rdfs-seeAlso">mysqli_fetch_row()</a> - Fetch the next row of a result set as an enumerated array</span></li>
    <li class="member"><span class="function"><a href="mysqli-result.fetch-object.html" class="function" rel="rdfs-seeAlso">mysqli_fetch_object()</a> - Fetch the next row of a result set as an object</span></li>
    <li class="member"><span class="function"><a href="mysqli.query.html" class="function" rel="rdfs-seeAlso">mysqli_query()</a> - 对数据库执行一次查询</span></li>
    <li class="member"><span class="function"><a href="mysqli-result.data-seek.html" class="function" rel="rdfs-seeAlso">mysqli_data_seek()</a> - Adjusts the result pointer to an arbitrary row in the result</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121998""></a>
  <div class="note">
   <strong class="user">meaje at msn dot com</strong>
   <a href="#121998" class="date">08-Dec-2017 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that under PHP 5.x there appears to be a globally defined variable MYSQL_ASSOC, MYSQL_NUM, or MYSQL_BOTH which is the equivalent of MYSQLI_ASSOC, MYSQLI_NUM, or MYSQLI_BOTH!!! Yet under PHP 7.x this is NOT the case and will cause a failure in trying to retrieve the result set!<br />
<br />
This can cause severe headaches when trying to find out why you are getting the error: <br />
&nbsp;- mysqli_result::fetch_array() expects parameter 1 to be integer, string given in 'Filename' on line 'XX'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111208""></a>
  <div class="note">
   <strong class="user">Duncan</strong>
   <a href="#111208" class="date">25-Jan-2013 11:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that the array returned contains only strings.<br />
<br />
E.g. when a MySQL field is an INT you may expect the field to be returned as an integer, however all fields are simply returned as strings.<br />
<br />
What this means: use double-equals not triple equals when comparing numbers.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">print </span><span class="default">$array_from_mysqli_fetch_array</span><span class="keyword">[</span><span class="string">'id'</span><span class="keyword">] == </span><span class="default">1 </span><span class="keyword">? </span><span class="string">"true" </span><span class="keyword">: </span><span class="string">"false"</span><span class="keyword">; </span><span class="comment">// true<br />
</span><span class="keyword">print </span><span class="default">$array_from_mysqli_fetch_array</span><span class="keyword">[</span><span class="string">'id'</span><span class="keyword">] === </span><span class="default">1 </span><span class="keyword">? </span><span class="string">"true" </span><span class="keyword">: </span><span class="string">"false"</span><span class="keyword">; </span><span class="comment">// false<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104189""></a>
  <div class="note">
   <strong class="user">ahouston at gmail dot com</strong>
   <a href="#104189" class="date">31-May-2011 02:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function to return an associative array with multiple columns as keys to the array.<br />
<br />
This is a rough approximation of the perl DBI-&gt;fetchall_hashref function - something I find myself using quite a bit.<br />
<br />
Given a simple mySQL table:<br />
<br />
mysql&gt; select * from city;<br />
+----------------+----------------+------------------+------------+<br />
| country&nbsp; &nbsp; &nbsp; &nbsp; | region&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | city&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | hemisphere |<br />
+----------------+----------------+------------------+------------+<br />
| South Africa&nbsp;&nbsp; | KwaZulu-Natal&nbsp; | Durban&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; | South&nbsp; &nbsp; &nbsp; |<br />
| South Africa&nbsp;&nbsp; | Gauteng&nbsp; &nbsp; &nbsp; &nbsp; | Johannesburg&nbsp; &nbsp;&nbsp; | South&nbsp; &nbsp; &nbsp; |<br />
| South Africa&nbsp;&nbsp; | Gauteng&nbsp; &nbsp; &nbsp; &nbsp; | Tshwane&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | South&nbsp; &nbsp; &nbsp; |<br />
| South Africa&nbsp;&nbsp; | KwaZulu-Natal&nbsp; | Pietermaritzburg | South&nbsp; &nbsp; &nbsp; |<br />
| United Kingdom | Greater London | City of London&nbsp;&nbsp; | North&nbsp; &nbsp; &nbsp; |<br />
| United Kingdom | Greater London | Wimbledon&nbsp; &nbsp; &nbsp; &nbsp; | North&nbsp; &nbsp; &nbsp; |<br />
| United Kingdom | Lancashire&nbsp; &nbsp;&nbsp; | Liverpool&nbsp; &nbsp; &nbsp; &nbsp; | North&nbsp; &nbsp; &nbsp; |<br />
| United Kingdom | Lancashire&nbsp; &nbsp;&nbsp; | Manchester&nbsp; &nbsp; &nbsp;&nbsp; | North&nbsp; &nbsp; &nbsp; |<br />
+----------------+----------------+------------------+------------+<br />
<br />
*Note* - this is a simple function that makes no attempt to keep multiple values per key, so you need to specify all the unique keys you require.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $link </span><span class="keyword">= </span><span class="default">mysqli_connect</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">, </span><span class="string">"username"</span><span class="keyword">, </span><span class="string">"password"</span><span class="keyword">, </span><span class="string">"test"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">mysqli_query</span><span class="keyword">(</span><span class="default">$link</span><span class="keyword">, </span><span class="string">"select * from city"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results_arr </span><span class="keyword">= </span><span class="default">fetch_all_assoc</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,array(</span><span class="string">'hemisphere'</span><span class="keyword">,</span><span class="string">'country'</span><span class="keyword">,</span><span class="string">'region'</span><span class="keyword">,</span><span class="string">'city'</span><span class="keyword">));<br />
<br />
function </span><span class="default">fetch_all_assoc</span><span class="keyword">(&amp; </span><span class="default">$result</span><span class="keyword">,</span><span class="default">$index_keys</span><span class="keyword">) {<br />
<br />
&nbsp; </span><span class="comment">// Args :&nbsp; &nbsp; $result = mysqli result variable (passed as reference to allow a free() at the end<br />
&nbsp; //&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $indexkeys = array of columns to index on<br />
&nbsp; // Returns : associative array indexed by the keys array<br />
<br />
&nbsp; </span><span class="default">$assoc </span><span class="keyword">= array();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// The array we're going to be returning<br />
<br />
&nbsp; </span><span class="keyword">while (</span><span class="default">$row </span><span class="keyword">= </span><span class="default">mysqli_fetch_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">MYSQLI_ASSOC</span><span class="keyword">)) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pointer </span><span class="keyword">= &amp; </span><span class="default">$assoc</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Start the pointer off at the base of the array<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$index_keys</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key_name </span><span class="keyword">= </span><span class="default">$index_keys</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$row</span><span class="keyword">[</span><span class="default">$key_name</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print </span><span class="string">"Error: Key </span><span class="default">$key_name</span><span class="string"> is not present in the results output.\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">false</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key_val</span><span class="keyword">= isset(</span><span class="default">$row</span><span class="keyword">[</span><span class="default">$key_name</span><span class="keyword">]) ? </span><span class="default">$row</span><span class="keyword">[</span><span class="default">$key_name</span><span class="keyword">]&nbsp; : </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$pointer</span><span class="keyword">[</span><span class="default">$key_val</span><span class="keyword">])) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pointer</span><span class="keyword">[</span><span class="default">$key_val</span><span class="keyword">] = </span><span class="string">""</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Start a new node<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pointer </span><span class="keyword">= &amp; </span><span class="default">$pointer</span><span class="keyword">[</span><span class="default">$key_val</span><span class="keyword">];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Move the pointer on to the new node<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pointer </span><span class="keyword">= &amp; </span><span class="default">$pointer</span><span class="keyword">[</span><span class="default">$key_val</span><span class="keyword">];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Already exists, move the pointer on to the new node<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } </span><span class="comment">// for $i<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // At this point, $pointer should be at the furthest point on the tree of keys<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Now we can go through all the columns and place their values on the tree<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // For ease of use, include the index keys and their values at this point too<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$row </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$val</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pointer</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$val</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp; } </span><span class="comment">// $row<br />
<br />
&nbsp; /* free result set */<br />
&nbsp; </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
<br />
&nbsp; return(</span><span class="default">$assoc</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95881""></a>
  <div class="note">
   <strong class="user">Jammerx2</strong>
   <a href="#95881" class="date">26-Jan-2010 07:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Putting multiple rows into an array:<br />
<br />
<span class="default">&lt;?php<br />
$mysqli </span><span class="keyword">= new </span><span class="default">mysqli</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">, </span><span class="string">"my_user"</span><span class="keyword">, </span><span class="string">"my_password"</span><span class="keyword">, </span><span class="string">"world"</span><span class="keyword">);<br />
<br />
</span><span class="comment">/* check connection */<br />
</span><span class="keyword">if (</span><span class="default">mysqli_connect_errno</span><span class="keyword">()) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">"Connect failed: %s\n"</span><span class="keyword">, </span><span class="default">mysqli_connect_error</span><span class="keyword">());<br />
&nbsp;&nbsp;&nbsp; exit();<br />
}<br />
<br />
</span><span class="default">$query </span><span class="keyword">= </span><span class="string">"SELECT Name, CountryCode FROM City ORDER by ID LIMIT 3"</span><span class="keyword">;<br />
</span><span class="default">$result </span><span class="keyword">= </span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">query</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);<br />
<br />
while(</span><span class="default">$row </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">fetch_array</span><span class="keyword">())<br />
{<br />
</span><span class="default">$rows</span><span class="keyword">[] = </span><span class="default">$row</span><span class="keyword">;<br />
}<br />
<br />
foreach(</span><span class="default">$rows </span><span class="keyword">as </span><span class="default">$row</span><span class="keyword">)<br />
{<br />
echo </span><span class="default">$row</span><span class="keyword">[</span><span class="string">'CountryCode'</span><span class="keyword">];<br />
}<br />
<br />
</span><span class="comment">/* free result set */<br />
</span><span class="default">$result</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
<br />
</span><span class="comment">/* close connection */<br />
</span><span class="default">$mysqli</span><span class="keyword">-&gt;</span><span class="default">close</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
