<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>从结果集中取得一行作为对象</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mysql-fetch-lengths.html">? mysql_fetch_lengths</a></li>
      <li style="float: right;"><a href="function.mysql-fetch-row.html">mysql_fetch_row ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mysql.html">MySQL 函数</a></li>
    <li>从结果集中取得一行作为对象</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mysql-fetch-object" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">mysql_fetch_object</h1>
    <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_fetch_object</span> &mdash; <span class="dc-title">从结果集中取得一行作为对象</span></p>

   </div>
 <div class="refsect1 description" id="refsect1-function.mysql-fetch-object-description">
  <h3 class="title">说明</h3>
     <div class="methodsynopsis dc-description">
      <span class="methodname"><strong>mysql_fetch_object</strong></span>
       ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$result</code></span>
      ) : <span class="type">object</span></div>

    <p class="para rdfs-comment">
     返回根据所取得的行生成的对象，如果没有更多行则返回 <strong><code>FALSE</code></strong>。
    </p>
    <p class="para">
     <span class="function"><strong>mysql_fetch_object()</strong></span> 和
     <span class="function"><a href="function.mysql-fetch-array.html" class="function">mysql_fetch_array()</a></span>
     类似，只有一点区别 - 返回一个对象而不是数组。间接地也意味着只能通过字段名来访问数组，而不是偏移量（数字是合法的属性名）。
    </p>
    <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数返回的字段名<em class="emphasis">大小写敏感</em>。</span></p></blockquote>
    <p class="para">
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">/*&nbsp;this&nbsp;is&nbsp;valid&nbsp;*/<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">field</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">/*&nbsp;this&nbsp;is&nbsp;invalid&nbsp;*/<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </p>
    <p class="para">
     速度上，本函数和
     <span class="function"><a href="function.mysql-fetch-array.html" class="function">mysql_fetch_array()</a></span> 一样，也几乎和
     <span class="function"><a href="function.mysql-fetch-row.html" class="function">mysql_fetch_row()</a></span> 一样快（差别很不明显）。
     <div class="example" id="example-2172">
      <p><strong>Example #1 <span class="function"><strong>mysql_fetch_object()</strong></span> 例子</strong></p>
      <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"hostname"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">mysql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">"mydb"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"select&nbsp;*&nbsp;from&nbsp;mytable"</span><span style="color: #007700">);<br />while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_object</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">user_id</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fullname</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">mysql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
      </div>

     </div>
    </p>
    <p class="para">
     参见 <span class="function"><a href="function.mysql-fetch-array.html" class="function">mysql_fetch_array()</a></span>，<span class="function"><a href="function.mysql-fetch-assoc.html" class="function">mysql_fetch_assoc()</a></span>
     和 <span class="function"><a href="function.mysql-fetch-row.html" class="function">mysql_fetch_row()</a></span>。
    </p>
   </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-fetch-object-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    <dt>
<code class="parameter">
result</code></dt>
<dd>
<p class="para"><span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span>
型的结果集。此结果集来自对 <span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span>
的调用。</p></dd>

    
     <dt>
<code class="parameter">class_name</code></dt>

      <dd>

       <p class="para">
        The name of the class to instantiate, set the properties of and return.
        If not specified, a <strong class="classname">stdClass</strong> object is returned.
       </p>
     </dd>

    
    
     <dt>
<code class="parameter">params</code></dt>

      <dd>

       <p class="para">
        An optional <span class="type"><a href="language.types.array.html" class="type array">array</a></span> of parameters to pass to the constructor
        for <code class="parameter">class_name</code> objects.
       </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-fetch-object-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an <span class="type"><a href="language.types.object.html" class="type object">object</a></span> with string properties that correspond to the
   fetched row, or <strong><code>FALSE</code></strong> if there are no more rows.
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.mysql-fetch-object-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>5.0.0</td>
       <td>
        Added the ability to return as a different object.
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mysql-fetch-object-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2173">
    <p><strong>Example #2 <span class="function"><strong>mysql_fetch_object()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"hostname"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">mysql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">"mydb"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"select&nbsp;*&nbsp;from&nbsp;mytable"</span><span style="color: #007700">);<br />while&nbsp;(</span><span style="color: #0000BB">$row&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_object</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">user_id</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fullname</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">mysql_free_result</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-2174">
    <p><strong>Example #3 <span class="function"><strong>mysql_fetch_object()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">foo&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;</span><span style="color: #0000BB">$name</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">"hostname"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"user"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">mysql_select_db</span><span style="color: #007700">(</span><span style="color: #DD0000">"mydb"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #DD0000">"select&nbsp;name&nbsp;from&nbsp;mytable&nbsp;limit&nbsp;1"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$obj&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_fetch_object</span><span style="color: #007700">(</span><span style="color: #0000BB">$result</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'foo'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$obj</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-fetch-object-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <strong>Performance</strong><br />
   <p class="para">
    Speed-wise, the function is identical to
    <span class="function"><a href="function.mysql-fetch-array.html" class="function">mysql_fetch_array()</a></span>, and almost as quick as
    <span class="function"><a href="function.mysql-fetch-row.html" class="function">mysql_fetch_row()</a></span> (the difference is
    insignificant).
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    <span class="function"><strong>mysql_fetch_object()</strong></span> is similar to
    <span class="function"><a href="function.mysql-fetch-array.html" class="function">mysql_fetch_array()</a></span>, with one difference - an
    object is returned, instead of an array.  Indirectly, that means
    that you can only access the data by the field names, and not by
    their offsets (numbers are illegal property names).
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数返回的字段名<em class="emphasis">大小写敏感</em>。</span></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数将 NULL 字段设置为 PHP <strong><code>NULL</code></strong> 值。</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-fetch-object-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-fetch-array.html" class="function" rel="rdfs-seeAlso">mysql_fetch_array()</a> - 从结果集中取得一行作为关联数组，或数字数组，或二者兼有</span></li>
    <li class="member"><span class="function"><a href="function.mysql-fetch-assoc.html" class="function" rel="rdfs-seeAlso">mysql_fetch_assoc()</a> - 从结果集中取得一行作为关联数组</span></li>
    <li class="member"><span class="function"><a href="function.mysql-fetch-row.html" class="function" rel="rdfs-seeAlso">mysql_fetch_row()</a> - 从结果集中取得一行作为枚举数组</span></li>
    <li class="member"><span class="function"><a href="function.mysql-data-seek.html" class="function" rel="rdfs-seeAlso">mysql_data_seek()</a> - 移动内部结果的指针</span></li>
    <li class="member"><span class="function"><a href="function.mysql-query.html" class="function" rel="rdfs-seeAlso">mysql_query()</a> - 发送一条 MySQL 查询</span></li>
   </ul>
  </p>
 </div>

  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="99720""></a>
  <div class="note">
   <strong class="user">webmaster at kibab dot com</strong>
   <a href="#99720" class="date">01-Sep-2010 07:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
That huge difference in timings may be caused by database cache issues. If mysql_fetch_object() was the first function to be used, the cache was empty, but subsequent invocations took the result from the query cache.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85374""></a>
  <div class="note">
   <strong class="user">mp</strong>
   <a href="#85374" class="date">27-Aug-2008 10:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When working with a stdClass object returned from a database query, specifically:<br />
<br />
$object = mysql_fetch_object($result)<br />
<br />
You may run into assignment problems if you have a field with a '.' in the name.<br />
e.g.: `user.id`<br />
<br />
To remedy this situation, you can use curly braces and single quotes during assignment.<br />
<br />
In place of:<br />
$myObject-&gt;user_id = $object-&gt;user.id;<br />
<br />
Use:<br />
$myObject-&gt;user_id = $object-&gt;{'user.id'};</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83632""></a>
  <div class="note">
   <strong class="user">strrev xc.noxeh@ellij</strong>
   <a href="#83632" class="date">05-Jun-2008 05:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I created a table, with 5 INT columns, and 1000 rows of random ints.<br />
I did 100 selects:<br />
<br />
SELECT * FROM bench... (mysql_fetch_object)<br />
Query time: 5.40725040436<br />
Fetching time: 16.2730708122 (avg: 1.32130565643E-5)<br />
Total time: 21.6803212166<br />
<br />
SELECT * FROM bench... (mysql_fetch_array)<br />
Query time: 5.37693023682<br />
Fetching time: 10.3851644993 (avg: 7.48886537552E-6)<br />
Total time: 15.7620947361<br />
<br />
SELECT * FROM bench... (mysql_fetch_assoc)<br />
Query time: 5.345921278<br />
Fetching time: 10.6170959473 (avg: 7.64049530029E-6)<br />
Total time: 15.9630172253<br />
<br />
"Note: Performance&nbsp; Speed-wise, the function is identical to mysql_fetch_array(), and almost as quick as mysql_fetch_row() (the difference is insignificant)."<br />
<br />
And I am a penguin :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83595""></a>
  <div class="note">
   <strong class="user">hcse at op dot pl</strong>
   <a href="#83595" class="date">03-Jun-2008 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Test </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; public </span><span class="default">$go </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$id </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">show</span><span class="keyword">() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">"id: </span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">id</span><span class="keyword">}</span><span class="string"> go: </span><span class="keyword">{</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">go</span><span class="keyword">}</span><span class="string">" </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__construct</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"in __construct() "</span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">show</span><span class="keyword">() .</span><span class="string">"\n" </span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">go </span><span class="keyword">= </span><span class="default">uniqid</span><span class="keyword">()&nbsp; &nbsp; ;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
}<br />
<br />
if (! (</span><span class="default">$res </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">'SELECT * FROM `test`'</span><span class="keyword">, </span><span class="default">$db</span><span class="keyword">))) {<br />
&nbsp;&nbsp;&nbsp; die(</span><span class="string">'Invalid query: ' </span><span class="keyword">. </span><span class="default">mysql_error</span><span class="keyword">() . </span><span class="string">"\n"</span><span class="keyword">);<br />
}<br />
<br />
while(</span><span class="default">$obj </span><span class="keyword">= </span><span class="default">mysql_fetch_object</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">, </span><span class="string">'Test'</span><span class="keyword">) ){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"outside ________ "</span><span class="keyword">. </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">show</span><span class="keyword">() .</span><span class="string">"\n\n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This code gives the result:<br />
in __construct() id: 1 go: first<br />
outside ________ id: 1 go: 4845bd99ca2e3<br />
<br />
in __construct() id: 2 go: second<br />
outside ________ id: 2 go: 4845bd99ca2fd<br />
<br />
It means that __construct() is invoked after filling fields with data from database, eg. it can be used to change strings into integers.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83251""></a>
  <div class="note">
   <strong class="user">Justin Rovang</strong>
   <a href="#83251" class="date">16-May-2008 12:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is another way to load variables quickly within $this, and allows for intervention on variable names. <br />
<br />
All columns from the single-row result are loaded and accessed via $this-&gt;_variableName.<br />
<br />
&lt;?<br />
class MyClass{<br />
&nbsp;&nbsp;&nbsp; public function _load($nID) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $Q = "SELECT * FROM myTable";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if($aTmp = RETURN_Q_ARRAY($Q)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $aTmp = $aTmp[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $aK =array_keys($aTmp);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach($aK as $sK) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!is_numeric($sK)) $this-&gt;{"_$sK"}=$aTmp[$sK];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return true;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
$o = new MyClass;<br />
$o-&gt;_load(1);<br />
<br />
echo $o-&gt;_id; //1<br />
echo $o-&gt;_otherColumn; //otherColumn value</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82643""></a>
  <div class="note">
   <strong class="user">Peter T</strong>
   <a href="#82643" class="date">19-Apr-2008 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're using mysql_fetch_object and specifying a class - the properties will be set BEFORE the constructor is executed.&nbsp; This is generally not an issue, but can cause some major problems if you're properties are set via the __set() magic method and constructor logic must be executed first.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80962""></a>
  <div class="note">
   <strong class="user">danielpunt</strong>
   <a href="#80962" class="date">08-Feb-2008 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@Jezze : This wil also work. Also works with static methods.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">class </span><span class="default">Foo<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$FooBar</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">LoadFromId</span><span class="keyword">(</span><span class="default">$Id</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Result </span><span class="keyword">= </span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">'SELECT * FROM foo WHERE Id = ' </span><span class="keyword">. </span><span class="default">$Id</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">$Row </span><span class="keyword">= </span><span class="default">mysql_fetch_object</span><span class="keyword">(</span><span class="default">$Result</span><span class="keyword">, </span><span class="default">__CLASS__</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$Row</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
<br />
</span><span class="default">$Foo </span><span class="keyword">= new </span><span class="default">Foo</span><span class="keyword">;<br />
</span><span class="default">$Foo</span><span class="keyword">-&gt;</span><span class="default">LoadAll</span><span class="keyword">();<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78036""></a>
  <div class="note">
   <strong class="user">Jezze</strong>
   <a href="#78036" class="date">24-Sep-2007 10:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have a class that represents itself in a database you can use this function to get the properties.<br />
<br />
class MyClass {<br />
<br />
&nbsp; public $name;<br />
&nbsp; public $language;<br />
<br />
&nbsp; function load($id) {<br />
<br />
&nbsp;&nbsp;&nbsp; $query = mysql_query("SELECT name, language FROM myTable WHERE id = $id");<br />
&nbsp;&nbsp;&nbsp; $result = mysql_fetch_object($query, get_class($this));<br />
<br />
&nbsp;&nbsp;&nbsp; foreach(get_object_vars($result) as $var =&gt; $value) $this-&gt;$var = $value;<br />
&nbsp; }<br />
<br />
}<br />
<br />
$a = new MyClass();<br />
$a-&gt;load(1);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77178""></a>
  <div class="note">
   <strong class="user">Chris at r3i dot it</strong>
   <a href="#77178" class="date">18-Aug-2007 10:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reply to rodolphe dot bodeau at free dot fr :<br />
<br />
The function mysql_fetch_object has other two parameters that you can use.<br />
As the manual say: <br />
mysql_fetch_object( $resource, $class_name, $params ) )<br />
<br />
$class_name and $params are optional.<br />
<br />
So if you want to fetch a row in a class you can:<br />
<br />
1) Define your class Test with method and other stuff.<br />
2) Execute Query<br />
3) call: <br />
$Object = mysql_fetch_object( $Resource, "Test" );<br />
<br />
so you can use $Object with the methods<br />
<br />
Be aware how you write code in your methods: in this case, classes are used for centralize the code and they are not<br />
really safe because you can have an additional Information <br />
( with a Join Query for example ) without methods to access to them.<br />
So classes need get and set method generalized.<br />
( for extra see PHP 5 Manual O'Rielly on the use of generalized methods get and set )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75116""></a>
  <div class="note">
   <strong class="user">rodolphe dot bodeau at free dot fr</strong>
   <a href="#75116" class="date">13-May-2007 05:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This little function stores the content of a mysql_fetch_object result into an object by using MySQL request field names as object parameters :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">FetchRequestInObject</span><span class="keyword">(&amp;</span><span class="default">$obj</span><span class="keyword">, </span><span class="default">$req</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ReqVars </span><span class="keyword">= </span><span class="default">get_object_vars</span><span class="keyword">(</span><span class="default">$req</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$ReqVars </span><span class="keyword">as </span><span class="default">$ReqName </span><span class="keyword">=&gt; </span><span class="default">$ReqValue</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">property_exists</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">, </span><span class="default">$ReqName</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">$ReqName </span><span class="keyword">= </span><span class="default">$ReqValue</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Remember that mysql_fetch_object is case sensitive, so beware of your object properties. Use keyword "AS" in your SQL request to change field name if necessary.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74893""></a>
  <div class="note">
   <strong class="user">info [at] woeiweb [dot] nl</strong>
   <a href="#74893" class="date">02-May-2007 12:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since PHP 5.2.1 it seems like this function doesn't like queries that return columns with empty names, like:<br />
select '' from `table`<br />
<br />
PHP exits and mysql_error() does not return an error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70613""></a>
  <div class="note">
   <strong class="user">syntax</strong>
   <a href="#70613" class="date">21-Oct-2006 06:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@Simon Paridon and others concerning SQL to php getting results via mysql_fetch_object:<br />
<br />
Every query that would fail in a database frontend, such as MySQLs "Query Browser" and only will work by using the `-marks will probably give results hardly accessible in PHP especially if you have column names with "-" or " " in it.<br />
<br />
Using the example of Simon Paridon: it is not possible to execute a query like:<br />
<br />
SELECT id, user-id FROM unlucky_naming<br />
<br />
only<br />
<br />
SELECT id, `user-id` FROM unlucky_naming<br />
<br />
will work...<br />
<br />
so either be a bit wiser when naming the colums (e.g. user_id)<br />
<br />
or try it with<br />
<br />
SELECT id, `user-id` AS user_id FROM unlucky_naming<br />
<br />
(i have not tested it in PHP yet, but i guess this will fail as well, if you have a query like "SELECT `foo name` FROM `unlucky naming 2`")<br />
<br />
Somewhat down "amackenz at cs dot uml dot edu" mentioned to name sum, count etc. this may be a good hint for newbies: increase the speed of your php applications by using (my)sql native functions and save data transfer as well as processing time</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69867""></a>
  <div class="note">
   <strong class="user">Simon Paridon</strong>
   <a href="#69867" class="date">24-Sep-2006 05:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The behavior of this function is slightly questionable.<br />
<br />
If you have a col in you table containing non-variable-name characters like "-", mysql_fetch_object will add "impossible variable names" to your object, e.g.<br />
<br />
object (<br />
&nbsp; [user-id] =&gt; 7<br />
)<br />
<br />
You can not access this variable normally with $obj-&gt;user-id, because the variable name is invalid. But you can however access it like this:<br />
<br />
$foo = 'user-id';<br />
echo $obj-&gt;$foo;<br />
<br />
It will correctly output 7, whereas var_dump($obj-&gt;user-id) would output int(0) for some reason.<br />
<br />
I got this behaviour with PHP 4.4.2.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68337""></a>
  <div class="note">
   <strong class="user">Kaminari (telecotxesco at hotmail)</strong>
   <a href="#68337" class="date">23-Jul-2006 04:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a very very elegant (and costless) way to fetch an enterie query to every single field name from a "wide" table:<br />
<br />
The tedious way fetching:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $idtable</span><span class="keyword">=</span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">,</span><span class="string">"user"</span><span class="keyword">,</span><span class="string">"pwd"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">"table"</span><span class="keyword">,</span><span class="default">$idtable</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$consult</span><span class="keyword">=</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"SELECT *<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; FROM models <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ORDER BY Serie,Year ASC"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$row</span><span class="keyword">=</span><span class="default">mysql_fetch_object</span><span class="keyword">(</span><span class="default">$consult</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$IdLomo</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">IdLomo</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Serie</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Serie</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Model</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Model</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Type</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Type</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Year</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Year</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Speed</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Speed</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Power</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Power</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Price</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Price</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Load1</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Load1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Load2</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Load2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Load3</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Load3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Load4</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Load4</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Server</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Servier</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Real</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Real</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$Lomo</span><span class="keyword">=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">Lomo</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Resulting on 15 new variables called like their name on table wich we introduced manualy for 5 minutes. But imagine each row has 100 fields!<br />
<br />
A way saving time with the same result:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $idtable</span><span class="keyword">=</span><span class="default">mysql_connect</span><span class="keyword">(</span><span class="string">"localhost"</span><span class="keyword">,</span><span class="string">"user"</span><span class="keyword">,</span><span class="string">"pwd"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mysql_select_db</span><span class="keyword">(</span><span class="string">"table"</span><span class="keyword">,</span><span class="default">$idtable</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$consult</span><span class="keyword">=</span><span class="default">mysql_query</span><span class="keyword">(</span><span class="string">"SELECT *<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; FROM models <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ORDER BY Serie,Year ASC"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// We find the fields number<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$numfields</span><span class="keyword">=</span><span class="default">mysql_num_fields</span><span class="keyword">(</span><span class="default">$consult</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Now we put the names of fields in a Array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$numfields</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fieldname</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]=</span><span class="default">mysql_field_name</span><span class="keyword">(</span><span class="default">$consult</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; while(</span><span class="default">$row</span><span class="keyword">=</span><span class="default">mysql_fetch_object</span><span class="keyword">(</span><span class="default">$consult</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Finally we assign the new variables<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$numfields</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $</span><span class="default">$fieldname</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]=</span><span class="default">$row</span><span class="keyword">-&gt;</span><span class="default">$fieldname</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56044""></a>
  <div class="note">
   <strong class="user">trithaithus at tibiahumor dot net</strong>
   <a href="#56044" class="date">21-Aug-2005 01:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This method offers a nice way to fetch objects from databases. As Federico at Pomi dot net mentioned it doesn't work native as the type of the object fetched isn't the right one, but with a small typecast it works flawlessly. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">ClassTypeCast</span><span class="keyword">(&amp;</span><span class="default">$obj</span><span class="keyword">,</span><span class="default">$class_type</span><span class="keyword">){<br />
&nbsp;&nbsp; if(</span><span class="default">class_exists</span><span class="keyword">(</span><span class="default">$class_type</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$obj </span><span class="keyword">= </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/^O:[0-9]+:\\"</span><span class="keyword">[^\</span><span class="string">"]+\\"</span><span class="keyword">:/</span><span class="default">i</span><span class="string">",<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; "</span><span class="default">O</span><span class="keyword">:</span><span class="string">".strlen(</span><span class="default">$class_type</span><span class="string">)."</span><span class="keyword">:\\</span><span class="string">""</span><span class="keyword">.</span><span class="default">$class_type</span><span class="keyword">.</span><span class="string">"\\"</span><span class="keyword">:</span><span class="string">", serialize(</span><span class="default">$obj</span><span class="string">)));<br />
&nbsp;&nbsp; }<br />
}<br />
<br />
class Foo<br />
{<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$foo</span><span class="string">;<br />
&nbsp;&nbsp;&nbsp; var </span><span class="default">$bar</span><span class="string">;<br />
&nbsp;&nbsp;&nbsp; function get_from_db()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; mysql_connect();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; mysql_select_db();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$res</span><span class="string"> = mysql_query("</span><span class="default">SELECT foo</span><span class="keyword">,</span><span class="default">bar from my_table</span><span class="string">");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fetched_object</span><span class="string"> = mysql_fetch_object(</span><span class="default">$res</span><span class="string">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ClassTypeCast(</span><span class="default">$fetched_object</span><span class="string">,"</span><span class="default">Foo</span><span class="string">");<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="string"> = </span><span class="default">$fetched_object</span><span class="string">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55559""></a>
  <div class="note">
   <strong class="user">backglancer at hotmail</strong>
   <a href="#55559" class="date">07-Aug-2005 03:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Watch out for mysql_fetch_object() to return all values as strings.<br />
if you try to do<br />
&lt;?<br />
$p = mysql_fetch_object($some_sql);<br />
// and then try to do something like<br />
<br />
$money = $p-&gt;dollars + $p-&gt;cents;<br />
?&gt;<br />
<br />
You may experience "Unsupported operand types"<br />
<br />
so always cast them both as (int) 's!!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43942""></a>
  <div class="note">
   <strong class="user">q</strong>
   <a href="#43942" class="date">09-Jul-2004 07:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some clarifications about previous notes concerning duplicate field names in a result set.<br />
<br />
Consider the following relations:<br />
<br />
TABLE_A(id, name)<br />
TABLE_B(id, name, id_A)<br />
<br />
Where TABLE_B.id_A references TABLE_A.id.<br />
<br />
Now, if we join these tables like this: "SELECT * FROM TABLE_A, TABLE_B WHERE TABLE_A.id = TABLE_B.id_A", the result set looks like this: (id, name, id, name, id_A).<br />
<br />
The behaviour of mysql_fetch_object on a result like this isn't documented here, but it seems obvious that some data will be lost because of the duplicate field names.<br />
<br />
This can be avoided, as Eskil Kvalnes stated, by aliasing the field names. However, it is not necessary to alias all fields on a large table, as the following syntax is legal in MySQL: "SELECT *, TABLE_A.name AS name_a, TABLE_B.name AS name_b FROM TABLE_A, TABLE_B ...". This will produce a result set formatted like this: (id, name, id, name, id_A, name_a, name_b), and your data is saved. Hooray!<br />
<br />
-q</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36608""></a>
  <div class="note">
   <strong class="user">rcoles at hotmail dot com</strong>
   <a href="#36608" class="date">16-Oct-2003 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reviewing Eskil Kvalnes's comments (04-Mar-2003 11:59 <br />
When using table joins in a query you obviously need to name all the fields to make it work right with mysql_fetch_object()) I was left asking and, as a newbie, the reason why I'm here. I have a 28 field table. Ran SELECT * with a LEFT JOIN, etc and it appears to have worked on my test server without issue.<br />
<br />
On further reading, MYSQL.COM has the following:<br />
* It is not allowed to use a column alias in a WHERE clause, because the column value may not yet be determined when the WHERE clause is executed. See section A.5.4 Problems with alias. <br />
* The FROM table_references clause indicates the tables from which to retrieve rows. If you name more than one table, you are performing a join. For information on join syntax, see section 6.4.1.1 JOIN Syntax. For each table specified, you may optionally specify an alias. <br />
<br />
Aware of the fact there's a difference between tables and fields there appears to be confusion here somewhere.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32088""></a>
  <div class="note">
   <strong class="user">zhundiak at comcast dot net</strong>
   <a href="#32088" class="date">15-May-2003 06:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a wrapper that will allow specifying a class name.<br />
function &amp;db_fetch_object($set,$className)<br />
{<br />
&nbsp; /* Start by getting the usual array */<br />
&nbsp; $row = mysql_fetch_assoc($set);<br />
&nbsp; if ($row === null) return null;<br />
<br />
&nbsp; /* Create the object */<br />
&nbsp; $obj =&amp; new $className();<br />
<br />
&nbsp; /* Explode the array and set the objects's instance data */<br />
&nbsp; foreach($row as $key =&gt; $value)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; $obj-&gt;{$key} = $value;<br />
&nbsp; }<br />
&nbsp; return $obj;<br />
}<br />
class CPerson<br />
{<br />
&nbsp; function getFullName()<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; return $this-&gt;fname . ' ' . $this-&gt;lname;<br />
&nbsp; }<br />
}<br />
$set = mysql_query('SELECT fname,lname FROM person');<br />
while($person =&amp; db_fetch_object($set,'CPerson'))<br />
{<br />
&nbsp; echo $person-&gt;getFullName();<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30011""></a>
  <div class="note">
   <strong class="user">Eskil Kvalnes</strong>
   <a href="#30011" class="date">03-Mar-2003 10:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using table joins in a query you obviously need to name all the fields to make it work right with mysql_fetch_object().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29033""></a>
  <div class="note">
   <strong class="user">kalleanka</strong>
   <a href="#29033" class="date">30-Jan-2003 03:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
an addition to the previous... <br />
<br />
for example getting members from a database:<br />
<br />
function getAllMembers () {<br />
&nbsp;&nbsp;&nbsp; $query = "SELECT * FROM people ORDER BY lname";<br />
&nbsp;&nbsp;&nbsp; $result = mysql_query($query);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; while($member = mysql_fetch_object($result)){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $members[] = $member;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return $members;<br />
}<br />
&lt;br&gt;&lt;br&gt;<br />
&nbsp;&nbsp;&nbsp; DON'T FORGET TO DECLARE THE ARRAY. If you try to cycle through members after the function has been called and you don't declare the array first you will get a horribly (HORRIBLY!) ugly error in your page. Also, if you try to add the object into the members array inside the while condition instead of in the while loop, you will generate one extra empty space in the array due to the last iteration/check.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28554""></a>
  <div class="note">
   <strong class="user">spamme at aol dot com</strong>
   <a href="#28554" class="date">16-Jan-2003 12:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is probably a little more elegant:<br />
<br />
$sql = "SELECT * FROM table ";<br />
$result = mysql_query($sql);<br />
<br />
$data = array();<br />
<br />
while ($row = mysql_fetch_object($result))<br />
&nbsp;&nbsp; $data[] = $row;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26973""></a>
  <div class="note">
   <strong class="user">allen at brooker dot gb dot net</strong>
   <a href="#26973" class="date">19-Nov-2002 04:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found the above code to be buggy, not adding all the records to the array. This is the code I used instead:<br />
<br />
&nbsp; $command = "SELECT * FROM table ";<br />
&nbsp; $result = mysql_query($command, $link_id);<br />
&nbsp; $num = mysql_num_rows($result);<br />
<br />
&nbsp; $clickthru = array();<br />
<br />
&nbsp; for ($i = 0; $i &lt;= $num; $i++) {<br />
&nbsp;&nbsp;&nbsp; $clickthru[$i] = array();<br />
&nbsp;&nbsp;&nbsp; $clickthru[$i] = mysql_fetch_array($result);<br />
&nbsp; }<br />
<br />
Allen</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25225""></a>
  <div class="note">
   <strong class="user">Federico at Pomi dot net</strong>
   <a href="#25225" class="date">15-Sep-2002 07:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be carefull:<br />
the object returned will be a new/fresh object.<br />
<br />
You can't use this function to replace some attributes of an existing object keeping the old ones. <br />
<br />
Example:<br />
class person<br />
{<br />
&nbsp;&nbsp; var $name;<br />
&nbsp;&nbsp; var $surname;<br />
&nbsp;&nbsp; var $doh;<br />
<br />
function print()<br />
{<br />
&nbsp;&nbsp; print($name." ".$surname);<br />
}<br />
<br />
function get_from_db()<br />
{<br />
&nbsp;&nbsp; $res=query("select name, surname from ppl where... limit 1");<br />
&nbsp;&nbsp; $this=mysql-fetch-object($res);<br />
}<br />
<br />
}<br />
<br />
This won't work! When the method get_from_db() is executed, your old object will be destroyed... you won't find anything in the attribute $doh, and if you'll try to call the method print(), it will say it doesn't exist.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
