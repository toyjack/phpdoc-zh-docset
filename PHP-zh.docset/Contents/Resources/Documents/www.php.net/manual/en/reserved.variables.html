<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>预定义变量</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.references.spot.html">? 引用定位</a></li>
      <li style="float: right;"><a href="language.variables.superglobals.html">超全局变量 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="langref.html">语言参考</a></li>
    <li>预定义变量</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="reserved.variables" class="reference">
 <h1 class="title">预定义变量</h1>

 <div class="partintro">

  <p class="para">
   对于全部脚本而言，PHP 提供了大量的预定义变量。这些变量将所有的<a href="language.variables.external.html" class="link">外部变量</a>表示成内建环境变量，并且将错误信息表示成返回头。
  </p>

 </div>

 




 



 




 



 





 


 




 



 




 



 




 



 




 



 




 



 




 



 




 



 




 



 




 



 




 



 





 




<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="language.variables.superglobals.html">超全局变量</a> &mdash; 在全部作用域中始终可用的内置变量</li><li><a href="reserved.variables.globals.html">$GLOBALS</a> &mdash; 引用全局作用域中可用的全部变量</li><li><a href="reserved.variables.server.html">$_SERVER</a> &mdash; 服务器和执行环境信息</li><li><a href="reserved.variables.get.html">$_GET</a> &mdash; HTTP GET 变量</li><li><a href="reserved.variables.post.html">$_POST</a> &mdash; HTTP POST 变量</li><li><a href="reserved.variables.files.html">$_FILES</a> &mdash; HTTP 文件上传变量</li><li><a href="reserved.variables.request.html">$_REQUEST</a> &mdash; HTTP Request 变量</li><li><a href="reserved.variables.session.html">$_SESSION</a> &mdash; Session 变量</li><li><a href="reserved.variables.environment.html">$_ENV</a> &mdash; 环境变量</li><li><a href="reserved.variables.cookies.html">$_COOKIE</a> &mdash; HTTP Cookies</li><li><a href="reserved.variables.phperrormsg.html">$php_errormsg</a> &mdash; 前一个错误信息</li><li><a href="reserved.variables.httpresponseheader.html">$http_response_header</a> &mdash; HTTP 响应头</li><li><a href="reserved.variables.argc.html">$argc</a> &mdash; 传递给脚本的参数数目</li><li><a href="reserved.variables.argv.html">$argv</a> &mdash; 传递给脚本的参数数组</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="102926""></a>
  <div class="note">
   <strong class="user">dusted at dusted dot dk</strong>
   <a href="#102926" class="date">15-Mar-2011 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use HTTP_X_FORWARDED_FOR because my webserver is behind a reverse proxy.<br />
This can be made secure:<br />
Configure the reverse proxy to block this field, and override it correctly.<br />
Configure the apache server to only accept incoming connections from the reverse proxy.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98485""></a>
  <div class="note">
   <strong class="user">autofei at gmail dot com</strong>
   <a href="#98485" class="date">17-Jun-2010 05:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you try to run php through command line, for example: php.exe c:\AppServ\www\cron_cache.php. You better avoid to use $_SERVER['DOCUMENT_ROOT'], because it will return nothing. Instead, you can use dirname(__FILE__). The reason to use command line running php is set it as Windows Scheduled Tasks. I did not test under Linux environment, but might be same.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81059""></a>
  <div class="note">
   <strong class="user">spamtrap at scottydm dot com</strong>
   <a href="#81059" class="date">12-Feb-2008 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was a little frustrated by the fact that some of the _SERVER variables didn't seem to exist, so I did a bit of Googling and found the answer: many of these variables are supplied by the web server and not all web servers supply the same set of variables.<br />
<br />
I found a comparison between Apache v1.3.29 and IIS v5.1 on this page: <a href="http://koivi.com/apache-iis-php-server-array.php Useful for those of us doing cross-platform development." rel="nofollow" target="_blank">http://koivi.com/apache-iis-php-server-array.php Useful for those of us doing cross-platform development.</a><br />
<br />
While running experiments with different browsers I noticed some of the HTTP_* variables come and go depending on the browser used, or in the case of Opera by diddling the "user mode" (the widget that lets you look at a page as text only, etc.). For example: in IE and Opera HTTP_KEEP_ALIVE was missing, but was present in Firefox and Mozilla, and when I fiddled with Opera's "user mode" I got somethings called HTTP_TE and HTTP_CACHE_CONTROL.<br />
<br />
So, what you get is dependent on the web server AND the browser.<br />
<br />
I did see one IIS supplied variable not on that list: REQUEST_TIME, which seems to be in Unix timestamp format.<br />
<br />
While researching this I discovered there are plenty of people who have their phpinfo() page visible and indexed on a few search engines. For those who want to dig a bit deeper than that nice web page comparing Apache to IIS, looking at other peoples' phpinfo() pages could be useful. You get the version of PHP plus OS and web server they use, along with all the _SERVER variables. I found the highest percent of signal-to-noise by searching for "phpinfo()" (with the quotes) on Dogpile: <a href="http://www.dogpile.com/" rel="nofollow" target="_blank">http://www.dogpile.com/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79811""></a>
  <div class="note">
   <strong class="user">php-net dot ucn dot extranet dot sys at dark-chiaki dot net</strong>
   <a href="#79811" class="date">13-Dec-2007 08:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In addition to mfyahya at gmail dot com (2007-06-07 03:33):<br />
<br />
If You are working with the Apache module mod_rewrite and want to set some environment vars, the Apache manual says this vars could be accessed in CGI using $ENV{VAR}. In PHP You might want to write $_ENV['VAR'] to get the value of VAR, but You have to access if via $_SERVER, and in some different ways:<br />
<br />
1. Example: .htaccess and example.php<br />
<br />
RewriteEngine on<br />
RewriteRule ^?var1=([^;]*);var2=([^;]*)$ \<br />
&nbsp;- [E=VAR1:$1,E=VAR2:$2]<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">echo(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'VAR1'</span><span class="keyword">].</span><span class="string">"\r\n"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">.</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'VAR2'</span><span class="keyword">]); </span><span class="default">?&gt;<br />
</span><br />
2. Example: .htaccess and index.php<br />
<br />
RewriteEngine on<br />
RewriteRule ^index\.php$ - [L]<br />
RewriteRule ?var1=([^;]*);var2=([^;]*)$ \<br />
&nbsp;index.php [E=VAR1:$1,E=VAR2:$2]<br />
<br />
<span class="default">&lt;?php </span><span class="keyword">echo(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REDIRECT_VAR1'</span><span class="keyword">].</span><span class="string">"\r\n"<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">.</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REDIRECT_VAR2'</span><span class="keyword">]); </span><span class="default">?&gt;<br />
</span><br />
Note: If any RewriteRule matches, an internal redirect than restarts (after the last defined rule, or immediately after the matched rule having a L-flag) checking the entire rule set again. For an internal redirect every defined VAR gets an 'REDIRECT_' prefix, i.e. VAR1 will be REDIRECT_VAR1, VAR2 will be REDIRECT_VAR2.<br />
<br />
Of course, You can (additionally) redefine the original VAR:<br />
<br />
RewriteEngine on<br />
RewriteRule ^index\.php$ \<br />
&nbsp;- [E=VAR1:%{REDIRECT_VAR1},E=VAR2:%{REDIRECT_VAR2},L]<br />
RewriteRule ?var1=([^;]*);var2=([^;]*)$ \<br />
&nbsp;index.php [E=VAR1:$1,E=VAR2:$2]<br />
<br />
With this, You will have $_SERVER['REDIRECT_VAR*'] -and- $_SERVER['VAR*'].<br />
<br />
***<br />
<br />
The given examples are only for explanation, in any case they are not intended to fit Your needs. The "\&lt;CRLF&gt;&lt;SP&gt;" in the .htaccess examples are only for display purpose, they should not occur in a real .htaccess file. The argument separator ';' in links can also be '&amp;', but this may cause some trouble with HTML/XHTML. See the following pages for more information about this issue:<br />
- <a href="http://www.w3.org/TR/html4/appendix/notes.html#h-B.2.2" rel="nofollow" target="_blank">http://www.w3.org/TR/html4/appendix/notes.html#h-B.2.2</a><br />
- <a href="http://www.w3.org/QA/2005/04/php-session" rel="nofollow" target="_blank">http://www.w3.org/QA/2005/04/php-session</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79359""></a>
  <div class="note">
   <strong class="user">Nicolae Namolovan</strong>
   <a href="#79359" class="date">22-Nov-2007 11:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
SECURITY RISK !<br />
<br />
Never ever trust the values that comes from $_SERVER.<br />
<br />
HTTP_X_FORWARDED, HTTP_X_FORWARDED_FOR, HTTP_FORWARDED_FOR, HTTP_FORWARDED, etc.. can be spoofed !<br />
<br />
To get the ip of user, use only $_SERVER['REMOTE_ADDR'], otherwise the 'ip' of user can be easily changed by sending a HTTP_X_* header, so user can escape a ban or spoof a trusted ip.<br />
<br />
Of course this is well know, but I don't see it mentioned in these notes..<br />
<br />
If you use the ip only for tracking (not for any security features like banning or allow access to something by ip), you can also use HTTP_X_FORWARDED to get user's ip what are behind proxy.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78628""></a>
  <div class="note">
   <strong class="user">jsan</strong>
   <a href="#78628" class="date">19-Oct-2007 12:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@White-Gandalf: one can control this behavior by setting:<br />
<br />
UseCanonicalName On|Off<br />
<br />
in their apache config (at least, on *ix platforms).<br />
<br />
On =&gt; $_SERVER['SERVER_NAME'] is the ServerName var from either the global server or virtual host, whichever wraps the PHP app closest.<br />
<br />
Off =&gt; Whatever was in the Host: header sent by the client.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74040""></a>
  <div class="note">
   <strong class="user">danvasile at pentest dot ro</strong>
   <a href="#74040" class="date">21-Mar-2007 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have problems with $_SERVER['HTTPS'], especially if it returns no values at all you should check the results of phpinfo(). It might not be listed at all. <br />
Here is a solution to check and change, if necessary, to ssl/https that will work in all cases:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SERVER_PORT'</span><span class="keyword">]!=</span><span class="default">443</span><span class="keyword">) {<br />
</span><span class="default">$sslport</span><span class="keyword">=</span><span class="default">443</span><span class="keyword">; </span><span class="comment">//whatever your ssl port is<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="string">"https://"</span><span class="keyword">. </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SERVER_NAME'</span><span class="keyword">] . </span><span class="string">":" </span><span class="keyword">. </span><span class="default">$sslport </span><span class="keyword">. </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'REQUEST_URI'</span><span class="keyword">];<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Location: </span><span class="default">$url</span><span class="string">"</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Of course, this should be done before any html tag or php echo/print.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72572""></a>
  <div class="note">
   <strong class="user">Joe Marty</strong>
   <a href="#72572" class="date">24-Jan-2007 11:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I think it is very important to note that PHP will automatically replace dots ('.') AND spaces (' ') with underscores ('_') in any incoming POST or GET (or REQUEST) variables.<br />
<br />
This page notes the dot replacement, but not the space replacement:<br />
<a href="http://us2.php.net/manual/en/language.variables.external.php" rel="nofollow" target="_blank">http://us2.php.net/manual/en/language.variables.external.php</a><br />
<br />
The reason is that '.' and ' ' are not valid characters to use in a variable name.&nbsp; This is confusing to many people, because most people use the format $_POST['name'] to access these values.&nbsp; In this case, the name is not used as a variable name but as an array index, in which those characters are valid.<br />
<br />
However, if the register_globals directive is set, these names must be used as variable names.&nbsp; As of now, PHP converts the names for these variables before inserting them into the external variable arrays, unfortunately - rather than leaving them as they are for the arrays and changing the names only for the variables set by register_globals.<br />
<br />
If you want to use:<br />
&lt;input name="title for page3.php" type="text"&gt;<br />
<br />
The value you will get in your POST array, for isntance would be:<br />
$_POST['title_for_page3_php']</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65690""></a>
  <div class="note">
   <strong class="user">jameslporter at gmail dot com</strong>
   <a href="#65690" class="date">05-May-2006 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Refer to CanonicalName if you are not getting the ServerName in the $_SERVER[SERVER_NAME] variable....This was a pain to figure out for me...now it works as expected by turning canonical naming on.<br />
<br />
<a href="http://www.apacheref.com/ref/http_core/UseCanonicalName.html" rel="nofollow" target="_blank">http://www.apacheref.com/ref/http_core/UseCanonicalName.html</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64443""></a>
  <div class="note">
   <strong class="user">Ben XO</strong>
   <a href="#64443" class="date">14-Apr-2006 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
So you have an application in your web space, with a URL such as this:<br />
<br />
<a href="http://&lt;host&gt;/&lt;installation_path&gt;/" rel="nofollow" target="_blank">http://&lt;host&gt;/&lt;installation_path&gt;/</a><br />
<br />
and pages such as<br />
<br />
<a href="http://&lt;host&gt;/&lt;installation_path&gt;/subfolder1/subfolder2/page.php" rel="nofollow" target="_blank">http://&lt;host&gt;/&lt;installation_path&gt;/subfolder1/subfolder2/page.php</a><br />
<br />
You have a file called config.php in &lt;installation_path&gt; which is include()d by all pages (in subfolders or not).<br />
<br />
How to work out &lt;installation_path&gt; without hard-coding it into a config file? <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// this is config.php, and it is in &lt;installation_path&gt;<br />
// it is included by &lt;installation_path&gt;/page.php<br />
// it is included by &lt;installation_path&gt;/subfolder/page2.php<br />
// etc<br />
<br />
</span><span class="default">$_REAL_SCRIPT_DIR </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_FILENAME'</span><span class="keyword">])); </span><span class="comment">// filesystem path of this page's directory (page.php)<br />
</span><span class="default">$_REAL_BASE_DIR </span><span class="keyword">= </span><span class="default">realpath</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)); </span><span class="comment">// filesystem path of this file's directory (config.php)<br />
</span><span class="default">$_MY_PATH_PART </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$_REAL_SCRIPT_DIR</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$_REAL_BASE_DIR</span><span class="keyword">)); </span><span class="comment">// just the subfolder part between &lt;installation_path&gt; and the page<br />
<br />
</span><span class="default">$INSTALLATION_PATH </span><span class="keyword">= </span><span class="default">$_MY_PATH_PART<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">? </span><span class="default">substr</span><span class="keyword">( </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_NAME'</span><span class="keyword">]), </span><span class="default">0</span><span class="keyword">, -</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$_MY_PATH_PART</span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; : </span><span class="default">dirname</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_NAME'</span><span class="keyword">])<br />
; </span><span class="comment">// we subtract the subfolder part from the end of &lt;installation_path&gt;, leaving us with just &lt;installation_path&gt; :)<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63888""></a>
  <div class="note">
   <strong class="user">todd dot kisov at yahoo dot com</strong>
   <a href="#63888" class="date">03-Apr-2006 02:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To convert query string parameter values ($_GET, $_REQUEST), which include escaped Unicode values resulting from applying the JavaScript "escape" function to a Unicode string (%uNNNN%uNNNN%uNNNN) fast and simple is to use PECL JSON extension:<br />
<br />
function JavaScript_Unicode_URL_2_Str($js_uni_str) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res = preg_replace('/%u([[:alnum:]]{4})/', '\\u\1', $js_uni_str);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res = str_replace('"', '\"', $res); // if in str "<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res = json_decode('["'.$res.'"]'); // JavaScrip array with string element<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res = $res[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res = iconv('UTF-8', ini_get('default_charset'), $res);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $res;<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63831""></a>
  <div class="note">
   
   <a href="#63831" class="date">31-Mar-2006 09:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was unable to convince my hosting company to change their installation of PHP and therefore had to find my own way to computer $_SERVER["DOCUMENT_ROOT"].&nbsp; I eventually settled on the following, which is a combination of earlier notes (with some typos corrected):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if ( ! isset(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">] ) )<br />
&nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'DOCUMENT_ROOT'</span><span class="keyword">] = </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'SCRIPT_FILENAME'</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">]) ) );<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62708""></a>
  <div class="note">
   <strong class="user">Aardvark</strong>
   <a href="#62708" class="date">07-Mar-2006 01:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
$_GET may not handle query string parameter values which include escaped Unicode values resulting from applying the JavaScript "escape" function to a Unicode string.<br />
To handle this the query parameter value can be obtained&nbsp; using a function such as:<br />
<br />
function getQueryParameter ($strParam) {<br />
&nbsp; $aParamList = explode('&amp;', $_SERVER['QUERY_STRING']);<br />
&nbsp; $i = 0;<br />
&nbsp; while ($i &lt; count($aParamList)) {<br />
&nbsp;&nbsp;&nbsp; $aParam = split('=', $aParamList[$i]);<br />
&nbsp;&nbsp;&nbsp; if ($strParam == $aParam[0]) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return $aParam[1];<br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp; }<br />
&nbsp; return "";<br />
}<br />
<br />
or by directly building an array or query string values and then processing the parameter string using a function such as the "unescape" function which can be found at <a href="http://www.kanolife.com/escape/2006/03/unicode-url-escapes-in-php.html (or http://www.kanolife.com/escape/ for related info" rel="nofollow" target="_blank">http://www.kanolife.com/escape/2006/03/unicode-url-escapes-in-php.html (or http://www.kanolife.com/escape/ for related info</a>).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62441""></a>
  <div class="note">
   <strong class="user">justin dot (nospam)george at gmail dot com</strong>
   <a href="#62441" class="date">28-Feb-2006 12:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that it's a very, very bad idea to append to global variables in a loop, unless you really, really mean to do so in a global context. I just a while ago hung my server with a snippet of code like this:<br />
<br />
<span class="default">&lt;?php<br />
$host&nbsp; </span><span class="keyword">= </span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'HTTP_HOST'</span><span class="keyword">];<br />
</span><span class="default">$uri&nbsp; </span><span class="keyword">= </span><span class="default">rtrim</span><span class="keyword">(</span><span class="default">$_SERVER</span><span class="keyword">[</span><span class="string">'PHP_SELF'</span><span class="keyword">], </span><span class="string">"/\\"</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; <br />
</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'SITE_ROOT'</span><span class="keyword">] = </span><span class="string">"<a href="http://" rel="nofollow" target="_blank">http://</a></span><span class="default">$host$uri</span><span class="string">"</span><span class="keyword">;<br />
<br />
while (</span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">somenumber</span><span class="keyword">)<br />
</span><span class="default">readfile</span><span class="keyword">(</span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'SITE_ROOT'</span><span class="keyword">] = </span><span class="default">$GLOBALS</span><span class="keyword">[</span><span class="string">'SITE_ROOT'</span><span class="keyword">] . </span><span class="string">'/this/file.php'</span><span class="keyword">);<br />
</span><span class="default">$i</span><span class="keyword">++<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
While it is an entertaining and unusual method of creating very long URLs and breaking servers, it's a pretty awesomely bad idea <br />
<br />
(Especially considering that the script in question ran concurrently with others of it's type, so the value in $GLOBALS['SITE_ROOT'] was unknown.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62214""></a>
  <div class="note">
   <strong class="user">nathan</strong>
   <a href="#62214" class="date">22-Feb-2006 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Also on using IPs to look up country &amp; city, note that what you get might not be entirely accurate.&nbsp; If their ISP is based in a different city or province/state, the IPs may be owned by the head office, and used across several areas.&nbsp; <br />
You also have rarer situations where they might be SSHed into another server, on the road, at work, at a friend's...&nbsp; It's a nice idea, but as the example code shows, it should only be used to set defaults.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57325""></a>
  <div class="note">
   <strong class="user">drew dot griffiths at clare dot net</strong>
   <a href="#57325" class="date">30-Sep-2005 08:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Re: You can take advantage of 404 error to an usable redirection using REQUEST_URI ...<br />
<br />
Whilst this is effective, a line in the .htaccess such as:<br />
<br />
RewriteEngine On<br />
RewriteRule ^profiles/([A-Za-z0-9-]+) showprofile.php?profile=$1 [L,NC,QSA]<br />
<br />
will throw the requested profile in a variable $profile to the showprofile.php page.&nbsp; <br />
<br />
You can further enhance the url (e.g <a href="http://servername/profiles/Jerry/homeaddress/index.htm" rel="nofollow" target="_blank">http://servername/profiles/Jerry/homeaddress/index.htm</a>) and the second variable value homeaddress becomes available in $url_array[3] when used below $url_array=explode("/",$_SERVER['REQUEST_URI']);&nbsp;&nbsp; <br />
<br />
Hope this helps - Works well for me<br />
<br />
Drew</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55337""></a>
  <div class="note">
   <strong class="user">Gregory Boshoff</strong>
   <a href="#55337" class="date">31-Jul-2005 02:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
$_SERVER['QUERY_STRING'] <br />
<br />
Does not contain XHTML 1.1 compliant ampersands i.e. &amp;amp;<br />
<br />
So you will need to do something like this if you are to use $_SERVER['QUERY_STRING'] in URL's.<br />
<br />
//&nbsp; XHTML 1.1 compliant ampersands <br />
$_SERVER['QUERY_STRING'] = <br />
str_replace(array('&amp;amp;', '&amp;'), array('&amp;', '&amp;amp;'), <br />
$_SERVER['QUERY_STRING']);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55068""></a>
  <div class="note">
   <strong class="user">New York PHP</strong>
   <a href="#55068" class="date">24-Jul-2005 06:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning: $_SERVER['PHP_SELF'] can include arbitrary user input. The documentation should be updated to reflect this.<br />
<br />
The request "<a href="http://example.com/info.php/attack%20here" rel="nofollow" target="_blank">http://example.com/info.php/attack%20here</a>" will run /info.php, but in Apache $_SERVER['PHP_SELF'] will equal "/info.php/attack here". This is a feature, but it means that PHP_SELF must be treated as user input.<br />
<br />
The attack string could contain urlencoded HTML and JavaScript (cross-site scripting) or it could contain urlencoded linebreaks (HTTP response-splitting).<br />
<br />
The use of $_SERVER['SCRIPT_NAME'] is recommended instead.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54825""></a>
  <div class="note">
   <strong class="user">daniel at softel dot jp</strong>
   <a href="#54825" class="date">15-Jul-2005 11:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that $php_errormsg may contain a newline character. This can be problematic if you are trying to output it with a JavaScript "alert()" for example.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53617""></a>
  <div class="note">
   <strong class="user">mfyahya at gmail dot com</strong>
   <a href="#53617" class="date">07-Jun-2005 06:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use Apache's redirection features for custom error pages or whatever, the following Apache's REDIRECT variables are also available in $_SERVER:<br />
$_SERVER['REDIRECT_UNIQUE_ID]' <br />
$_SERVER['REDIRECT_SCRIPT_URL]' <br />
$_SERVER['REDIRECT_SCRIPT_URI]' <br />
$_SERVER['REDIRECT_SITE_ROOT]' <br />
$_SERVER['REDIRECT_SITE_HTMLROOT]' <br />
$_SERVER['REDIRECT_SITE_CGIROOT]' <br />
$_SERVER['REDIRECT_STATUS]' <br />
$_SERVER['REDIRECT_QUERY_STRING]' <br />
$_SERVER['REDIRECT_URL]' <br />
<br />
I'm not sure if this is a complete list though</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49964""></a>
  <div class="note">
   <strong class="user">Gregory Boshoff</strong>
   <a href="#49964" class="date">13-Feb-2005 04:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The Environment variable $ENV is useful for coding portable platform specific application constants. <br />
<br />
// Define a Windows or else Linux root directory path<br />
$_ENV['OS'] == 'Windows_NT' ? $path = 'L:\\www\\' : $path = ' /var/www/';<br />
<br />
define('PATH', $path);<br />
<br />
echo PATH;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49316""></a>
  <div class="note">
   <strong class="user">marcus at lastcraft dot com</strong>
   <a href="#49316" class="date">23-Jan-2005 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The variable $php_errormsg is not populated if you have XDebug running.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46658""></a>
  <div class="note">
   <strong class="user">mrnopersonality at yahoo dot com</strong>
   <a href="#46658" class="date">19-Oct-2004 08:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Nothing about the message-body ...<br />
<br />
You can get cookies, session variables, headers, the request-uri , the request method, etc but not the message body. You may want it sometimes when your page is to be requested with the POST method.<br />
<br />
Maybe they should have mentioned $HTTP_RAW_POST_DATA or php://stdin</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41295""></a>
  <div class="note">
   <strong class="user">youdontmeanmuch [at] yahoo.com</strong>
   <a href="#41295" class="date">05-Apr-2004 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be carful when using $_SERVER['DOCUMENT_ROOT']; in your applications where you want to distribute them to other people with different server types. It isnt always supported by the webserver (IIS).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37982""></a>
  <div class="note">
   <strong class="user">josh,endquote,com</strong>
   <a href="#37982" class="date">03-Dec-2003 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Running PHP 4.3 under IIS 5 on Windows XP, there is no $_SERVER['REQUEST_URI'] variable. This seems to fix it:<br />
<br />
if(!isset($_SERVER['REQUEST_URI'])) {<br />
&nbsp;&nbsp;&nbsp; $_SERVER['REQUEST_URI'] = substr($_SERVER['argv'][0], strpos($_SERVER['argv'][0], ';') + 1);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
