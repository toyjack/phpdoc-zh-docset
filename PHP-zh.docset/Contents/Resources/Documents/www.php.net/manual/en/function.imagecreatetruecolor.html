<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>新建一个真彩色图像</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imagecreatefromxpm.html">? imagecreatefromxpm</a></li>
      <li style="float: right;"><a href="function.imagecrop.html">imagecrop ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.image.html">GD 和图像处理 函数</a></li>
    <li>新建一个真彩色图像</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imagecreatetruecolor" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imagecreatetruecolor</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.6, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">imagecreatetruecolor</span> &mdash; <span class="dc-title">新建一个真彩色图像</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.imagecreatetruecolor-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>imagecreatetruecolor</strong></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$width</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$height</code></span>
   ) : <span class="type">resource</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>imagecreatetruecolor()</strong></span> 返回一个图像标识符，代表了一幅大小为
   <code class="parameter">x_size</code> 和 <code class="parameter">y_size</code> 的黑色图像。
  </p>
  <p class="para">
   是否定义了本函数取决于 PHP 和 GD 的版本。从 PHP 4.0.6 到 4.1.x
   只要加载了 GD 模块本函数一直存在，但是在没有安装 GD2 的时候调用，PHP
   将发出致命错误并退出。在 PHP 4.2.x 中此行为改为发出警告而不是错误。其它版本只在安装了正确的
   GD 版本时定义了本函数。
  </p>
 </div>

 <div class="refsect1 parameters" id="refsect1-function.imagecreatetruecolor-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">width</code></dt>

     <dd>

      <p class="para">
       图像宽度。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">height</code></dt>

     <dd>

      <p class="para">
       图像高度。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.imagecreatetruecolor-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">成功后返回图象资源,失败后返回 <strong><code>FALSE</code></strong> 。</p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.imagecreatetruecolor-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-3722">
    <p><strong>Example #1 
     新建一个新的 GD 图像流并输出图像
    </strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />header&nbsp;</span><span style="color: #007700">(</span><span style="color: #DD0000">'Content-Type:&nbsp;image/png'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">=&nbsp;@</span><span style="color: #0000BB">imagecreatetruecolor</span><span style="color: #007700">(</span><span style="color: #0000BB">120</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;die(</span><span style="color: #DD0000">'Cannot&nbsp;Initialize&nbsp;new&nbsp;GD&nbsp;image&nbsp;stream'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$text_color&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">233</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">14</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">91</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagestring</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;&nbsp;</span><span style="color: #DD0000">'A&nbsp;Simple&nbsp;Text&nbsp;String'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$text_color</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagedestroy</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="mediaobject">
     
     <div class="imageobject">
      <img src="images/21009b70229598c6a80eef8b45bf282b-imagecreatetruecolor.png" alt="例子的输出： 新建一个新的 GD 图像流并输出图像" width="120" height="20" />
     </div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.imagecreatetruecolor-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数需要 GD 2.0.1 或更高版本(推荐 2.0.28 及更高版本)。</span></p></blockquote>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.imagecreatetruecolor-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.imagedestroy.html" class="function" rel="rdfs-seeAlso">imagedestroy()</a> - 销毁一图像</span></li>
    <li class="member"><span class="function"><a href="function.imagecreate.html" class="function" rel="rdfs-seeAlso">imagecreate()</a> - 新建一个基于调色板的图像</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115048""></a>
  <div class="note">
   <strong class="user">smcjones at gmail dot com</strong>
   <a href="#115048" class="date">18-May-2014 08:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please note that if you are receiving a warning about incorrect dimensions in PHP, it could be because your values are being stored as strings. You can use intval() to change a string value into an integer value which will pass the correct information into this function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113063""></a>
  <div class="note">
   <strong class="user">jessiedeer at hotmail dot com</strong>
   <a href="#113063" class="date">24-Aug-2013 05:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is no need to allocate colors with imagecreatetruecolor. All [256 x 256 x 256 x 128] true colors are already allocated, and you can use the color indexes directly.<br />
<br />
Examples :<br />
Blue =&gt; color index 255.<br />
White =&gt; color index 16777215 (= 255*2562 + 255*256+255).<br />
Full transparent =&gt; color index 2130706432 (= 127*256^3).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99623""></a>
  <div class="note">
   <strong class="user">arthur at kuhrmeier dot com</strong>
   <a href="#99623" class="date">26-Aug-2010 08:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
HOW THE CHECK THE MEMORY BEFORE CREATING AN IMAGE?<br />
<br />
I worked on a script where I delt with large images. Very often the error "out of memory" occured. So I had to figure out, how to check the memory BEFORE creating an image. I didn't find a solution on the web, so I ran my own test script. It built lots of images to compute the needed memory. I found out, that the formula mem = x * y * channel was not enough. There was an additional multiplier that varied. As a result 1.7 worked best. So the formula is: mem = x * y * channel * 1.7.<br />
<br />
I post this script here hoping it is useful to someone who will run into the same problems.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//-------------------------------------------------- DEFINE MAXMEM<br />
</span><span class="default">define </span><span class="keyword">(</span><span class="string">"MAXMEM"</span><span class="keyword">, </span><span class="default">32</span><span class="keyword">*</span><span class="default">1024</span><span class="keyword">*</span><span class="default">1024</span><span class="keyword">);&nbsp; </span><span class="comment">//--- memory limit (32M) ---<br />
<br />
//-------------------------------------------------- ENOUGH MEMORY ?<br />
</span><span class="keyword">function </span><span class="default">enoughmem </span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$rgb</span><span class="keyword">=</span><span class="default">3</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return ( </span><span class="default">$x </span><span class="keyword">* </span><span class="default">$y </span><span class="keyword">* </span><span class="default">$rgb </span><span class="keyword">* </span><span class="default">1.7 </span><span class="keyword">&lt; </span><span class="default">MAXMEM </span><span class="keyword">- </span><span class="default">memory_get_usage</span><span class="keyword">() );<br />
}<br />
<br />
</span><span class="comment">//-------------------------------------------------- SIMPLE EXAMPLE<br />
</span><span class="keyword">list (</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">) = @</span><span class="default">getimagesize </span><span class="keyword">(</span><span class="string">'your_img.jpg'</span><span class="keyword">);&nbsp; </span><span class="comment">//--- get size of img ---<br />
</span><span class="keyword">if (</span><span class="default">enoughmem</span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= @</span><span class="default">imagecreatefromjpeg </span><span class="keyword">(</span><span class="string">'your_img.jpg'</span><span class="keyword">);&nbsp; </span><span class="comment">//--- open img file ---<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$thumb </span><span class="keyword">= </span><span class="default">200</span><span class="keyword">;&nbsp; </span><span class="comment">//--- max. size of thumb ---<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$x </span><span class="keyword">&gt; </span><span class="default">$y</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tx </span><span class="keyword">= </span><span class="default">$thumb</span><span class="keyword">;&nbsp; </span><span class="comment">//--- landscape ---<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ty </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$thumb </span><span class="keyword">/ </span><span class="default">$x </span><span class="keyword">* </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tx </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$thumb </span><span class="keyword">/ </span><span class="default">$y </span><span class="keyword">* </span><span class="default">$x</span><span class="keyword">);&nbsp; </span><span class="comment">//--- portrait ---<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ty </span><span class="keyword">= </span><span class="default">$thumb</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">enoughmem</span><span class="keyword">(</span><span class="default">$tx</span><span class="keyword">,</span><span class="default">$ty</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thb </span><span class="keyword">= </span><span class="default">imagecreatetruecolor </span><span class="keyword">(</span><span class="default">$tx</span><span class="keyword">, </span><span class="default">$ty</span><span class="keyword">);&nbsp; </span><span class="comment">//--- create thumbnail ---<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecopyresampled </span><span class="keyword">(</span><span class="default">$thb</span><span class="keyword">,</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">$tx</span><span class="keyword">,</span><span class="default">$ty</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagejpeg </span><span class="keyword">(</span><span class="default">$thb</span><span class="keyword">, </span><span class="string">'your_thumbnail.jpg'</span><span class="keyword">, </span><span class="default">80</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy </span><span class="keyword">(</span><span class="default">$thb</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagedestroy </span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">//--------------------------------------------------<br />
//--- to check the memory working with&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ---<br />
//--- b/w-image or gif use:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ---<br />
//--------------------------------------------------<br />
</span><span class="default">$check </span><span class="keyword">= </span><span class="default">enoughmem </span><span class="keyword">(</span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Taking the opportunity, I thank everyone here at php.net for the great manual and the useful user scripts.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91180""></a>
  <div class="note">
   <strong class="user">hemjesti at yahoo dot com</strong>
   <a href="#91180" class="date">28-May-2009 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I put this together - combining two of the examples and then generated the text dynamically. but, with this set up, i was able to get the transparent background working as well. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Set the content-type<br />
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: image/png'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Create the image<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">175</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">);<br />
</span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Create some colors<br />
</span><span class="default">$white </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
</span><span class="default">$grey </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">128</span><span class="keyword">, </span><span class="default">128</span><span class="keyword">, </span><span class="default">128</span><span class="keyword">);<br />
</span><span class="default">$black </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">$black</span><span class="keyword">);<br />
</span><span class="default">$trans_colour </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">127</span><span class="keyword">);<br />
</span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$trans_colour</span><span class="keyword">);<br />
<br />
</span><span class="comment">// The text to draw<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'text'</span><span class="keyword">];<br />
</span><span class="comment">// Replace path by your own font path<br />
</span><span class="default">$font </span><span class="keyword">= </span><span class="string">'catriel regular.ttf'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Add some shadow to the text<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">13</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">, </span><span class="default">$black</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Add the text<br />
</span><span class="default">imagettftext</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">9</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">12</span><span class="keyword">, </span><span class="default">15</span><span class="keyword">, </span><span class="default">$white</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Using imagepng() results in clearer text compared with imagejpeg()<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81699""></a>
  <div class="note">
   <strong class="user">weareexit at yahoo dot co dot uk</strong>
   <a href="#81699" class="date">10-Mar-2008 03:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to place an image on a larger canvas you've previously created with imagecreatetruecolor(), but you don't want the default black background to surround it: use imagefill() AFTER imagecopyresampled().<br />
<br />
I have no idea why this should be the case, but it works!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75298""></a>
  <div class="note">
   <strong class="user">Richard Davey rich at corephp dot co dot uk</strong>
   <a href="#75298" class="date">22-May-2007 04:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to create a *transparent* PNG image, where the background is fully transparent, and all draw operations happen on-top of this, then do the following:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $png </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">800</span><span class="keyword">, </span><span class="default">600</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$png</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$trans_colour </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$png</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">127</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$png</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$trans_colour</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$red </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$png</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagefilledellipse</span><span class="keyword">(</span><span class="default">$png</span><span class="keyword">, </span><span class="default">400</span><span class="keyword">, </span><span class="default">300</span><span class="keyword">, </span><span class="default">400</span><span class="keyword">, </span><span class="default">300</span><span class="keyword">, </span><span class="default">$red</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$png</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
What you do is create a true colour image, make sure that the alpha save-state is on, then fill the image with a colour that has had its alpha level set to fully transparent (127).<br />
<br />
The resulting PNG from the code above will have a red circle on a fully transparent background (drag the image into Photoshop to see for yourself)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72993""></a>
  <div class="note">
   <strong class="user">phpnet at sjeiti dot com</strong>
   <a href="#72993" class="date">06-Feb-2007 02:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a small rectification for the msg by '<br />
thomas dot urban at toxa dot de' (23-May-2006 03:28) about transparency.<br />
Line 3 in the example returns a 'wrong parameter warning': 'imagecolorallocate' should be replaced by 'imagecolorallocatealpha'.<br />
(You better just alter that note and delete this one.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69207""></a>
  <div class="note">
   <strong class="user">behun at webconsult dot sk</strong>
   <a href="#69207" class="date">27-Aug-2006 01:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
imagecreatetruecolor() returns not only image identifier representing a black image of size x_size by y_size.<br />
<br />
imagecreatetruecolor() is called to create truecolor images, with an essentially unlimited number of colors (also not only 256 colors).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68299""></a>
  <div class="note">
   <strong class="user">Florin [ florin.at.flachi.dot.net ]</strong>
   <a href="#68299" class="date">21-Jul-2006 02:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A very simple and efficient way to create RGB color from hexadecimal (HTML) notation:<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">color_hex2dec </span><span class="keyword">(</span><span class="default">$color</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return array (</span><span class="default">hexdec </span><span class="keyword">(</span><span class="default">substr </span><span class="keyword">(</span><span class="default">$color</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)), </span><span class="default">hexdec </span><span class="keyword">(</span><span class="default">substr </span><span class="keyword">(</span><span class="default">$color</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)), </span><span class="default">hexdec </span><span class="keyword">(</span><span class="default">substr </span><span class="keyword">(</span><span class="default">$color</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; list (</span><span class="default">$r</span><span class="keyword">, </span><span class="default">$g</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">) = </span><span class="default">color_hex2dec </span><span class="keyword">(</span><span class="string">'FFEECC'</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68045""></a>
  <div class="note">
   <strong class="user">j.fenin _At_ seekport [d0t] biz</strong>
   <a href="#68045" class="date">11-Jul-2006 09:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a strange bug occurring under Debian Linux with PHP5.<br />
<br />
In file B (where I create the image) I included a file (file A). The image that was produced was always corrupt. When I did not include file A, everything was fine.<br />
<br />
After 2 hours of searching I found that there were some extra spaces and linefeeds after the PHP closing tag ?&gt; in file A. After removing those chars, everything works fine again.<br />
<br />
Obviously those extra bytes of file A were added to the image and corrupted it.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66975""></a>
  <div class="note">
   <strong class="user">d dot duquenoy at kdland dot org</strong>
   <a href="#66975" class="date">01-Jun-2006 01:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My function to know how much bytes imagecreate or imagecreatetruecolor require before using it.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getNeededMemoryForImageCreate</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$truecolor</span><span class="keyword">) {<br />
&nbsp; return </span><span class="default">$width</span><span class="keyword">*</span><span class="default">$height</span><span class="keyword">*(</span><span class="default">2.2</span><span class="keyword">+(</span><span class="default">$truecolor</span><span class="keyword">*</span><span class="default">3</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="66448""></a>
  <div class="note">
   <strong class="user">thomas dot urban at toxa dot de</strong>
   <a href="#66448" class="date">22-May-2006 06:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is another approach to get an initially transparent truecolor canvas and in comparison to the one below it does not declare black to be transparent (which might be okay on indexed-color images and unless you want to draw in black) ...<br />
<br />
$im = imagecreatetruecolor( $w, $h );<br />
imagealphablending( $im, false );<br />
$col = imagecolorallocate( $im, 0, 0, 0, 127 );<br />
imagefilledrectangle( $im, 0, 0, $w, $h, $col );<br />
imagealphablending( $im, true );<br />
<br />
Without disabling blending mode this would paint transparent rectangle over current background thus not changing anything. Nevertheless blending mode is required e.g. to get proper results from using imagettftext ... that's why it is enabled after filling, again.<br />
<br />
Don't miss to disable blending mode and enable savealpha prior to generating a PNG ...<br />
<br />
imagealphablending( $im, false );<br />
imagesavealpha( $im, true );<br />
imagepng( $im );</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54155""></a>
  <div class="note">
   <strong class="user">send at mail dot 2aj dot net</strong>
   <a href="#54155" class="date">24-Jun-2005 07:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want a simple way to mirror images, use the function I've included below.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">image_mirror </span><span class="keyword">(</span><span class="default">$input_image_resource</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagesx </span><span class="keyword">( </span><span class="default">$input_image_resource </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagesy </span><span class="keyword">( </span><span class="default">$input_image_resource </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output_image_resource </span><span class="keyword">= </span><span class="default">imagecreatetruecolor </span><span class="keyword">( </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; while ( </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$height </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ( </span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">$width</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++ )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel </span><span class="keyword">( </span><span class="default">$output_image_resource</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">imagecolorat </span><span class="keyword">( </span><span class="default">$input_image_resource</span><span class="keyword">, ( </span><span class="default">$i </span><span class="keyword">), ( </span><span class="default">$height </span><span class="keyword">- </span><span class="default">$y </span><span class="keyword">) ) );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$y </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$output_image_resource</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Example Usage:<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// A good use of this is when a user uploads a TGA file,<br />
// on the completion screen show the image and have a link<br />
// that asks if the image appears mirrored, and if so<br />
// that link will execute these commands below.<br />
<br />
// I suggest checking $HTTP_REFERER for security.<br />
<br />
// $_GET['file'] in this case would be something along the lines<br />
// of johndoe-img0001 (Basename is necessary to prevent <br />
// abuse of this script!)<br />
<br />
</span><span class="keyword">if ( isset( </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] ) )<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$filename </span><span class="keyword">= </span><span class="string">"./" </span><span class="keyword">. </span><span class="default">basename </span><span class="keyword">( </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'file'</span><span class="keyword">] ) . </span><span class="string">".jpg"</span><span class="keyword">;<br />
</span><span class="comment">// Making the image resource that needs to be mirrored<br />
// Taking it from a previously exported to JPEG file.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output_resource_image </span><span class="keyword">= </span><span class="default">image_mirror </span><span class="keyword">( </span><span class="default">imagecreatefromjpeg </span><span class="keyword">( </span><span class="default">$filename </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">imagejpeg </span><span class="keyword">( </span><span class="default">$output_resource_image</span><span class="keyword">, </span><span class="default">$filename</span><span class="keyword">, </span><span class="default">75 </span><span class="keyword">) )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Image resaved successfully"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Image couldn't be written over (Check permissions)!"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54025""></a>
  <div class="note">
   
   <a href="#54025" class="date">21-Jun-2005 03:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// Creates a transparent image rather than the default black image<br />
function imageCreateTransparent($x, $y) { <br />
&nbsp;&nbsp;&nbsp; $imageOut = imagecreate($x, $y);<br />
&nbsp;&nbsp;&nbsp; $colourBlack = imagecolorallocate($imageOut, 0, 0, 0);<br />
&nbsp;&nbsp;&nbsp; imagecolortransparent($imageOut, $colourBlack);<br />
&nbsp;&nbsp;&nbsp; return $imageOut;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54010""></a>
  <div class="note">
   <strong class="user">send at mail dot 2aj dot net</strong>
   <a href="#54010" class="date">20-Jun-2005 06:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Thanks to OverFlow636 at gmail dot com and kuya1284 at techie dot com for their original coding which this function is based upon.<br />
<br />
PHP lacks an imagecreatefromtga function, so I have prepared a simple function to include in your library if you deal with TGA images. In addition to creating an image from TGA, it also, optionally, will output an array with the dimensions of the image because getimagesize() does not function with TGA files.<br />
<br />
Hopefully this function will eventually be unneeded if GD is ever updated to support the TGA format.<br />
<br />
Please keep in mind that TGA's come in many different compressions, color settings, and as a result this function will not work 100% of the time. Resulting images will fit the symptoms kuya1284 at techie dot com mentioned, and as a result you may need to create a second function. Keep in mind that using her code causes the "mirror" effect on images that load properly with the following function.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagecreatefromtga </span><span class="keyword">( </span><span class="default">$filename</span><span class="keyword">, </span><span class="default">$return_array </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$handle </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">( </span><span class="default">$filename</span><span class="keyword">, </span><span class="string">'rb' </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data </span><span class="keyword">= </span><span class="default">fread </span><span class="keyword">( </span><span class="default">$handle</span><span class="keyword">, </span><span class="default">filesize</span><span class="keyword">( </span><span class="default">$filename </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose </span><span class="keyword">( </span><span class="default">$handle </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pointer </span><span class="keyword">= </span><span class="default">18</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$w </span><span class="keyword">= </span><span class="default">base_convert </span><span class="keyword">( </span><span class="default">bin2hex </span><span class="keyword">( </span><span class="default">strrev </span><span class="keyword">( </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, </span><span class="default">12</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) ) ), </span><span class="default">16</span><span class="keyword">, </span><span class="default">10 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$h </span><span class="keyword">= </span><span class="default">base_convert </span><span class="keyword">( </span><span class="default">bin2hex </span><span class="keyword">( </span><span class="default">strrev </span><span class="keyword">( </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, </span><span class="default">14</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">) ) ), </span><span class="default">16</span><span class="keyword">, </span><span class="default">10 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">( </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; while ( </span><span class="default">$pointer </span><span class="keyword">&lt; </span><span class="default">strlen </span><span class="keyword">( </span><span class="default">$data </span><span class="keyword">) )<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel </span><span class="keyword">( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">base_convert </span><span class="keyword">( </span><span class="default">bin2hex </span><span class="keyword">( </span><span class="default">strrev </span><span class="keyword">( </span><span class="default">substr </span><span class="keyword">( </span><span class="default">$data</span><span class="keyword">, </span><span class="default">$pointer</span><span class="keyword">, </span><span class="default">3 </span><span class="keyword">) ) ), </span><span class="default">16</span><span class="keyword">, </span><span class="default">10 </span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x</span><span class="keyword">++;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$x </span><span class="keyword">== </span><span class="default">$w</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pointer </span><span class="keyword">+= </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$return_array </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return array ( </span><span class="default">$img</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$img</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Example Usage<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Get the image &amp; its dimensions<br />
</span><span class="default">$array </span><span class="keyword">= </span><span class="default">imagecreatefromtga</span><span class="keyword">(</span><span class="string">"source_image.tga"</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
<br />
</span><span class="comment">// the image ( resource image )<br />
</span><span class="default">$image </span><span class="keyword">= </span><span class="default">$array</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
<br />
</span><span class="comment">// its dimensions ( integers )<br />
</span><span class="default">$dimensions</span><span class="keyword">[</span><span class="string">'width'</span><span class="keyword">] = </span><span class="default">$array</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
</span><span class="default">$dimensions</span><span class="keyword">[</span><span class="string">'height'</span><span class="keyword">] = </span><span class="default">$array</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">];<br />
<br />
</span><span class="comment">// Delete the image resource array entry to free memory<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);<br />
</span><span class="default">?&gt;<br />
</span><br />
The second variable, $return_array is optional. If you simply want to load a TGA, leave the variable off the function's call as such:<br />
&lt;?<br />
// Return the resource image alone<br />
$resource_image = imagecreatefromtga ( "source_image.tga" );<br />
<br />
// Declare the content-type as a JPEG image.<br />
header ( 'Content-type: image/jpeg' );<br />
<br />
// Convert the image to JPEG for smaller file size and compatability<br />
imagejpeg ( $resource_image, NULL, 100 );<br />
imagedestroy ( $resource_image );<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50400""></a>
  <div class="note">
   <strong class="user">kuya1284 at techie dot com</strong>
   <a href="#50400" class="date">26-Feb-2005 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
OverFlow636, <br />
<br />
It appears that your code was causing TGA's to be inverted horizontally and upside down.&nbsp; I modified your code accordingly. The sample below is an example of what I did to convert a tga to jpg. The for loop was taken from the comment below (Eric Mulders) to properly render the image.<br />
<br />
Nice job with the code buddy.<br />
<br />
function tga2jpg ($image)<br />
{<br />
&nbsp;&nbsp;&nbsp; $handle = fopen($image, "rb");<br />
&nbsp;&nbsp;&nbsp; $data = fread($handle, filesize($image));<br />
&nbsp;&nbsp;&nbsp; fclose($handle);<br />
<br />
&nbsp;&nbsp;&nbsp; $pointer = 18;<br />
&nbsp;&nbsp;&nbsp; $w = fileint (substr ($data, 12, 2));<br />
&nbsp;&nbsp;&nbsp; $h = fileint (substr ($data, 14, 2));<br />
&nbsp;&nbsp;&nbsp; $x = 0;<br />
&nbsp;&nbsp;&nbsp; $y = $h;<br />
<br />
&nbsp;&nbsp;&nbsp; $img = imagecreatetruecolor($w, $h);<br />
<br />
&nbsp;&nbsp;&nbsp; while ($pointer &lt; strlen($data))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; imagesetpixel ($img, $x, $y, fileint (substr ($data, $pointer, 3)));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $x++;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($x == $w)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $y--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $x = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $pointer += 3;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for($a = 0; $a &lt; imagecolorstotal ($img); $a++) <br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $color = imagecolorsforindex ($img, $a); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $R=.299 * ($color['red'])+ .587 * ($color['green'])+ .114 * ($color['blue']); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $G=.299 * ($color['red'])+ .587 * ($color['green'])+ .114 * ($color['blue']); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $B=.299 * ($color['red'])+ .587 * ($color['green'])+ .114 * ($color['blue']); <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; imagecolorset ($img, $a, $R, $G, $B); <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; imagejpeg ($img, 'test.jpg', 100);<br />
&nbsp;&nbsp;&nbsp; imagedestroy ($img);<br />
}<br />
<br />
function fileint($str)<br />
{<br />
&nbsp;&nbsp;&nbsp; return base_convert (bin2hex (strrev ($str)), 16, 10);<br />
}<br />
<br />
tga2jpg ('test.tga');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48162""></a>
  <div class="note">
   <strong class="user">OverFlow636 at gmail dot com</strong>
   <a href="#48162" class="date">14-Dec-2004 12:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i dont know if there was an easyer way to do this, but heres my code to convert a .tga image to whatever you want to output it as<br />
it works with basic tga files only<br />
<br />
&lt;?<br />
$handle = fopen("xxx.tga","rb");<br />
$data = fread($handle,filesize("xxx.tga"));<br />
fclose($handle);<br />
$pointer = 18;<br />
$x = 0;<br />
$y = 0;<br />
$w = fileint(substr($data,12,2));<br />
$h = fileint(substr($data,14,2));<br />
$img = imagecreatetruecolor($w,$h);<br />
<br />
while ($pointer &lt; strlen($data))<br />
{<br />
imagesetpixel($img, $x,$y,fileint(substr($data,$pointer,3)));<br />
$x++;<br />
<br />
if ($x==$w)<br />
{<br />
$y++;<br />
$x=0;<br />
}<br />
<br />
$pointer += 3;<br />
}<br />
<br />
header("Content-type: image/jpeg");<br />
imagepng($img);<br />
imagedestroy($img);<br />
<br />
function fileint($str)<br />
{<br />
&nbsp; return base_convert(bin2hex(strrev($str)),16,10);<br />
}<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47917""></a>
  <div class="note">
   <strong class="user">termian</strong>
   <a href="#47917" class="date">05-Dec-2004 04:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
kai wrote:<br />
//using imagecolorallocate to specify the image's background<br />
//color does not work with truecolor-image.<br />
//<br />
//instead you have to use imagefill to force flood-filling the<br />
//image with the backgorund-color previously allocated:<br />
//<br />
//$bgColor = imagecolorallocate($img, 255,255,255);<br />
//imagefill($img , 0,0 , $bgColor);<br />
<br />
even this doesn't work for my configuration - fedora core2, php 4.3.8 + gd bundled (2.0.23 compatible) and I have to do this:<br />
$img = imagecreatetruecolor($x, $y);<br />
$bgColor = imagecolorallocate($img, 255,255,255);<br />
imagefilledrectangle($img, 0, 0, $x-1, $y-1, $bgColor);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46341""></a>
  <div class="note">
   <strong class="user">kai at meder dot info</strong>
   <a href="#46341" class="date">07-Oct-2004 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
using imagecolorallocate to specify the image's background color does not work with truecolor-image.<br />
<br />
instead you have to use imagefill to force flood-filling the image with the backgorund-color previously allocated:<br />
<br />
$bgColor = imagecolorallocate($img, 255,255,255);<br />
imagefill($img , 0,0 , $bgColor);<br />
<br />
kai</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="42645""></a>
  <div class="note">
   <strong class="user">unigram at byair dot net</strong>
   <a href="#42645" class="date">25-May-2004 02:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If your hosting system does not have imagecreatetruecolor() because of PHP&lt;4.2 and GD&lt;2.0 then a get around is<br />
<br />
&lt;?<br />
$thumb = imagecreate ($width, $height);<br />
imageJPEG($thumb,"images/temp.jpg");<br />
$thumb = @imagecreatefromjpeg("images/temp.jpg");<br />
?&gt;<br />
<br />
which creates a thumbnail of right size, saves as a jpeg and then reads it, in true color.<br />
<br />
This corrected the degradation caused by using palette images as destination for imagecopyresized ()</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38856""></a>
  <div class="note">
   <strong class="user">Justin Greer</strong>
   <a href="#38856" class="date">08-Jan-2004 08:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I know it's not a discussion board, but when incorrect info is posted, it should be corrected.<br />
<br />
The function_exists() check does not work correctly because if PHP is compiled with an older GD library, the imagecreatetruecolor() function still exists -- it just gives a fatal error when called, stating that GD2 is required.&nbsp; Therefore, the function_exists() method will fail on any new-ish copy of PHP that only has GD 1.x.&nbsp; (That includes most of the 4.1.x and 4.2.x installs I've seen.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="38553""></a>
  <div class="note">
   <strong class="user">fixxxer at php5 dot ru</strong>
   <a href="#38553" class="date">26-Dec-2003 05:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A note to post by Justin Greer @ 18-Nov-2003 10:40:<br />
<br />
While this information has already been posted by php at REMOVEreallynicejerk dot com @ 16-Sep-2002 12:01, I feel it neccesary to notice 'cause Justin's post is in the top and it can make people go the wrong way: Justin's way of detecting which imagecreate function to use is too complicated, while there's an easy standard way:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'imagecreatetruecolor'</span><span class="keyword">) {<br />
&nbsp;</span><span class="comment">// use imagecreatetruecolor<br />
</span><span class="keyword">} else {<br />
&nbsp;</span><span class="comment">// use imagecreate<br />
</span><span class="keyword">}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37523""></a>
  <div class="note">
   <strong class="user">Justin Greer</strong>
   <a href="#37523" class="date">18-Nov-2003 02:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Unfortunately the @imagecreatetruecolor() method doesn't even work because php dies with a fatal error noting that GD 2 is required.&nbsp; You can't even capture this error with a custom error handler.
<br />

<br />
I have come up with a function to get the GD version number that seems to work pretty well on every version of PHP and GD I've thrown at it (even CLI versions.)&nbsp; It's obviously not the most efficient thing in the world, but it does cache the result in a static variable so calling it multiple times doesn't slow down further.
<br />

<br />
function gd_version() {
<br />
&nbsp;&nbsp;&nbsp; static $gd_version_number = null;
<br />
&nbsp;&nbsp;&nbsp; if ($gd_version_number === null) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Use output buffering to get results from phpinfo() 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // without disturbing the page we're in.&nbsp; Output 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // buffering is "stackable" so we don't even have to 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // worry about previous or encompassing buffering.
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ob_start();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; phpinfo(8);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $module_info = ob_get_contents();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ob_end_clean();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (preg_match("/\bgd\s+version\b[^\d\n\r]+?([\d\.]+)/i",
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $module_info,$matches)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $gd_version_number = $matches[1];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $gd_version_number = 0;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return $gd_version_number;
<br />
}
<br />

<br />
Then you can simply use it something like this:
<br />

<br />
if (gd_version() &gt;= 2) {
<br />
&nbsp;&nbsp;&nbsp; $image = ImageCreateTrueColor($width, $height);
<br />
} else {
<br />
&nbsp;&nbsp;&nbsp; $image = ImageCreate($width, $height);
<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36915""></a>
  <div class="note">
   <strong class="user">Hallvord RM Steen &lt;phpnet at hallvord dot com&gt;</strong>
   <a href="#36915" class="date">27-Oct-2003 05:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding choosing the TrueColor or the plain version of imagecreate automatically, I've found that the following works for me:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$newImg</span><span class="keyword">=@</span><span class="default">ImageCreateTrueColor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) <br />
&nbsp;&nbsp;&nbsp; or </span><span class="default">$newImg</span><span class="keyword">=</span><span class="default">ImageCreate</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">); <br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33890""></a>
  <div class="note">
   <strong class="user">Jami</strong>
   <a href="#33890" class="date">10-Jul-2003 03:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's good to use the imagecopyresampled- function when creating thumbnails with true colors, it might look better than imagecopyresized..</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="32818""></a>
  <div class="note">
   <strong class="user">bjorntje at hotmail dot com</strong>
   <a href="#32818" class="date">07-Jun-2003 10:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I just fiddled around with Phpix, which had some problems using the GD lib 
<br />
(washed out colours). 
<br />
I changed the lines, which did the trick. 
<br />
Just in case some of you are still having problems and 
<br />
you can't change the PHP-install 
<br />
on the hosting side:
<br />

<br />
$im = ImageCreateFromJPEG($source); 
<br />
$new_im = ImageCreate($new_width,$new_height);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
ImageCopyResized($new_im,$im,0,0,0,0,
<br />
$new_width,$new_height,ImageSX($im),ImageSY($im)); 
<br />

<br />
TO
<br />

<br />
$im = ImageCreateFromJPEG($source); 
<br />
$new_im = ImageCreateTrueColor($new_width,$new_height);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
ImageCopyResized($new_im,$im,0,0,0,0,$new_width,
<br />
$new_height,ImageSX($im),ImageSY($im));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="30160""></a>
  <div class="note">
   <strong class="user">Micke (micke dot prag at newstonight dot net)</strong>
   <a href="#30160" class="date">08-Mar-2003 04:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is my solution for creating images with the same code for both GD &lt; 2 and GD &gt; 2:<br />
<br />
$dst_img = @imageCreateTrueColor($width, $height);<br />
if (!$dst_img) { $dst_img = imageCreate($width, $height); }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29912""></a>
  <div class="note">
   <strong class="user">Andreas from www.ems-p.de</strong>
   <a href="#29912" class="date">28-Feb-2003 06:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The request of gdlib from brad at brwebdesign dot com won't work with PHP &lt; 4.1 (version_compare).<br />
<br />
Some phpinfo versions offer the version number without space so you better ask for the dot:<br />
<br />
ob_start();<br />
phpinfo(8);<br />
$phpinfo=ob_get_contents();<br />
ob_end_clean();<br />
$phpinfo=strip_tags($phpinfo);<br />
$phpinfo=stristr($phpinfo,"gd version");<br />
$phpinfo=stristr($phpinfo,"version");<br />
$end=strpos($phpinfo,".");<br />
$phpinfo=substr($phpinfo,0,$end);<br />
$length = strlen($phpinfo)-1;<br />
$phpinfo=substr($phpinfo,$length);<br />
if($phpinfo&lt;2){<br />
&nbsp;&nbsp;&nbsp; $dst_img=ImageCreate($new_w,$new_h);}<br />
else {<br />
&nbsp;&nbsp;&nbsp; $dst_img=ImageCreateTrueColor($new_w,$new_h);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28822""></a>
  <div class="note">
   <strong class="user">marc at thewebguys dot com dot au</strong>
   <a href="#28822" class="date">24-Jan-2003 04:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I discovered when installing GD 2+ that ImageCreate() doesn't work well with JPEGS, it makes a true colour JPEG into a 16 colour mess when combining ImageCreateFromJPEG(). If you have GD 2+ you must use ImageCreateTrueColor() for things like thumbnails, etc.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28470""></a>
  <div class="note">
   <strong class="user">billet_jerome at yahoo dot fr</strong>
   <a href="#28470" class="date">14-Jan-2003 05:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Because imagecreatetruecolor exist both in gd and gd2,<br />
you can't use function_exists or get_extension_funcs to check for gd2 !<br />
But ... there is a difference in imagettfbbox between gd and gd2:<br />
gd use pixels and gd2 use points.<br />
<br />
Then you can check gd2 with this function:<br />
<br />
function sysB_chkgd2()<br />
{<br />
<br />
$rep=false;<br />
if(isset($GLOBALS["gBGDVersion"]))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; $rep=$GLOBALS["gBGDVersion"];<br />
&nbsp;&nbsp;&nbsp; }<br />
else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if(function_exists("gd_info"))<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; $gdver=gd_info();<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(strstr($gdver["GD Version"],"1.")!=false)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $rep=false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rep=true;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $size=40;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $font= your font file path here;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $b=imagettfbbox ($size,0,$font,"abcdefghijklmnopqrstuvwxyz<br />
ABCDEFGHIJKLMNOPQRSTUVWXYZ");<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(($size+1)&lt;abs($b[5]-$b[3]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $rep=true;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; $GLOBALS["gBGDVersion"]=$rep;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
return $rep;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25487""></a>
  <div class="note">
   <strong class="user">aaron at aaron-wright dot com</strong>
   <a href="#25487" class="date">25-Sep-2002 02:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Actually GD &lt;2.0 had imagecreattruecolor, it just didn't work :P<br />
<br />
This is a better test:<br />
<br />
function chkgd2(){<br />
&nbsp; $testGD = get_extension_funcs("gd"); // Grab function list<br />
&nbsp; if (!$testGD){ echo "GD not even installed."; exit; }<br />
&nbsp; if (in_array ("imagegd2",$testGD)) $gd_version = "&lt;2"; // Check<br />
&nbsp; if ($gd_version == "&lt;2") return false; else return true;<br />
}<br />
<br />
if (chkgd2()) echo "&lt;h1&gt;GD2+ is installed.&lt;/h1&gt;"; // Test for GD2<br />
else echo "&lt;h1&gt;GD2+ is not installed.&lt;/h1&gt;";</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25234""></a>
  <div class="note">
   <strong class="user">php at REMOVEreallynicejerk dot com</strong>
   <a href="#25234" class="date">15-Sep-2002 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Why not just use function_exists?&nbsp; <br />
<br />
<a href="http://www.php.net/function_exists" rel="nofollow" target="_blank">http://www.php.net/function_exists</a><br />
<br />
Just because they have version 2.0 GD doesn't mean that they haven't disabled that function.<br />
<br />
Also instead of determining which one you have on your machine and then writing setup specific code, you can write a universal code usable on either setups.<br />
<br />
::pseudo code::<br />
<br />
if (function_exists(imagecreatetruecolor)){<br />
use imagecreatetruecolor()<br />
}else{<br />
use imagecreate()<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="21761""></a>
  <div class="note">
   <strong class="user">brad at brwebdesign dot com</strong>
   <a href="#21761" class="date">25-May-2002 02:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I came up with this today.&nbsp; You need GD2.0 or greater to use imagecreatetruecolor so you can parse phpinfo to get the needed information.&nbsp; this will have to go at the very top of the page with no whitespace above it<br />
<br />
<span class="default">&lt;?php<br />
ob_start</span><span class="keyword">();<br />
</span><span class="default">phpinfo</span><span class="keyword">(</span><span class="default">8</span><span class="keyword">);<br />
</span><span class="default">$phpinfo</span><span class="keyword">=</span><span class="default">ob_get_contents</span><span class="keyword">();<br />
</span><span class="default">ob_end_clean</span><span class="keyword">();<br />
</span><span class="default">$phpinfo</span><span class="keyword">=</span><span class="default">strip_tags</span><span class="keyword">(</span><span class="default">$phpinfo</span><span class="keyword">);<br />
</span><span class="default">$phpinfo</span><span class="keyword">=</span><span class="default">stristr</span><span class="keyword">(</span><span class="default">$phpinfo</span><span class="keyword">,</span><span class="string">"gd version"</span><span class="keyword">);<br />
</span><span class="default">$phpinfo</span><span class="keyword">=</span><span class="default">stristr</span><span class="keyword">(</span><span class="default">$phpinfo</span><span class="keyword">,</span><span class="string">"version"</span><span class="keyword">);<br />
</span><span class="default">$end</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$phpinfo</span><span class="keyword">,</span><span class="string">" "</span><span class="keyword">);<br />
</span><span class="default">$phpinfo</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$phpinfo</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">);<br />
</span><span class="default">$phpinfo</span><span class="keyword">=</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$phpinfo</span><span class="keyword">,</span><span class="default">7</span><span class="keyword">);<br />
if(</span><span class="default">version_compare</span><span class="keyword">(</span><span class="string">"2.0"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$phpinfo</span><span class="string">"</span><span class="keyword">)==</span><span class="default">1</span><span class="keyword">)<br />
echo </span><span class="string">"you have a version less then 2"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The if statement is for PHP 4.1 or greater, but you can use other methods of comparing the version numbers if the server you are on do not have that version of php</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19385""></a>
  <div class="note">
   <strong class="user">pmas7354 at artax dot karlin dot mff dot cuni dot cz</strong>
   <a href="#19385" class="date">26-Feb-2002 05:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is answer for first question 'why do I need true color images'.<br />
<br />
True color images you need when you want to work with images such as photos (snapshots), video frames and so on.<br />
<br />
When you need to combine some these images for user, or to send him only small part of your image, and you try to use 256 colors, image will be ugly (try it if you want). Some colors will change dramatically.<br />
<br />
"Antialias" lines which you may see are probably the result of using JPEG compression. JPEG is not looseless compression so "small image details may be changed" in order to reduce image size dramatically. On really true-color images such as your snapshots of landscape and so on and using small compression level you will hardly see differences. But on exact objects, such as lines, circles, which you draw on solid background using single color, you can see that if you save and load this image that some details are changed.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="18462""></a>
  <div class="note">
   <strong class="user">rossa at studioware dot net</strong>
   <a href="#18462" class="date">23-Jan-2002 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
function ConvertGreyscale($image){<br />
# this file outputs a grey version of specified image<br />
<br />
&nbsp; $total = ImageColorsTotal($image);<br />
&nbsp; for( $i=0; $i&lt;$total; $i++){<br />
&nbsp;&nbsp; &nbsp; $old = ImageColorsForIndex($image, $i);<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; #trying to keep proper saturation when converting<br />
&nbsp;&nbsp; &nbsp; $commongrey = (int)(($old[red] + $old[green] + $old[blue]) / 3);<br />
<br />
&nbsp;&nbsp; &nbsp; ImageColorSet($image, $i, $commongrey, $commongrey, $commongrey);<br />
&nbsp; }<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14729""></a>
  <div class="note">
   <strong class="user">eric at spiderws dot com</strong>
   <a href="#14729" class="date">12-Aug-2001 10:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This little function does it for you:
<br />

<br />
&lt;?
<br />
$image_id = imageCreateFromJPEG($image);
<br />
for($a=0;$a&lt;imagecolorstotal ($image_id);$a++) 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $color = ImageColorsForIndex($image_id,$i);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $R=.299 * ($color['red'])+ .587 * ($color['green'])+ .114 * ($color['blue']);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $G=.299 * ($color['red'])+ .587 * ($color['green'])+ .114 * ($color['blue']);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $B=.299 * ($color['red'])+ .587 * ($color['green'])+ .114 * ($color['blue']);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ImageColorSet($image_id, $a, $R, $G, $B);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
imageJPEG($image_id,"$image");
<br />
?&gt;
<br />

<br />
The .299 , .578 , .114 values are estimations, and add a gamma correction to the colors. For more or less luminace in the result, you can change these values.
<br />

<br />
Goodluck,
<br />
Eric Mulders, Netherlands</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
