<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Fetch a result row as an associative array</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.odbc-execute.html">? odbc_execute</a></li>
      <li style="float: right;"><a href="function.odbc-fetch-into.html">odbc_fetch_into ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.uodbc.html">ODBC 函数</a></li>
    <li>Fetch a result row as an associative array</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.odbc-fetch-array" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">odbc_fetch_array</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.2, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">odbc_fetch_array</span> &mdash; <span class="dc-title">Fetch a result row as an associative array</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.odbc-fetch-array-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>odbc_fetch_array</strong></span>(<span class="methodparam"><span class="type">resource</span> <code class="parameter">$statement</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$row</code><span class="initializer"> = -1</span></span>): <span class="type"><span class="type">array</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Fetch an associative <span class="type">array</span> from an ODBC query.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.odbc-fetch-array-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">statement</code></dt>

     <dd>

      <p class="para">
       The result resource from <span class="function"><a href="function.odbc-exec.html" class="function">odbc_exec()</a></span>.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">row</code></dt>

     <dd>

      <p class="para">
       Optionally choose which row number to retrieve.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.odbc-fetch-array-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   Returns an array that corresponds to the fetched row, or <strong><code>false</code></strong> if there 
   are no more rows.
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.odbc-fetch-array-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    This function exists when compiled with DBMaker, IBM DB2 or UnixODBC support.
   </span>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.odbc-fetch-array-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.odbc-fetch-row.html" class="function" rel="rdfs-seeAlso">odbc_fetch_row()</a> - Fetch a row</span></li>
    <li class="member"><span class="function"><a href="function.odbc-fetch-object.html" class="function" rel="rdfs-seeAlso">odbc_fetch_object()</a> - Fetch a result row as an object</span></li>
    <li class="member"><span class="function"><a href="function.odbc-num-rows.html" class="function" rel="rdfs-seeAlso">odbc_num_rows()</a> - Number of rows in a result</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="116134""></a>
  <div class="note">
   <strong class="user">dinchu at gmail dot com</strong>
   <a href="#116134" class="date">12-Nov-2014 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've found an issue while working with php ODBC functions. odbc_fetch_array and odbc_fetch_object fail when query has a join with a table that has the same column name, even when that certain field is excluded from the field selection (With SQL SERVER):<br />
<br />
THIS ONLY HAPPENS WHEN USING SQL_CUR_USE_ODBC<br />
<br />
for example<br />
<br />
$con = odbc_connect("Driver={SQL Server Native Client 11.0};Server=$serverName;Database=$db;", 'user', 'pass',SQL_CUR_USE_ODBC);<br />
<br />
$query="SELECT table1.field1, table1.field2 from table1 JOIN table2 ON&nbsp; table1.field1=table2.field1";<br />
<br />
$result = odbc_exec($con,$query);<br />
<br />
&nbsp;$a=odbc_fetch_array($result); <br />
the code above generates a warning:<br />
<br />
Warning: odbc_fetch_array() [function.odbc-fetch-array]: SQL error: [Microsoft][SQL Server Native Client 10.0][SQL Server]the column name '' is ambiguous., SQL state 37000 in SQLGetData<br />
<br />
The error would be okay if i had selected field1 without specifying from which table, but even when it is explicit it doesn't work. the only "workaround" i've found so far is to remove the field from the selected fields or changinf the field name from the second table<br />
<br />
I tried with: both SQL Server Native Client 10.0 and SQL Server Native Client 11.0 SQL server 2008 Php 5.3.2 over Windows<br />
<br />
PD: If someone has any aideas without using sqlsrv or mssqL extension it will be great</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100833""></a>
  <div class="note">
   <strong class="user">Vadim Istratov</strong>
   <a href="#100833" class="date">10-Nov-2010 04:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful while using this function with MSSQL for fetching results of SQL queries like following: "SELECT * FROM table". In this case array will NOT contain named indexes!
<br />

<br />
I.e.:
<br />
Table:
<br />
------------------------
<br />
| col1 | col2 | col3&nbsp; |
<br />
------------------------
<br />
|&nbsp;&nbsp; 1&nbsp;&nbsp; |&nbsp;&nbsp; 2&nbsp;&nbsp; |&nbsp;&nbsp; 3&nbsp;&nbsp; |
<br />
------------------------
<br />
|&nbsp;&nbsp; 4&nbsp;&nbsp; |&nbsp;&nbsp; 5&nbsp;&nbsp; |&nbsp;&nbsp; 6&nbsp;&nbsp; |
<br />
------------------------
<br />

<br />
Code:
<br />
---------------------
<br />
<span class="default">&lt;?php
<br />
$query </span><span class="keyword">= </span><span class="string">"SELECT * FROM table"</span><span class="keyword">;
<br />
</span><span class="default">$res </span><span class="keyword">= </span><span class="default">odbc_exec</span><span class="keyword">(</span><span class="default">$query</span><span class="keyword">);
<br />

<br />
while( </span><span class="default">$row </span><span class="keyword">= </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$res</span><span class="keyword">) ) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$row</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>---------------------
<br />

<br />
Output will be:
<br />
---------------------
<br />
Array(
<br />
&nbsp;[0] =&gt; 1,
<br />
&nbsp;[1] =&gt; 2,
<br />
&nbsp;[2] =&gt; 3
<br />
)
<br />
Array(
<br />
&nbsp;[0] =&gt; 4,
<br />
&nbsp;[1] =&gt; 5,
<br />
&nbsp;[2] =&gt; 6
<br />
)
<br />
---------------------
<br />

<br />
No field names here!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89906""></a>
  <div class="note">
   <strong class="user">James Auxier</strong>
   <a href="#89906" class="date">27-Mar-2009 10:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some interesting behavior was discovered while attempting simultaneous queries to a MS SQL server through the ODBC/freeTDS layer on SUSE on a persistent connection with ODBC cursors enabled. Stepping through the first resource with odbc_fetch_array() in a while loop works as expected, but calls to subsequently created resources within that loop were failing to return data where MySQL equivalents to the script were working just fine.<br />
<br />
I found that adding a num_rows function call [custom function that simply steps through the result set... the misbehavior of odbc_num_rows() is another matter] immediately following each odbc_exec() then resetting the cursor seemed to cache the results for proper performance of the multiple active result sets.&nbsp; It may be slightly slower than the MySQL equivalent, but at least it works.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83054""></a>
  <div class="note">
   <strong class="user">michael dot buergi at zhdk dot ch</strong>
   <a href="#83054" class="date">08-May-2008 02:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use an odbc connection to a mssql2000 db. As long as I had set ansi_warnings on, I occasionnally got the last record twice when retrieving them with odbc_fetch_array or odbc_fetch_row and odbc_result.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81957""></a>
  <div class="note">
   <strong class="user">bryant at zionprogramming dot com</strong>
   <a href="#81957" class="date">20-Mar-2008 03:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found the function submitted by jezndiatyahoodotcodotuk to be very helpful.&nbsp; I'm using PHP 5.2.5 and this function isn't defined, so it may depend on the ODBC driver being used.<br />
<br />
The only problem with the solution already posted is that the return values don't match the ones specified by the documentation.&nbsp; I made the following modification so that the function will work the same whether it exists internally or not:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'odbc_fetch_array'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$rownumber</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!(</span><span class="default">$cols </span><span class="keyword">= </span><span class="default">odbc_fetch_into</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$result_array</span><span class="keyword">, </span><span class="default">$rownumber</span><span class="keyword">))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt;= </span><span class="default">$cols</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">odbc_field_name</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">)] = </span><span class="default">$result_array</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76627""></a>
  <div class="note">
   <strong class="user">luke at croslow dot com</strong>
   <a href="#76627" class="date">23-Jul-2007 10:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
On IBM DB2 for iSeries I have to specify a specific row number to retrieve. If I don't specify the row number, the behavior is erratic.<br />
<br />
This seems to work:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;</span><span class="default">$row</span><span class="keyword">=</span><span class="default">odbc_fetch_row</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp; </span><span class="comment">//use $row<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
The row count MUST start at 1 or else the behavior seems undefined; i.e., when I start from 0 some rows might be returned two or more times or not at all.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="72247""></a>
  <div class="note">
   <strong class="user">robincw at gnospammail dot com</strong>
   <a href="#72247" class="date">09-Jan-2007 04:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am using MS SQL Server 2005, and using odbc_connect with SQL_CUR_USE_ODBC.<br />
<br />
I had a problem with odbc_fetch_array when getting results from a stored procedure that returns a text column. The misleading error I got was:<br />
<br />
odbc_fetch_array() [function.odbc-fetch-array]: SQL error: [Microsoft][ODBC Cursor Library] Result set was not generated by a SELECT statement, SQL state SL004 in SQLGetData<br />
<br />
Eventually I found that by converting the text column in my database to varchar(8000), it worked fine. Perhaps using CONVERT or CAST might have worked too. I also found that varchar(max) columns were scrambled.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56802""></a>
  <div class="note">
   <strong class="user">tim at tmcode dot com</strong>
   <a href="#56802" class="date">15-Sep-2005 08:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Depending on the odbc driver/operating system you are using,&nbsp; odbc_fetch_array might not be defined. (ie if you used --with-custom-odbc you may be out of luck).&nbsp;&nbsp; The following can be safely added to define the odbc_fetch_array function if doesn't exist already.&nbsp; Unlike some of the other examples contributed here, this one will create the numeric keys and the text keys.&nbsp;&nbsp; This function is definitely not very optimal because it has to check the number of fields and field names each time a row is pulled.&nbsp; Often you will be looping through a result set and there is no need to pull this information each time.&nbsp; It could probably be improved by caching the result of these functions but I'll leave that as an exercise for someone else... :)<br />
<br />
if(!function_exists("odbc_fetch_array"))<br />
{<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function odbc_fetch_array($res)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // make sure to pass back the false if we are out of rows<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(!odbc_fetch_row($res)) return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $row=array();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // populate the row array<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $numfields=odbc_num_fields($res);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for($i=1; $i&lt;=$numfields; $i++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //odbc starts its indice at 1 but since I am <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // trying to emulate the functionality of *_fetch_array<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // for other dbs (ie mysql)&nbsp; I'm going to decrement my<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // my numeric indice by 1.&nbsp; This might not be what <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // you are after in which case get rid of the -1&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $row[odbc_field_name($res,$i)]=$row[$i-1]=odbc_result($res,$i);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $row;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51826""></a>
  <div class="note">
   <strong class="user">Remy</strong>
   <a href="#51826" class="date">12-Apr-2005 05:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I use this function to get my recordset in an array, and it's very easy to use.<br />
<br />
function dbquery($sql) {<br />
&nbsp; $arr&nbsp; &nbsp; = array();<br />
&nbsp; $conn = odbc_connect('dsn','user','pass');<br />
&nbsp; $rs&nbsp; &nbsp;&nbsp; = odbc_exec($conn,$sql);<br />
&nbsp; $x&nbsp; &nbsp; &nbsp; = 1;<br />
&nbsp; while (odbc_fetch_row($rs)) {<br />
&nbsp;&nbsp;&nbsp; for ($y = 1; $y &lt;= odbc_num_fields($rs); $y++) <br />
&nbsp;&nbsp; &nbsp;&nbsp; $arr[$x][$y] = odbc_result($rs,$y);<br />
&nbsp;&nbsp;&nbsp; $x++;<br />
&nbsp; }<br />
&nbsp; if ($x &gt; 1)<br />
&nbsp;&nbsp;&nbsp; return $arr;<br />
}<br />
<br />
usage:<br />
<br />
$arr=dbquery("SELECT * FROM tblTable");<br />
echo $arr[1][1] //echo's first column of the first row</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51152""></a>
  <div class="note">
   <strong class="user">philip</strong>
   <a href="#51152" class="date">21-Mar-2005 08:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function requires one of the following to exist: Windows, DB2, or UNIXODBC.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48228""></a>
  <div class="note">
   <strong class="user">miles at e-clipseconsulting dot com</strong>
   <a href="#48228" class="date">15-Dec-2004 01:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to Sena's post, odbc_num_rows does not always return a row count.&nbsp; When executing a query on MS Access it seems to return a row count of -1.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">while(</span><span class="default">odbc_num_rows</span><span class="keyword">(</span><span class="default">$myodbcexec</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$myarray</span><span class="keyword">[] = </span><span class="default">odbc_fetch_array</span><span class="keyword">(</span><span class="default">$myodbcexec</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Just something to watch out for when attempting to execute this code.<br />
<br />
Miles Phillips<br />
e-Clipse Consulting</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47340""></a>
  <div class="note">
   <strong class="user">russ at russprince dot com</strong>
   <a href="#47340" class="date">11-Nov-2004 06:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I really liked Ryan's example so I took it another step and added a recordset class to work with the connection class.&nbsp; I made slight alterations to the original code as well.&nbsp; Also note the recordset class takes advantage of php5's __get property function...<br />
<br />
&lt;%<br />
class odbcRecordset {<br />
&nbsp;&nbsp; var $recordcount;<br />
&nbsp;&nbsp; var $currentrow;<br />
&nbsp;&nbsp; var $eof;<br />
<br />
&nbsp;&nbsp; var $recorddata;<br />
&nbsp;&nbsp; var $query;<br />
<br />
&nbsp;&nbsp; function odbcConnection(){<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;recordcount = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;recorddata = 0;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; function SetData( $newdata, $num_records, $query ) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;recorddata = $newdata;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;recordcount = $num_records;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;query = $query;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;currentrow = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;set_eof();<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; function set_eof() {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;eof = $this-&gt;currentrow &gt;= $this-&gt;recordcount;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; function movenext()&nbsp; { if ($this-&gt;currentrow &lt; $this-&gt;recordcount) { $this-&gt;currentrow++; $this-&gt;set_eof(); } }<br />
&nbsp;&nbsp; function moveprev()&nbsp; { if ($this-&gt;currentrow &gt; 0)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; { $this-&gt;currentrow--; $this-&gt;set_eof(); } }<br />
&nbsp;&nbsp; function movefirst() { $this-&gt;currentrow = 0; set_eof();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; function movelast()&nbsp; { $this-&gt;currentrow = $this-&gt;recordcount - 1;&nbsp; set_eof();&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; function data($field_name) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (isset($this-&gt;recorddata[$this-&gt;currentrow][$field_name])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $thisVal = $this-&gt;recorddata[$this-&gt;currentrow][$field_name];<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else if ($this-&gt;eof) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; die("&lt;B&gt;Error!&lt;/B&gt; eof of recordset was reached");<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; die("&lt;B&gt;Error!&lt;/B&gt; Field &lt;B&gt;" . $field_name . "&lt;/B&gt; was not found in the current recordset from query:&lt;br&gt;&lt;br&gt;$this-&gt;query");<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; return $thisVal;<br />
&nbsp;&nbsp; } <br />
<br />
&nbsp;&nbsp; function __get($field_name) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return $this-&gt;data($field_name);<br />
&nbsp;&nbsp; } <br />
}<br />
<br />
class odbcConnection {<br />
&nbsp;&nbsp; var $user;&nbsp; //Username for the database<br />
&nbsp;&nbsp; var $pass; //Password<br />
<br />
&nbsp;&nbsp; var $conn_handle; //Connection handle<br />
&nbsp;&nbsp; var $temp_fieldnames; //Tempory array used to store the fieldnames, makes parsing returned data easier.<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; function odbcConnection(){<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;user = "";<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;pass = "";<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; function open($dsn,$user,$pass){<br />
&nbsp;&nbsp; &nbsp;&nbsp; $handle = @odbc_connect($dsn,$user,$pass,SQL_CUR_USE_ODBC) or<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Connect To Database. Error Code:&nbsp; ".odbc_error());<br />
&nbsp;&nbsp; &nbsp;&nbsp; $this-&gt;conn_handle = $handle;<br />
&nbsp;&nbsp; &nbsp;&nbsp; return true;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; function &amp;execute($query){<br />
&nbsp;&nbsp; &nbsp;&nbsp; //Create a temp recordset<br />
&nbsp;&nbsp; &nbsp;&nbsp; $newRS = new odbcRecordset;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $thisData = "";<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $res = @odbc_exec($this-&gt;conn_handle,$query) or<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Run Query:&lt;br&gt;&lt;br&gt;" . $query . "&lt;br&gt;&lt;br&gt;Error Code:&nbsp; ".odbc_error());<br />
&nbsp;&nbsp; &nbsp;&nbsp; unset($this-&gt;temp_fieldnames);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; $i = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $j = 0;<br />
&nbsp;&nbsp; &nbsp;&nbsp; $num_rows = 0;<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; // only populate select queries<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (stripos($query, 'select ') !== false) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; while(odbc_fetch_row($res)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $num_rows++;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Build tempory<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ($j = 1; $j &lt;= odbc_num_fields($res); $j++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $field_name = odbc_field_name($res, $j);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;temp_fieldnames[$j] = $field_name;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ar[$field_name] = odbc_result($res, $field_name) . "";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $thisData[$i] = $ar;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp;&nbsp; //populate the recordset and return it<br />
&nbsp;&nbsp; &nbsp;&nbsp; $newRS-&gt;SetData( $thisData, $num_rows, $query );<br />
&nbsp;&nbsp; &nbsp;&nbsp; return $newRS;<br />
&nbsp;&nbsp; }<br />
}<br />
%&gt;<br />
<br />
usage is pretty simple:<br />
<br />
&lt;%<br />
&nbsp; $con = new odbcConnection<br />
&nbsp; $con-&gt;open("dsn","user","pass")<br />
<br />
&nbsp; $sql = "select bar from foo";<br />
&nbsp; $rs = $con-&gt;execute($sql);<br />
<br />
&nbsp; if (!$rs-&gt;eof) {<br />
&nbsp;&nbsp;&nbsp; print $rs-&gt;data("bar");<br />
&nbsp;&nbsp; &nbsp;&nbsp; // or //<br />
&nbsp;&nbsp;&nbsp; print $rs-&gt;bar;<br />
&nbsp; }<br />
<br />
&nbsp; while (!$rs-&gt;eof) {<br />
&nbsp;&nbsp;&nbsp; // blah blah code<br />
&nbsp;&nbsp;&nbsp; $rs-&gt;movenext();<br />
&nbsp; }<br />
%&gt;<br />
<br />
Works pretty well, but I haven't thoughly tested it yet.<br />
Code can be dl'd here:<br />
<br />
<a href="http://www.russprince.com/odbc_functions.zip" rel="nofollow" target="_blank">http://www.russprince.com/odbc_functions.zip</a><br />
<br />
Cheers,<br />
Russ</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41437""></a>
  <div class="note">
   <strong class="user">Ryan (rystar_x2000 at hotmail dot com)</strong>
   <a href="#41437" class="date">09-Apr-2004 06:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Heya,<br />
<br />
After much fiddling around with the odbc_num_rows() function, and trying to get odbc_fetch_array() to play nice with it, I decided to write this little function which will return a 2-dimensional array, in the format [rownumber][field].<br />
<br />
The 'rownumber' array index is obviously the number of the row stored in the array.<br />
The 'field' index is keyed to the field name on that row. <br />
<br />
--Function--<br />
&lt;?<br />
<br />
function fetch2DArray($res){&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; $i = 0;<br />
&nbsp;&nbsp;&nbsp; $j = 0;<br />
&nbsp;&nbsp;&nbsp; $toReturn = "";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; while(odbc_fetch_row($res))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for ($j = 1; $j &lt;= odbc_num_fields($res); $j++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $field_name = odbc_field_name($res, $j);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ar[$field_name] = odbc_result($res, $field_name);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $toReturn[$i] = $ar;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $toReturn;&nbsp; &nbsp; <br />
}<br />
?&gt;<br />
<br />
I then took this one stage further.. and wrote a whole class to deal with the odbc connection... it's a bit slap-happy, but it does work well enough.<br />
<br />
-- Class --<br />
&lt;?<br />
class odbcConnection{<br />
&nbsp;&nbsp; var $user;&nbsp; //Username for the database<br />
&nbsp;&nbsp; var $pass; //Password<br />
&nbsp;&nbsp; var $conn_handle; //Connection handle<br />
&nbsp;&nbsp; var $temp_fieldnames; //Tempory array used to store the fieldnames, makes parsing returned data easier.<br />
<br />
&nbsp;&nbsp; function odbcConnection(){<br />
&nbsp;&nbsp; &nbsp; &nbsp; $this-&gt;user = "";<br />
&nbsp;&nbsp; &nbsp; &nbsp; $this-&gt;pass = "";<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; function connectDatabase($dsn_link,$user,$pass){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $handle = @odbc_connect($dsn_link,$user,$pass,SQL_CUR_USE_DRIVER) or die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Connect To Database. Error Code:&nbsp; ".odbc_error());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;conn_handle = $handle;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return true;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function runStoredQuery($query, $returns_results){<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if($returns_results == false){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $toReturn = "";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res = @odbc_exec($this-&gt;conn_handle, "exec ".$query."") or die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Run Stored Query. Error Code:&nbsp; ".odbc_error());<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($this-&gt;temp_fieldnames);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $j = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(odbc_fetch_row($res))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Build tempory<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ($j = 1; $j &lt;= odbc_num_fields($res); $j++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $field_name = odbc_field_name($res, $j);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;temp_fieldnames[$j] = $field_name;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $this-&gt;temp_fieldnames[$j];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ar[$field_name] = odbc_result($res, $field_name);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $toReturn[$i] = $ar;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; return $toReturn;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function runSQL($query,$returns_results){<br />
&nbsp;&nbsp;&nbsp; $toReturn = "";<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $res = @odbc_exec($this-&gt;conn_handle,$query) or die("&lt;B&gt;Error!&lt;/B&gt; Couldn't Run Query. Error Code:&nbsp; ".odbc_error());<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; unset($this-&gt;temp_fieldnames);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if($returns_results == false){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $j = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while(odbc_fetch_row($res))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Build tempory<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for ($j = 1; $j &lt;= odbc_num_fields($res); $j++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $field_name = odbc_field_name($res, $j);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $this-&gt;temp_fieldnames[$j] = $field_name;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ar[$field_name] = odbc_result($res, $field_name);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $toReturn[$i] = $ar;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; return $toReturn;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
<br />
}<br />
<br />
//And an example of how to use the class:<br />
<br />
include("dbClass.inc");&nbsp; //Where dbClass.inc is the name of the file holding the class<br />
<br />
//Declare a new instance of the class <br />
$dbConnection = new odbcConnection;<br />
<br />
$dsn = "GroupWork";&nbsp;&nbsp; //Your System DSN name to point to your database<br />
$dbConnection-&gt;connectDatabase($dsn,"","");&nbsp; //No username and password - read only access<br />
<br />
echo"&lt;BR&gt;&lt;HR&gt;&lt;B&gt;Testing SQL&lt;/b&gt;&lt;BR&gt;&lt;BR&gt;";<br />
$query_result = $dbConnection-&gt;runSQL("SELECT * FROM Event WHERE Type = 'Sport' ORDER BY EDate ASC",true); <br />
<br />
&nbsp;&nbsp;&nbsp; if(!$query_result)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //No Results - Your Error Code Here<br />
&nbsp;&nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //Get the results<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $key = $dbConnection-&gt;temp_fieldnames;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $rows = count($query_result);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $keys = count($key);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $i = 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while($i &lt; $rows){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $j = 1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "Echoing Row $i:&lt;BR&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while($j &lt; $keys - 1){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //$query_result[row][field];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $result = $query_result[$i][$key[$j]];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $field = $key[$j];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo("Field &lt;b&gt;'".$field."'&lt;/b&gt; : ".$result." &lt;BR&gt;");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $j++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "&lt;BR&gt;----&lt;BR&gt;&lt;BR&gt;";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $i++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
?&gt;<br />
<br />
Hope this was of some help. If anyone has any improvments to the class, please drop them by me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41017""></a>
  <div class="note">
   <strong class="user">powerstat at web dot de</strong>
   <a href="#41017" class="date">26-Mar-2004 04:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function is badly implemented, because the fetch_array versions for all other databases are storing the values as associative AND numeric key.<br />
This one only stores as associative key :(<br />
Someone should really cleanup the complete database api design!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40951""></a>
  <div class="note">
   <strong class="user">xhat at NOSPAM dot hotmail dot com</strong>
   <a href="#40951" class="date">24-Mar-2004 10:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a quick and dirty way to accomplish the same thing:<br />
<br />
&lt;?<br />
while(odbc_fetch_row($result)) {<br />
$var1 = odbc_result($result, "NAMEOFFIELD1");<br />
$var2 = odbc_result($result, "NAMEOFFIELD2");<br />
..... //as many vars as you have fields with data to capture<br />
<br />
$array_of_results[] = compact('var1', 'var2','var3', etc, etc)<br />
}<br />
?&gt;<br />
<br />
Just turn each returned row's data into variables then use the compact().&nbsp; Turns each variable name into a key and the vars value into the array value.&nbsp; Makes a wonderful 2d array that you can walk easily and still use key values to get at data.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
