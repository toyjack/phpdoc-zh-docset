<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>取得本地时间</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.idate.html">? idate</a></li>
      <li style="float: right;"><a href="function.microtime.html">microtime ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.datetime.html">Date/Time 函数</a></li>
    <li>取得本地时间</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.localtime" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">localtime</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">localtime</span> &mdash; <span class="dc-title">取得本地时间</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.localtime-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>localtime</strong></span>(<span class="methodparam"><span class="type">int</span> <code class="parameter">$timestamp</code><span class="initializer"> = time()</span></span>, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$is_associative</code><span class="initializer"> = false</span></span>): <span class="type">array</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>localtime()</strong></span> 函数返回一个数组，其结构和
   C 函数调用返回的完全一样。
  </p>
 </div>


   <div class="refsect1 parameters" id="refsect1-function.localtime-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
    <dt>
<code class="parameter">timestamp</code></dt>
<dd>
<p class="para">
可选的 <code class="parameter">timestamp</code> 参数是一个 <span class="type">int</span> 的 Unix
时间戳，如未指定或是 <strong><code>null</code></strong>，参数值默认为当前本地时间。也就是说，其值默认为
<span class="function"><a href="function.time.html" class="function">time()</a></span> 的返回值。</p></dd>

   
    
     <dt>
<code class="parameter">is_associative</code></dt>

     <dd>

      <p class="para">
       如果设为 <strong><code>false</code></strong>
          或未提供则返回的是普通的数字索引数组。如果该参数设为 <strong><code>true</code></strong> 则
          <span class="function"><strong>localtime()</strong></span> 函数返回包含有所有从
          C 的 localtime 函数调用所返回的不同单元的关联数组。关联数组中不同的键名为：
      </p>
      <p class="para">
       <ul class="itemizedlist">
        <li class="listitem">
         <span class="simpara">
          &quot;tm_sec&quot; - 秒数， <code class="literal">0</code> 到 <code class="literal">59</code>
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_min&quot; - 分钟数， <code class="literal">0</code> 到 <code class="literal">59</code>
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_hour&quot; - 小时， <code class="literal">0</code> 到 <code class="literal">23</code>
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_mday&quot; - 月份中的第几日， <code class="literal">1</code> 到 <code class="literal">31</code>
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_mon&quot; - 年份中的第几个月， <code class="literal">0</code> (Jan) 到 <code class="literal">11</code> (Dec)
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_year&quot; - 年份，从 1900 开始
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_wday&quot; - 星期中的第几天， <code class="literal">0</code> (Sun) 到 <code class="literal">6</code> (Sat)
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_yday&quot; - 一年中的第几天， <code class="literal">0</code> 到 <code class="literal">365</code>
         </span>
        </li>
        <li class="listitem">
         <span class="simpara">
          &quot;tm_isdst&quot; - 夏令时当前是否生效？
         </span>
         <span class="simpara">
          如果是生效的是正数， <code class="literal">0</code> 代表未生效，负数代表未知。
         </span>
        </li>
       </ul>
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

   
  <div class="refsect1 errors" id="refsect1-function.localtime-errors">
  <h3 class="title">错误／异常</h3>
   
   <p class="para">
在每次调用日期/时间函数时，如果时区无效则会引发 <strong><code>E_NOTICE</code></strong> 错误。参见
<span class="function"><a href="function.date-default-timezone-set.html" class="function">date_default_timezone_set()</a></span>。</p>
 
 </div>
  
   
 <div class="refsect1 changelog" id="refsect1-function.localtime-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      
      <tr><td>5.1.0</td><td><p class="para">
现在发布 <strong><code>E_STRICT</code></strong> 和 <strong><code>E_NOTICE</code></strong>
时区错误。</p></td></tr>

     
     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.localtime-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2041">
    <p><strong>Example #1 <span class="function"><strong>localtime()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$localtime&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">localtime</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$localtime_assoc&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">localtime</span><span style="color: #007700">(</span><span style="color: #0000BB">time</span><span style="color: #007700">(),&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$localtime</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$localtime_assoc</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Array
(
    [0] =&gt; 24
    [1] =&gt; 3
    [2] =&gt; 19
    [3] =&gt; 3
    [4] =&gt; 3
    [5] =&gt; 105
    [6] =&gt; 0
    [7] =&gt; 92
    [8] =&gt; 1
)

Array
(
    [tm_sec] =&gt; 24
    [tm_min] =&gt; 3
    [tm_hour] =&gt; 19
    [tm_mday] =&gt; 3
    [tm_mon] =&gt; 3
    [tm_year] =&gt; 105
    [tm_wday] =&gt; 0
    [tm_yday] =&gt; 92
    [tm_isdst] =&gt; 1
)
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.localtime-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.getdate.html" class="function" rel="rdfs-seeAlso">getdate()</a> - 取得日期／时间信息</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="115756""></a>
  <div class="note">
   <strong class="user">mimmux</strong>
   <a href="#115756" class="date">18-Sep-2014 08:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
its something strange on locatime function, if i test this function with zero parameter<br />
<br />
print_r(localtime(0));<br />
<br />
it returns this <br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; 1&nbsp;&nbsp; &lt;-----<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; 70<br />
&nbsp;&nbsp;&nbsp; [6] =&gt; 4<br />
&nbsp;&nbsp;&nbsp; [7] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [8] =&gt; 0<br />
)<br />
that is not the unix epoc but one hour after, it should be<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; 0&nbsp;&nbsp; &lt;-----<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; 1<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; 70<br />
&nbsp;&nbsp;&nbsp; [6] =&gt; 4<br />
&nbsp;&nbsp;&nbsp; [7] =&gt; 0<br />
&nbsp;&nbsp;&nbsp; [8] =&gt; 0<br />
)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="104133""></a>
  <div class="note">
   <strong class="user">Chris</strong>
   <a href="#104133" class="date">25-May-2011 08:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes, there's not a server-based/PHP method for getting local time. You have to get it from the client via Javascript.&nbsp; Google "bitbucket timezone detect" and use it to set a "local_timezone" cookie that you can read from PHP and set via date_default_timezone_set()</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71632""></a>
  <div class="note">
   <strong class="user">anomie at users dot sourceforge dot net</strong>
   <a href="#71632" class="date">08-Dec-2006 12:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is another version of gmtime(). This one doesn't involve messing around with timezones at all. Note that PHP4 users should check out the array_combine page for replacements for that function.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">gmtime</span><span class="keyword">(</span><span class="default">$ts</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">, </span><span class="default">$is_associative</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$ts</span><span class="keyword">)) </span><span class="default">$ts</span><span class="keyword">=</span><span class="default">time</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t</span><span class="keyword">=</span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'intval'</span><span class="keyword">,</span><span class="default">explode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">,</span><span class="default">gmdate</span><span class="keyword">(</span><span class="string">'s,i,H,d,m,Y,w,z,I'</span><span class="keyword">,</span><span class="default">$ts</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">]--;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$t</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">]-=</span><span class="default">1900</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$is_associative</span><span class="keyword">) return </span><span class="default">$t</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">array_combine</span><span class="keyword">(array(</span><span class="string">'tm_sec'</span><span class="keyword">,</span><span class="string">'tm_min'</span><span class="keyword">,</span><span class="string">'tm_hour'</span><span class="keyword">,</span><span class="string">'tm_mday'</span><span class="keyword">,</span><span class="string">'tm_mon'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'tm_year'</span><span class="keyword">,</span><span class="string">'tm_wday'</span><span class="keyword">,</span><span class="string">'tm_yday'</span><span class="keyword">,</span><span class="string">'tm_isdst'</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$t</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="40183""></a>
  <div class="note">
   <strong class="user">tony at speedscript dot com</strong>
   <a href="#40183" class="date">24-Feb-2004 10:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Date select box for the current week, or whatever week you give for an offset (in seconds), returns the string you can echo with the select box named $name:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">week_date_selectbox</span><span class="keyword">( </span><span class="default">$time_offset</span><span class="keyword">, </span><span class="default">$name </span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp;&nbsp; if( isset( </span><span class="default">$time_offset </span><span class="keyword">) )
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">() + </span><span class="default">$time_offset</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$t </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wday </span><span class="keyword">= array(</span><span class="string">"Sun "</span><span class="keyword">,</span><span class="string">"Mon "</span><span class="keyword">,</span><span class="string">"Tue "</span><span class="keyword">,</span><span class="string">"Wed "</span><span class="keyword">,</span><span class="string">"Thu "</span><span class="keyword">,</span><span class="string">"Fri "</span><span class="keyword">,</span><span class="string">"Sat "</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mon </span><span class="keyword">= array(</span><span class="string">"Jan "</span><span class="keyword">,</span><span class="string">"Feb "</span><span class="keyword">,</span><span class="string">"Mar "</span><span class="keyword">,</span><span class="string">"Apr "</span><span class="keyword">,</span><span class="string">"May "</span><span class="keyword">,</span><span class="string">"Jun "</span><span class="keyword">,</span><span class="string">"Jul "</span><span class="keyword">,</span><span class="string">"Aug "</span><span class="keyword">,</span><span class="string">"Sep "</span><span class="keyword">,</span><span class="string">"Oct "</span><span class="keyword">,</span><span class="string">"Nov "</span><span class="keyword">,</span><span class="string">"Dec "</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mybox </span><span class="keyword">= </span><span class="string">"&lt;select name=\"</span><span class="default">$name</span><span class="string">\"&gt;\n"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$ii </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$ii </span><span class="keyword">&gt; -</span><span class="default">6</span><span class="keyword">; </span><span class="default">$ii</span><span class="keyword">--)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tarr </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">( </span><span class="default">$t </span><span class="keyword">+ </span><span class="default">$ii </span><span class="keyword">* </span><span class="default">86400</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_wday"</span><span class="keyword">] == </span><span class="default">0 </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// found Sunday, now make the week's strings
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">for(</span><span class="default">$jj </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$jj </span><span class="keyword">&lt; </span><span class="default">7</span><span class="keyword">; </span><span class="default">$jj</span><span class="keyword">++)
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tarr </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">( </span><span class="default">$t </span><span class="keyword">+ (</span><span class="default">$jj </span><span class="keyword">+ </span><span class="default">$ii</span><span class="keyword">) * </span><span class="default">86400</span><span class="keyword">, </span><span class="default">1 </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mybox </span><span class="keyword">.= </span><span class="default">sprintf</span><span class="keyword">( </span><span class="string">" &lt;option value=\"%04d-%02d-%02d\"&gt;%s%s%d %d&lt;/option&gt;\n"</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((int)</span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_year"</span><span class="keyword">] + </span><span class="default">1900</span><span class="keyword">),
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_mon"</span><span class="keyword">],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((int)</span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_mday"</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">),
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$wday</span><span class="keyword">[</span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_wday"</span><span class="keyword">]],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mon</span><span class="keyword">[</span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_mon"</span><span class="keyword">]],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (int)</span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_mday"</span><span class="keyword">],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ((int)</span><span class="default">$tarr</span><span class="keyword">[</span><span class="string">"tm_year"</span><span class="keyword">] + </span><span class="default">1900</span><span class="keyword">) );
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$mybox </span><span class="keyword">.= </span><span class="string">"&lt;/select&gt;\n"</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$mybox</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27516""></a>
  <div class="note">
   <strong class="user">arch at archtech dot yi dot org</strong>
   <a href="#27516" class="date">09-Dec-2002 01:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can implement gmtime quote simply.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">GetTZOffset</span><span class="keyword">() { 
<br />
&nbsp; </span><span class="default">$Offset </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"O"</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br />
&nbsp;&nbsp; 
<br />
&nbsp; </span><span class="default">$Parity </span><span class="keyword">= </span><span class="default">$Offset </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">? -</span><span class="default">1 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$Offset </span><span class="keyword">= </span><span class="default">$Parity </span><span class="keyword">* </span><span class="default">$Offset</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$Offset </span><span class="keyword">= (</span><span class="default">$Offset </span><span class="keyword">- (</span><span class="default">$Offset </span><span class="keyword">% </span><span class="default">100</span><span class="keyword">))/</span><span class="default">100</span><span class="keyword">*</span><span class="default">60 </span><span class="keyword">+ </span><span class="default">$Offset </span><span class="keyword">% </span><span class="default">100</span><span class="keyword">;
<br />

<br />
&nbsp; return </span><span class="default">$Parity </span><span class="keyword">* </span><span class="default">$Offset</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">$TZOffset </span><span class="keyword">= </span><span class="default">GetTZOffset</span><span class="keyword">();
<br />

<br />
</span><span class="default">$t_time </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">()-</span><span class="default">$TZOffset</span><span class="keyword">*</span><span class="default">60</span><span class="keyword">; </span><span class="comment">#Counter adjust for localtime()
<br />
</span><span class="default">$t_arr </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">$t_time</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="21035""></a>
  <div class="note">
   <strong class="user">jausions-N at SPAM-hotmail dot com</strong>
   <a href="#21035" class="date">26-Apr-2002 12:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I strongly suggest to do all of your developments using GMT/UTC dates &amp; times.
<br />

<br />
I provide here a version of a 'gmttime' function. Save it in a separate file and include it when needed.
<br />

<br />
Please post a correction here if you find it not working for your timezone (with or without daylight saving time.). 
<br />

<br />
Thanks &amp; Enjoy.
<br />
-----------------------------------------------
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">//
<br />
// File: gmttime.php
<br />
//
<br />
// Description:
<br />
//&nbsp; &nbsp; Implements the gmttime function if missing from the PHP distribution
<br />
//
<br />

<br />
// Verifies that the function isn't already implemented
<br />
</span><span class="keyword">if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="default">gmttime</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; return;
<br />

<br />
</span><span class="comment">//
<br />
// Function: gmttime
<br />
//
<br />
// Description:
<br />
//&nbsp;&nbsp; Returns an array indexed as by the localtime() function:
<br />
//&nbsp;&nbsp; - 0 or tm_sec: Seconds
<br />
//&nbsp;&nbsp; - 1 or tm_min: Minutes
<br />
//&nbsp;&nbsp; - 2 or tm_hour: Hour
<br />
//&nbsp;&nbsp; - 3 or tm_mday: Day of the month
<br />
//&nbsp;&nbsp; - 4 or tm_mon: Month of the year
<br />
//&nbsp;&nbsp; - 5 or tm_year: Years since 1900
<br />
//&nbsp;&nbsp; - 6 or tm_wday: Day of the week
<br />
//&nbsp;&nbsp; - 7 or tm_yday: Day of the year
<br />
//&nbsp;&nbsp; - 8 or tm_isdst: Is daylight saving time in effect
<br />
//&nbsp;&nbsp; - tm_fyear: Full year (only available with associative array)
<br />
//
<br />
// Arguments:
<br />
//&nbsp;&nbsp; - Timestamp
<br />
//&nbsp;&nbsp; - Boolean (for associative indexing: 0 = off, 1 = on)
<br />
//
<br />
// Returns:
<br />
//&nbsp;&nbsp; An array on success,
<br />
//&nbsp;&nbsp; false on failure.
<br />
//
<br />
</span><span class="keyword">function </span><span class="default">gmttime</span><span class="keyword">(</span><span class="default">$dTimestamp </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$bAssoc </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Evaluate how much difference there is between local and GTM/UTC
<br />
&nbsp;&nbsp;&nbsp; // Don't forget to correct for daylight saving time...
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aNow </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$iDelta </span><span class="keyword">= </span><span class="default">gmmktime</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1970</span><span class="keyword">, </span><span class="default">$aNow</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">]) - </span><span class="default">mktime</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1970</span><span class="keyword">, </span><span class="default">$aNow</span><span class="keyword">[</span><span class="default">8</span><span class="keyword">]);
<br />

<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$bAssoc</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$dTimestamp </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">time</span><span class="keyword">() - </span><span class="default">$iDelta</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">$dTimestamp </span><span class="keyword">- </span><span class="default">$iDelta</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// For associative array, add full year index
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$dTimestamp </span><span class="keyword">== </span><span class="string">''</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aGMTTime </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">time</span><span class="keyword">() - </span><span class="default">$iDelta</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aGMTTime </span><span class="keyword">= </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">$dTimestamp </span><span class="keyword">- </span><span class="default">$iDelta</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aGMTTime</span><span class="keyword">[</span><span class="string">'tm_fyear'</span><span class="keyword">] = </span><span class="default">$aGMTTime</span><span class="keyword">[</span><span class="string">'tm_year'</span><span class="keyword">] + </span><span class="default">1900</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$aGMTTime</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } </span><span class="comment">// End [IF] return associative array?
<br />
</span><span class="keyword">} </span><span class="comment">// End [FUNCTION] gmttime
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20336""></a>
  <div class="note">
   <strong class="user">bens_nospam at benjamindsmith dot com</strong>
   <a href="#20336" class="date">30-Mar-2002 06:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You must keep in mind the difference between your server's time and your client's time! <br />
<br />
I ran into this one when I wrote a calendar-based reminder system with SMS messaging - guys back east were always getting their messages late. (!?!) <br />
<br />
I wrote two functions as wrappers for date handling, ServerTime() and ClientTime() that take client time (integer timestamp) and translate to server time and vice-versa based on config file settings. <br />
<br />
Needless to say, you CANNOT FORGET THIS.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14936""></a>
  <div class="note">
   <strong class="user">test at test dot de</strong>
   <a href="#14936" class="date">21-Aug-2001 10:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
to set up berlin time it could look like this:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">print </span><span class="string">"&lt;HTML&gt;&lt;body&gt;&lt;pre&gt;"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setlocale</span><span class="keyword">( </span><span class="string">"LC_ALL"</span><span class="keyword">, </span><span class="string">"de_DE" </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">putenv</span><span class="keyword">( </span><span class="string">"PHP_TZ=Europe/Berlin" </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$now </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">localtime</span><span class="keyword">(</span><span class="default">time</span><span class="keyword">(),</span><span class="default">true</span><span class="keyword">) );
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">( </span><span class="default">getdate</span><span class="keyword">() );
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="default">date</span><span class="keyword">(</span><span class="string">"H:i:s"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="default">date</span><span class="keyword">(</span><span class="string">"T"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="14203""></a>
  <div class="note">
   <strong class="user">verdy_p at wanadoo dot fr</strong>
   <a href="#14203" class="date">22-Jul-2001 05:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The corresponding function call to get the GMT time is not specified here. Only local time is reported, according to the current TZ environment setting.
<br />
One could try to use putenv() to set another timezone temporarily, however when running PHP in safe mode, putenv() is disabled and cannot be used in scripts.
<br />
However it's possible to simulate gmttime() by using localtime() and by transforming the results in the returned array.
<br />
The biggest problem with this function is that it is using an OS-dependent and localtime() function which is also depending on the standard C library implementation (some of them, do not support accurate locales). The second problem is that localtime() does not return an index specifying the local timezone offset, so transforming this date to UTC will become very ugly. Some systems support the gmtime() C function call, some don't. To get the timezone, some C libraries provide a global _timezone variable, some provide it as a macro that use a function call, some do not provide any variable, and one must deduce it by interpreting the TZ environment. This is too much ugly for PHP.
<br />

<br />
PHP should be extended by adding support to gmttime() with the same parameters, but the returned array should include additional indices to store the timezone offsets in seconds and names for both standard time and DST, for example:
<br />
&nbsp;[tz_offset_std] = 3600,
<br />
&nbsp;[tz_offset_dst]= 7200,
<br />
&nbsp;[tz_name_std] = 'CET', (GMT+01:00)
<br />
&nbsp;[tz_name_dst] = 'CEDT'. (GMT+02:00)
<br />
Or for the international, locale-independant, Zulu time (also known as UCT or simply UT), returned by gmtime():
<br />
&nbsp;[tz_offset] = 0,
<br />
&nbsp;[tz_offset_dst]= 0,
<br />
&nbsp;[tz_name] = 'Z',
<br />
&nbsp;[tz_name_dst] = 'Z'.
<br />

<br />
But it's much easier to use PHP's date() and gmdate() to make such transformations.
<br />

<br />
Beware of DST rules! In the southern hemisphere, standard time still occurs during winter, but the southern Winter is in June, not in December ! Use the tm_isdst indicator to know which timezone to display or interpret !</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
