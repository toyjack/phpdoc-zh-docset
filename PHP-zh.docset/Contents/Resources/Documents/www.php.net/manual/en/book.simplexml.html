<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>SimpleXML</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.libxml-use-internal-errors.html">? libxml_use_internal_errors</a></li>
      <li style="float: right;"><a href="intro.simplexml.html">简介 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="refs.xml.html">XML 操作</a></li>
    <li>SimpleXML</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="book.simplexml" class="book">
 
 <h1 class="title">SimpleXML</h1>
 
 
 
 
 
 







 







 







 




 




 







 
<ul class="chunklist chunklist_book"><li><a href="intro.simplexml.html">简介</a></li><li><a href="simplexml.setup.html">安装／配置</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="simplexml.requirements.html">需求</a></li><li><a href="simplexml.installation.html">安装</a></li><li><a href="simplexml.configuration.html">运行时配置</a></li><li><a href="simplexml.resources.html">资源类型</a></li></ul></li><li><a href="simplexml.constants.html">预定义常量</a></li><li><a href="simplexml.examples.html">范例</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="simplexml.examples-basic.html">Basic SimpleXML usage</a></li><li><a href="simplexml.examples-errors.html">Dealing with XML errors</a></li></ul></li><li><a href="class.simplexmlelement.html">SimpleXMLElement</a> &mdash; The SimpleXMLElement class<ul class="chunklist chunklist_book chunklist_children"><li><a href="simplexmlelement.addattribute.html">SimpleXMLElement::addAttribute</a> &mdash; Adds an attribute to the SimpleXML element</li><li><a href="simplexmlelement.addchild.html">SimpleXMLElement::addChild</a> &mdash; Adds a child element to the XML node</li><li><a href="simplexmlelement.asxml.html">SimpleXMLElement::asXML</a> &mdash; Return a well-formed XML string based on SimpleXML element</li><li><a href="simplexmlelement.attributes.html">SimpleXMLElement::attributes</a> &mdash; Identifies an element's attributes</li><li><a href="simplexmlelement.children.html">SimpleXMLElement::children</a> &mdash; Finds children of given node</li><li><a href="simplexmlelement.construct.html">SimpleXMLElement::__construct</a> &mdash; Creates a new SimpleXMLElement object</li><li><a href="simplexmlelement.count.html">SimpleXMLElement::count</a> &mdash; Counts the children of an element</li><li><a href="simplexmlelement.getdocnamespaces.html">SimpleXMLElement::getDocNamespaces</a> &mdash; Returns namespaces declared in document</li><li><a href="simplexmlelement.getname.html">SimpleXMLElement::getName</a> &mdash; Gets the name of the XML element</li><li><a href="simplexmlelement.getnamespaces.html">SimpleXMLElement::getNamespaces</a> &mdash; Returns namespaces used in document</li><li><a href="simplexmlelement.registerxpathnamespace.html">SimpleXMLElement::registerXPathNamespace</a> &mdash; Creates a prefix/ns context for the next XPath query</li><li><a href="simplexmlelement.savexml.html">SimpleXMLElement::saveXML</a> &mdash; 别名 SimpleXMLElement::asXML</li><li><a href="simplexmlelement.tostring.html">SimpleXMLElement::__toString</a> &mdash; Returns the string content</li><li><a href="simplexmlelement.xpath.html">SimpleXMLElement::xpath</a> &mdash; Runs XPath query on XML data</li></ul></li><li><a href="class.simplexmliterator.html">SimpleXMLIterator</a> &mdash; The SimpleXMLIterator class<ul class="chunklist chunklist_book chunklist_children"><li><a href="simplexmliterator.current.html">SimpleXMLIterator::current</a> &mdash; Returns the current element</li><li><a href="simplexmliterator.getchildren.html">SimpleXMLIterator::getChildren</a> &mdash; Returns the sub-elements of the current element</li><li><a href="simplexmliterator.haschildren.html">SimpleXMLIterator::hasChildren</a> &mdash; Checks whether the current element has sub elements</li><li><a href="simplexmliterator.key.html">SimpleXMLIterator::key</a> &mdash; Return current key</li><li><a href="simplexmliterator.next.html">SimpleXMLIterator::next</a> &mdash; Move to next element</li><li><a href="simplexmliterator.rewind.html">SimpleXMLIterator::rewind</a> &mdash; Rewind to the first element</li><li><a href="simplexmliterator.valid.html">SimpleXMLIterator::valid</a> &mdash; Check whether the current element is valid</li></ul></li><li><a href="ref.simplexml.html">SimpleXML 函数</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="function.simplexml-import-dom.html">simplexml_import_dom</a> &mdash; Get a SimpleXMLElement object from a DOM node</li><li><a href="function.simplexml-load-file.html">simplexml_load_file</a> &mdash; Interprets an XML file into an object</li><li><a href="function.simplexml-load-string.html">simplexml_load_string</a> &mdash; Interprets a string of XML into an object</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="124534""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#124534" class="date">25-Dec-2019 09:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">array_to_xml</span><span class="keyword">( </span><span class="default">$array</span><span class="keyword">, </span><span class="default">$xml </span><span class="keyword">= </span><span class="default">null </span><span class="keyword">) {<br />
&nbsp; if ( </span><span class="default">is_array</span><span class="keyword">( </span><span class="default">$array </span><span class="keyword">) ) {<br />
&nbsp;&nbsp;&nbsp; foreach( </span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ( </span><span class="default">is_int</span><span class="keyword">( </span><span class="default">$key </span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$key </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$node </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$parent </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">xpath</span><span class="keyword">( </span><span class="string">".." </span><span class="keyword">)[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$node </span><span class="keyword">= </span><span class="default">$parent</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">( </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">() );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$node </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">addChild</span><span class="keyword">( </span><span class="default">$key </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">array_to_xml</span><span class="keyword">( </span><span class="default">$value</span><span class="keyword">, </span><span class="default">$node </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp; }<br />
}<br />
<br />
</span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">"&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;&lt;root&gt;&lt;/root&gt;" </span><span class="keyword">);<br />
<br />
</span><span class="default">array_to_xml</span><span class="keyword">( </span><span class="default">$array</span><span class="keyword">, </span><span class="default">$xml </span><span class="keyword">);<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120167""></a>
  <div class="note">
   <strong class="user">charles dot a dot dacosta at gmail dot com</strong>
   <a href="#120167" class="date">15-Nov-2016 09:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had to do the following to catch the fact that my simplexml_load_string call was not working right (it was returning empty objects).<br />
<br />
$statistik = simplexml_load_string($record,"SimpleXMLElement",LIBXML_NSCLEAN,$ns,TRUE); <br />
<br />
&nbsp;&nbsp;&nbsp; if (($statistik === FALSE) or ($statistik === NULL) or empty($statistik))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "$ctr) STATISTIK ERROR---\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; var_dump($statistik);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "\n\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo "Failed loading XML\n";<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(libxml_get_errors() as $error) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo "\n", $error-&gt;message;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; die();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
before I put the check for "empty()" I was not catching the error.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119080""></a>
  <div class="note">
   <strong class="user">oleg at mastak dot fi</strong>
   <a href="#119080" class="date">30-Mar-2016 09:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Two lines xml2array:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlstring</span><span class="keyword">);<br />
</span><span class="default">$array </span><span class="keyword">= (array) </span><span class="default">$xml</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116781""></a>
  <div class="note">
   <strong class="user">Serge</strong>
   <a href="#116781" class="date">26-Feb-2015 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
XML data values should not contain "&amp;" and that need to be replaced by html-entity "&amp;amp;"<br />
<br />
You can use this code to replace lonely "&amp;" to "&amp;amp;":<br />
<br />
<span class="default">&lt;?php<br />
$sText </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'#&amp;(?![a-z]{1,6};)#i'</span><span class="keyword">, </span><span class="string">'&amp;amp;'</span><span class="keyword">, </span><span class="default">$sText</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
This will replace just "&amp;" into "&amp;amp;" but dont touches other html-entities like "&amp;nbsp;", "&amp;lt;" etc and, of course, "&amp;amp;".<br />
<br />
P.S. In regexp max length is 6 becouse I found that is the maximum length of possible html entity using this code:<br />
<span class="default">&lt;?php<br />
max</span><span class="keyword">(</span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'strlen'</span><span class="keyword">, </span><span class="default">array_values</span><span class="keyword">(</span><span class="default">get_html_translation_table</span><span class="keyword">(</span><span class="default">HTML_ENTITIES</span><span class="keyword">, </span><span class="default">ENT_QUOTES </span><span class="keyword">| </span><span class="default">ENT_HTML5</span><span class="keyword">)))) - </span><span class="default">2<br />
?&gt;<br />
</span>minus two is for first "&amp;" and last ";" in an any html entity.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114201""></a>
  <div class="note">
   <strong class="user">Tim Adam Perez</strong>
   <a href="#114201" class="date">23-Jan-2014 08:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
XML to Array in a single line:<br />
$array = (array) simplexml_load_string($xml);<br />
<br />
Enjoy!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113485""></a>
  <div class="note">
   <strong class="user">maikel at yuluma dot com</strong>
   <a href="#113485" class="date">17-Oct-2013 09:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In reply to&nbsp; soloman at textgrid dot com,<br />
<br />
2 line XML2Array:<br />
<br />
$xml = simplexml_load_string($file);<br />
$array = (array)$xml;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113348""></a>
  <div class="note">
   <strong class="user">dkrnl at yandex dot ru</strong>
   <a href="#113348" class="date">30-Sep-2013 02:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Wrapper XMLReader class, for simple SAX-reading huge xml:<br />
https://github.com/dkrnl/SimpleXMLReader<br />
<br />
Usage example: <a href="http://github.com/dkrnl/SimpleXMLReader/blob/master/examples/example1.php" rel="nofollow" target="_blank">http://github.com/dkrnl/SimpleXMLReader/blob/master/examples/example1.php</a><br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Simple XML Reader<br />
&nbsp;*<br />
&nbsp;* @license Public Domain<br />
&nbsp;* @author Dmitry Pyatkov(aka dkrnl) &lt;dkrnl@yandex.ru&gt;<br />
&nbsp;* @url <a href="http://github.com/dkrnl/SimpleXMLReader" rel="nofollow" target="_blank">http://github.com/dkrnl/SimpleXMLReader</a><br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">SimpleXMLReader </span><span class="keyword">extends </span><span class="default">XMLReader<br />
</span><span class="keyword">{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Callbacks<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @var array<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$callback </span><span class="keyword">= array();<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Add node callback<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string&nbsp;&nbsp; $name<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; callback $callback<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; integer&nbsp; $nodeType<br />
&nbsp;&nbsp; &nbsp; * @return SimpleXMLReader<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">registerCallback</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$callback</span><span class="keyword">, </span><span class="default">$nodeType </span><span class="keyword">= </span><span class="default">XMLREADER</span><span class="keyword">::</span><span class="default">ELEMENT</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Already exists callback </span><span class="default">$name</span><span class="string">(</span><span class="default">$nodeType</span><span class="string">)."</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">is_callable</span><span class="keyword">(</span><span class="default">$callback</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Already exists parser callback </span><span class="default">$name</span><span class="string">(</span><span class="default">$nodeType</span><span class="string">)."</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$callback</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Remove node callback<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string&nbsp; $name<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; integer $nodeType<br />
&nbsp;&nbsp; &nbsp; * @return SimpleXMLReader<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">unRegisterCallback</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, </span><span class="default">$nodeType </span><span class="keyword">= </span><span class="default">XMLREADER</span><span class="keyword">::</span><span class="default">ELEMENT</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Unknow parser callback </span><span class="default">$name</span><span class="string">(</span><span class="default">$nodeType</span><span class="string">)."</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$nodeType</span><span class="keyword">][</span><span class="default">$name</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Run parser<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @return void<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">parse</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (empty(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">"Empty parser callback."</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$continue </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$continue </span><span class="keyword">&amp;&amp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">read</span><span class="keyword">()) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">nodeType</span><span class="keyword">][</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$continue </span><span class="keyword">= </span><span class="default">call_user_func</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">callback</span><span class="keyword">[</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">nodeType</span><span class="keyword">][</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">name</span><span class="keyword">], </span><span class="default">$this</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Run XPath query on current node<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $path<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $version<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $encoding<br />
&nbsp;&nbsp; &nbsp; * @return array(SimpleXMLElement)<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">expandXpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">, </span><span class="default">$version </span><span class="keyword">= </span><span class="string">"1.0"</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">"UTF-8"</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expandSimpleXml</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">)-&gt;</span><span class="default">xpath</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Expand current node to string<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $version<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $encoding<br />
&nbsp;&nbsp; &nbsp; * @return SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">expandString</span><span class="keyword">(</span><span class="default">$version </span><span class="keyword">= </span><span class="string">"1.0"</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">"UTF-8"</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expandSimpleXml</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">)-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Expand current node to SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $version<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $encoding<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $className<br />
&nbsp;&nbsp; &nbsp; * @return SimpleXMLElement<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">expandSimpleXml</span><span class="keyword">(</span><span class="default">$version </span><span class="keyword">= </span><span class="string">"1.0"</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">"UTF-8"</span><span class="keyword">, </span><span class="default">$className </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expand</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$document </span><span class="keyword">= new </span><span class="default">DomDocument</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$node </span><span class="keyword">= </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">importNode</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">appendChild</span><span class="keyword">(</span><span class="default">$node</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">simplexml_import_dom</span><span class="keyword">(</span><span class="default">$node</span><span class="keyword">, </span><span class="default">$className</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Expand current node to DomDocument<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $version<br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; string $encoding<br />
&nbsp;&nbsp; &nbsp; * @return DomDocument<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">expandDomDocument</span><span class="keyword">(</span><span class="default">$version </span><span class="keyword">= </span><span class="string">"1.0"</span><span class="keyword">, </span><span class="default">$encoding </span><span class="keyword">= </span><span class="string">"UTF-8"</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$element </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expand</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$document </span><span class="keyword">= new </span><span class="default">DomDocument</span><span class="keyword">(</span><span class="default">$version</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$node </span><span class="keyword">= </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">importNode</span><span class="keyword">(</span><span class="default">$element</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$document</span><span class="keyword">-&gt;</span><span class="default">appendChild</span><span class="keyword">(</span><span class="default">$node</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$document</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110958""></a>
  <div class="note">
   <strong class="user">whyme</strong>
   <a href="#110958" class="date">28-Dec-2012 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple means simple.&nbsp; If you know the structure and just want the value of a tag:
<br />

<br />
<span class="default">&lt;?php
<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$xmlfile</span><span class="keyword">);
<br />
print </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">City</span><span class="keyword">-&gt;</span><span class="default">Street</span><span class="keyword">-&gt;</span><span class="default">Address</span><span class="keyword">-&gt;</span><span class="default">HouseColor</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Warning, numbers can come out as strings, empty elements like &lt;HouseColor&gt;&lt;/HouseColor&gt; come out as array(0)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109154""></a>
  <div class="note">
   <strong class="user">Laurent Vervisch</strong>
   <a href="#109154" class="date">24-Jun-2012 10:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is an example of an easy mapping between xml and classes defined by user.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">XmlClass </span><span class="keyword">extends </span><span class="default">SimpleXMLElement<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Returns this object as an instance of the given class.<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public function </span><span class="default">asInstanceOf</span><span class="keyword">(</span><span class="default">$class_name</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// should check that class_name is valid<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">simplexml_import_dom</span><span class="keyword">(</span><span class="default">dom_import_simplexml</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">), </span><span class="default">$class_name</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">__call</span><span class="keyword">(</span><span class="default">$name</span><span class="keyword">, array </span><span class="default">$arguments</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"magic __call called for method </span><span class="default">$name</span><span class="string"> on instance of "</span><span class="keyword">.</span><span class="default">get_class</span><span class="keyword">().</span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// class could be mapped according $this-&gt;getName()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$class_name </span><span class="keyword">= </span><span class="string">'Test'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$instance </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">asInstanceOf</span><span class="keyword">(</span><span class="default">$class_name</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">call_user_func_array</span><span class="keyword">(array(</span><span class="default">$instance</span><span class="keyword">, </span><span class="default">$name</span><span class="keyword">), </span><span class="default">$arguments</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
class </span><span class="default">Test </span><span class="keyword">extends </span><span class="default">XmlClass<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; public function </span><span class="default">setValue</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;{</span><span class="default">0</span><span class="keyword">} = </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">XmlClass</span><span class="keyword">(</span><span class="string">'&lt;example&gt;&lt;test/&gt;&lt;/example&gt;'</span><span class="keyword">);<br />
</span><span class="default">$test </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">-&gt;</span><span class="default">asInstanceOf</span><span class="keyword">(</span><span class="string">'Test'</span><span class="keyword">);<br />
echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">), </span><span class="string">"\n"</span><span class="keyword">;<br />
echo </span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$test</span><span class="keyword">), </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">$test</span><span class="keyword">-&gt;</span><span class="default">setValue</span><span class="keyword">(</span><span class="string">'value set directly by instance of Test'</span><span class="keyword">);<br />
echo (string)</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
echo (string)</span><span class="default">$test</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">-&gt;</span><span class="default">setValue</span><span class="keyword">(</span><span class="string">'value set by instance of XmlClass and magic __call'</span><span class="keyword">);<br />
echo (string)</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">test</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
echo (string)</span><span class="default">$test</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
XmlClass<br />
Test<br />
value set directly by instance of Test<br />
value set directly by instance of Test<br />
magic __call called for method setValue on instance of XmlClass<br />
value set by instance of XmlClass and magic __call<br />
value set by instance of XmlClass and magic __call</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108688""></a>
  <div class="note">
   <strong class="user">xaviered at gmail dot com</strong>
   <a href="#108688" class="date">17-May-2012 07:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a recursive function that will convert a given SimpleXMLElement object into an array, preserving namespaces and attributes.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">xmlObjToArr</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$namespace </span><span class="keyword">= </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">getDocNamespaces</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$namespace</span><span class="keyword">[</span><span class="default">NULL</span><span class="keyword">] = </span><span class="default">NULL</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= array();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attributes </span><span class="keyword">= array();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">((string)</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">());
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">((string)</span><span class="default">$obj</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) &lt;= </span><span class="default">0 </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">NULL</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// get info for all namespaces
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$namespace </span><span class="keyword">as </span><span class="default">$ns</span><span class="keyword">=&gt;</span><span class="default">$nsUrl </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// atributes
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$objAttributes </span><span class="keyword">= </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">(</span><span class="default">$ns</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$objAttributes </span><span class="keyword">as </span><span class="default">$attributeName </span><span class="keyword">=&gt; </span><span class="default">$attributeValue </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attribName </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">((string)</span><span class="default">$attributeName</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attribVal </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">((string)</span><span class="default">$attributeValue</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!empty(</span><span class="default">$ns</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attribName </span><span class="keyword">= </span><span class="default">$ns </span><span class="keyword">. </span><span class="string">':' </span><span class="keyword">. </span><span class="default">$attribName</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attributes</span><span class="keyword">[</span><span class="default">$attribName</span><span class="keyword">] = </span><span class="default">$attribVal</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// children
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$objChildren </span><span class="keyword">= </span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">(</span><span class="default">$ns</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach( </span><span class="default">$objChildren </span><span class="keyword">as </span><span class="default">$childName</span><span class="keyword">=&gt;</span><span class="default">$child </span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childName </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">((string)</span><span class="default">$childName</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !empty(</span><span class="default">$ns</span><span class="keyword">) ) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childName </span><span class="keyword">= </span><span class="default">$ns</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">.</span><span class="default">$childName</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$childName</span><span class="keyword">][] = </span><span class="default">xmlObjToArr</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'name'</span><span class="keyword">=&gt;</span><span class="default">$name</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'text'</span><span class="keyword">=&gt;</span><span class="default">$text</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'attributes'</span><span class="keyword">=&gt;</span><span class="default">$attributes</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'children'</span><span class="keyword">=&gt;</span><span class="default">$children
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108039""></a>
  <div class="note">
   <strong class="user">thedoc8786 at gmail dot com</strong>
   <a href="#108039" class="date">23-Mar-2012 07:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
FAIL! This function works better than the one I posted below:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">toArray</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">), </span><span class="default">TRUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ( </span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">) as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( empty(</span><span class="default">$value</span><span class="keyword">) ) </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">NULL</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">) ) </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">toArray</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108035""></a>
  <div class="note">
   <strong class="user">thedoc8786 at gmail dot com</strong>
   <a href="#108035" class="date">23-Mar-2012 04:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I know it is over-done, but the following is a super-short example of a XML to Array conversion function (recursive):<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">toArray</span><span class="keyword">(</span><span class="default">SimpleXMLElement $xml</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= (array)</span><span class="default">$xml</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ( </span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">) as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$value </span><span class="keyword">instanceof </span><span class="default">SimpleXMLElement </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = empty(</span><span class="default">$value</span><span class="keyword">) ? </span><span class="default">NULL </span><span class="keyword">: </span><span class="default">toArray</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$array</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105697""></a>
  <div class="note">
   <strong class="user">xananax at yelostudio dot com</strong>
   <a href="#105697" class="date">07-Sep-2011 06:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
None of the XML2Array functions that I found satisfied me completely; Their results did not always fit the project I was working on, and I found none that would account for repeating XML elements (such as
<br />
&lt;fields&gt;&lt;field/&gt;&lt;field/&gt;&lt;field/&gt;&lt;/fields&gt;)
<br />
So I rolled out my own; hope it helps someone.
<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* Converts a simpleXML element into an array. Preserves attributes.&lt;br/&gt;
<br />
&nbsp;* You can choose to get your elements either flattened, or stored in a custom
<br />
&nbsp;* index that you define.&lt;br/&gt;
<br />
&nbsp;* For example, for a given element
<br />
&nbsp;* &lt;code&gt;
<br />
&nbsp;* &lt;field name="someName" type="someType"/&gt;
<br />
&nbsp;* &lt;/code&gt;
<br />
&nbsp;* &lt;br&gt;
<br />
&nbsp;* if you choose to flatten attributes, you would get:
<br />
&nbsp;* &lt;code&gt;
<br />
&nbsp;* $array['field']['name'] = 'someName';
<br />
&nbsp;* $array['field']['type'] = 'someType';
<br />
&nbsp;* &lt;/code&gt;
<br />
&nbsp;* If you choose not to flatten, you get:
<br />
&nbsp;* &lt;code&gt;
<br />
&nbsp;* $array['field']['@attributes']['name'] = 'someName';
<br />
&nbsp;* &lt;/code&gt;
<br />
&nbsp;* &lt;br&gt;__________________________________________________________&lt;br&gt;
<br />
&nbsp;* Repeating fields are stored in indexed arrays. so for a markup such as:
<br />
&nbsp;* &lt;code&gt;
<br />
&nbsp;* &lt;parent&gt;
<br />
&nbsp;*&nbsp; &nbsp;&nbsp; &lt;child&gt;a&lt;/child&gt;
<br />
&nbsp;*&nbsp; &nbsp;&nbsp; &lt;child&gt;b&lt;/child&gt;
<br />
&nbsp;*&nbsp; &nbsp;&nbsp; &lt;child&gt;c&lt;/child&gt;
<br />
&nbsp;* ...
<br />
&nbsp;* &lt;/code&gt;
<br />
&nbsp;* you array would be:
<br />
&nbsp;* &lt;code&gt;
<br />
&nbsp;* $array['parent']['child'][0] = 'a';
<br />
&nbsp;* $array['parent']['child'][1] = 'b';
<br />
&nbsp;* ...And so on.
<br />
&nbsp;* &lt;/code&gt;
<br />
&nbsp;* @param simpleXMLElement&nbsp; &nbsp; $xml&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the XML to convert
<br />
&nbsp;* @param boolean|string&nbsp; &nbsp; $attributesKey&nbsp; &nbsp; if you pass TRUE, all values will be
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stored under an '@attributes' index.
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note that you can also pass a string
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to change the default index.&lt;br/&gt;
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; defaults to null.
<br />
&nbsp;* @param boolean|string&nbsp; &nbsp; $childrenKey&nbsp; &nbsp; if you pass TRUE, all values will be
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stored under an '@children' index.
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Note that you can also pass a string
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to change the default index.&lt;br/&gt;
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; defaults to null.
<br />
&nbsp;* @param boolean|string&nbsp; &nbsp; $valueKey&nbsp; &nbsp; &nbsp; &nbsp; if you pass TRUE, all values will be
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stored under an '@values' index. Note
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; that you can also pass a string to
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; change the default index.&lt;br/&gt;
<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; defaults to null.
<br />
&nbsp;* @return array the resulting array.
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">simpleXMLToArray</span><span class="keyword">(</span><span class="default">SimpleXMLElement $xml</span><span class="keyword">,</span><span class="default">$attributesKey</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">,</span><span class="default">$childrenKey</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">,</span><span class="default">$valueKey</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">){
<br />

<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$childrenKey </span><span class="keyword">&amp;&amp; !</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$childrenKey</span><span class="keyword">)){</span><span class="default">$childrenKey </span><span class="keyword">= </span><span class="string">'@children'</span><span class="keyword">;}
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$attributesKey </span><span class="keyword">&amp;&amp; !</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$attributesKey</span><span class="keyword">)){</span><span class="default">$attributesKey </span><span class="keyword">= </span><span class="string">'@attributes'</span><span class="keyword">;}
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$valueKey </span><span class="keyword">&amp;&amp; !</span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$valueKey</span><span class="keyword">)){</span><span class="default">$valueKey </span><span class="keyword">= </span><span class="string">'@values'</span><span class="keyword">;}
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$return </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$name </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_value </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">((string)</span><span class="default">$xml</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$_value</span><span class="keyword">)){</span><span class="default">$_value </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;};
<br />

<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$_value</span><span class="keyword">!==</span><span class="default">null</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$valueKey</span><span class="keyword">){</span><span class="default">$return</span><span class="keyword">[</span><span class="default">$valueKey</span><span class="keyword">] = </span><span class="default">$_value</span><span class="keyword">;}
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{</span><span class="default">$return </span><span class="keyword">= </span><span class="default">$_value</span><span class="keyword">;}
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$first </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$elementName </span><span class="keyword">=&gt; </span><span class="default">$child</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">simpleXMLToArray</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">,</span><span class="default">$attributesKey</span><span class="keyword">, </span><span class="default">$childrenKey</span><span class="keyword">,</span><span class="default">$valueKey</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(isset(</span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">])){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">])){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$first</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$temp </span><span class="keyword">= </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">][] = </span><span class="default">$temp</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">][] = </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }else{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">] = array(</span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">],</span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children</span><span class="keyword">[</span><span class="default">$elementName</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$children</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$childrenKey</span><span class="keyword">){</span><span class="default">$return</span><span class="keyword">[</span><span class="default">$childrenKey</span><span class="keyword">] = </span><span class="default">$children</span><span class="keyword">;}
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{</span><span class="default">$return </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$return</span><span class="keyword">,</span><span class="default">$children</span><span class="keyword">);}
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$attributes </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">attributes</span><span class="keyword">() as </span><span class="default">$name</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$attributes</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$attributes</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$attributesKey</span><span class="keyword">){</span><span class="default">$return</span><span class="keyword">[</span><span class="default">$attributesKey</span><span class="keyword">] = </span><span class="default">$attributes</span><span class="keyword">;}
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{</span><span class="default">$return </span><span class="keyword">= </span><span class="default">array_merge</span><span class="keyword">(</span><span class="default">$return</span><span class="keyword">, </span><span class="default">$attributes</span><span class="keyword">);}
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$return</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105330""></a>
  <div class="note">
   <strong class="user">soloman at textgrid dot com</strong>
   <a href="#105330" class="date">09-Aug-2011 05:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Three line xml2array:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xmlstring</span><span class="keyword">);<br />
</span><span class="default">$json </span><span class="keyword">= </span><span class="default">json_encode</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">);<br />
</span><span class="default">$array </span><span class="keyword">= </span><span class="default">json_decode</span><span class="keyword">(</span><span class="default">$json</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Ta da!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="103816""></a>
  <div class="note">
   <strong class="user">streaver91 at gmail dot com</strong>
   <a href="#103816" class="date">04-May-2011 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The BIGGEST differece between an XML and a PHP array is that in an XML file, the name of elements can be the same even if they are siblings, eg. "&lt;pa&gt;&lt;ch /&gt;&lt;ch /&gt;&lt;ch /&gt;&lt;/pa&gt;", while in an PHP array, the key of which must be different.
<br />

<br />
I think the array structure developed by svdmeer can fit for XML, and fits well.
<br />

<br />
here is an example array converted from an xml file:
<br />
array(
<br />
"@tag"=&gt;"name",
<br />
"@attr"=&gt;array(
<br />
&nbsp;&nbsp;&nbsp; "id"=&gt;"1","class"=&gt;"2")
<br />
"@text"=&gt;"some text",
<br />
)
<br />

<br />
or if it has childrens, that can be:
<br />

<br />
array(
<br />
"@tag"=&gt;"name",
<br />
"@attr"=&gt;array(
<br />
&nbsp;&nbsp;&nbsp; "id"=&gt;"1","class"=&gt;"2")
<br />
"@items"=&gt;array(
<br />
&nbsp;&nbsp;&nbsp; 0=&gt;array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; "@tag"=&gt;"name","@text"=&gt;"some text"
<br />
&nbsp;&nbsp;&nbsp; )
<br />
)
<br />

<br />
Also, I wrote a function that can change that array back to XML.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">array2XML</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">,</span><span class="default">$root</span><span class="keyword">) {
<br />
</span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">"&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?&gt;&lt;</span><span class="keyword">{</span><span class="default">$root</span><span class="keyword">}</span><span class="string">&gt;&lt;/</span><span class="keyword">{</span><span class="default">$root</span><span class="keyword">}</span><span class="string">&gt;"</span><span class="keyword">); 
<br />
</span><span class="default">$f </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$f,$c,$a'</span><span class="keyword">,</span><span class="string">' 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach($a as $v) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset($v["@text"])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ch = $c-&gt;addChild($v["@tag"],$v["@text"]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ch = $c-&gt;addChild($v["@tag"]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset($v["@items"])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $f($f,$ch,$v["@items"]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(isset($v["@attr"])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach($v["@attr"] as $attr =&gt; $val) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ch-&gt;addAttribute($attr,$val);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }'</span><span class="keyword">);
<br />
</span><span class="default">$f</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">,</span><span class="default">$xml</span><span class="keyword">,</span><span class="default">$arr</span><span class="keyword">);
<br />
return </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101949""></a>
  <div class="note">
   <strong class="user">phil at dier dot us</strong>
   <a href="#101949" class="date">19-Jan-2011 11:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a function I came up with to convert an associative array to XML.&nbsp; Works for multidimensional arrays as well.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">assocArrayToXML</span><span class="keyword">(</span><span class="default">$root_element_name</span><span class="keyword">,</span><span class="default">$ar</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="string">"&lt;?xml version=\"1.0\"?&gt;&lt;</span><span class="keyword">{</span><span class="default">$root_element_name</span><span class="keyword">}</span><span class="string">&gt;&lt;/</span><span class="keyword">{</span><span class="default">$root_element_name</span><span class="keyword">}</span><span class="string">&gt;"</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">create_function</span><span class="keyword">(</span><span class="string">'$f,$c,$a'</span><span class="keyword">,</span><span class="string">'
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach($a as $k=&gt;$v) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(is_array($v)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ch=$c-&gt;addChild($k);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $f($f,$ch,$v);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $c-&gt;addChild($k,$v);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f</span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">,</span><span class="default">$xml</span><span class="keyword">,</span><span class="default">$ar</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101063""></a>
  <div class="note">
   <strong class="user">philipp at strazny dot com</strong>
   <a href="#101063" class="date">23-Nov-2010 05:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a quick way to dump the nodeValues from SimpleXML into an array using the path to each nodeValue as key. The paths are compatible with e.g. DOMXPath. I use this when I need to update values externally (i.e. in code that doesn't know about the underlying xml). Then I use DOMXPath to find the node containing the original value and update it.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">XMLToArrayFlat</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, &amp;</span><span class="default">$return</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">, </span><span class="default">$root</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$xml </span><span class="keyword">instanceof </span><span class="default">SimpleXMLElement</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$children </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$root</span><span class="keyword">){ </span><span class="comment">// we're at root
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$path </span><span class="keyword">.= </span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">();
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">count</span><span class="keyword">(</span><span class="default">$children</span><span class="keyword">) == </span><span class="default">0 </span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$return</span><span class="keyword">[</span><span class="default">$path</span><span class="keyword">] = (string)</span><span class="default">$xml</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$seen</span><span class="keyword">=array();
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$children </span><span class="keyword">as </span><span class="default">$child </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$childname </span><span class="keyword">= (</span><span class="default">$child </span><span class="keyword">instanceof </span><span class="default">SimpleXMLElement</span><span class="keyword">)?</span><span class="default">$child</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">():</span><span class="default">$child</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( !isset(</span><span class="default">$seen</span><span class="keyword">[</span><span class="default">$childname</span><span class="keyword">])){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$seen</span><span class="keyword">[</span><span class="default">$childname</span><span class="keyword">]=</span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$seen</span><span class="keyword">[</span><span class="default">$childname</span><span class="keyword">]++;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">XMLToArrayFlat</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$return</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">.</span><span class="string">'/'</span><span class="keyword">.</span><span class="default">$child</span><span class="keyword">.</span><span class="string">'['</span><span class="keyword">.</span><span class="default">$seen</span><span class="keyword">[</span><span class="default">$childname</span><span class="keyword">].</span><span class="string">']'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
} 
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Use like this:
<br />

<br />
<span class="default">&lt;?php
<br />
$xml </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(...</span><span class="default">some xml string</span><span class="keyword">...);
<br />
</span><span class="default">$xmlarray </span><span class="keyword">= array(); </span><span class="comment">// this will hold the flattened data
<br />
</span><span class="default">XMLToArrayFlat</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$xmlarray</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
You can also pull multiple files in one array:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">foreach(</span><span class="default">$files </span><span class="keyword">as </span><span class="default">$file</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">XMLToArrayFlat</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$xmlarray</span><span class="keyword">, </span><span class="default">$file</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>The respective filename/path is thus prefixed to each key.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="100981""></a>
  <div class="note">
   <strong class="user">kristof at viewranger dot com</strong>
   <a href="#100981" class="date">18-Nov-2010 05:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you tried to load an XML file with this, but the CDATA parts were not loaded for some reason, is because you should do it this way:<br />
<br />
$xml = simplexml_load_file($this-&gt;filename, 'SimpleXMLElement', LIBXML_NOCDATA);<br />
<br />
This converts CDATA to String in the returning object.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99729""></a>
  <div class="note">
   <strong class="user">sherwinterunez at yahoo dot com</strong>
   <a href="#99729" class="date">01-Sep-2010 11:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">// Sherwin R. Terunez<br />
//<br />
// This is my own version of XML Object to Array<br />
// <br />
<br />
</span><span class="keyword">function </span><span class="default">amstore_xmlobj2array</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">, </span><span class="default">$level</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$items </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">)) return </span><span class="default">$items</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$child </span><span class="keyword">= (array)</span><span class="default">$obj</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">)&gt;</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$child </span><span class="keyword">as </span><span class="default">$aa</span><span class="keyword">=&gt;</span><span class="default">$bb</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$bb </span><span class="keyword">as </span><span class="default">$ee</span><span class="keyword">=&gt;</span><span class="default">$ff</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$ff</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$aa</span><span class="keyword">][</span><span class="default">$ee</span><span class="keyword">] = </span><span class="default">$ff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$ff</span><span class="keyword">)==</span><span class="string">'SimpleXMLElement'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$aa</span><span class="keyword">][</span><span class="default">$ee</span><span class="keyword">] = </span><span class="default">amstore_xmlobj2array</span><span class="keyword">(</span><span class="default">$ff</span><span class="keyword">,</span><span class="default">$level</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$aa</span><span class="keyword">] = </span><span class="default">$bb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">)==</span><span class="string">'SimpleXMLElement'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$aa</span><span class="keyword">] = </span><span class="default">amstore_xmlobj2array</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">,</span><span class="default">$level</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } else<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$child</span><span class="keyword">)&gt;</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$child </span><span class="keyword">as </span><span class="default">$aa</span><span class="keyword">=&gt;</span><span class="default">$bb</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">)&amp;&amp;!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$aa</span><span class="keyword">] = </span><span class="default">$bb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$aa</span><span class="keyword">] = </span><span class="default">amstore_xmlobj2array</span><span class="keyword">(</span><span class="default">$bb</span><span class="keyword">,</span><span class="default">$level</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach(</span><span class="default">$bb </span><span class="keyword">as </span><span class="default">$cc</span><span class="keyword">=&gt;</span><span class="default">$dd</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_object</span><span class="keyword">(</span><span class="default">$dd</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">()][</span><span class="default">$cc</span><span class="keyword">] = </span><span class="default">$dd</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">get_class</span><span class="keyword">(</span><span class="default">$dd</span><span class="keyword">)==</span><span class="string">'SimpleXMLElement'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$items</span><span class="keyword">[</span><span class="default">$obj</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">()][</span><span class="default">$cc</span><span class="keyword">] = </span><span class="default">amstore_xmlobj2array</span><span class="keyword">(</span><span class="default">$dd</span><span class="keyword">,</span><span class="default">$level</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$items</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97355""></a>
  <div class="note">
   <strong class="user">michael dot allen at emp dot shentel dot com</strong>
   <a href="#97355" class="date">15-Apr-2010 11:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a very robust SimpleXML parser.&nbsp; Can be used to load files, strings, or DOM into SimpleXML, or can be used to perform the reverse when handed SimpleXML.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
&nbsp;* XMLParser Class File<br />
&nbsp;*<br />
&nbsp;* This class loads an XML document into a SimpleXMLElement that can<br />
&nbsp;* be processed by the calling application.&nbsp; This accepts xml strings,<br />
&nbsp;* files, and DOM objects.&nbsp; It can also perform the reverse, converting<br />
&nbsp;* an SimpleXMLElement back into a string, file, or DOM object.<br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">XMLParser </span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * While parsing, parse the supplied XML document.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * Sets up a SimpleXMLElement object based on success of parsing<br />
&nbsp;&nbsp; &nbsp; * the XML document file.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param string $doc the xml document location path<br />
&nbsp;&nbsp; &nbsp; * @return object<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">loadFile</span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$doc</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception </span><span class="keyword">(</span><span class="string">"Unable to load the xml file " </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"using: \"</span><span class="default">$doc</span><span class="string">\""</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * While parsing, parse the supplied XML string.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * Sets up a SimpleXMLElement object based on success of parsing<br />
&nbsp;&nbsp; &nbsp; * the XML string.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param string $string the xml document string<br />
&nbsp;&nbsp; &nbsp; * @return object<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">loadString</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$string</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception </span><span class="keyword">(</span><span class="string">"Unable to load the xml string " </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"using: \"</span><span class="default">$string</span><span class="string">\""</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * While parsing, parse the supplied XML DOM node.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * Sets up a SimpleXMLElement object based on success of parsing<br />
&nbsp;&nbsp; &nbsp; * the XML DOM node.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param object $dom the xml DOM node<br />
&nbsp;&nbsp; &nbsp; * @return object<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">loadDOM</span><span class="keyword">(</span><span class="default">$dom</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$dom</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">simplexml_import_dom</span><span class="keyword">(</span><span class="default">$dom</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception </span><span class="keyword">(</span><span class="string">"Unable to load the xml DOM node " </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"using: \"</span><span class="default">$dom</span><span class="string">\""</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * While parsing, parse the SimpleXMLElement.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * Sets up a XML file, string, or DOM object based on success of<br />
&nbsp;&nbsp; &nbsp; * parsing the XML DOM node.<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param object $path the xml document location path<br />
&nbsp;&nbsp; &nbsp; * @param string $type the return type (string, file, dom)<br />
&nbsp;&nbsp; &nbsp; * @param object $simplexml the simple xml element<br />
&nbsp;&nbsp; &nbsp; * @return mixed<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">loadSXML</span><span class="keyword">(</span><span class="default">$simplexml</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$simplexml</span><span class="keyword">) &amp;&amp; isset(</span><span class="default">$type</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">$type</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'string'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$simplexml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'file'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$path</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$simplexml</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception </span><span class="keyword">(</span><span class="string">"Unable to create the XML file. Path is missing or" </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"is invalid: \"</span><span class="default">$path</span><span class="string">\""</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="string">'dom'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">dom_import_simplexml</span><span class="keyword">(</span><span class="default">$simplexml</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception </span><span class="keyword">(</span><span class="string">"Unable to load the simple XML element " </span><span class="keyword">.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">"using: \"</span><span class="default">$simplexml</span><span class="string">\""</span><span class="keyword">, </span><span class="default">E_USER_ERROR</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="96263""></a>
  <div class="note">
   <strong class="user">emmanuel</strong>
   <a href="#96263" class="date">17-Feb-2010 10:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
dynamic sql in php using xml:
<br />

<br />
test.xml:
<br />
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
<br />
&lt;sql&gt;
<br />
&nbsp;&nbsp;&nbsp; &lt;statement&gt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; SELECT * FROM USERS
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;call criteria="byId"&gt;WHERE id = %d&lt;/call&gt;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; &lt;call criteria="byUsername"&gt;WHERE username = "%s"&lt;/call&gt;;
<br />
&nbsp;&nbsp;&nbsp; &lt;/statement&gt;
<br />
&lt;/sql&gt;
<br />

<br />
index.php:
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">callMe</span><span class="keyword">(</span><span class="default">$param</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$search </span><span class="keyword">= array(</span><span class="string">'byUsername' </span><span class="keyword">=&gt; </span><span class="string">'dynsql'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$search</span><span class="keyword">[</span><span class="default">$param</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]])) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">sprintf</span><span class="keyword">(</span><span class="default">$param</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">], </span><span class="default">$search</span><span class="keyword">[</span><span class="default">$param</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]]);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="string">""</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="string">"test.xml"</span><span class="keyword">);
<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">statement</span><span class="keyword">-&gt;</span><span class="default">asXML</span><span class="keyword">();
<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">preg_replace_callback</span><span class="keyword">(</span><span class="string">'/&lt;call criteria="(\w+)"&gt;(.*?)&lt;\/call&gt;/'</span><span class="keyword">, </span><span class="string">'callMe'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);
<br />
</span><span class="default">$node </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);
<br />
echo </span><span class="default">$node</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
obviously, this example can be improved [in your own code.]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="95762""></a>
  <div class="note">
   <strong class="user">mahmutta at gmail dot com</strong>
   <a href="#95762" class="date">20-Jan-2010 12:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
while using simple xml and get double or float int value from xml object for using math operations (+ * - / ) some errors happens on the operation, this is because of simple xml returns everythings to objects. <br />
exmple;<br />
<br />
<span class="default">&lt;?php<br />
<br />
$name </span><span class="keyword">= </span><span class="string">"somestring"</span><span class="keyword">;<br />
</span><span class="default">$size </span><span class="keyword">= </span><span class="default">11.45</span><span class="keyword">;<br />
</span><span class="default">$xml </span><span class="keyword">= </span><span class="string">'<br />
&lt;xml&gt;<br />
&nbsp;&lt;name&gt;somestring&lt;/name&gt;<br />
&nbsp;&lt;size&gt;11.45&lt;/size&gt;<br />
&lt;/xml&gt;'</span><span class="keyword">;<br />
<br />
&nbsp;<br />
</span><span class="default">$xmlget </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">)<br />
<br />
echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">size</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">;&nbsp; &nbsp; </span><span class="comment">// 20&nbsp; its false<br />
// ($xml-&gt;size is an object (int)11 and&nbsp; (45) )<br />
<br />
// this is true<br />
</span><span class="keyword">echo </span><span class="default">$size</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// 22.90 <br />
</span><span class="keyword">echo (float)</span><span class="default">$size</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">;&nbsp;&nbsp; </span><span class="comment">// 22.90 <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94105""></a>
  <div class="note">
   <strong class="user">antoine dot rabanes at gmail dot com</strong>
   <a href="#94105" class="date">16-Oct-2009 07:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if for some reasons you need the string value instead of the simpleXML Object you can cast the return value as a string.
<br />

<br />
exemple: 
<br />

<br />
<span class="default">&lt;?php
<br />
$all_api_call </span><span class="keyword">= </span><span class="default">simplexml_load_file</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);
<br />
</span><span class="default">$all_api </span><span class="keyword">= array();
<br />
</span><span class="default">$all_api </span><span class="keyword">= </span><span class="default">$all_api_call</span><span class="keyword">-&gt;</span><span class="default">result</span><span class="keyword">;
<br />
</span><span class="default">$list_all_api_name </span><span class="keyword">= array();
<br />
</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
foreach (</span><span class="default">$all_api</span><span class="keyword">-&gt;</span><span class="default">children</span><span class="keyword">() as </span><span class="default">$funcky_function</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$string_tmp </span><span class="keyword">= (string )</span><span class="default">$funcky_function</span><span class="keyword">-&gt;</span><span class="default">function</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$list_all_api_name</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">++] = </span><span class="default">$putain</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91494""></a>
  <div class="note">
   <strong class="user">walter</strong>
   <a href="#91494" class="date">12-Jun-2009 07:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Working fix for the infamous SimpleXML + memcache bug.
<br />

<br />
Improves code at <a href="http://tinyurl.com/bmoon-simplexml to actually work for arbitrary-depth structures.&nbsp; (Because neither the function nor the json_decode(json_encode($obj" rel="nofollow" target="_blank">http://tinyurl.com/bmoon-simplexml to actually work for arbitrary-depth structures.&nbsp; (Because neither the function nor the json_decode(json_encode($obj</a>)) hack listed there worked for me.)
<br />

<br />
There's probably some superfluous code in here that could be improved on -- but it works!
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;</span><span class="comment"># convert a structure that may include objects to a pure
<br />
&nbsp;# array-based structure (that can be stored in memcache)
<br />
&nbsp;#&nbsp; ... includes support for simplexml!
<br />
&nbsp;# (nb: may have problems with infinite recursive structs)
<br />
&nbsp;</span><span class="keyword">function </span><span class="default">enforce_array</span><span class="keyword">(</span><span class="default">$obj</span><span class="keyword">) {
<br />
&nbsp; </span><span class="default">$array </span><span class="keyword">= (array)</span><span class="default">$obj</span><span class="keyword">;
<br />
&nbsp; if(empty(</span><span class="default">$array</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; </span><span class="default">$array </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp; }
<br />
&nbsp; else {
<br />
&nbsp;&nbsp; foreach(</span><span class="default">$array </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">is_scalar</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; if(</span><span class="default">is_a</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">,</span><span class="string">'SimpleXMLElement'</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="default">memcache_objects_to_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$tmp</span><span class="keyword">)) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$tmp </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">.</span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$tmp</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; else {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">enforce_array</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else {
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$array</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; }
<br />
&nbsp; }
<br />
&nbsp; return </span><span class="default">$array</span><span class="keyword">;
<br />
&nbsp;}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90554""></a>
  <div class="note">
   <strong class="user">mail at kleineedv dot de</strong>
   <a href="#90554" class="date">28-Apr-2009 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a problem with simplexml reading nodes from an xml file. It always return an SimpleXML-Object but not the text inside the node.
<br />

<br />
Example:
<br />
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
<br />
&lt;Test&gt;
<br />
&nbsp;&nbsp;&nbsp; &lt;Id&gt;123&lt;/Id&gt;
<br />
&lt;/Test&gt;
<br />

<br />
Reading this xml into a variable called $xml and then doing the following
<br />
<span class="default">&lt;?php
<br />
$myId </span><span class="keyword">= </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">Id</span><span class="keyword">;
<br />
</span><span class="default">?&gt;
<br />
</span>Did not return 123 in $myId, but instead I got a SimpleXMLElement Object.
<br />

<br />
The solution is simple, when you know it. Use explicit string conversion.
<br />
<span class="default">&lt;?php
<br />
$myId </span><span class="keyword">= (string)</span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">Id</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88457""></a>
  <div class="note">
   <strong class="user">oscargodson at gmail dot com</strong>
   <a href="#88457" class="date">25-Jan-2009 03:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To add to what others have said, you can't directly put a $_GET or $_POST value into a variable then into an attribute using SimpleXML. You must first convert it to an integer.<br />
<br />
This will NOT work<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp;&nbsp; $page_id </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'id'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">page</span><span class="keyword">[</span><span class="default">$page_id</span><span class="keyword">]<br />
</span><span class="default">?&gt;<br />
</span><br />
You will get something like:<br />
Notice: Trying to get property of non-object in /Applications/MAMP/htdocs/mysite/index.php on line 10<br />
<br />
However, this WILL work and is much simpler then using (string) or other methods.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; $page_id </span><span class="keyword">= </span><span class="default">intval</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'id'</span><span class="keyword">]);<br />
&nbsp;&nbsp; echo </span><span class="default">$xml</span><span class="keyword">-&gt;</span><span class="default">page</span><span class="keyword">[</span><span class="default">$page_id</span><span class="keyword">]<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87249""></a>
  <div class="note">
   <strong class="user">bxt at die-optimisten dot net</strong>
   <a href="#87249" class="date">26-Nov-2008 07:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Addition to QLeap's post: <br />
SimpleXML will return a reference to an object containing the node value and you can't use references in session variables as there is no feasible way to restore a reference to another variable. <br />
<br />
This won't work too:<br />
$val=$this-&gt;xml-&gt;node-&gt;attributes()-&gt;name;<br />
echo $array[$val]; // will cause a warning because of the wrong index type. <br />
<br />
You have to convert/cast to a String first:<br />
echo $array[(string)$val];<br />
<br />
This will work as expected, because converting will call the __toString() method. Therefor echo works too:<br />
echo $val; // will display the name</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87083""></a>
  <div class="note">
   <strong class="user">QLeap</strong>
   <a href="#87083" class="date">18-Nov-2008 02:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Storing SimpleXMLElement values in $_SESSION does not work. Saving the results as an object or individual elements of the object will result in the dreaded "Warning: session_start() [function.session-start]: Node no longer exists" error.<br />
<br />
For example, this does not work:<br />
<br />
&nbsp;&nbsp;&nbsp; $xml&nbsp; = new SimpleXMLElement($page);<br />
&nbsp;&nbsp;&nbsp; $country&nbsp; = $xml-&gt;Response-&gt;Placemark-&gt;AddressDetails-&gt;Country-&gt;CountryNameCode;<br />
&nbsp;&nbsp;&nbsp; $_SESSION['country'] = $country;<br />
<br />
This will work:<br />
<br />
&nbsp;&nbsp;&nbsp; $_SESSION['country'] = (string) $country;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85674""></a>
  <div class="note">
   <strong class="user">gwhitescarver at yahoo dot com</strong>
   <a href="#85674" class="date">11-Sep-2008 01:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Moving some code from a PHP 5.2.6 / Windows environment to a 5.2.0 / Linux environment, I somehow lost access to a plain text node within a SimpleXML Object.&nbsp; On a var_dump of $xml_node, a [0] element was shown as the string '12'.&nbsp; However, $xml_node[0] was evaluating NULL in 5.2.0.&nbsp; You can see below the code change I made, pulling my data out of the raw XML with a regular expression.&nbsp; Hope this is useful to someone.<br />
<br />
//In some versions of PHP it seems we cannot access the [0] element of a SimpleXML Object.&nbsp; Doesn't work in 5.2.0:<br />
//$count = $xml_node[0];<br />
//grab the raw XML:<br />
$count = ($xml_node-&gt;asXML());<br />
//pull out the number between the closing and opening brace of the xml:<br />
$count = preg_replace('/.*&gt;(\d*)&lt;.*/', '$1', $count);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85106""></a>
  <div class="note">
   <strong class="user">charlie at blankcanvasstudios dot com</strong>
   <a href="#85106" class="date">14-Aug-2008 11:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Optimizing aalaap at gmail dot com's php<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">is_rss</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$feed </span><span class="keyword">= </span><span class="default">simplexml_load_string</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$feed</span><span class="keyword">-&gt;</span><span class="default">channel</span><span class="keyword">-&gt;</span><span class="default">item</span><span class="keyword">)?</span><span class="default">true</span><span class="keyword">:</span><span class="default">false</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">is_atom</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$feed </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; (</span><span class="default">$feed</span><span class="keyword">-&gt;</span><span class="default">entry</span><span class="keyword">):</span><span class="default">true</span><span class="keyword">:</span><span class="default">false</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84135""></a>
  <div class="note">
   <strong class="user">aalaap at gmail dot com</strong>
   <a href="#84135" class="date">30-Jun-2008 06:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are two quick and dirty functions that use SimpleXML to detect if a feed xml is RSS or ATOM:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">is_rss</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$feed </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$feed</span><span class="keyword">-&gt;</span><span class="default">channel</span><span class="keyword">-&gt;</span><span class="default">item</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />

<br />
function </span><span class="default">is_atom</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">$feed </span><span class="keyword">= new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$feedxml</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$feed</span><span class="keyword">-&gt;</span><span class="default">entry</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The functions take in the full text feed (retrieved via cURL, for example) and return a true or a false based on the result.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
