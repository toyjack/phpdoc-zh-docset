<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>水平地画一行字符串</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.imagesettile.html">? imagesettile</a></li>
      <li style="float: right;"><a href="function.imagestringup.html">imagestringup ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.image.html">GD 和图像处理 函数</a></li>
    <li>水平地画一行字符串</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.imagestring" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">imagestring</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">imagestring</span> &mdash; <span class="dc-title">水平地画一行字符串</span></p>

 </div>
 <div class="refsect1 unknown-unknown-noteu" id="refsect1-function.imagestring-unknown-unknown-noteu">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>imagestring</strong></span>
    ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$image</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$font</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$x</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$y</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$s</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$col</code></span>
   ) : <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>imagestring()</strong></span> 用 <code class="parameter">col</code>
   颜色将字符串 <code class="parameter">s</code> 画到 <code class="parameter">image</code>
   所代表的图像的 <code class="parameter">x</code>，<code class="parameter">y</code>
   坐标处（这是字符串左上角坐标，整幅图像的左上角为 0，0）。如果
   <code class="parameter">font</code> 是 1，2，3，4 或 5，则使用内置字体。
  </p>
  <p class="para">
   <div class="example" id="example-3077">
    <p><strong>Example #1 <span class="function"><strong>imagestring()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;建立一幅&nbsp;100X30&nbsp;的图像<br /></span><span style="color: #0000BB">$im&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecreate</span><span style="color: #007700">(</span><span style="color: #0000BB">100</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">30</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;白色背景和蓝色文本<br /></span><span style="color: #0000BB">$bg&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$textcolor&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">imagecolorallocate</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">255</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;把字符串写在图像左上角<br /></span><span style="color: #0000BB">imagestring</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Hello&nbsp;world!"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$textcolor</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;输出图像<br /></span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-type:&nbsp;image/png"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">imagepng</span><span style="color: #007700">(</span><span style="color: #0000BB">$im</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   参见 <span class="function"><a href="function.imageloadfont.html" class="function">imageloadfont()</a></span> 和
   <span class="function"><a href="function.imagettftext.html" class="function">imagettftext()</a></span>。
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="123818""></a>
  <div class="note">
   <strong class="user">wheberson dot com dot br at gmail dot com</strong>
   <a href="#123818" class="date">02-May-2019 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// Convert e-mail to image (png)<br />
function convertEmailToImg ($aValue, $aRed, $aGreen, $aBlue, $aAlphaF=0, $aAlphaB=127, $aFontSize=4)<br />
<br />
{<br />
&nbsp;&nbsp;&nbsp; $img= imagecreatetruecolor (imagefontwidth ($aFontSize) * strlen ($aValue), imagefontheight ($aFontSize));<br />
&nbsp;&nbsp;&nbsp; imagesavealpha ($img, true);<br />
&nbsp;&nbsp;&nbsp; imagefill ($img, 0, 0, imagecolorallocatealpha ($img, 0, 0, 0, $aAlphaB));<br />
&nbsp;&nbsp;&nbsp; imagestring ($img, $aFontSize, 0, 0, $aValue, imagecolorallocatealpha ($img, $aRed, $aGreen, $aBlue, $aAlphaF));<br />
&nbsp;&nbsp;&nbsp; ob_start ();<br />
&nbsp;&nbsp;&nbsp; imagepng ($img);<br />
&nbsp;&nbsp;&nbsp; imagedestroy ($img);<br />
&nbsp;&nbsp;&nbsp; return base64_encode (ob_get_clean ());<br />
}<br />
<br />
// Example<br />
$imgString= convertEmailToImg ('contact@example.com', 0, 0, 255, 0, 127, 4);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116501""></a>
  <div class="note">
   <strong class="user">Booteille</strong>
   <a href="#116501" class="date">14-Jan-2015 12:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a function with similar declaration of imagestring() but who handles whitespaces (It creates new lines and 4 spaces instead of \n and \t) and image's size limits<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* @author Booteille<br />
&nbsp;*<br />
&nbsp;* @param resource $image<br />
&nbsp;* @param int $font<br />
&nbsp;* @param int $x<br />
&nbsp;* @param int $y<br />
&nbsp;* @param string $string<br />
&nbsp;* @param int $color<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">whitespaces_imagestring</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$font_height </span><span class="keyword">= </span><span class="default">imagefontheight</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$font_width </span><span class="keyword">= </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image_height </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$image_width </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$max_characters </span><span class="keyword">= (int) (</span><span class="default">$image_width </span><span class="keyword">- </span><span class="default">$x</span><span class="keyword">) / </span><span class="default">$font_width </span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$next_offset_y </span><span class="keyword">= </span><span class="default">$y</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$exploded_string </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">), </span><span class="default">$i_count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$exploded_string</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$i_count</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$exploded_wrapped_string </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">wordwrap</span><span class="keyword">(</span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"\t"</span><span class="keyword">, </span><span class="string">"&nbsp; &nbsp; "</span><span class="keyword">, </span><span class="default">$exploded_string</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]), </span><span class="default">$max_characters</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$j_count </span><span class="keyword">= </span><span class="default">count</span><span class="keyword">(</span><span class="default">$exploded_wrapped_string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$j </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">$j_count</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$next_offset_y</span><span class="keyword">, </span><span class="default">$exploded_wrapped_string</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$next_offset_y </span><span class="keyword">+= </span><span class="default">$font_height</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$next_offset_y </span><span class="keyword">&gt;= </span><span class="default">$image_height </span><span class="keyword">- </span><span class="default">$y</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93353""></a>
  <div class="note">
   <strong class="user">jordanslost at gmail</strong>
   <a href="#93353" class="date">04-Sep-2009 04:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a small bit I made for writing to a image from right to left when you are limited to imagestring()<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $pageview_letters </span><span class="keyword">= </span><span class="default">preg_split</span><span class="keyword">(</span><span class="string">'//'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, -</span><span class="default">1 </span><span class="keyword">); </span><span class="comment">// Form are original array of letters.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$minus </span><span class="keyword">= </span><span class="default">6</span><span class="keyword">; </span><span class="comment">// The letter spacing in pixels<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; </span><span class="comment">// Whether or not we have started the string<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">375</span><span class="keyword">; </span><span class="comment">// X Location of imagestring<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">23</span><span class="keyword">; </span><span class="comment">// Y Location of imagestring<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$letters </span><span class="keyword">= array(); </span><span class="comment">// Initiate the array o letters.<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach ( </span><span class="default">$pageview_letters </span><span class="keyword">as </span><span class="default">$letter </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$letters</span><span class="keyword">[] = </span><span class="default">$letter</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$letters </span><span class="keyword">= </span><span class="default">array_reverse</span><span class="keyword">( </span><span class="default">$letters </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ( </span><span class="default">$letters </span><span class="keyword">as </span><span class="default">$letter </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$first </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagestring</span><span class="keyword">( </span><span class="default">$image</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$letter</span><span class="keyword">, </span><span class="default">$light_blue </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= ( </span><span class="default">$x </span><span class="keyword">- </span><span class="default">$minus </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagestring</span><span class="keyword">( </span><span class="default">$image</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$letter</span><span class="keyword">, </span><span class="default">$light_blue </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90481""></a>
  <div class="note">
   <strong class="user">eric dot brison at anakeen dot com</strong>
   <a href="#90481" class="date">24-Apr-2009 12:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Same function as above but it can display multi-line strings.<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">sendimagetext</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) {<br />
&nbsp; </span><span class="comment">// Set font size<br />
&nbsp; </span><span class="default">$font_size </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
<br />
&nbsp; </span><span class="default">$ts</span><span class="keyword">=</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$width</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp; foreach (</span><span class="default">$ts </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$string</span><span class="keyword">) { </span><span class="comment">//compute width<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width</span><span class="keyword">=</span><span class="default">max</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">));<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="comment">// Create image width dependant on width of the string<br />
&nbsp; </span><span class="default">$width&nbsp; </span><span class="keyword">= </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">)*</span><span class="default">$width</span><span class="keyword">;<br />
&nbsp; </span><span class="comment">// Set height to that of the font<br />
&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagefontheight</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">)*</span><span class="default">count</span><span class="keyword">(</span><span class="default">$ts</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$el</span><span class="keyword">=</span><span class="default">imagefontheight</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$em</span><span class="keyword">=</span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// Create the image pallette<br />
&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// Dark red background<br />
&nbsp; </span><span class="default">$bg </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0xAA</span><span class="keyword">, </span><span class="default">0x00</span><span class="keyword">, </span><span class="default">0x00</span><span class="keyword">);<br />
&nbsp; </span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,</span><span class="default">$width </span><span class="keyword">,</span><span class="default">$height </span><span class="keyword">, </span><span class="default">$bg</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// White font color<br />
&nbsp; </span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
<br />
&nbsp; foreach (</span><span class="default">$ts </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Length of the string<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Y-coordinate of character, X changes, Y is static<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ypos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Loop through the string<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Position of the character horizontally<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$xpos </span><span class="keyword">= </span><span class="default">$i </span><span class="keyword">* </span><span class="default">$em</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ypos </span><span class="keyword">= </span><span class="default">$k </span><span class="keyword">* </span><span class="default">$el</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Draw character<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">imagechar</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$font_size</span><span class="keyword">, </span><span class="default">$xpos</span><span class="keyword">, </span><span class="default">$ypos</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="comment">// Remove character from string<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; </span><span class="comment">// Return the image<br />
&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Type: image/png"</span><span class="keyword">);<br />
&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp; </span><span class="comment">// Remove image<br />
&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87759""></a>
  <div class="note">
   <strong class="user">mike at mike-griffiths dot co dot uk</strong>
   <a href="#87759" class="date">19-Dec-2008 12:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I created an alternative using the function imagechar to create a string of an image.&nbsp; The below function below was used to create an image the same height and width of the text string.&nbsp; It is used on my website to mask users email addresses.
<br />

<br />
<span class="default">&lt;?PHP
<br />

<br />
</span><span class="comment">// Set your string somehow
<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="string">'your@example.com'</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// Set font size
<br />
</span><span class="default">$font_size </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;
<br />

<br />
</span><span class="comment">// Create image width dependant on width of the string
<br />
</span><span class="default">$width&nbsp; </span><span class="keyword">= </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">)*</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);
<br />
</span><span class="comment">// Set height to that of the font
<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagefontheight</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">);
<br />
</span><span class="comment">// Create the image pallette
<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);
<br />
</span><span class="comment">// Grey background
<br />
</span><span class="default">$bg&nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">);
<br />
</span><span class="comment">// White font color
<br />
</span><span class="default">$color </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);
<br />
</span><span class="comment">// Length of the string
<br />
</span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);
<br />
</span><span class="comment">// Y-coordinate of character, X changes, Y is static
<br />
</span><span class="default">$ypos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
</span><span class="comment">// Loop through the string
<br />
</span><span class="keyword">for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Position of the character horizontally
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$xpos </span><span class="keyword">= </span><span class="default">$i </span><span class="keyword">* </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Draw character
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagechar</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$font_size</span><span class="keyword">, </span><span class="default">$xpos</span><span class="keyword">, </span><span class="default">$ypos</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Remove character from string
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; 
<br />
}
<br />
</span><span class="comment">// Return the image
<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-Type: image/gif"</span><span class="keyword">);
<br />
</span><span class="default">imagegif</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
</span><span class="comment">// Remove image 
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86763""></a>
  <div class="note">
   <strong class="user">keksnicoh at googlemail dot com</strong>
   <a href="#86763" class="date">02-Nov-2008 10:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some fun with imagestring:<br />
<br />
This function is a product of too much time..<br />
It opens an image and create a new image with one letter instead of a pixel.<br />
<br />
<span class="default">&lt;?php<br />
error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
</span><span class="comment">/**<br />
&nbsp;* generates a image with chars instead of pixels<br />
&nbsp;*<br />
&nbsp;* @param string $url Filepath or url<br />
&nbsp;* @param string $chars The chars which should replace the pixels<br />
&nbsp;* @param int $shrpns Sharpness (2 = every second pixel, 1 = every pixel ... )<br />
&nbsp;* @param int $size <br />
&nbsp;* @param int $weight font-weight/size<br />
&nbsp;* @return sesource<br />
&nbsp;* @author Nicolas 'KeksNicoh' Heimann &lt;www.salamipla.net&gt;<br />
&nbsp;* @date 02nov08<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">pixelfuck</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$chars</span><span class="keyword">=</span><span class="string">'ewk34543§G§$§$Tg34g4g'</span><span class="keyword">, </span><span class="default">$shrpns</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">, </span><span class="default">$size</span><span class="keyword">=</span><span class="default">4</span><span class="keyword">,</span><span class="default">$weight</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; list(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$type</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$resource </span><span class="keyword">= </span><span class="default">imagecreatefromstring</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">*</span><span class="default">$size</span><span class="keyword">,</span><span class="default">$h</span><span class="keyword">*</span><span class="default">$size</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$cc </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$chars</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$y</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$y </span><span class="keyword">&lt;</span><span class="default">$h</span><span class="keyword">;</span><span class="default">$y</span><span class="keyword">+=</span><span class="default">$shrpns</span><span class="keyword">) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$x</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$x </span><span class="keyword">&lt;</span><span class="default">$w</span><span class="keyword">;</span><span class="default">$x</span><span class="keyword">+=</span><span class="default">$shrpns</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$weight</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">*</span><span class="default">$size</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">*</span><span class="default">$size</span><span class="keyword">, </span><span class="default">$chars</span><span class="keyword">{@++</span><span class="default">$p</span><span class="keyword">%</span><span class="default">$cc</span><span class="keyword">}, </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$resource</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$img</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$url </span><span class="keyword">= </span><span class="string">'<a href="http://upload.wikimedia.org/wikipedia/commons/b/be/Manga_Icon.png" rel="nofollow" target="_blank">http://upload.wikimedia.org/wikipedia/commons/b/be/Manga_Icon.png</a>'</span><span class="keyword">;<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="string">'I-dont-like-manga-...-Why-do-they-have-such-big-eyes? Strange-...-WHAT-WANT-YOU-DO?'</span><span class="keyword">;<br />
<br />
</span><span class="default">Header</span><span class="keyword">(</span><span class="string">'Content-Type: image/png'</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">pixelfuck</span><span class="keyword">(</span><span class="default">$url</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
Have fun&nbsp; :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85197""></a>
  <div class="note">
   <strong class="user">Abubaker dot shamlan at gmail dot com</strong>
   <a href="#85197" class="date">19-Aug-2008 03:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
this is a function that is based on imagestring but it produces text in the center of an image i hope it helps :D
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">ImageStringCenter</span><span class="keyword">(</span><span class="default">$image_resource</span><span class="keyword">, </span><span class="default">$font_size</span><span class="keyword">, </span><span class="default">$line_number</span><span class="keyword">, </span><span class="default">$total_lines</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$color </span><span class="keyword">) {
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$center_x </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">( ( </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image_resource</span><span class="keyword">) - ( </span><span class="default">ImageFontWidth</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">) * </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) ) ) / </span><span class="default">2 </span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$center_y </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">( ( ( </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image_resource</span><span class="keyword">) - ( </span><span class="default">ImageFontHeight</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">) * </span><span class="default">$total_lines </span><span class="keyword">) ) / </span><span class="default">2</span><span class="keyword">)&nbsp; + ( (</span><span class="default">$line_number</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">) * </span><span class="default">ImageFontHeight</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">) ) );
<br />

<br />
</span><span class="default">ImageString</span><span class="keyword">(</span><span class="default">$image_resource</span><span class="keyword">, </span><span class="default">$font_size</span><span class="keyword">, </span><span class="default">$center_x</span><span class="keyword">, </span><span class="default">$center_y</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$color </span><span class="keyword">);
<br />

<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85089""></a>
  <div class="note">
   <strong class="user">mustafa at hafunny dot info</strong>
   <a href="#85089" class="date">14-Aug-2008 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you have any problem with CentralEurope's words, for example : ?????yáíéú???, I am try this problem by iconv() function.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// create example image<br />
</span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">200</span><span class="keyword">, </span><span class="default">20</span><span class="keyword">);<br />
</span><span class="default">$bg </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
</span><span class="default">$textcolor </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
</span><span class="default">$text </span><span class="keyword">= </span><span class="string">"?????yáíéú???..."</span><span class="keyword">;<br />
<br />
</span><span class="comment">//simple convert string<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"Windows-1250"</span><span class="keyword">, </span><span class="string">"Latin2"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
</span><span class="comment">// write converted string at the top left<br />
</span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$textcolor</span><span class="keyword">);<br />
<br />
</span><span class="comment">// output the image<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81829""></a>
  <div class="note">
   <strong class="user">sk89q</strong>
   <a href="#81829" class="date">14-Mar-2008 02:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Creates a box of text. Has horizontal and vertical alignment, box arguments, and custom leading. I submitted this to the manual in 2003 actually, but it disappeared after a year or so (not sure why). Here it is again.<br />
<br />
<span class="default">&lt;?php<br />
define</span><span class="keyword">(</span><span class="string">"ALIGN_LEFT"</span><span class="keyword">, </span><span class="string">"left"</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"ALIGN_CENTER"</span><span class="keyword">, </span><span class="string">"center"</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"ALIGN_RIGHT"</span><span class="keyword">, </span><span class="string">"right"</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"VALIGN_TOP"</span><span class="keyword">, </span><span class="string">"top"</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"VALIGN_MIDDLE"</span><span class="keyword">, </span><span class="string">"middle"</span><span class="keyword">);<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">"VALIGN_BOTTOM"</span><span class="keyword">, </span><span class="string">"bottom"</span><span class="keyword">);<br />
<br />
function </span><span class="default">imagestringbox</span><span class="keyword">(&amp;</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$left</span><span class="keyword">, </span><span class="default">$top</span><span class="keyword">, </span><span class="default">$right</span><span class="keyword">, </span><span class="default">$bottom</span><span class="keyword">, </span><span class="default">$align</span><span class="keyword">, </span><span class="default">$valign</span><span class="keyword">, </span><span class="default">$leading</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp; </span><span class="comment">// Get size of box<br />
&nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= </span><span class="default">$bottom </span><span class="keyword">- </span><span class="default">$top</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">$right </span><span class="keyword">- </span><span class="default">$left</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">// Break the text into lines, and into an array<br />
&nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">wordwrap</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$width </span><span class="keyword">/ </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">)), </span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$lines </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$lines</span><span class="keyword">);<br />
&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">// Other important numbers<br />
&nbsp;&nbsp; </span><span class="default">$line_height </span><span class="keyword">= </span><span class="default">imagefontheight</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">) + </span><span class="default">$leading</span><span class="keyword">;<br />
&nbsp;&nbsp; </span><span class="default">$line_count </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">$height </span><span class="keyword">/ </span><span class="default">$line_height</span><span class="keyword">);<br />
&nbsp;&nbsp; </span><span class="default">$line_count </span><span class="keyword">= (</span><span class="default">$line_count </span><span class="keyword">&gt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">)) ? (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">)) : (</span><span class="default">$line_count</span><span class="keyword">);<br />
&nbsp; <br />
&nbsp;&nbsp; </span><span class="comment">// Loop through lines<br />
&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$line_count</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Vertical Align<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="keyword">switch(</span><span class="default">$valign</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="default">VALIGN_TOP</span><span class="keyword">: </span><span class="comment">// Top<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$top </span><span class="keyword">+ (</span><span class="default">$i </span><span class="keyword">* </span><span class="default">$line_height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="default">VALIGN_MIDDLE</span><span class="keyword">: </span><span class="comment">// Middle<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$top </span><span class="keyword">+ ((</span><span class="default">$height </span><span class="keyword">- (</span><span class="default">$line_count </span><span class="keyword">* </span><span class="default">$line_height</span><span class="keyword">)) / </span><span class="default">2</span><span class="keyword">) + (</span><span class="default">$i </span><span class="keyword">* </span><span class="default">$line_height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="default">VALIGN_BOTTOM</span><span class="keyword">: </span><span class="comment">// Bottom<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$y </span><span class="keyword">= (</span><span class="default">$top </span><span class="keyword">+ </span><span class="default">$height</span><span class="keyword">) - (</span><span class="default">$line_count </span><span class="keyword">* </span><span class="default">$line_height</span><span class="keyword">) + (</span><span class="default">$i </span><span class="keyword">* </span><span class="default">$line_height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Horizontal Align<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$line_width </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$lines</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) * </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; switch(</span><span class="default">$align</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="default">ALIGN_LEFT</span><span class="keyword">: </span><span class="comment">// Left<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$left</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="default">ALIGN_CENTER</span><span class="keyword">: </span><span class="comment">// Center<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$left </span><span class="keyword">+ ((</span><span class="default">$width </span><span class="keyword">- </span><span class="default">$line_width</span><span class="keyword">) / </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case </span><span class="default">ALIGN_RIGHT</span><span class="keyword">: </span><span class="comment">// Right<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$left </span><span class="keyword">+ (</span><span class="default">$width </span><span class="keyword">- </span><span class="default">$line_width</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="comment">// Draw<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$lines</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp; }<br />
&nbsp; <br />
&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80199""></a>
  <div class="note">
   <strong class="user">eviloverlord+php at gmail dot com</strong>
   <a href="#80199" class="date">03-Jan-2008 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple script to convert a string (such as an email addresses) to a transparent image.<br />
<br />
Usage: <br />
&lt;img src="stringtoimg.php?string=<span class="default">&lt;?= urlencode</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$email</span><span class="keyword">)) </span><span class="default">?&gt;</span>"&gt;<br />
<br />
From a spambot's point of view, they see:<br />
&lt;img src="stringtoimg.php?string=ZpbXZG92ZXJsb3JkQGdtYWlsLmNvbQ%3D%3D"&gt;<br />
<br />
Optional parameters:<br />
&nbsp;&nbsp;&nbsp; font_size: 1 to 5, with the default at 3<br />
&nbsp;&nbsp;&nbsp; R/G/B: the font color, in hex.<br />
<br />
Usage:<br />
&lt;img src="stringtoimg.php?string=<span class="default">&lt;?= urlencode</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">(</span><span class="default">$email</span><span class="keyword">)) </span><span class="default">?&gt;</span>&amp;font_size=4&amp;R=FF&amp;G=FF&amp;B=00"&gt;<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
Filename: stringtoimg.php<br />
<br />
Parameters:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; string: the string to print<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; font_size (optional): the size of the font from 1-5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; R/G/B (optional): the RGB colors of the font in hex&nbsp; &nbsp; &nbsp;&nbsp; <br />
*/<br />
<br />
</span><span class="default">header </span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Get string info<br />
</span><span class="default">$font_size </span><span class="keyword">= isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'font_size'</span><span class="keyword">]) ? </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'font_size'</span><span class="keyword">] : </span><span class="default">3</span><span class="keyword">;<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">urldecode</span><span class="keyword">(</span><span class="default">base64_decode</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'string'</span><span class="keyword">]));<br />
<br />
</span><span class="comment">//Get the size of the string<br />
</span><span class="default">$width </span><span class="keyword">= </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">) * </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagefontheight</span><span class="keyword">(</span><span class="default">$font_size</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Create the image<br />
</span><span class="default">$img </span><span class="keyword">= @</span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp;&nbsp; or die(</span><span class="string">"Cannot Initialize new GD image stream"</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Make it transparent<br />
</span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$trans_colour </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">127</span><span class="keyword">);<br />
</span><span class="default">imagefill</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$trans_colour</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Get the text color<br />
</span><span class="default">$text_color </span><span class="keyword">= isset(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'R'</span><span class="keyword">], </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'G'</span><span class="keyword">], </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'B'</span><span class="keyword">]) ?<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'R'</span><span class="keyword">]), </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'G'</span><span class="keyword">]), </span><span class="default">hexdec</span><span class="keyword">(</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'B'</span><span class="keyword">])) :<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Draw the string<br />
</span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$font_size</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,&nbsp; </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$text_color</span><span class="keyword">);<br />
<br />
</span><span class="comment">//Output the image<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80186""></a>
  <div class="note">
   <strong class="user">Epidemiah</strong>
   <a href="#80186" class="date">03-Jan-2008 05:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Its just an easy function to write an string in the middle of a picture.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">imageCenterString</span><span class="keyword">(&amp;</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$font </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">|| </span><span class="default">$font </span><span class="keyword">&gt; </span><span class="default">5</span><span class="keyword">){ </span><span class="default">$font </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$num </span><span class="keyword">= array(array(</span><span class="default">4.6</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="default">4.6</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="default">5.6</span><span class="keyword">, </span><span class="default">12</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="default">6.5</span><span class="keyword">, </span><span class="default">12</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="default">7.6</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">),<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array(</span><span class="default">8.5</span><span class="keyword">, </span><span class="default">16</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">ceil</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">$num</span><span class="keyword">[</span><span class="default">$font</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$x&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) - </span><span class="default">$width </span><span class="keyword">- </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$y&nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">Imagesy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) - (</span><span class="default">$num</span><span class="keyword">[</span><span class="default">$font</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">] + </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">, </span><span class="default">$color</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73346""></a>
  <div class="note">
   <strong class="user">jlamer</strong>
   <a href="#73346" class="date">18-Feb-2007 06:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
//&nbsp; Example of use...<br />
<br />
//&nbsp; This is a simple function to output text to an image<br />
//&nbsp; which is centered (as much as I want to do by eye)<br />
//&nbsp; and wrapped<br />
//&nbsp; &nbsp; Just remember that all the sizes are guessed<br />
// doesn't cut on the space (only on number of characters)<br />
//&nbsp; or change color of text, but this isn't for that...<br />
function imageCenterString( $imgw, $imgh,<br />
&nbsp;&nbsp; $image_text = '', $text_size=5 )<br />
{<br />
&nbsp;&nbsp; $im = imagecreate( $imgw, $imgh );<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; // white background and blue text<br />
&nbsp;&nbsp; $bg = imagecolorallocate($im, 255, 255, 255);<br />
&nbsp;&nbsp; $textcolor = imagecolorallocate($im, 0, 0, 0);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; $t_h = $t_w = $t_x = $t_y = 0;<br />
&nbsp;&nbsp; $base_w =9; $base_h = 16;<br />
&nbsp;&nbsp; $m = 0.88;<br />
&nbsp;&nbsp; switch ( $text_size )<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; case 1: $t_w = $base_w*pow(($m*.98),4);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $t_h = $base_h*pow(($m*.98),4);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; case 2: $t_w = $base_w*pow($m,3);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $t_h = $base_h*pow($m,3);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; case 3: $t_w = $base_w*pow($m,2);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $t_h = $base_h*pow($m,2);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; case 4: $t_w = $base_w*$m;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $t_h = $base_h*$m;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; case 5: $t_w = $base_w;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $t_h = $base_h;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if ( $text_size &gt;= 5 ) // set to 5<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {&nbsp;&nbsp; $t_w = $base_w; $t_h = $base_h; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if ( $text_size &lt; 5 ) // set to 1<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $t_w = $base_w*pow(($m*.98),4);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $t_h = $base_h*pow(($m*.98),4);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; break;<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; $text_array = array();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; $max = floor($imgw/$t_w);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; for( $i=0; strlen($image_text) &gt; 0; $i += $max)<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; array_push($text_array, substr($image_text,0,$max));<br />
&nbsp;&nbsp; &nbsp;&nbsp; if ( strlen($image_text) &gt;= $max )<br />
&nbsp;&nbsp; &nbsp;&nbsp; {&nbsp;&nbsp; $image_text = substr($image_text,$max); }<br />
&nbsp;&nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp;&nbsp; {&nbsp;&nbsp; $image_text = ''; }<br />
&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; $t_y = ($imgh/2) - ($t_h*count($text_array)/2);<br />
<br />
&nbsp;&nbsp; foreach ( $text_array as $text )<br />
&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; $t_x = ($imgw/2)-($t_w*strlen($text)/2);<br />
&nbsp;&nbsp; &nbsp;&nbsp; imagestring($im, $text_size, $t_x, $t_y,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; $text, $textcolor);<br />
&nbsp;&nbsp; &nbsp;&nbsp; $t_y += $t_h;<br />
&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; // output the image<br />
&nbsp;&nbsp; header("Content-type: image/gpeg");<br />
&nbsp;&nbsp; imagejpeg($im);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71995""></a>
  <div class="note">
   <strong class="user">gannon (at) portablesofdoom (dot) org</strong>
   <a href="#71995" class="date">27-Dec-2006 06:53</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I like this better than "tjpoe at cableaz dot com"'s function for wrapping text to fit width (auto-adjusts height as needed) since it doesn't only do 1 word per line.<br />
<br />
function make_wrapped_txt($txt, $color=000000, $space=4, $font=4, $w=300) {<br />
&nbsp; if (strlen($color) != 6) $color = 000000;<br />
&nbsp; $int = hexdec($color);<br />
&nbsp; $h = imagefontheight($font);<br />
&nbsp; $fw = imagefontwidth($font);<br />
&nbsp; $txt = explode("\n", wordwrap($txt, ($w / $fw), "\n"));<br />
&nbsp; $lines = count($txt);<br />
&nbsp; $im = imagecreate($w, (($h * $lines) + ($lines * $space)));<br />
&nbsp; $bg = imagecolorallocate($im, 255, 255, 255);<br />
&nbsp; $color = imagecolorallocate($im, 0xFF &amp; ($int &gt;&gt; 0x10), 0xFF &amp; ($int &gt;&gt; 0x8), 0xFF &amp; $int);<br />
&nbsp; $y = 0;<br />
&nbsp; foreach ($txt as $text) {<br />
&nbsp;&nbsp;&nbsp; $x = (($w - ($fw * strlen($text))) / 2);<br />
&nbsp;&nbsp;&nbsp; imagestring($im, $font, $x, $y, $text, $color);<br />
&nbsp;&nbsp;&nbsp; $y += ($h + $space);<br />
&nbsp; }<br />
&nbsp; header('Content-type: image/jpeg');<br />
&nbsp; die(imagejpeg($im));<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71752""></a>
  <div class="note">
   <strong class="user">iibm at free dot fr</strong>
   <a href="#71752" class="date">14-Dec-2006 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've made a little modification of the (quite usefull) imagestringcutted function (when align=center, it doesn't work well for me if x1!=0) so juste replace the last line with :<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; </span><span class="keyword">[...]<br />
&nbsp;&nbsp; else </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">$x1</span><span class="keyword">+(</span><span class="default">$x2</span><span class="keyword">-</span><span class="default">$x1</span><span class="keyword">)/ </span><span class="default">2 </span><span class="keyword">- </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">$fontwidth </span><span class="keyword">/ </span><span class="default">2</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71038""></a>
  <div class="note">
   <strong class="user">Piotr dot Sulecki at traxelektronik dot pl</strong>
   <a href="#71038" class="date">09-Nov-2006 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The built-in fonts used to be in latin-2 (iso8859-2) encoding. For some time, they are in latin-1 (iso8859-1) encoding. There is no way to change the encoding at all. If you need to use any other encoding, you have to use TrueType fonts.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70486""></a>
  <div class="note">
   <strong class="user">god at in-heaven dot org</strong>
   <a href="#70486" class="date">18-Oct-2006 02:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a simple function for creating an aligned string which is cutted to match the space between $x1 and $x2<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagestringcutted</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$x1</span><span class="keyword">,</span><span class="default">$x2</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">,</span><span class="default">$align</span><span class="keyword">=</span><span class="string">"center"</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fontwidth </span><span class="keyword">= </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$fullwidth </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">$fontwidth</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$maxwidth </span><span class="keyword">= </span><span class="default">$x2</span><span class="keyword">-</span><span class="default">$x1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$targetwidth </span><span class="keyword">= </span><span class="default">$fullwidth</span><span class="keyword">-(</span><span class="default">4</span><span class="keyword">*</span><span class="default">$fontwidth</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$fullwidth </span><span class="keyword">&gt; </span><span class="default">$maxwidth</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) AND ((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)-(</span><span class="default">$i</span><span class="keyword">-</span><span class="default">4</span><span class="keyword">))*</span><span class="default">$fontwidth</span><span class="keyword">) &gt; </span><span class="default">$targetwidth </span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) { }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)-</span><span class="default">$i</span><span class="keyword">)-</span><span class="default">4</span><span class="keyword">).</span><span class="string">"..."</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$align </span><span class="keyword">== </span><span class="string">"left"</span><span class="keyword">) </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">$x1</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; elseif(</span><span class="default">$align </span><span class="keyword">== </span><span class="string">"right"</span><span class="keyword">) </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">$x2 </span><span class="keyword">- ((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">$fontwidth</span><span class="keyword">)),</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; else </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,(</span><span class="default">$x2</span><span class="keyword">-</span><span class="default">$x1</span><span class="keyword">)/ </span><span class="default">2 </span><span class="keyword">- </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">$fontwidth </span><span class="keyword">/ </span><span class="default">2</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span>Usage:<br />
<span class="default">&lt;?php<br />
imagestringcutted</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="default">$x1</span><span class="keyword">,</span><span class="default">$x2</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">,</span><span class="default">$align</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Will create a string $text, which is cutted if it's too long to match between&nbsp; $x1 and $2, on $img with font $font and color $color at height $y and with align to $align.<br />
Hope it will help some people.<br />
Sorry for my bad English.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62440""></a>
  <div class="note">
   <strong class="user">rush at 507magazine dot com</strong>
   <a href="#62440" class="date">28-Feb-2006 11:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
hello, I noticed that if you put a rand(3,5) it will put random sizes of font to each character put on the image. this is very useful when programming captchas for anti-spam form verification.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61378""></a>
  <div class="note">
   <strong class="user">julien / at / theoconcept.com</strong>
   <a href="#61378" class="date">01-Feb-2006 03:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are looking for a way to generate a "CAPTCHA" image for a form verification (to verify it is not a robot), have a look at this : <a href="http://blog.theoconcept.com/static/distortion/" rel="nofollow" target="_blank">http://blog.theoconcept.com/static/distortion/</a><br />
<br />
It gives an animated image with the parameter string, with distortion, here is an example :<br />
<a href="http://blog.theoconcept.com/static/distortion/distortion.php" rel="nofollow" target="_blank">http://blog.theoconcept.com/static/distortion/distortion.php</a><br />
<br />
(*)&nbsp; You'll need GD + Freetype support<br />
(**) You'll need ImageMagick on the machine</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59390""></a>
  <div class="note">
   <strong class="user">m dot onderwater at esperantoxl dot nl</strong>
   <a href="#59390" class="date">05-Dec-2005 10:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is a small error in the function for horizontal and vertical centering by "jurgen dot vanoosterwijck at pandora dot be"<br />
<br />
the line <br />
<br />
&nbsp;$cy = (imagesy($img)/2) - (imagefontwidth($font)/2);<br />
<br />
should be<br />
<br />
&nbsp;$cy = (imagesy($img)/2) - (imagefontheight($font)/2);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53740""></a>
  <div class="note">
   <strong class="user">aly at slo-igre dot net</strong>
   <a href="#53740" class="date">11-Jun-2005 01:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There is an error in "tjpoe at cableaz dot com" 's function ImageStringWrap. Instead of <br />
<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $string = $text;<br />
<br />
there should be<br />
<br />
&nbsp;&nbsp; &nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $string = array($text);<br />
<br />
for function to work for strings with only one word. Otherwise it works like a charm, thanks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53298""></a>
  <div class="note">
   <strong class="user">tjpoe at cableaz dot com</strong>
   <a href="#53298" class="date">27-May-2005 07:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i modified the centering functions and created this which centers each word on it's own line. You can adjust the spacing with the $valign var. currently no implimentation if text is too large for image. strings are tokenized by space, but can obviously be changed. <br />
<br />
function ImageStringWrap($image, $font, $text, $color)<br />
{<br />
&nbsp; $fontwidth = ImageFontWidth($font);<br />
&nbsp; $fontheight = ImageFontHeight($font);<br />
&nbsp; $words= str_word_count($text);<br />
&nbsp; if ($words &gt; 1){<br />
&nbsp;&nbsp;&nbsp; $string=array(strtok($text,' '));<br />
&nbsp;&nbsp;&nbsp; for ($i = 1 ; $i &lt;= $words ; $i++){<br />
&nbsp;&nbsp; &nbsp;&nbsp; $string=array_merge($string,array($i=&gt;strtok(' ')));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; else<br />
&nbsp;&nbsp;&nbsp; $string=$text;<br />
&nbsp; $vspace=4;<br />
&nbsp; $y=((imagesy($image)-($fontheight*$words)-($words*$vspace))/2);<br />
&nbsp; foreach($string as $st){<br />
&nbsp;&nbsp;&nbsp; $x=((imagesx($image)-($fontwidth * strlen($st)))/2);<br />
&nbsp;&nbsp;&nbsp; ImageString($image,$font,$x,$y,$st,$color);<br />
&nbsp;&nbsp;&nbsp; $y+=($fontheight+$vspace);<br />
&nbsp; }<br />
}<br />
hope this is helpful</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53114""></a>
  <div class="note">
   <strong class="user">bpgordon at gmail dot com</strong>
   <a href="#53114" class="date">23-May-2005 04:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This code produces a png image of the text within the query. It autofits to the length of the string. <br />
Usage: <a href="http://yoursite.com/text.php?abcdefg+hijk" rel="nofollow" target="_blank">http://yoursite.com/text.php?abcdefg+hijk</a><br />
<br />
Use + to produce a space in the image. The + can be excaped with a carat (^). Most other symbols work fine in the query string, like the ?.<br />
<br />
<span class="default">&lt;?php<br />
header </span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">$_ENV</span><span class="keyword">[</span><span class="string">"QUERY_STRING"</span><span class="keyword">];<br />
</span><span class="default">$md5 </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">); </span><span class="comment">//just so we don't convert valid text into a +<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"^+"</span><span class="keyword">, </span><span class="default">$md5</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">); </span><span class="comment">//replaces ^+ with long, unnatural string<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"+"</span><span class="keyword">, </span><span class="string">" "</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">); </span><span class="comment">//replaces + with space<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$md5</span><span class="keyword">, </span><span class="string">"+"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">); </span><span class="comment">//replaces the long, unnatural string with +<br />
</span><span class="default">$width&nbsp; </span><span class="keyword">= </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">) * </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">imagefontheight</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">);<br />
</span><span class="default">$image </span><span class="keyword">= @</span><span class="default">imagecreate</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">);<br />
</span><span class="default">$black </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">); </span><span class="comment">//background<br />
</span><span class="default">$white </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
</span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">,&nbsp; </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$white</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52797""></a>
  <div class="note">
   <strong class="user">jurgen dot vanoosterwijck at pandora dot be</strong>
   <a href="#52797" class="date">12-May-2005 10:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Based on the previous example, here's how to center a string both horizontally and vertically...<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagestringcentered </span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">) {<br />
&nbsp;while (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">) &gt; </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">)) {<br />
&nbsp; if (</span><span class="default">$font </span><span class="keyword">&gt; </span><span class="default">1</span><span class="keyword">) { </span><span class="default">$font</span><span class="keyword">--; }<br />
&nbsp; else { break; }<br />
&nbsp;} <br />
&nbsp;</span><span class="default">$cy </span><span class="keyword">= (</span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">)/</span><span class="default">2</span><span class="keyword">) - (</span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">)/</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;</span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) / </span><span class="default">2 </span><span class="keyword">- </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">) / </span><span class="default">2</span><span class="keyword">,</span><span class="default">$cy</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51306""></a>
  <div class="note">
   <strong class="user">shadikka at gmail dot com</strong>
   <a href="#51306" class="date">26-Mar-2005 11:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My version of the centered string, it decreases the font number (since I've noticed smaller numbers are smaller fonts) until 1 if the string won't fit. Then it will give up.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagestringcentered </span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">$cy</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">) {<br />
&nbsp;while (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">) &gt; </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">)) {<br />
&nbsp; if (</span><span class="default">$font </span><span class="keyword">&gt; </span><span class="default">1</span><span class="keyword">) { </span><span class="default">$font</span><span class="keyword">--; }<br />
&nbsp; else { break; }<br />
&nbsp;}&nbsp; <br />
&nbsp;</span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$font</span><span class="keyword">,</span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">) / </span><span class="default">2 </span><span class="keyword">- </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) * </span><span class="default">imagefontwidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">) / </span><span class="default">2</span><span class="keyword">,</span><span class="default">$cy</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">,</span><span class="default">$color</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50455""></a>
  <div class="note">
   <strong class="user">webmaster at acdrifter dot com</strong>
   <a href="#50455" class="date">28-Feb-2005 08:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are looking to center the text, use the following function; I'm not promising perfection...<br />
<br />
function imagecenteredstring ( &amp;$img, $font, $xMin, $xMax, $y, $str, $col ) {<br />
&nbsp;&nbsp;&nbsp; $textWidth = imagefontwidth( $font ) * strlen( $str );<br />
&nbsp;&nbsp;&nbsp; $xLoc = ( $xMax - $xMin - $textWidth ) / 2 + $xMin + $font;<br />
&nbsp;&nbsp;&nbsp; imagestring( $img, $font, $xLoc, $y, $str, $col );<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="47479""></a>
  <div class="note">
   <strong class="user">cesargus at yahoo dot com</strong>
   <a href="#47479" class="date">17-Nov-2004 10:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
//simple hello world<br />
<br />
&lt;?<br />
header ("Content-type: image/png");<br />
<br />
$img_handle = ImageCreate (200, 20) or die ("Cannot Create image");<br />
$back_color = ImageColorAllocate ($img_handle, 0, 10, 10);<br />
$txt_color = ImageColorAllocate ($img_handle, 235, 235, 51);<br />
ImageString ($img_handle, 10, 25, 5,&nbsp; "Hello world!", $txt_color);<br />
ImagePng ($img_handle); <br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46512""></a>
  <div class="note">
   <strong class="user">brooks dot boyd at gmail dot com</strong>
   <a href="#46512" class="date">13-Oct-2004 12:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Drawing a string as an image is a handy way to disguise an eMail address so spam sniffers can't get it as easily. The only catch to creating a dynamic image with your eMail in it is the eMail to be displayed must be passed via the query string to enable static HTML to use it. So, the eMail must be encrypted slightly in order to not defeat the purpose of not typing your eMail address outright. I wrote the following script to do so:<br />
<br />
Save the following as email.php<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'addr'</span><span class="keyword">] != </span><span class="string">""</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="default">$_GET</span><span class="keyword">[</span><span class="string">'addr'</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/\[dot]/"</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">,</span><span class="default">$msg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/\[at]/"</span><span class="keyword">,</span><span class="string">"@"</span><span class="keyword">,</span><span class="default">$msg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$final </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$final </span><span class="keyword">.= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">)-</span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="default">$final</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$char_width </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$char_height </span><span class="keyword">= </span><span class="default">17</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$padding </span><span class="keyword">= </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$width </span><span class="keyword">= </span><span class="default">$padding</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">+</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">)*</span><span class="default">$char_width</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$height </span><span class="keyword">= +</span><span class="default">$padding</span><span class="keyword">*</span><span class="default">2</span><span class="keyword">+</span><span class="default">$char_height</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bg </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">100</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilledrectangle </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">, </span><span class="default">$bg</span><span class="keyword">); </span><span class="comment"># Make transparent<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagestring</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">, </span><span class="default">$padding</span><span class="keyword">, </span><span class="default">$padding</span><span class="keyword">, </span><span class="default">$msg</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$im </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagealphablending</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">FALSE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesavealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">TRUE</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bg </span><span class="keyword">= </span><span class="default">imagecolorallocatealpha</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">125</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagefilledrectangle </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">$bg</span><span class="keyword">); </span><span class="comment"># Make transparent<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: image/jpg'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
If the script is called without an eMail address, it outputs a 2x2 transparent image.<br />
<br />
To call the script to generate the eMail "user@home.com", the HTML tag would be:<br />
<br />
&lt;img src="email.php?addr=moc[dot]emoh[at]resu"&gt;<br />
<br />
To 'encrypt' the eMail address to pass to the script, write the address backwards and replace "." with "[dot]" and "@" with "[at]". It's not the most ironclad protection, but it thwarts most casual eMail sniffers.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29485""></a>
  <div class="note">
   <strong class="user">php dot net at mvoncken dot nl</strong>
   <a href="#29485" class="date">14-Feb-2003 02:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple example:<br />
To make one line of text fit in the image.<br />
<br />
<span class="default">&lt;?php<br />
header </span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="string">"spam@mvoncken.nl"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
</span><span class="default">$font&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
</span><span class="default">$width&nbsp; </span><span class="keyword">= </span><span class="default">ImageFontWidth</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">) * </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
</span><span class="default">$height </span><span class="keyword">= </span><span class="default">ImageFontHeight</span><span class="keyword">(</span><span class="default">$font</span><span class="keyword">);<br />
<br />
</span><span class="default">$im </span><span class="keyword">= @</span><span class="default">imagecreate </span><span class="keyword">(</span><span class="default">$width</span><span class="keyword">,</span><span class="default">$height</span><span class="keyword">);<br />
</span><span class="default">$background_color </span><span class="keyword">= </span><span class="default">imagecolorallocate </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">); </span><span class="comment">//white background<br />
</span><span class="default">$text_color </span><span class="keyword">= </span><span class="default">imagecolorallocate </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);</span><span class="comment">//black text<br />
</span><span class="default">imagestring </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$font</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">,&nbsp; </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$text_color</span><span class="keyword">);<br />
</span><span class="default">imagepng </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
I use something like this for spamprotection of my visitors (pass userid as an url-parameter for this php)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26674""></a>
  <div class="note">
   <strong class="user">aholmes84 at hotmail dot com</strong>
   <a href="#26674" class="date">08-Nov-2002 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When setting the font, any integer less than 1 defaults to 1, and any integer greater than 5 defaults to 5.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="22211""></a>
  <div class="note">
   <strong class="user">deejay_world at yahoo dot com</strong>
   <a href="#22211" class="date">10-Jun-2002 07:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Width ImageString, the strings you draw are not automatically wrapped width the edge of the image. You may use this function to automatically wrap them:<br />
<br />
function ImageStringWrap($image, $font, $x, $y, $text, $color, $maxwidth)<br />
{<br />
&nbsp;&nbsp;&nbsp; $fontwidth = ImageFontWidth($font);<br />
&nbsp;&nbsp;&nbsp; $fontheight = ImageFontHeight($font);<br />
<br />
&nbsp;&nbsp;&nbsp; if ($maxwidth != NULL) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $maxcharsperline = floor($maxwidth / $fontwidth);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $text = wordwrap($text, $maxcharsperline, "\n", 1);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; $lines = explode("\n", $text);<br />
&nbsp;&nbsp;&nbsp; while (list($numl, $line) = each($lines)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; ImageString($image, $font, $x, $y, $line, $color);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $y += $fontheight;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
}<br />
<br />
So, in particular, if you want to wrap a text with the edge of the Image, you may do:<br />
ImageStringWrap($img, $font, 0, $y, $text, $color, ImageSX($img) );</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20402""></a>
  <div class="note">
   <strong class="user">bob dot brown at opus dot co dot nz</strong>
   <a href="#20402" class="date">02-Apr-2002 03:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you find that you are getting two characters on the end of your imageString that look like a Y and an upside down L then they're probably representations of CR/LF.&nbsp; Try trim()ing the string before outputting it.&nbsp; (I was sooo sure this was a bug &lt;g&gt;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
