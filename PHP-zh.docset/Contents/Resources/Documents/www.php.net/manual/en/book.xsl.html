<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>XSL</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.xmlwriter-write-raw.html">? XMLWriter::writeRaw</a></li>
      <li style="float: right;"><a href="intro.xsl.html">简介 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="refs.xml.html">XML 操作</a></li>
    <li>XSL</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="book.xsl" class="book">
 
 <h1 class="title">XSL</h1>
 
 
 
 
 
 







 





 




 

 


 




<ul class="chunklist chunklist_book"><li><a href="intro.xsl.html">简介</a></li><li><a href="xsl.setup.html">安装／配置</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="xsl.requirements.html">需求</a></li><li><a href="xsl.installation.html">安装</a></li><li><a href="xsl.configuration.html">运行时配置</a></li><li><a href="xsl.resources.html">资源类型</a></li></ul></li><li><a href="xsl.constants.html">预定义常量</a></li><li><a href="xsl.examples.html">范例</a><ul class="chunklist chunklist_book chunklist_children"><li><a href="xsl.examples-collection.html">Example collection.xml and collection.xsl files</a></li><li><a href="xsl.examples-errors.html">Error handling with libxml error handling functions</a></li></ul></li><li><a href="class.xsltprocessor.html">XSLTProcessor</a> &mdash; The XSLTProcessor class<ul class="chunklist chunklist_book chunklist_children"><li><a href="xsltprocessor.construct.html">XSLTProcessor::__construct</a> &mdash; Creates a new XSLTProcessor object</li><li><a href="xsltprocessor.getparameter.html">XSLTProcessor::getParameter</a> &mdash; Get value of a parameter</li><li><a href="xsltprocessor.getsecurityprefs.html">XSLTProcessor::getSecurityPrefs</a> &mdash; Get security preferences</li><li><a href="xsltprocessor.hasexsltsupport.html">XSLTProcessor::hasExsltSupport</a> &mdash; Determine if PHP has EXSLT support</li><li><a href="xsltprocessor.importstylesheet.html">XSLTProcessor::importStylesheet</a> &mdash; Import stylesheet</li><li><a href="xsltprocessor.registerphpfunctions.html">XSLTProcessor::registerPHPFunctions</a> &mdash; Enables the ability to use PHP functions as XSLT functions</li><li><a href="xsltprocessor.removeparameter.html">XSLTProcessor::removeParameter</a> &mdash; Remove parameter</li><li><a href="xsltprocessor.setparameter.html">XSLTProcessor::setParameter</a> &mdash; Set value for a parameter</li><li><a href="xsltprocessor.setprofiling.html">XSLTProcessor::setProfiling</a> &mdash; Sets profiling output file</li><li><a href="xsltprocessor.setsecurityprefs.html">XSLTProcessor::setSecurityPrefs</a> &mdash; Set security preferences</li><li><a href="xsltprocessor.transformtodoc.html">XSLTProcessor::transformToDoc</a> &mdash; Transform to a DOMDocument</li><li><a href="xsltprocessor.transformtouri.html">XSLTProcessor::transformToUri</a> &mdash; Transform to URI</li><li><a href="xsltprocessor.transformtoxml.html">XSLTProcessor::transformToXml</a> &mdash; Transform to XML</li></ul></li></ul></div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="104572""></a>
  <div class="note">
   <strong class="user">Jaroslaw Zabiello</strong>
   <a href="#104572" class="date">23-Jun-2011 07:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is more usefull, no files needed, it just takes XML and XSL strings as input parameters and returns transformed XML
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* @param&nbsp; $xml
<br />
&nbsp;* @param&nbsp; $xsl
<br />
&nbsp;* @return string xml
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">transform</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">, </span><span class="default">$xsl</span><span class="keyword">) {
<br />
&nbsp;&nbsp; </span><span class="default">$xslt </span><span class="keyword">= new </span><span class="default">XSLTProcessor</span><span class="keyword">();
<br />
&nbsp;&nbsp; </span><span class="default">$xslt</span><span class="keyword">-&gt;</span><span class="default">importStylesheet</span><span class="keyword">(new&nbsp; </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xsl</span><span class="keyword">));
<br />
&nbsp;&nbsp; return </span><span class="default">$xslt</span><span class="keyword">-&gt;</span><span class="default">transformToXml</span><span class="keyword">(new </span><span class="default">SimpleXMLElement</span><span class="keyword">(</span><span class="default">$xml</span><span class="keyword">));
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90510""></a>
  <div class="note">
   <strong class="user">sudhir dot vis at gmail dot com</strong>
   <a href="#90510" class="date">25-Apr-2009 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a simplest way to transform the xml from php 
<br />

<br />
<span class="default">&lt;?php
<br />
$sXml&nbsp; </span><span class="keyword">= </span><span class="string">"&lt;xml&gt;"</span><span class="keyword">;
<br />
</span><span class="default">$sXml </span><span class="keyword">.= </span><span class="string">"&lt;sudhir&gt;hello sudhir&lt;/sudhir&gt;"</span><span class="keyword">;
<br />
</span><span class="default">$sXml </span><span class="keyword">.= </span><span class="string">"&lt;/xml&gt;"</span><span class="keyword">;
<br />

<br />
</span><span class="comment"># LOAD XML FILE
<br />
</span><span class="default">$XML </span><span class="keyword">= new </span><span class="default">DOMDocument</span><span class="keyword">();
<br />
</span><span class="default">$XML</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">( </span><span class="default">$sXml </span><span class="keyword">);
<br />

<br />
</span><span class="comment"># START XSLT
<br />
</span><span class="default">$xslt </span><span class="keyword">= new </span><span class="default">XSLTProcessor</span><span class="keyword">();
<br />
</span><span class="default">$XSL </span><span class="keyword">= new </span><span class="default">DOMDocument</span><span class="keyword">();
<br />
</span><span class="default">$XSL</span><span class="keyword">-&gt;</span><span class="default">load</span><span class="keyword">( </span><span class="string">'xsl/index.xsl'</span><span class="keyword">, </span><span class="default">LIBXML_NOCDATA</span><span class="keyword">);
<br />
</span><span class="default">$xslt</span><span class="keyword">-&gt;</span><span class="default">importStylesheet</span><span class="keyword">( </span><span class="default">$XSL </span><span class="keyword">);
<br />
</span><span class="comment">#PRINT
<br />
</span><span class="keyword">print </span><span class="default">$xslt</span><span class="keyword">-&gt;</span><span class="default">transformToXML</span><span class="keyword">( </span><span class="default">$XML </span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90395""></a>
  <div class="note">
   <strong class="user">allens at nospam dot com</strong>
   <a href="#90395" class="date">19-Apr-2009 08:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Problem:<br />
Getting Netbeans error message:<br />
Fatal error: Class 'xsltprocessor' not found<br />
<br />
Solution:<br />
place copy of php.ini in the c:\windows directory!<br />
<br />
by default the php.ini file has xsl disabled......search for the line <br />
<br />
;extension=php_xsl.dll<br />
<br />
to enable XSL....remove ; so that the extension gets included<br />
<br />
Then if Netbeans gives you the following message:<br />
PHP Startup: Unable to load dynamic library './php_xsl.dll'<br />
<br />
then you need to run the php-5.2.9-1-win32-installer.msi again<br />
this time selecting the XSL extension!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85852""></a>
  <div class="note">
   <strong class="user">visual77 at gmail dot com</strong>
   <a href="#85852" class="date">20-Sep-2008 04:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The XSLTProcessor is kind of a pain to use to generate an entire website, mostly due to the tedious process of building an XML tree through DOMDocument's createElement and appendChild functions.<br />
<br />
To get an entire website out of nothing but XML and XSL (which really is a superior system to just echoing out the HTML), you could use an object that does all the PHP data structure to XML data tree conversion, and combines with the XSLTProcessor for rendering. A good object like this is DOMi, which you can find at <a href="http://domi.sourceforge.net." rel="nofollow" target="_blank">http://domi.sourceforge.net.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81755""></a>
  <div class="note">
   <strong class="user">emilise dot victor at gmail dot com</strong>
   <a href="#81755" class="date">12-Mar-2008 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a way to get an output without using &lt;xml:message&gt; : use the var_dump function of php : <br />
- First bind the php functions with<br />
&lt;? $xslt-&gt;registerPHPFunctions() ?&gt; <br />
and xmlns:php="<a href="http://php.net/xsl" rel="nofollow" target="_blank">http://php.net/xsl</a>" in the stylesheet<br />
- Then you can call the var_dump function like this : &lt;xsl:variable name="a" select="php:function('var_dump', $return)" /&gt;<br />
<br />
I couldn't find a way to call the function and have it really print the result without creating a variable, but well, it's just for debugging...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80348""></a>
  <div class="note">
   <strong class="user">shangxiao at php dot net</strong>
   <a href="#80348" class="date">10-Jan-2008 05:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using the DOM api to add xsl commands to your stylesheet dynamically, be sure to use createElementNS() rather than createElement() otherwise the XSLTProcessor will not recognise these DOM nodes.<br />
<br />
Eg:<br />
$xsl-&gt;createElementNS('<a href="http://www.w3.org/1999/XSL/Transform" rel="nofollow" target="_blank">http://www.w3.org/1999/XSL/Transform</a>', 'xsl:element');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78436""></a>
  <div class="note">
   <strong class="user">pb at online-magazin dot at</strong>
   <a href="#78436" class="date">11-Oct-2007 03:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Calling the Saxon XSLT Processor is a very esay task to do!<br />
<br />
You just need to do some simple task<br />
<br />
1. Install the JavaBridge for PHP<br />
<br />
2. Download the freeware (B) Saxon distribution from <a href="http://saxon.sourceforge.net/" rel="nofollow" target="_blank">http://saxon.sourceforge.net/</a><br />
<br />
3. Put the jar files in a directory whre you have access<br />
<br />
4. Use this sample of code<br />
<br />
// Directory where the jar files are located<br />
define("SAXON_DIR", $_SERVER['DOCUMENT_ROOT']."/saxonb8.9.0/");<br />
<br />
// include the jars<br />
java_require(SAXON_DIR."saxon8.jar;".SAXON_DIR."saxon8-dom.jar");<br />
&nbsp;<br />
&nbsp;<br />
$sXslFile = $_SERVER['DOCUMENT_ROOT']."/myfirst.xsl"; // The xsl file<br />
$sXmlFile = $_SERVER['DOCUMENT_ROOT']."/myfirst.xml"; // The xml file<br />
<br />
try<br />
{<br />
&nbsp; $oXslSource = new java("javax.xml.transform.stream.StreamSource", "file://".$sXslFile);<br />
&nbsp; $oXmlSource = new java("javax.xml.transform.stream.StreamSource", "file://".$sXmlFile);<br />
<br />
&nbsp; $oFeatureKeys = new JavaClass("net.sf.saxon.FeatureKeys");<br />
<br />
&nbsp; // Create the Factory<br />
&nbsp; $oTransformerFactory = new java("net.sf.saxon.TransformerFactoryImpl");<br />
<br />
&nbsp; //Disable source document validation<br />
&nbsp; $oTransformerFactory-&gt;setAttribute($oFeatureKeys-&gt;SCHEMA_VALIDATION, 4);<br />
<br />
&nbsp; // Create a new Transformer<br />
&nbsp; $oTransFormer = $oTransformerFactory-&gt;newTransformer($oXslSource);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp; // Create a StreamResult to store the output<br />
&nbsp; $oResultStringWriter = new java("java.io.StringWriter");<br />
&nbsp; $oResultStream = new java("javax.xml.transform.stream.StreamResult", $oResultStringWriter);<br />
&nbsp; <br />
&nbsp; // Transform<br />
&nbsp; $oTransFormer-&gt;transform($oXmlSource, $oResultStream);<br />
&nbsp; <br />
&nbsp; // Echo the output from the transformation<br />
&nbsp; echo java_cast($oResultStringWriter-&gt;toString(), "string");<br />
&nbsp; <br />
}<br />
catch(JavaException $e){<br />
&nbsp;&nbsp; echo java_cast($e-&gt;getCause()-&gt;toString(), "string");<br />
&nbsp;&nbsp; exit;<br />
}<br />
<br />
5. Enjoy<br />
<br />
This is working quite well.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77244""></a>
  <div class="note">
   <strong class="user">Vasil Rangelov</strong>
   <a href="#77244" class="date">21-Aug-2007 07:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
@basslines at gmail dot com<br />
"<br />
As far as I can tell, the most recent stable versions of LibXML/LibXSLT/LibEXSLT do NOT support xPath 2.0 / XSLT 2.0 transformations. The only support for XSLT 2.0 that I've found is in Java's SAXON processor (<a href="http://saxon.sourceforge.net/" rel="nofollow" target="_blank">http://saxon.sourceforge.net/</a>).<br />
"<br />
<br />
Using SAXON or AltovaXML by using their JAVA bindings could prove to be a difficult task to do, and .NET seems to be buggy (at least for me). However, I've made a class that uses SAXON or AltovaXML from the command line. AltovaXML could also be used with COM, provided it's registered as a COM component.<br />
<br />
You can download my wrapper from:<br />
<a href="http://xslt2processor.sourceforge.net/" rel="nofollow" target="_blank">http://xslt2processor.sourceforge.net/</a><br />
<br />
I still need to implement a more graceful error handling (the way the XSL extension uses the Libxml functions), and once the bug<br />
<a href="http://bugs.php.net/bug.php?id=41577" rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=41577</a><br />
is fixed, I'll implement the .NET interfaces too.<br />
<br />
I'll appreciate any feedback.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="76132""></a>
  <div class="note">
   <strong class="user">geoffreyj dot lee at gmail dot com</strong>
   <a href="#76132" class="date">01-Jul-2007 11:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here are a couple useful tips for those who care about cross-browser compatibility.<br />
<br />
Given:<br />
<br />
&lt;script type="text/javascript" src="test.js"&gt;&lt;/script&gt;<br />
<br />
XSLT will automatically condense it to:<br />
<br />
&lt;script type="text/javascript" src="test.js"/&gt;<br />
<br />
While this is good, Internet Explorer breaks on empty script tags. So, the simple solution is to add something to prevent an empty tag. For example:<br />
<br />
&lt;script type="text/javascript" src="test.js"&gt;&lt;xsl:comment/&gt;&lt;/script&gt;<br />
<br />
Produces:<br />
<br />
&lt;script type="text/javascript" src="test.js"&gt;<br />
<br />
&lt;/script&gt;<br />
<br />
------------------------<br />
<br />
Also, here is a way to use IE's conditional comments:<br />
<br />
&lt;xsl:comment&gt;[if gte IE 5]&amp;#62;<br />
&amp;#60;link rel="stylesheet" type="text/css" href="ie.css" /&amp;#62;<br />
&amp;#60;![endif]&lt;/xsl:comment&gt;<br />
<br />
Produces:<br />
<br />
&lt;!--[if gte IE 5]&gt;<br />
&lt;link rel="stylesheet" type="text/css" href="ie.css" /&gt;<br />
&lt;![endif]--&gt;<br />
<br />
This will let you isolate IE-related CSS without needing to use ugly CSS hacks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75055""></a>
  <div class="note">
   <strong class="user">gabriel dot birke at web dot de</strong>
   <a href="#75055" class="date">10-May-2007 03:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Each &lt;xsl:message&gt; tag will generate a PHP error (level Warning). If you want to collect and pretty-print them, you could use a custom error handling function that collects the warnings in a static variable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75025""></a>
  <div class="note">
   <strong class="user">mnot at mnot dot net</strong>
   <a href="#75025" class="date">08-May-2007 08:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can set an HTTP proxy for the XSLT document() function to use (as well as DTD external references) by setting http_proxy in the environment.<br />
<br />
E.g., in Apache configuration;<br />
<br />
SetEnv http_proxy <a href="http://127.0.0.1:3128/" rel="nofollow" target="_blank">http://127.0.0.1:3128/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74883""></a>
  <div class="note">
   <strong class="user">Ryan D. Hatch</strong>
   <a href="#74883" class="date">02-May-2007 01:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Looking for php_xsl.dll?<br />
<br />
If you installed on Windows using the MSI Installer - you may not have it.<br />
<br />
1.) Add/Remove Programs and Change PHP Installation.&nbsp; Select XSL Extension.<br />
<br />
OR<br />
<br />
2.) Download complete .zip file of PHP and you can copy php_xsl.dll into your PHP/etc directory.<br />
<br />
Just a note.<br />
<br />
Ryan D. Hatch</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69661""></a>
  <div class="note">
   <strong class="user">adrian at foeder dot de</strong>
   <a href="#69661" class="date">14-Sep-2006 02:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to use the document()-function inside your XSL stylesheet, please note that you have to use an absolute path there.<br />
Important for windows users: the absolute path *has* to be with forward slashes, so subsitute windows-path-backslashes to forward slashes before you transform the document.<br />
<br />
Examples:<br />
This will NOT work:<br />
&lt;xsl:copy-of select="document('test.xml')" /&gt;<br />
<br />
This will also NOT work:<br />
&lt;xsl:copy-of select="document('c:\temp\test.xml')" /&gt;<br />
<br />
But this WILL work:<br />
&lt;xsl:copy-of select="document('c:/temp/test.xml')" /&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65277""></a>
  <div class="note">
   
   <a href="#65277" class="date">27-Apr-2006 06:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Enable libxslt library, PHP 5, under windows:<br />
<br />
To Enable:<br />
In your php.ini<br />
1. Uncomment ;extension=php_xsl.dll<br />
2. Change extension_dir to<br />
&nbsp;&nbsp; &nbsp; extension_dir = "./ext"<br />
<br />
To Confirm:<br />
1. In a test.php page:<br />
<span class="default">&lt;?php phpinfo</span><span class="keyword">() </span><span class="default">?&gt;<br />
</span>2. Run test.php<br />
3. Search for "libxslt Version". It should return a version number in a XSL headed table.<br />
<br />
Further info Google<br />
"Configuring and Testing PHP Servers for XSL Support"</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63764""></a>
  <div class="note">
   <strong class="user">Fabrice Bonny</strong>
   <a href="#63764" class="date">30-Mar-2006 01:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to how to use entities from DTD (internal or external) in XSLT. It works if you do this way:<br />
<br />
$xsl = new DOMDocument;<br />
$xsl-&gt;resolveExternals = TRUE;<br />
$xsl-&gt;substituteEntities = TRUE;<br />
$xsl-&gt;load(...);<br />
<br />
Hope this helps! ;-)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63738""></a>
  <div class="note">
   <strong class="user">basslines at gmail dot com</strong>
   <a href="#63738" class="date">29-Mar-2006 10:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As far as I can tell, the most recent stable versions of LibXML/LibXSLT/LibEXSLT do NOT support xPath 2.0 / XSLT 2.0 transformations. The only support for XSLT 2.0 that I've found is in Java's SAXON processor (<a href="http://saxon.sourceforge.net/" rel="nofollow" target="_blank">http://saxon.sourceforge.net/</a>).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63264""></a>
  <div class="note">
   
   <a href="#63264" class="date">17-Mar-2006 09:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to appletalk at gmail dot com<br />
&lt;snip&gt;<br />
As many of you may have noticed, DOM parser gives errors if the '&amp;nbsp;' entity is present. The E_WARN message looks like:<br />
Warning: DOMDocument::load() [function.load]: Entity 'nbsp' not defined in ...<br />
There're many ways to solve this:<br />
.....<br />
b) Defining &amp;nbsp;<br />
At the top of the document, after the &lt;?xml?&gt; definition, add:<br />
&nbsp;&nbsp; &lt;!DOCTYPE xsl:stylesheet [<br />
&nbsp;&nbsp; &lt;!ENTITY nbsp "&amp;#160;" &gt;<br />
&nbsp;&nbsp; ]&gt;<br />
.......&lt;/snip&gt;<br />
Just wanted to let people know that option b does NOT work. I'm not sure why this isn't implemented correctly, but it isn't, so don't waste your time. It's unfortunate the DOMXSL transform is so much less capable than the old xslt function.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50472""></a>
  <div class="note">
   <strong class="user">venkatesh at lammersmedical dot com</strong>
   <a href="#50472" class="date">01-Mar-2005 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is function to read from the XSL sheet which is saved as a text file.<br />
<br />
function ReadExcelSheet($filename){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $test=file($filename);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ar1=str_replace("~[^\t]*\t","\t",$test);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ar2=str_replace("~","",$ar1);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $ar=str_replace("?","",$ar2);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $temp=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for ($i=0; $i&lt;count($ar); $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if((substr($ar[$i],0,1)!= "\t")){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if($ar[$i]!=="\r\n"){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; array_push($temp,$ar[$i]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $name=split("\t",$temp[0]);<br />
&nbsp;&nbsp;&nbsp; $ExcelList=array();<br />
&nbsp;&nbsp;&nbsp; for($i=1;$i&lt;count($temp);$i++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $split_result=split("\t",$temp[$i]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array_push($ExcelList,$split_result);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; $result=insert_into_array($ExcelList,0,$name);<br />
&nbsp;&nbsp;&nbsp; return($result);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="49694""></a>
  <div class="note">
   <strong class="user">appletalk at gmail dot com</strong>
   <a href="#49694" class="date">04-Feb-2005 10:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As many of you may have noticed, DOM parser gives errors if the '&amp;nbsp;' entity is present. The E_WARN message looks like:<br />
<br />
Warning: DOMDocument::load() [function.load]: Entity 'nbsp' not defined in ...<br />
<br />
There're many ways to solve this:<br />
a) The hard way<br />
&lt;xsl:text disable-output-escaping="yes"&gt; &amp;amp;nbsp;&lt;/xsl:text&gt;<br />
<br />
b) Defining &amp;nbsp;<br />
At the top of the document, after the &lt;?xml?&gt; definition, add:<br />
&nbsp;&nbsp; &lt;!DOCTYPE xsl:stylesheet [ <br />
&nbsp;&nbsp;&nbsp; &lt;!ENTITY nbsp "&amp;#160;" &gt;<br />
&nbsp;&nbsp;&nbsp; ]&gt;<br />
<br />
c) External Doctype<br />
Just in case you want need other HTML entities, you can call an external doctype with the proper definitions<br />
<br />
&lt;!DOCTYPE page SYSTEM "<a href="http://gv.ca/dtd/character-entities.dtd" rel="nofollow" target="_blank">http://gv.ca/dtd/character-entities.dtd</a>"&gt;<br />
<br />
Of course, you can download the file and place it in your server.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48416""></a>
  <div class="note">
   <strong class="user">kekoajs at yahoo dot com</strong>
   <a href="#48416" class="date">22-Dec-2004 02:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Wow, I spent the better part of a day looking for how one could pass an entire test expression to an XSL stylesheet.&nbsp; It seems that the XSLT 1.0 specification doesn't support it but PHP 5 (and maybe 4s) inclusion of&nbsp; EXSLT allows one to do exactly that...<br />
<br />
simply add these lines...<br />
<br />
xmlns:dyn="<a href="http://exslt.org/dynamic" rel="nofollow" target="_blank">http://exslt.org/dynamic</a>"<br />
extension-element-prefixes="dyn"<br />
<br />
to the &lt;xsl:stylesheet&gt; element and when using an expression stored in a &lt;xsl:param&gt; element write<br />
<br />
&lt;xsl:if test="dyn:evaluate($param-name)"&gt;<br />
<br />
and viola!&nbsp; you can now use expressions generated externally in your stylesheet!<br />
<br />
EXSLT adds many useful functions that can be integrated into your XSL in a similar fashion.&nbsp; You can go to <a href="http://exslt.org/ to learn more..." rel="nofollow" target="_blank">http://exslt.org/ to learn more...</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45950""></a>
  <div class="note">
   <strong class="user">rd at jerntorget dot se</strong>
   <a href="#45950" class="date">24-Sep-2004 03:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get the following warning message:<br />
<br />
xsltApplyOneTemplate: _if_ was not compiled in (if can for example be apply-template or some other method), i've found that the problem seems to be an &amp;nbsp; directly before the &lt;xsl:if&gt; or what ever is causing the problem.<br />
<br />
One way to get thru the problem is to use span tags around &amp;nbsp;&nbsp; like : &lt;span&gt;&amp;nbsp;&lt;/span&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45415""></a>
  <div class="note">
   <strong class="user">jw at jwscripts dot com</strong>
   <a href="#45415" class="date">06-Sep-2004 02:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The following code is a wrapper to support calls to some of the old xslt_* functions:<br />
<br />
&lt;?<br />
<br />
if (PHP_VERSION &gt;= 5) {<br />
&nbsp;&nbsp;&nbsp; // Emulate the old xslt library functions<br />
&nbsp;&nbsp;&nbsp; function xslt_create() {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return new XsltProcessor();<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function xslt_process($xsltproc, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xml_arg, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xsl_arg, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xslcontainer = null, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $args = null, <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $params = null) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Start with preparing the arguments<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xml_arg = str_replace('arg:', '', $xml_arg);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xsl_arg = str_replace('arg:', '', $xsl_arg);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Create instances of the DomDocument class<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xml = new DomDocument;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xsl = new DomDocument;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Load the xml document and the xsl template<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xml-&gt;loadXML($args[$xml_arg]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xsl-&gt;loadXML($args[$xsl_arg]);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Load the xsl template<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $xsltproc-&gt;importStyleSheet($xsl);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Set parameters when defined<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($params) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; foreach ($params as $param =&gt; $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $xsltproc-&gt;setParameter("", $param, $value);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Start the transformation<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $processed = $xsltproc-&gt;transformToXML($xml);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Put the result in a file when specified<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($xslcontainer) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return @file_put_contents($xslcontainer, $processed);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $processed;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; function xslt_free($xsltproc) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset($xsltproc);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
$arguments = array(<br />
&nbsp;&nbsp;&nbsp; '/_xml' =&gt; file_get_contents("newxslt.xml"),<br />
&nbsp;&nbsp;&nbsp; '/_xsl' =&gt; file_get_contents("newxslt.xslt")<br />
);<br />
<br />
$xsltproc = xslt_create();<br />
$html = xslt_process(<br />
&nbsp;&nbsp;&nbsp; $xsltproc, <br />
&nbsp;&nbsp;&nbsp; 'arg:/_xml', <br />
&nbsp;&nbsp;&nbsp; 'arg:/_xsl', <br />
&nbsp;&nbsp;&nbsp; null, <br />
&nbsp;&nbsp;&nbsp; $arguments<br />
);<br />
<br />
xslt_free($xsltproc);<br />
print $html;<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="43514""></a>
  <div class="note">
   <strong class="user">rojaro</strong>
   <a href="#43514" class="date">23-Jun-2004 07:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're want to use XML from a variable e.g. $xmldata but the XSLT-StyleSheet from a file, you can do it also the following way:<br />
<br />
<span class="default">&lt;?php<br />
$xslt </span><span class="keyword">= new </span><span class="default">xsltProcessor</span><span class="keyword">;<br />
</span><span class="default">$xslt</span><span class="keyword">-&gt;</span><span class="default">importStyleSheet</span><span class="keyword">(</span><span class="default">DomDocument</span><span class="keyword">::</span><span class="default">load</span><span class="keyword">(</span><span class="string">'filename.xsl'</span><span class="keyword">));<br />
print </span><span class="default">$xslt</span><span class="keyword">-&gt;</span><span class="default">transformToXML</span><span class="keyword">(</span><span class="default">DomDocument</span><span class="keyword">::</span><span class="default">loadXML</span><span class="keyword">(</span><span class="default">$xmldata</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
