<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>生成更好的随机数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mt-getrandmax.html">? mt_getrandmax</a></li>
      <li style="float: right;"><a href="function.mt-srand.html">mt_srand ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.math.html">Math 函数</a></li>
    <li>生成更好的随机数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mt-rand" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">mt_rand</h1>
    <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mt_rand</span> &mdash; <span class="dc-title">生成更好的随机数</span></p>

   </div>
 <div class="refsect1 description" id="refsect1-function.mt-rand-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mt_rand</strong></span>
    (
   ) : <span class="type">int</span></div>

  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mt_rand</strong></span>
    ( <span class="methodparam"><span class="type">int</span> <code class="parameter">$min</code></span>
   , <span class="methodparam"><span class="type">int</span> <code class="parameter">$max</code></span>
   ) : <span class="type">int</span></div>

    <p class="simpara">
     很多老的 libc
     的随机数发生器具有一些不确定和未知的特性而且很慢。PHP
     的 <span class="function"><a href="function.rand.html" class="function">rand()</a></span> 函数默认使用
     libc 随机数发生器。<span class="function"><strong>mt_rand()</strong></span>
     函数是非正式用来替换它的。该函数用了
     <a href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html" class="link external" title="Link : http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html">&raquo;&nbsp;Mersenne Twister</a>
     中已知的特性作为随机数发生器，它可以产生随机数值的平均速度比
     libc 提供的 rand() 快四倍。
    </p>
    <p class="simpara">
     如果没有提供可选参数 <code class="parameter">min</code> 和
     <code class="parameter">max</code>，<span class="function"><strong>mt_rand()</strong></span>
     返回 0 到 <span class="function"><a href="function.mt-getrandmax.html" class="function">mt_getrandmax()</a></span>
     之间的伪随机数。例如想要 5 到 15（包括 5 和 15）之间的随机数，用
     <code class="literal">mt_rand(5, 15)</code>。
    </p>
   </div>

 <div class="refsect1 parameters" id="refsect1-function.mt-rand-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">min</code></dt>

     <dd>

      <p class="para">
       可选的、返回的最小值（默认：0）
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">max</code></dt>

     <dd>

      <p class="para">
       可选的、返回的最大值（默认：<span class="function"><a href="function.mt-getrandmax.html" class="function">mt_getrandmax()</a></span>）
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.mt-rand-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回 <code class="parameter">min</code> （或者 0） 到 <code class="parameter">max</code> （或者是到  <span class="function"><a href="function.mt-getrandmax.html" class="function">mt_getrandmax()</a></span>
     ，包含这个值）之间的随机整数。
  </p>
 </div>

 <div class="refsect1 changelog" id="refsect1-function.mt-rand-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr><td>4.2.0</td><td>随机数发生器自动进行播种。</td></tr>

     </tbody>
    
   </table>

  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.mt-rand-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-3469">
    <p><strong>Example #1 <span class="function"><strong>mt_rand()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br />echo&nbsp;</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">(</span><span style="color: #0000BB">5</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">15</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程的输出类似于：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
1604716014
1478613278
6
</pre></div>
    </div>
   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.mt-rand-notes">
  <h3 class="title">注释</h3>
  <div class="caution"><strong class="caution">Caution</strong>
   <p class="para">
    The distribution of <span class="function"><strong>mt_rand()</strong></span> return values is biased
    towards even numbers on 64-bit builds of PHP when
    <code class="parameter">max</code> is beyond <code class="literal">2^32</code>.
   </p>
  </div>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.mt-rand-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mt-srand.html" class="function" rel="rdfs-seeAlso">mt_srand()</a> - 播下一个更好的随机数发生器种子</span></li>
    <li class="member"><span class="function"><a href="function.mt-getrandmax.html" class="function" rel="rdfs-seeAlso">mt_getrandmax()</a> - 显示随机数的最大可能值</span></li>
    <li class="member"><span class="function"><a href="function.rand.html" class="function" rel="rdfs-seeAlso">rand()</a> - 产生一个随机整数</span></li>
   </ul>
  </p>
 </div>

  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="124672""></a>
  <div class="note">
   <strong class="user">Nikhil S.</strong>
   <a href="#124672" class="date">03-Feb-2020 05:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A nifty function to generate pretty coupon codes. This will generate unique coupon codes and you don't have to do a database check whether the code already exists.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">giftCodes</span><span class="keyword">(){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">&lt;=</span><span class="default">4</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">4</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$j </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">) { </span><span class="default">$a </span><span class="keyword">.= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"d"</span><span class="keyword">); </span><span class="default">$c</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$j </span><span class="keyword">== </span><span class="default">3</span><span class="keyword">) { </span><span class="default">$a </span><span class="keyword">.= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"m"</span><span class="keyword">); </span><span class="default">$c</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$j </span><span class="keyword">== </span><span class="default">4</span><span class="keyword">) { </span><span class="default">$a </span><span class="keyword">.= </span><span class="default">date</span><span class="keyword">(</span><span class="string">"y"</span><span class="keyword">); </span><span class="default">$c</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;= </span><span class="default">$c</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(!</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">)?</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">48</span><span class="keyword">,</span><span class="default">57</span><span class="keyword">):</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">65</span><span class="keyword">,</span><span class="default">90</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">.=</span><span class="string">'-'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, -</span><span class="default">1</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123458""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#123458" class="date">20-Dec-2018 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The seed is the PID + LCG (https://github.com/php/php-src/search?q=GENERATE_SEED&amp;unscoped_q=GENERATE_SEED)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119430""></a>
  <div class="note">
   <strong class="user">nospamremove dot francois dot gannaz at silecs dot info</strong>
   <a href="#119430" class="date">03-Jun-2016 10:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
rand() comes from the libc, and mt_rand() is internal to PHP. So the differences vary with their respective versions.<br />
<br />
On a 64b Debian Stretch with PHP 5.6.21, there is no visible difference: <a href="http://oi64.tinypic.com/2nkqas6.jpg" rel="nofollow" target="_blank">http://oi64.tinypic.com/2nkqas6.jpg</a><br />
<br />
This image compares the two functions. In the top half with random points, in the lower half with random intensity on each point. This is totally different from what was obtained 4 years ago in another note, with an unknown environment.<br />
<br />
Here is the code for this visual comparison.<br />
<span class="default">&lt;?php<br />
$sizex </span><span class="keyword">= </span><span class="default">400</span><span class="keyword">;<br />
</span><span class="default">$sizey </span><span class="keyword">= </span><span class="default">400</span><span class="keyword">;<br />
<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">2 </span><span class="keyword">* </span><span class="default">$sizex</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$sizey</span><span class="keyword">);<br />
</span><span class="default">$white </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">);<br />
</span><span class="default">$inks </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(<br />
&nbsp;&nbsp;&nbsp; function(</span><span class="default">$r</span><span class="keyword">) use(</span><span class="default">$img</span><span class="keyword">) { return </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">, </span><span class="default">$r</span><span class="keyword">); },<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">range</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">)<br />
);<br />
for (</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$sizex </span><span class="keyword">; </span><span class="default">$x</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$y </span><span class="keyword">= </span><span class="default">0 </span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">$sizey </span><span class="keyword">; </span><span class="default">$y</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// placing ($sizex x $sizey) white points at random in the top half<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$sizex </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">), </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$sizey </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">), </span><span class="default">$white</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$sizex </span><span class="keyword">+ </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$sizex </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">), </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$sizey </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">), </span><span class="default">$white</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// random intensity for each point in the lower half<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$sizey </span><span class="keyword">+ </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$inks</span><span class="keyword">[</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">)]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$sizex </span><span class="keyword">+ </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$sizey </span><span class="keyword">+ </span><span class="default">$y</span><span class="keyword">, </span><span class="default">$inks</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">)]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118873""></a>
  <div class="note">
   <strong class="user">syouseki</strong>
   <a href="#118873" class="date">19-Feb-2016 05:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mt_rand is not calculated by Mersenne Twister.<br />
<br />
https://github.com/php/php-src/commit/a0724d30817600540946b41e40f4cfc2a0c30f80</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115724""></a>
  <div class="note">
   <strong class="user">Jeff Cours</strong>
   <a href="#115724" class="date">12-Sep-2014 10:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
With PHP 5.3.3, we're seeing odd behavior on 32 bit Linux.<br />
<br />
This works fine on 64 bit Linux: <br />
<span class="default">&lt;?php<br />
printf </span><span class="keyword">(</span><span class="string">"%08x\n"</span><span class="keyword">, </span><span class="default">mt_rand </span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0xFFFFFFFF</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span>but on our 32 bit Linux development server, it's always yielding "00000000". <br />
<br />
On that same machine, this: <br />
<span class="default">&lt;?php<br />
printf </span><span class="keyword">(</span><span class="string">"%08x\n"</span><span class="keyword">, </span><span class="default">mt_rand </span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0xFFFFFFF0</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span> <br />
seems to always yield either 00000000 or a number in the range fffffff2 to ffffffff. This: <br />
<span class="default">&lt;?php<br />
printf </span><span class="keyword">(</span><span class="string">"%08x\n"</span><span class="keyword">, </span><span class="default">mt_rand </span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0xFFFFFF00</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span> <br />
gives numbers where the last two digits vary, and so on through at least 0xF0000000. <br />
<br />
However, this: <br />
<span class="default">&lt;?php<br />
printf </span><span class="keyword">(</span><span class="string">"%08x\n"</span><span class="keyword">, </span><span class="default">mt_rand </span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">0x7FFFFFFF</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span>seems to be well-behaved.<br />
<br />
The moral? On 32 bit systems, be careful about crossing the signed number boundary, 0x7FFFFFFF.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115363""></a>
  <div class="note">
   <strong class="user">falkartis at gmail dot com</strong>
   <a href="#115363" class="date">12-Jul-2014 03:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote another function to get a random float, if its not precise enougth jut add some '0' to the $mul parameter.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">,</span><span class="default">$mul</span><span class="keyword">=</span><span class="default">1000000</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$min</span><span class="keyword">&gt;</span><span class="default">$max</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">*</span><span class="default">$mul</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">*</span><span class="default">$mul</span><span class="keyword">)/</span><span class="default">$mul</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>I made following&nbsp; tests:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">().</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//0.497153<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0.5</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//0.857822<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0.5</span><span class="keyword">,</span><span class="default">0.6</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//0.599956<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//5.801949<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//1.5<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">f_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">10</span><span class="keyword">).</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">//1.7<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113611""></a>
  <div class="note">
   <strong class="user">Pawe Krawczyk</strong>
   <a href="#113611" class="date">05-Nov-2013 11:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To reiterate the message about *not* using mt_rand() for anything security related, here's a new tool that has been just posted that recovers the seed value given a single mt_rand() output:<br />
<br />
<a href="http://www.openwall.com/php_mt_seed/README" rel="nofollow" target="_blank">http://www.openwall.com/php_mt_seed/README</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112889""></a>
  <div class="note">
   <strong class="user">Miller</strong>
   <a href="#112889" class="date">02-Aug-2013 06:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another generic random string function, but very small and fast.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">mt_rand_str </span><span class="keyword">(</span><span class="default">$l</span><span class="keyword">, </span><span class="default">$c </span><span class="keyword">= </span><span class="string">'abcdefghijklmnopqrstuvwxyz1234567890'</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$s </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">, </span><span class="default">$cl </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">, </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$l</span><span class="keyword">; </span><span class="default">$s </span><span class="keyword">.= </span><span class="default">$c</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">$cl</span><span class="keyword">)], ++</span><span class="default">$i</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$s</span><span class="keyword">;<br />
}<br />
<br />
echo </span><span class="default">mt_rand_str</span><span class="keyword">(</span><span class="default">8</span><span class="keyword">); </span><span class="comment">// Something like mp2tmpsw<br />
</span><span class="keyword">echo </span><span class="default">mt_rand_str</span><span class="keyword">(</span><span class="default">6</span><span class="keyword">, </span><span class="string">'0123456789ABCDEF'</span><span class="keyword">); </span><span class="comment">// Something like B9CD0F<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111243""></a>
  <div class="note">
   <strong class="user">Hayley Watson</strong>
   <a href="#111243" class="date">29-Jan-2013 10:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another graphical comparison of rand() and mt_rand(). It effectively draws a graph showing how the last generated number affects the next by plotting the numbers in consecutive pairs against each other.<br />
<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);<br />
</span><span class="default">$sizex</span><span class="keyword">=</span><span class="default">800</span><span class="keyword">;<br />
</span><span class="default">$sizey</span><span class="keyword">=</span><span class="default">800</span><span class="keyword">;<br />
<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">2 </span><span class="keyword">* </span><span class="default">$sizex</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">);<br />
</span><span class="default">$black </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">);<br />
</span><span class="default">imagefilledrectangle</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$sizex</span><span class="keyword">, </span><span class="default">$sizey</span><span class="keyword">, </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">));<br />
<br />
</span><span class="default">$p </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">100000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$np </span><span class="keyword">= </span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$p</span><span class="keyword">, </span><span class="default">$np</span><span class="keyword">, </span><span class="default">$black</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">= </span><span class="default">$np</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">$p </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">100000</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$np </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$p </span><span class="keyword">+ </span><span class="default">$sizex</span><span class="keyword">, </span><span class="default">$np</span><span class="keyword">, </span><span class="default">$black</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$p </span><span class="keyword">= </span><span class="default">$np</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107738""></a>
  <div class="note">
   <strong class="user">cyrax21 at gmail dot com</strong>
   <a href="#107738" class="date">01-Mar-2012 08:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
i wanted to spot out the big difference between rand and mt_rand when producing images using randomness as noise.
<br />

<br />
for example this is a comparation between rand and mt_rand on a 400x400 pixel png: <a href="http://oi43.tinypic.com/vwtppl.jpg" rel="nofollow" target="_blank">http://oi43.tinypic.com/vwtppl.jpg</a>
<br />

<br />
code:
<br />
<span class="default">&lt;?php
<br />
header</span><span class="keyword">(</span><span class="string">"Content-type: image/png"</span><span class="keyword">);
<br />
</span><span class="default">$sizex</span><span class="keyword">=</span><span class="default">800</span><span class="keyword">;
<br />
</span><span class="default">$sizey</span><span class="keyword">=</span><span class="default">400</span><span class="keyword">;
<br />

<br />
</span><span class="default">$img </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$sizex</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">);
<br />
</span><span class="default">$ink </span><span class="keyword">= </span><span class="default">imagecolorallocate</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">,</span><span class="default">255</span><span class="keyword">);
<br />

<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$sizey</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">++) {
<br />
&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">), </span><span class="default">rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">), </span><span class="default">$ink</span><span class="keyword">);
<br />
&nbsp; }
<br />
}
<br />
&nbsp;
<br />
for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$sizex</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;</span><span class="default">$sizey</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">++) {
<br />
&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">$sizex</span><span class="keyword">/</span><span class="default">2</span><span class="keyword">,</span><span class="default">$sizex</span><span class="keyword">), </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$sizey</span><span class="keyword">), </span><span class="default">$ink</span><span class="keyword">);
<br />
&nbsp; }
<br />
}
<br />

<br />
</span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
</span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
the differences reduce when reducing the pixels of the image.. infact for a 100x100 pixel image the noise produced from the rand function is much more realistic than how it is for a 400x400 image: <a href="http://oi39.tinypic.com/5k0row.jpg" rel="nofollow" target="_blank">http://oi39.tinypic.com/5k0row.jpg</a>
<br />

<br />
(rand is on the left, mt_rand on the right)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106645""></a>
  <div class="note">
   <strong class="user">contact at sheyd dot fr</strong>
   <a href="#106645" class="date">24-Nov-2011 04:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To quickly build a human-readable random string for a captcha per example :<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">random</span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">8</span><span class="keyword">)<br />
{&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$chars </span><span class="keyword">= </span><span class="string">'bcdfghjklmnprstvwxzaeiou'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$p </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$p </span><span class="keyword">&lt; </span><span class="default">$length</span><span class="keyword">; </span><span class="default">$p</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">.= (</span><span class="default">$p</span><span class="keyword">%</span><span class="default">2</span><span class="keyword">) ? </span><span class="default">$chars</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">19</span><span class="keyword">, </span><span class="default">23</span><span class="keyword">)] : </span><span class="default">$chars</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">18</span><span class="keyword">)];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Note that I have removed q and y from $chars to avoid readability problems.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105639""></a>
  <div class="note">
   <strong class="user">j dot s dot shiuan at gmail dot com</strong>
   <a href="#105639" class="date">02-Sep-2011 11:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another good way to get a random float is to divide the result of mt_rand.<br />
Let's say we want a float between 0.75 and 1.25.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$i </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">75</span><span class="keyword">,</span><span class="default">125</span><span class="keyword">) / </span><span class="default">100</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="101564""></a>
  <div class="note">
   <strong class="user">Robin Leffmann</strong>
   <a href="#101564" class="date">25-Dec-2010 06:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Fast, pseudo-random binary data generation using mt_rand():<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">rnd_bin</span><span class="keyword">( </span><span class="default">$length </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; while( @</span><span class="default">$c</span><span class="keyword">++ * </span><span class="default">16 </span><span class="keyword">&lt; </span><span class="default">$length </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; @</span><span class="default">$tmp </span><span class="keyword">.= </span><span class="default">md5</span><span class="keyword">( </span><span class="default">mt_rand</span><span class="keyword">(), </span><span class="default">true </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">substr</span><span class="keyword">( </span><span class="default">$tmp</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$length </span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97977""></a>
  <div class="note">
   <strong class="user">nilesh at itech7 dot com</strong>
   <a href="#97977" class="date">19-May-2010 12:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A class to generate 99.5% unqiue strings. I found that there is only one or two characters common between two subsequent strings.
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
</span><span class="keyword">class </span><span class="default">Local_RandomString </span><span class="keyword">{
<br />
&nbsp; 
<br />
&nbsp; protected </span><span class="default">$_length</span><span class="keyword">;
<br />
&nbsp; protected </span><span class="default">$_prevRand</span><span class="keyword">;
<br />

<br />
&nbsp; public function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">15</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length </span><span class="keyword">= </span><span class="default">$length</span><span class="keyword">;
<br />

<br />
&nbsp; }
<br />

<br />
&nbsp; public function </span><span class="default">getRand</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$randStr </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;&nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$args</span><span class="keyword">[] = </span><span class="string">'N' </span><span class="keyword">. </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$args</span><span class="keyword">[] = </span><span class="default">mt_rand</span><span class="keyword">();&nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$randStr </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">base64_encode</span><span class="keyword">((</span><span class="default">call_user_func_array</span><span class="keyword">(</span><span class="string">'pack'</span><span class="keyword">, </span><span class="default">$args</span><span class="keyword">))), </span><span class="default">1</span><span class="keyword">, </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_prevRand </span><span class="keyword">= </span><span class="default">$randStr</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$randStr</span><span class="keyword">;
<br />

<br />
&nbsp; }
<br />

<br />
&nbsp; public function </span><span class="default">setLength</span><span class="keyword">(</span><span class="default">$l</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length </span><span class="keyword">= (int) </span><span class="default">$l</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_length </span><span class="keyword">&lt;= </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; throw new </span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Invalid random string length'</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp; }
<br />

<br />
&nbsp; public function </span><span class="default">getPrevRand</span><span class="keyword">() {
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">_prevRand</span><span class="keyword">;
<br />

<br />
&nbsp; }
<br />

<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89057""></a>
  <div class="note">
   <strong class="user">mark omohundro, ajamyajax dot com</strong>
   <a href="#89057" class="date">19-Feb-2009 09:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
just another example: both of these routines return a random decimal number between -1 and 1... since rand() only returns a max 'integer' value while mt_rand() return a max 'long' value -- at least on some platforms -- mt_rand() could be the better precision choice for some on any variation to this routine (but i don't think it matters here):<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">echo </span><span class="string">"-1 to 1 rand() value: "</span><span class="keyword">. (</span><span class="default">rand</span><span class="keyword">(</span><span class="default">getrandmax</span><span class="keyword">()*-</span><span class="default">1</span><span class="keyword">,</span><span class="default">getrandmax</span><span class="keyword">())/</span><span class="default">getrandmax</span><span class="keyword">()). </span><span class="string">"\n&lt;br/&gt;"</span><span class="keyword">;<br />
echo </span><span class="string">"-1 to 1 mt_rand() value: "</span><span class="keyword">. (</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">mt_getrandmax</span><span class="keyword">()*-</span><span class="default">1</span><span class="keyword">,</span><span class="default">mt_getrandmax</span><span class="keyword">())/</span><span class="default">mt_getrandmax</span><span class="keyword">()). </span><span class="string">"\n"</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83655""></a>
  <div class="note">
   <strong class="user">Mark Seecof</strong>
   <a href="#83655" class="date">05-Jun-2008 11:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you need some pseudorandom bits for security or cryptographic purposes (e.g.g., random IV for block cipher, random salt for password hash) mt_rand() is a poor source.&nbsp; On most Unix/Linux and/or MS-Windows platforms you can get a better grade of pseudorandom bits from the OS or system library, like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// get 128 pseudorandom bits in a string of 16 bytes<br />
<br />
</span><span class="default">$pr_bits </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Unix/Linux platform?<br />
</span><span class="default">$fp </span><span class="keyword">= @</span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'/dev/urandom'</span><span class="keyword">,</span><span class="string">'rb'</span><span class="keyword">);<br />
if (</span><span class="default">$fp </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pr_bits </span><span class="keyword">.= @</span><span class="default">fread</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">,</span><span class="default">16</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; @</span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// MS-Windows platform?<br />
</span><span class="keyword">if (@</span><span class="default">class_exists</span><span class="keyword">(</span><span class="string">'COM'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// <a href="http://msdn.microsoft.com/en-us/library/aa388176(VS.85" rel="nofollow" target="_blank">http://msdn.microsoft.com/en-us/library/aa388176(VS.85</a>).aspx<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">try {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$CAPI_Util </span><span class="keyword">= new </span><span class="default">COM</span><span class="keyword">(</span><span class="string">'CAPICOM.Utilities.1'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pr_bits </span><span class="keyword">.= </span><span class="default">$CAPI_Util</span><span class="keyword">-&gt;</span><span class="default">GetRandom</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// if we ask for binary data PHP munges it, so we<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // request base64 return value.&nbsp; We squeeze out the<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // redundancy and useless ==CRLF by hashing...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$pr_bits</span><span class="keyword">) { </span><span class="default">$pr_bits </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$pr_bits</span><span class="keyword">,</span><span class="default">TRUE</span><span class="keyword">); }<br />
&nbsp;&nbsp;&nbsp; } catch (</span><span class="default">Exception $ex</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// echo 'Exception: ' . $ex-&gt;getMessage();<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
}<br />
<br />
if (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$pr_bits</span><span class="keyword">) &lt; </span><span class="default">16</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// do something to warn system owner that<br />
&nbsp;&nbsp;&nbsp; // pseudorandom generator is missing<br />
</span><span class="keyword">}<br />
</span><span class="default">?&gt;<br />
</span><br />
NB: it is generally safe to leave both the attempt to read /dev/urandom and the attempt to access CAPICOM in your code, though each will fail silently on the other's platform.&nbsp; Leave them both there so your code will be more portable.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82156""></a>
  <div class="note">
   <strong class="user">geompse at yopmail dot com</strong>
   <a href="#82156" class="date">29-Mar-2008 04:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mt_rand() is not faster than rand() !<br />
<br />
Tested over 100'000 iterations, with none/various/random arguments, mt_rand is always 3% slower than rand().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79141""></a>
  <div class="note">
   <strong class="user">fabiovh on gmail</strong>
   <a href="#79141" class="date">13-Nov-2007 06:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
performance: for a repetitive task, it's much faster not to use the limit parameters, as shown below. just use the % operator.<br />
<br />
$t=microtime(true);<br />
for($i=0;$i&lt;1000000;$i++)<br />
&nbsp;mt_rand()%3;<br />
echo microtime(true)-$t;<br />
<br />
echo '|';<br />
<br />
$t=microtime(true);<br />
for($i=0;$i&lt;1000000;$i++)<br />
&nbsp;mt_rand(0,2);<br />
echo microtime(true)-$t;<br />
<br />
echo '|';<br />
<br />
$t=microtime(true);<br />
for($i=0;$i&lt;1000000;$i++)<br />
&nbsp;mt_rand();<br />
echo microtime(true)-$t;<br />
<br />
output: 0.316797971725|0.442242145538|0.253082036972</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75793""></a>
  <div class="note">
   <strong class="user">rok dot kralj at gmail dot com</strong>
   <a href="#75793" class="date">16-Jun-2007 12:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mt_rand function returns just a whole numbers. If you want a random float, then here's an elegant way:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">random_float </span><span class="keyword">(</span><span class="default">$min</span><span class="keyword">,</span><span class="default">$max</span><span class="keyword">) {<br />
&nbsp;&nbsp; return (</span><span class="default">$min</span><span class="keyword">+</span><span class="default">lcg_value</span><span class="keyword">()*(</span><span class="default">abs</span><span class="keyword">(</span><span class="default">$max</span><span class="keyword">-</span><span class="default">$min</span><span class="keyword">)));<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74036""></a>
  <div class="note">
   <strong class="user">chagenbu at php dot net</strong>
   <a href="#74036" class="date">21-Mar-2007 09:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The algorithm used by mt_rand() changed in PHP 5.2.1. If you are relying on getting the same sequence from mt_rand() after calling mt_srand() with a known seed, upgrading to PHP 5.2.1 will break your code. See <a href="http://bugs.php.net/bug.php?id=40724 for something of an explanation; there is no workaround." rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=40724 for something of an explanation; there is no workaround.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73077""></a>
  <div class="note">
   <strong class="user">zolaar at nothanks dot com</strong>
   <a href="#73077" class="date">07-Feb-2007 10:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
a better (and likely faster) way to generate a random 6-digit hex string:<br />
<br />
<span class="default">&lt;?php<br />
$num </span><span class="keyword">= </span><span class="default">mt_rand </span><span class="keyword">( </span><span class="default">0</span><span class="keyword">, </span><span class="default">0xffffff </span><span class="keyword">); </span><span class="comment">// trust the library, love the library...<br />
</span><span class="default">$output </span><span class="keyword">= </span><span class="default">sprintf </span><span class="keyword">( </span><span class="string">"%06x" </span><span class="keyword">, </span><span class="default">$num </span><span class="keyword">); </span><span class="comment">// muchas smoochas to you, PHP!<br />
</span><span class="keyword">return </span><span class="default">$output</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
The mt_rand function won't give you a number outside the bounds you asked for -- no need to and-off the top bits -- and the sprintf function has params for length-padding &amp; hexidecimal output.&nbsp; It's likely faster because most of the work is being done by the wicked fast C functions that PHP sits on top of, though YMMV in that dept.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51948""></a>
  <div class="note">
   <strong class="user">nowhere at where dot net</strong>
   <a href="#51948" class="date">16-Apr-2005 02:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Allows characters 0-9, a-z<br />
Weighted (and tested) ok.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">generate_string </span><span class="keyword">(</span><span class="default">$length </span><span class="keyword">= </span><span class="default">20</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nps </span><span class="keyword">= </span><span class="string">""</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$length</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nps </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">( (</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">36</span><span class="keyword">) &lt;= </span><span class="default">26</span><span class="keyword">) ? </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">97</span><span class="keyword">, </span><span class="default">122</span><span class="keyword">) : </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">48</span><span class="keyword">, </span><span class="default">57 </span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nps</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39805""></a>
  <div class="note">
   
   <a href="#39805" class="date">11-Feb-2004 05:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a example of a very small, compact, quite random-random string generator. It will make a string with uppercase &amp; lowercase letters, with numbers. You simply need to set $len in the for() structure, and then the string will be in $r.&nbsp; It has been designed for size, while it's still quite fast.&nbsp; Mind the wrapping, it should be 1 line.<br />
<br />
<span class="default">&lt;?php <br />
</span><span class="keyword">for(</span><span class="default">$len</span><span class="keyword">=</span><span class="default">8</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">=</span><span class="string">''</span><span class="keyword">;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">)&lt;</span><span class="default">$len</span><span class="keyword">;</span><span class="default">$r</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(!</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">)?<br />
</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">48</span><span class="keyword">,</span><span class="default">57</span><span class="keyword">):(!</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">)?</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">65</span><span class="keyword">,</span><span class="default">90</span><span class="keyword">):</span><span class="default">mt_rand<br />
</span><span class="keyword">(</span><span class="default">97</span><span class="keyword">,</span><span class="default">122</span><span class="keyword">))));<br />
</span><span class="default">?&gt;<br />
</span><br />
Armond Carroll</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="19541""></a>
  <div class="note">
   <strong class="user">demogracia at metropoliglobal dot com</strong>
   <a href="#19541" class="date">02-Mar-2002 12:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment">//
<br />
// Generates a random string with the specified length
<br />
// Chars are chosen from the provided [optional] list
<br />
//
<br />
</span><span class="keyword">function </span><span class="default">simpleRandString</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">=</span><span class="default">16</span><span class="keyword">, </span><span class="default">$list</span><span class="keyword">=</span><span class="string">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">mt_srand</span><span class="keyword">((double)</span><span class="default">microtime</span><span class="keyword">()*</span><span class="default">1000000</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$newstring</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$length</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$newstring</span><span class="keyword">)&lt;</span><span class="default">$length</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">$list</span><span class="keyword">[</span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$list</span><span class="keyword">)-</span><span class="default">1</span><span class="keyword">)];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$newstring</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="comment">//
<br />
// Generates a random string with the specified length
<br />
// Includes: a-z, A-Z y 0-9
<br />
//
<br />
</span><span class="keyword">function </span><span class="default">randString</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">=</span><span class="default">16</span><span class="keyword">) {
<br />
&nbsp;&nbsp; </span><span class="default">$newstring</span><span class="keyword">=</span><span class="string">""</span><span class="keyword">;
<br />
&nbsp;&nbsp; if(</span><span class="default">$length</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; while(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$newstring</span><span class="keyword">)&lt;</span><span class="default">$length</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$randnum </span><span class="keyword">= </span><span class="default">mt_rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">61</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$randnum </span><span class="keyword">&lt; </span><span class="default">10</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$randnum</span><span class="keyword">+</span><span class="default">48</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } elseif (</span><span class="default">$randnum </span><span class="keyword">&lt; </span><span class="default">36</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$randnum</span><span class="keyword">+</span><span class="default">55</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$newstring</span><span class="keyword">.=</span><span class="default">chr</span><span class="keyword">(</span><span class="default">$randnum</span><span class="keyword">+</span><span class="default">61</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; }
<br />
&nbsp;&nbsp; }
<br />
&nbsp;&nbsp; return </span><span class="default">$newstring</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
