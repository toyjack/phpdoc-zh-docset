<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>向服务器发送 SITE 命令</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.ftp-set-option.html">? ftp_set_option</a></li>
      <li style="float: right;"><a href="function.ftp-size.html">ftp_size ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.ftp.html">FTP 函数</a></li>
    <li>向服务器发送 SITE 命令</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.ftp-site" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">ftp_site</h1>
    <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">ftp_site</span> &mdash; <span class="dc-title">向服务器发送 SITE 命令</span></p>

   </div>
   <div class="refsect1 description" id="refsect1-function.ftp-site-description">
    <h3 class="title">说明</h3>
    <div class="methodsynopsis dc-description">
     <span class="methodname"><strong>ftp_site</strong></span>
      ( <span class="methodparam"><span class="type">resource</span> <code class="parameter">$ftp_stream</code></span>
     , <span class="methodparam"><span class="type">string</span> <code class="parameter">$command</code></span>
     ) : <span class="type">bool</span></div>

    <p class="para rdfs-comment">
     <span class="function"><strong>ftp_site()</strong></span> 函数向 FTP 服务器发送指定的命令。
    </p>
    <p class="para">
     <code class="literal">SITE</code> 命令是非标准化的，不同的服务器不尽相同。主要用于处理文件权限以及组成员等事情。
    </p>
   </div>

   <div class="refsect1 parameters" id="refsect1-function.ftp-site-parameters">
   <h3 class="title">参数</h3>
    <p class="para">
     <dl>

      
       <dt>
<code class="parameter">ftp_stream</code></dt>

       <dd>

        <p class="para">
        FTP 连接资源。
        </p>
       </dd>

      
      
       <dt>
<code class="parameter">command</code></dt>

       <dd>

        <p class="para">
         SITE
         命令。注意本参数没有经过处理，在文件名有存在空格或其它特殊字符的情况下可能会有问题。
        </p>
       </dd>

      
     </dl>

    </p>
   </div>

   <div class="refsect1 returnvalues" id="refsect1-function.ftp-site-returnvalues">
   <h3 class="title">返回值</h3>
   <p class="para">
   成功时返回 <strong><code>true</code></strong>， 或者在失败时返回 <strong><code>false</code></strong>。
   </p>
   </div>

   <div class="refsect1 examples" id="refsect1-function.ftp-site-examples">
    <h3 class="title">范例</h3>
    <p class="para">
    <div class="example" id="example-4650">
     <p><strong>Example #1 向一个 FTP 服务器发送一条 SITE 命令</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;连接&nbsp;FTP&nbsp;服务器<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ftp_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'ftp.example.com'</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">$conn</span><span style="color: #007700">)&nbsp;die(</span><span style="color: #DD0000">'无法连接到&nbsp;ftp.example.com'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;使用用户&nbsp;user&nbsp;和密码&nbsp;pass&nbsp;登录服务器<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">ftp_login</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'user'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'pass'</span><span style="color: #007700">))&nbsp;die(</span><span style="color: #DD0000">'登录失败到&nbsp;ftp.example.com'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Issue:&nbsp;"SITE&nbsp;CHMOD&nbsp;0600&nbsp;/home/user/privatefile"&nbsp;command&nbsp;to&nbsp;ftp&nbsp;server<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">ftp_site</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'CHMOD&nbsp;0600&nbsp;/home/user/privatefile'</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"命令执行成功。\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;die(</span><span style="color: #DD0000">'命令执行失败。'</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
    </p>
   </div>


   <div class="refsect1 seealso" id="refsect1-function.ftp-site-seealso">
    <h3 class="title">参见</h3>
    <p class="para">
     <ul class="simplelist">
      <li class="member"><span class="function"><a href="function.ftp-raw.html" class="function" rel="rdfs-seeAlso">ftp_raw()</a> - 向 FTP 服务器发送命令</span></li>
     </ul>
    </p>
   </div>

  </div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="86838""></a>
  <div class="note">
   <strong class="user">www.bossftp.com</strong>
   <a href="#86838" class="date">05-Nov-2008 06:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To send a SITE command and get the result, you can try this:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">ftpsite</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="default">$cmd</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">ftp_raw</span><span class="keyword">(</span><span class="default">$conn</span><span class="keyword">, </span><span class="string">"SITE </span><span class="default">$cmd</span><span class="string">"</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="34735""></a>
  <div class="note">
   <strong class="user">Marc</strong>
   <a href="#34735" class="date">05-Aug-2003 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Use ftp_raw() (PHP 5+) instead of ftp_site() if you need the results of the remote command.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33169""></a>
  <div class="note">
   <strong class="user">webmaster at beezm dot net</strong>
   <a href="#33169" class="date">17-Jun-2003 11:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote some functions for an ftp server for windows called GuildFTPd.<br />
<br />
Here they are, they are pretty much so self explanitory:<br />
&lt;?<br />
function guildftpd_adduser($ftp_stream,$group,$username,$password){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE ADDUSER $group $username $password");<br />
}<br />
function guildftpd_addgroup($ftp_stream,$groupname){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE ADDGROUP $groupname");<br />
}<br />
function guildftpd_deluser($ftp_stream,$username){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE DELUSER $username");<br />
}<br />
function guildftpd_addpath($ftp_stream,$username,$path,$vpath){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE ADDPATH $username $path $vpath");<br />
}<br />
function guildftpd_delpath($ftp_stream,$username,$path,$vpath){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE DELPATH $username $path $vpath");<br />
}<br />
function guildftpd_anon($ftp_stream){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE ANON ALLOW");<br />
}<br />
function guildftpd_anond($ftp_stream){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE ANON DENY");<br />
}<br />
function guildftpd_chpass($ftp_stream,$user,$pass){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE CHPASS $user $pass");<br />
}<br />
function guildftpd_disable($ftp_stream,$user){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE DISABLE $user");<br />
}<br />
function guildftpd_enable($ftp_stream,$user){<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE ENABLE $user");<br />
}<br />
function guildftpd_who($ftp_stream){<br />
&nbsp;&nbsp;&nbsp; $who = ftp_site($ftp_stream,"SITE WHO");<br />
}<br />
function guildftpd_kick($ftp_stream,$user);<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE KICK $user");<br />
}<br />
function guildftpd_msg($ftp_stream,$text);<br />
&nbsp;&nbsp;&nbsp; ftp_site($ftp_stream,"SITE MSG $text");<br />
}<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="27047""></a>
  <div class="note">
   <strong class="user">to at mail dot isec dot pt</strong>
   <a href="#27047" class="date">21-Nov-2002 05:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hya, <br />
&nbsp; Recently I had to work with FTP over PHP, since I didn't found any help about this topic I decided to post this here. If you need to chmod one file, I tested this on the ftp server using a ftp client and after I knew that the ftp server supported chmod I used the following commands:<br />
$upload = ftp_put($conn_id, "/home/to/public_html/index.php", $source_file, FTP_ASCII);<br />
$ch=@ftp_site($conn_id,"chmod 755 /home/to/public_html/index.php");<br />
<br />
Hope this help!<br />
<br />
T?</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="26907""></a>
  <div class="note">
   <strong class="user">daemorhedron</strong>
   <a href="#26907" class="date">17-Nov-2002 05:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I'd like to follow up with Ivan's observation there. Unless I am missing the obvious, which is entirely possible of course, this command is quite useless unless it returns the data from the SITE &lt;foo&gt; request.<br />
<br />
Besides the obvious SITE HELP command, another one that would require catching the feedback would be the SITE LOCATE | SITE SEARCH commands. I completely recognize that SITE &lt;foo&gt; commands are indeed insanely proprietary, but the fact still remains that changing this to return the results, or at least having the option to do so (such as exec() and the like) would be vastly preferred to the current method of returning true/false values.<br />
<br />
Thanks.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="13703""></a>
  <div class="note">
   
   <a href="#13703" class="date">29-Jun-2001 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
site commands are extra-functionality provided by some ftp servers, and depend on the server : 
<br />
e.g. trying "ftp&gt; site help" (with an interactive ftp client) on a proftp server would give :
<br />
&nbsp;
<br />
214-The following SITE extensions are recognized:
<br />
&nbsp;RATIO -- show all ratios in effect
<br />
&nbsp;The following SITE commands are recognized (* =&gt;'s unimplemented).
<br />
&nbsp;HELP&nbsp; &nbsp; CHMOD
<br />
214 Direct comments to admin@ftp.blahblah.fr
<br />

<br />
while with wu-ftpd on can typically get :
<br />

<br />
214-The following SITE commands are recognized (* =&gt;'s unimplemented).
<br />
&nbsp;&nbsp; UMASK&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; GROUP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; INDEX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; GROUPS
<br />
&nbsp;&nbsp; IDLE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GPASS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; EXEC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CHECKMETHOD
<br />
&nbsp;&nbsp; CHMOD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; NEWER&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ALIAS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; CHECKSUM
<br />
&nbsp;&nbsp; HELP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MINFO&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; CDPATH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
214 blabla
<br />

<br />
Unfortunately, ftp_site only returns true or false. It would be nice to have a way to get the server's reply in full : ftp_site('help') return 1, which pretty much useless.
<br />

<br />
Hope that helps,
<br />

<br />
Ivan</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
