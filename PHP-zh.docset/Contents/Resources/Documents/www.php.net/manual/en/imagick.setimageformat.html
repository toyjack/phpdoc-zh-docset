<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>为图片设置指定的格式</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="imagick.setimagefilename.html">? Imagick::setImageFilename</a></li>
      <li style="float: right;"><a href="imagick.setimagegamma.html">Imagick::setImageGamma ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.imagick.html">Imagick</a></li>
    <li>为图片设置指定的格式</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="imagick.setimageformat" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">Imagick::setImageFormat</h1>
  <p class="verinfo">(PECL imagick 2, PECL imagick 3)</p><p class="refpurpose"><span class="refname">Imagick::setImageFormat</span> &mdash; <span class="dc-title">为图片设置指定的格式</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-imagick.setimageformat-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>Imagick::setImageFormat</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$format</code></span>
   ) : <span class="type">bool</span></div>

  <p class="para rdfs-comment">
   为图片设置指定的格式
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-imagick.setimageformat-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">format</code></dt>

     <dd>

      <p class="para">
       表示图片格式的一个字符串。支持的格式依赖于 ImageMagick 的安装。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-imagick.setimageformat-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   成功时返回 <strong><code>true</code></strong>。
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="112572""></a>
  <div class="note">
   <strong class="user">layzee dot dk at gmail dot com</strong>
   <a href="#112572" class="date">01-Jul-2013 06:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This method only affects the individual loaded/constructed images.<br />
<br />
To set the format of the entire object, use the Imagick::setFormat method. E.g. load TIFF files, then use setFormat('pdf') on the Imagick object, then writeImagesFile('foo.pdf') or getImagesBlob().</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110815""></a>
  <div class="note">
   <strong class="user">markus dot s dot schmitz at gmail dot com</strong>
   <a href="#110815" class="date">11-Dec-2012 01:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use writeFile or writeFiles without setting the format, it is automatically set according to the file extension used within the parameter of writeFile.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99458""></a>
  <div class="note">
   <strong class="user">nathan at crause dot name</strong>
   <a href="#99458" class="date">18-Aug-2010 09:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those of you completely confused by the utter lack of documentation for this class (including notes being dropped, probably this one included), the differences between any "setXXX" and "setImageXXX" seems to be entirely dependently on HOW the image was loaded.<br />
<br />
If the image was loaded at object constructor time, it seems that you use "setXXX" - if you loaded it after the fact (such as via "readImageBlob") then you use "setImageXXX".<br />
<br />
This is irregular, however. For example:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $image </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setResolution</span><span class="keyword">(</span><span class="default">300</span><span class="keyword">, </span><span class="default">300</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">readImageBlob</span><span class="keyword">(...);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// convert the output to JPEG<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageFormat</span><span class="keyword">(</span><span class="string">'jpeg'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$image</span><span class="keyword">-&gt;</span><span class="default">setImageCompressionQuality</span><span class="keyword">(</span><span class="default">90</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
Note that we use "setResolution" not "setImageResolution".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89210""></a>
  <div class="note">
   <strong class="user">andy at live dot nl</strong>
   <a href="#89210" class="date">26-Feb-2009 06:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had a problem when using $im-&gt;setImageFormat('jpeg');
<br />
Image colors got inverted when i converted pdfs to jpg thumbs.
<br />
Had to add $im-&gt;setImageColorspace(255); to solve it.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">// read page 1
<br />
</span><span class="default">$im </span><span class="keyword">= new </span><span class="default">imagick</span><span class="keyword">( </span><span class="string">'test.pdf[ 0]' </span><span class="keyword">);
<br />

<br />
</span><span class="comment">// convert to jpg
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageColorspace</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">);
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setCompression</span><span class="keyword">(</span><span class="default">Imagick</span><span class="keyword">::</span><span class="default">COMPRESSION_JPEG</span><span class="keyword">);
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setCompressionQuality</span><span class="keyword">(</span><span class="default">60</span><span class="keyword">);
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageFormat</span><span class="keyword">(</span><span class="string">'jpeg'</span><span class="keyword">);
<br />

<br />
</span><span class="comment">//resize
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">resizeImage</span><span class="keyword">(</span><span class="default">290</span><span class="keyword">, </span><span class="default">375</span><span class="keyword">, </span><span class="default">imagick</span><span class="keyword">::</span><span class="default">FILTER_LANCZOS</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">);&nbsp; 
<br />

<br />
</span><span class="comment">//write image on server
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">writeImage</span><span class="keyword">(</span><span class="string">'thumb.jpg'</span><span class="keyword">);
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">clear</span><span class="keyword">();
<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">destroy</span><span class="keyword">();
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81765""></a>
  <div class="note">
   <strong class="user">barclay[dot]loftus[at]gmail.com</strong>
   <a href="#81765" class="date">12-Mar-2008 03:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another note about image output. For jpeg images, the quality is adjusted by Imagick::setCompressionQuality(). <br />
<br />
<span class="default">&lt;?php<br />
$img</span><span class="keyword">-&gt;</span><span class="default">setCompressionQuality</span><span class="keyword">(</span><span class="default">90</span><span class="keyword">);<br />
</span><span class="default">$img</span><span class="keyword">-&gt;</span><span class="default">setImageFormat</span><span class="keyword">(</span><span class="string">'jpeg'</span><span class="keyword">);<br />
</span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: image/jpg'</span><span class="keyword">);<br />
echo </span><span class="default">$img</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79343""></a>
  <div class="note">
   <strong class="user">optymizer at yahoo dot com</strong>
   <a href="#79343" class="date">21-Nov-2007 03:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The previous example did not work for me. I received an error that the IMagick object cannot be converted to string.<br />
<br />
This example uses the IMagick::getImageBlob() method to properly output the contents of the converted image:<br />
<br />
function getImage($filename)<br />
{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $image-&gt;readImage($filename);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $image-&gt;setImageFormat("png");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; header("Content-type: image/png");<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; echo $image-&gt;getImageBlob();<br />
}<br />
<br />
Hope this helps!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78350""></a>
  <div class="note">
   <strong class="user">Devo</strong>
   <a href="#78350" class="date">07-Oct-2007 08:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A list of formats can be found here: <a href="http://www.imagemagick.org/script/formats.php" rel="nofollow" target="_blank">http://www.imagemagick.org/script/formats.php</a><br />
<br />
Formats marked with a W can be output to file with writeImage (capabilities depend on your particular installation of course).<br />
<br />
For example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// create new imagick object from image.jpg<br />
</span><span class="default">$im </span><span class="keyword">= new </span><span class="default">Imagick</span><span class="keyword">( </span><span class="string">"image.jpg" </span><span class="keyword">);<br />
<br />
</span><span class="comment">// change format to png<br />
</span><span class="default">$im</span><span class="keyword">-&gt;</span><span class="default">setImageFormat</span><span class="keyword">( </span><span class="string">"png" </span><span class="keyword">);<br />
<br />
</span><span class="comment">// output the image to the browser as a png<br />
</span><span class="default">header</span><span class="keyword">( </span><span class="string">"Content-Type: image/png" </span><span class="keyword">);<br />
echo </span><span class="default">$im</span><span class="keyword">;<br />
<br />
</span><span class="comment">// or you could output the image to a file:<br />
//$im-&gt;writeImage( "image.png" );<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
