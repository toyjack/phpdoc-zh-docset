<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Windows 系统下的安装</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="install.macosx.compile.html">? 在 macOS 下编译 PHP</a></li>
      <li style="float: right;"><a href="install.windows.requirements.html">环境要求 ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="install.html">安装与配置</a></li>
    <li>Windows 系统下的安装</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="install.windows" class="chapter">
 <h1>Windows 系统下的安装</h1>
<h2>Table of Contents</h2><ul class="chunklist chunklist_chapter"><li><a href="install.windows.requirements.html">环境要求</a></li><li><a href="install.windows.pecl.html">PECL</a></li><li><a href="install.windows.tools.html">Windows 下的 PHP 安装程序工具</a></li><li><a href="install.windows.recommended.html">Windows 系统下的推荐配置</a></li><li><a href="install.windows.manual.html">在 Windows 上手动安装 PHP</a></li><li><a href="install.windows.troubleshooting.html">Windows 下 PHP 故障排除</a></li><li><a href="install.windows.legacy.index.html">旧版本 Windows 支持</a></li></ul>

  <p class="para">
    在微软 Windows 系统上安装 PHP，并推荐使用常见的 Web 服务器进行配置。
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
    <p class="para">
      如果您正在寻找有关旧系统的信息，如 Windows XP、2003、98 或 Apache 1.x，请参阅 <a href="install.windows.legacy.index.html" class="link">旧版本 Windows 支持</a> 章节。
    </p>
  </p></blockquote>

  <p class="para">
    PHP 在 Windows 上的官方版本被推荐用于生产环境。如果有需要，你也可以从源码中构建 PHP。你需要一个 Visual Studio 环境。请参阅
    <a href="https://wiki.php.net/internals/windows/stepbystepbuild" class="link external" title="Link : https://wiki.php.net/internals/windows/stepbystepbuild">&raquo;&nbsp;从源码构建</a> 章节。
  </p>
  <p class="para">
    <ul class="itemizedlist">
      <li class="listitem">
        <p class="para">
          <a href="install.windows.legacy.index.html#install.windows.legacy.commandline" class="link">在 Windows 命令行使用 PHP</a>
        </p>
      </li>
      <li class="listitem">
        <p class="para">
          <a href="install.cloud.azure.html" class="link">在 Azure 上安装 PHP 服务</a> (又称 Microsoft Azure、Windows Azure 或 (Windows) Azure Web Apps)。
        </p>
      </li>
    </ul>
  </p>

  

  
 
  
  






  






  





  






  


  



</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="93607""></a>
  <div class="note">
   <strong class="user">bufoni at hotmail dot com</strong>
   <a href="#93607" class="date">17-Sep-2009 07:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Oh Man!<br />
<br />
I installed by Microsoft Installer, manually, whatever I always received de same error from IIS7.<br />
<br />
HTTP Error 404.3 - Not Found<br />
The page you are requesting cannot be served because of the extension configuration. If the page is a script, add a handler. If the file should be downloaded, add a MIME map.<br />
<br />
The IIS7 interface is quite diferent and are not all together like IIS6<br />
<br />
The 5.3 version have not any of those files: php5stdll, php5isapi.dll. etc.<br />
<br />
The installer puts others files in handlers and I decided to use them as substitutes. Nothing done!<br />
<br />
After that, I discovered that installer do not install these files within the sites, but in the root default site configuration of IIS7.<br />
<br />
So, I copied the root configuration to my site and them it worked (all others procedures were done e.g. copy php.ini to windows folder)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="90936""></a>
  <div class="note">
   <strong class="user">dpharshman at dslextreme dot com</strong>
   <a href="#90936" class="date">16-May-2009 05:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
PHP 5.2.9.2 Install on XP Pro IIS 5.1 - phpinfo( ) results incorrect<br />
<br />
Testing Date:&nbsp; 05.15.09<br />
<br />
Background:<br />
For several days now I, as a newbie, have been unsure if I had installed PHP correctly, or not.&nbsp; No matter what I did phpinfo( ) reported "Configuratin File Path" as:&nbsp; "C:\WINDOWS".&nbsp; I was left to wonder what was wrong.<br />
<br />
To help resolve the phpinfo() "issue", I conducted a series of tests using two scripts:<br />
<br />
The first is "test-php-ini-loaded.php"; it is stored in c:\inetpub\wwwroot, and has the following code:<br />
<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; $inipath </span><span class="keyword">= </span><span class="default">php_ini_loaded_file</span><span class="keyword">();<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$inipath</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'Loaded php.ini: ' </span><span class="keyword">. </span><span class="default">$inipath</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'A php.ini file is not loaded'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">?&gt;<br />
</span><br />
The second script is simply calls phpinfo( ).&nbsp; It is named test.php, is stored in "c:\inetpub\wwroot",&nbsp; and has the following code:<br />
<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php phpinfo</span><span class="keyword">( ); </span><span class="default">?&gt;<br />
</span><br />
My Dev Environment:<br />
1. Windows XP Pro SP3<br />
2. IIS 5.1 / MMC 3.0<br />
3. PHP 5.2.9.2 - phpMyAdmin not yet installed<br />
4. (plus MySQL 5.1, etc.)<br />
5. Install location is on my local E: drive<br />
<br />
The Tests:<br />
<br />
Test 1:<br />
a. PHPRC environment variable and IniFilePath Registry left in place and active<br />
b. Verified no other copies of php.ini exist on the system other than in my E:\PHP folder<br />
c. Renamed php.ini to hold-php.ini<br />
d. Stopped and started IIS ("net stop iisadmin" and "net start w3svc")<br />
e. Ran "test-php-ini-loaded.php" to check whether my php.ini is loaded.&nbsp; It is not.<br />
f. Ran "test.php".&nbsp; "Loaded Configuration File" was empty, while "Configuration File (php.ini) Path" showed:&nbsp; C:\WINDOWS.<br />
<br />
Test 2:<br />
a. Moved php.ini from E:\PHP to C:\WINDOWS<br />
b. Stopped and started IIS<br />
c. Ran "test-php-ini-loaded.php" to check if my php.ini is loaded.&nbsp; It is not, which surprised me.<br />
d. Ran "test.php".&nbsp; My php.ini is apparently not loaded, or found, by phpinfo( ), even though "Configuration File (php.ini) Path" reports it as being in C:\WINDOWS.<br />
e. Note:&nbsp; Per PHP's "The configuration file" note, PHP's search order includes:&nbsp; "Windows directory (C:\windows or C:\winnt) (for Windows), ..."; but it apparently doesn't or php.ini would have been found and displayed at "Loaded Configuration File".<br />
<br />
Test 3:<br />
a. Left the solo copy of my php.ini in C:\WINDOWS<br />
b. Disabled PHPRC environment variable by renaming it to "Ex-PHPRC and saving the settings (note: for this test&nbsp; I left the Registry entry for PHP IniFilePath intact)<br />
c. Stopped and started IIS<br />
d. Ran "test-php-ini-loaded.php" to check whether my php.ini is loaded.&nbsp; Predictably it is not found.<br />
e. Ran the "test.php".&nbsp; Again, my php.ini file is reported as not found in C:\WINDOWS though "Configuration File (php.ini) Path" reports it as being there.<br />
<br />
Test 4:<br />
a. To be thorough and eliminate all possible sources of "mis-direction" I deleted the PHP IniFilePath Registry entry (after backing up the Registry).&nbsp; The PHPRC environment variable was left disabled.&nbsp; <br />
b. Stopped and started IIS<br />
c. Ran "test-php-ini-loaded.php" to check whether my php.ini is loaded.&nbsp; Predictably it is not.<br />
d. Ran "test.php".&nbsp; Again, no change.&nbsp; My php.ini file is not found "Configuration File (php.ini) Path" reports it as being there.<br />
<br />
Conclusions:<br />
The first conclusion I came to is that, in the default download version of phpinfo( ), "Configuration File (php.ini) Path" is hard-wired to report C:\WINDOWS whether php.ini is there or not.&nbsp; Further, that C:\WINDOWS is not a default search location (at least not on XP).&nbsp; <br />
<br />
However, given an otherwise "proper" setup, phpinfo() reporting C:\WINDOWS as the value for "Configuration File (php.ini) Path" is merely misleading and is not actually harmful or indicative of a failed installation. <br />
<br />
Thanks go to Peter Guy of www.peterguy.com who suggested the testing, and to Daniel Brown of www.php.net for some initial guidance.<br />
<br />
P.S.&nbsp; This note is not meant to take anything away from PHP.&nbsp; It is a fine tool.&nbsp; The sole purpose of the testing was to confirm that my installation of PHP was correct.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80001""></a>
  <div class="note">
   <strong class="user">smileclick at hotmail dot com</strong>
   <a href="#80001" class="date">23-Dec-2007 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Still Can't Run PHP Code?<br />
<br />
After installing php-5.2.5-win32-installer.msi on my Windows XP2. with IIS5.1 it still didn't run PHP files.<br />
<br />
I eventually found the fix*:<br />
<br />
1. Goto Control Panel&gt;System&gt;Advanced&gt;Environmental Variables<br />
2. Add a New System Variable "PHRC" and set its path as "C:\Program Files\PHP"<br />
3. Restart<br />
<br />
*source: <br />
<a href="http://us2.php.net/manual/en/faq.installation.php" rel="nofollow" target="_blank">http://us2.php.net/manual/en/faq.installation.php</a><br />
#faq.installation.addtopath</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79809""></a>
  <div class="note">
   <strong class="user">robert dot johnson at icap dot com</strong>
   <a href="#79809" class="date">13-Dec-2007 07:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
IIS setup: 403 forbidden error.&nbsp; <br />
<br />
We had installed two separate different PHP versions - PHP 5.1.4 followed by 5.2.5.<br />
<br />
We configured 5.2.5 php5isapi.dll to be loaded as the .php file type extension.<br />
<br />
Despite this, php version 5.1.4 was being loaded.&nbsp; We renamed 5.1.4's folder and then PHP was not loading at all.<br />
<br />
There were no visible references to 5.1.4 in the IIS configuration, but in the file \webConfig.xml, there was a reference to 5.1.4's isapi under IISFilters.<br />
<br />
To fix this problem, we added version 5.2.5's php5isapi.dll to the ISAPI Filter category for the web site, in the IIS control panel.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77680""></a>
  <div class="note">
   <strong class="user">Jack Hardie</strong>
   <a href="#77680" class="date">08-Sep-2007 02:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are installing PHP on Vista just go to David Wang's blog. <a href="http://blogs.msdn.com/david.wang/" rel="nofollow" target="_blank">http://blogs.msdn.com/david.wang/</a><br />
archive/2006/06/21/HOWTO-Install-and-Run-PHP-on-IIS7-Part-2.aspx<br />
&nbsp;<br />
Magic!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71027""></a>
  <div class="note">
   <strong class="user">jneill at gamedaytv dot com</strong>
   <a href="#71027" class="date">08-Nov-2006 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's how to run dual PHP instances with PHP 5.2 and any previous PHP on Windows 2003:<br />
<br />
1. Right-click My Computer, go to Advanced tab, and click on Environment Variables.<br />
<br />
Add the two installations and their EXT directories to the Path variable. For example, add:<br />
c:\php;c:\php\ext;c:\TMAS\php;c:\tmas\php\ext;<br />
<br />
Then, add the newer PHP version's directory as a variable called PHPRC. For example:<br />
Variable:PHPRC<br />
Value: C:\PHP<br />
<br />
Click OK to close the Environment Variables window, and click OK to close System Properties.<br />
<br />
2. In registry, under HKEY_LOCAL_MACHINE&gt;SOFTWARE&gt;PHP, add a REG_SZ key called iniFilePath and give it a value<br />
of the directory where the older PHP is installed. For example:<br />
C:\TMAS\PHP<br />
<br />
3. In IIS, go to the Web Service Extensions. Add both versions' ISAPI module separately to the extensions<br />
list, and allow both.<br />
<br />
4. In IIS, go to each website utilizing the PHP versions. Set an ISAPI filter if needed. On the Home Directory<br />
tab, click Configuration, and add .php, .php3, .phtml, and any other extensions needed (perhaps .html?) to<br />
be filtered through PHP, and specify the ISAPI module version needed for each website.<br />
<br />
You can now run two versions of PHP. This is because the order of where to look for the .ini file changed<br />
between previous PHP versions and PHP 5.2, as documented at <a href="http://us2.php.net/ini:" rel="nofollow" target="_blank">http://us2.php.net/ini:</a><br />
<br />
---------------------------------------------------<br />
&nbsp;php.ini is searched in these locations (in order):<br />
<br />
&nbsp;&nbsp;&nbsp; * SAPI module specific location (PHPIniDir directive in Apache 2, -c command line option in CGI and CLI, php_ini parameter in NSAPI, PHP_INI_PATH environment variable in THTTPD)<br />
&nbsp;&nbsp;&nbsp; * The PHPRC environment variable. Before PHP 5.2.0 this was checked after the registry key mentioned below.<br />
&nbsp;&nbsp;&nbsp; * HKEY_LOCAL_MACHINE\SOFTWARE\PHP\IniFilePath (Windows Registry location)<br />
&nbsp;&nbsp;&nbsp; * Current working directory (for CLI)<br />
&nbsp;&nbsp;&nbsp; * The web server's directory (for SAPI modules), or directory of PHP (otherwise in Windows)<br />
&nbsp;&nbsp;&nbsp; * Windows directory (C:\windows or C:\winnt) (for Windows), or --with-config-file-path compile time option <br />
----------------------------------------------------</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71006""></a>
  <div class="note">
   <strong class="user">webmaster at nachelfamily dot com</strong>
   <a href="#71006" class="date">07-Nov-2006 05:13</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I made the mistake of setting a 'wildcard application map' for PHP on a Windows 2003 / IIS 6.0 / PHP ISAPI installation.&nbsp; <br />
<br />
This resulted in "No input file specified" errors whenever I tried to load the default page in my site's directories.&nbsp; I don't know why this broke things, but it did.<br />
<br />
If anyone has the same problem, this may be the cause.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="64754""></a>
  <div class="note">
   <strong class="user">SmugWimp at smugwimp dot com</strong>
   <a href="#64754" class="date">20-Apr-2006 02:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you make changes to your PHP.ini file, consider the following.
<br />

<br />
(I'm running IIS5 on W2K server. I don't know about 2K3)
<br />

<br />
PHP will not "take" the changes until the webserver is restarted, and that doesn't mean through the MMC.&nbsp; Usually folks just reboot. But you can also use the following commands, for a much faster "turnaround".&nbsp; At a command line prompt, type:
<br />

<br />
iisreset /stop
<br />

<br />
and that will stop the webserver service.&nbsp; Then type:
<br />

<br />
net start w3svc
<br />

<br />
and that will start the webserver service again.&nbsp; MUCH faster than a reboot, and you can check your changes faster as a result with the old:
<br />

<br />
&lt;?php&gt;
<br />
phpinfo();
<br />
?&gt;
<br />

<br />
in your page somewhere.
<br />

<br />
I wish I could remember where I read this tip; it isn't anything I came up with...</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63937""></a>
  <div class="note">
   <strong class="user">ratkinson at tbs-ltd dot co dot uk</strong>
   <a href="#63937" class="date">04-Apr-2006 05:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When installing onto the Windows IIS platform, ensure you add the PHPRC Server Variable to point to your PHP.INI file.<br />
<br />
Also, add '.INI' to the FILEEXT Server Variable. Failure to add these could stop the PHP engine being able to find your PHP.INI file, and none of your modifications will be read.<br />
<br />
Rob.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60737""></a>
  <div class="note">
   <strong class="user">lukasz at szostak dot biz</strong>
   <a href="#60737" class="date">15-Jan-2006 07:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
You can have multiple versions of PHP running on the same Apache server. I have seen many different solutions pointing at achieving this, but most of them required installing additional instances of Apache, redirecting ports/hosts, etc., which was not satisfying for me.<br />
Finally, I have come up with the simplest solution I've seen so far, limited to reconfiguring Apache's httpd.conf.<br />
<br />
My goal is to have PHP5 as the default scripting language for .php files in my DocumentRoot (which is in my case d:/htdocs), and PHP4 for specified DocumentRoot subdirectories.<br />
<br />
Here it is (Apache's httpd.conf contents):<br />
<br />
---------------------------<br />
# replace with your PHP4 directory<br />
ScriptAlias /php4/ "c:/usr/php4/"<br />
# replace with your PHP5 directory<br />
ScriptAlias /php5/ "c:/usr/php5/"<br />
<br />
AddType application/x-httpd-php .php<br />
Action application/x-httpd-php "/php5/php-cgi.exe"<br />
<br />
# populate this for every directory with PHP4 code<br />
&lt;Directory "d:/htdocs/some_subdir"&gt;<br />
&nbsp;&nbsp;&nbsp; Action application/x-httpd-php "/php4/php.exe"<br />
&nbsp;&nbsp;&nbsp; # directory where your PHP4 php.ini file is located at<br />
&nbsp;&nbsp;&nbsp; SetEnv PHPRC "c:/usr/php4"<br />
&lt;/Directory&gt;<br />
<br />
# remember to put this section below the above<br />
&lt;Directory "d:/htdocs"&gt;<br />
&nbsp;&nbsp;&nbsp; # directory where your PHP5 php.ini file is located at<br />
&nbsp;&nbsp;&nbsp; SetEnv PHPRC "c:/usr/php5"<br />
&lt;/Directory&gt;<br />
---------------------------<br />
<br />
This solution is not limited to having only two parallel versions of PHP. You can play with httpd.conf contents to have as many PHP versions configured as you want.<br />
You can also use multiple php.ini configuration files for the same PHP version (but for different DocumentRoot subfolders), which might be useful in some cases.<br />
<br />
Remember to put your php.ini files in directories specified in lines "SetEnv PHPRC...", and make sure that there's no php.ini files in other directories (such as c:\windows in Windows).<br />
<br />
And finally, as you can see, I run PHP in CGI mode. This has its advantages and limitations. If you have to run PHP as Apache module, then... sorry - you have to use other solution (the best advice as always is: Google it!).<br />
<br />
Hope this helps someone.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="55049""></a>
  <div class="note">
   <strong class="user">jp at iticonsulting dot nl</strong>
   <a href="#55049" class="date">23-Jul-2005 09:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get 404 page not found on Windows/IIS5, have a look at C:\SYSTEM32\INETSRV\URLSCAN<br />
<br />
There is a .ini file there that prevents some files from being served by IIS, even if they exist, instead IIS will give a 404. The urlscan logfile (same place) should give you some insight into what parameter is preventing a page from loading, if any.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53646""></a>
  <div class="note">
   <strong class="user">Feroz Zahid</strong>
   <a href="#53646" class="date">08-Jun-2005 01:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In order to run php scripts with php.exe CGI instead of php4isapi.dll under IIS, following steps can be followed.<br />
<br />
i) Add a web service extension for PHP using IIS manager. Choose a web service extension name like 'PHP' and add your php.exe path in the 'file location' while adding the required file e.g. 'C:\php\php.exe' in the Add extension dialog box. Don't forget to 'Allow' the extension file.<br />
<br />
ii) Open php.ini file located at %systemroot%. Set the following variables to the shown values.<br />
<br />
cgi.force_redirect = 0<br />
cgi.redirect_status_env = ENV_VAR_NAME<br />
<br />
iii) In your websites, add Application Mapping for '.php' and set the executable path to your php.exe file path. <br />
<br />
You can test whether PHP is running or not and other PHP settings using the following simple PHP script.<br />
<br />
&lt;?php&gt;<br />
phpinfo();<br />
?&gt;<br />
<br />
Feroz Zahid<br />
ferozzahid [_at_] usa [_dot_] [_com_]</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
