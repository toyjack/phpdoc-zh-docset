<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>转换字符的编码</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.mb-convert-case.html">? mb_convert_case</a></li>
      <li style="float: right;"><a href="function.mb-convert-kana.html">mb_convert_kana ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.mbstring.html">多字节字符串 函数</a></li>
    <li>转换字符的编码</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.mb-convert-encoding" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mb_convert_encoding</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.6, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mb_convert_encoding</span> &mdash; <span class="dc-title">转换字符的编码</span></p>

 </div>
   
 <div class="refsect1 description" id="refsect1-function.mb-convert-encoding-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mb_convert_encoding</strong></span>(<span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">string</span></span> <code class="parameter">$string</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$to_encoding</code></span>, <span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">string</span>|<span class="type">null</span></span> <code class="parameter">$from_encoding</code><span class="initializer"> = <strong><code>null</code></strong></span></span>): <span class="type"><span class="type">array</span>|<span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   将 <span class="type">string</span> 类型 <code class="parameter">str</code> 的字符编码从可选的 <code class="parameter">from_encoding</code> 转换到 <code class="parameter">to_encoding</code>。
   当参数 <code class="parameter">string</code> 是一个 <span class="type">array</span> 时，将递归转换它所有的 <span class="type">string</span> 值。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mb-convert-encoding-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       要编码的 <span class="type">string</span> 或 <span class="type">array</span>。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">to_encoding</code></dt>

     <dd>

      <p class="para">
       <code class="parameter">string</code> 要转换成的编码类型。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">from_encoding</code></dt>

     <dd>

      <p class="para">
       在转换前通过字符代码名称来指定。它可以是一个 <span class="type">array</span> 也可以是逗号分隔的枚举列表。
       如果没有提供 <code class="parameter">from_encoding</code>，则会使用内部（internal）编码。
       
      </p>
      <p class="para">
      参见<a href="mbstring.supported-encodings.html" class="link">支持的编码</a>。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.mb-convert-encoding-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   编码后的 <span class="type">string</span>。
   成功时返回编码后的 <span class="type">string</span> 或 <span class="type">array</span>， 或者在失败时返回 <strong><code>false</code></strong>。
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.mb-convert-encoding-errors">
  <h3 class="title">错误／异常</h3>
  <p class="para">
   当 <code class="parameter">to_encoding</code> 或 <code class="parameter">from_encoding</code> 为无效的编码时，
   PHP 8.0.0 起将抛出 <span class="classname"><a href="class.valueerror.html" class="classname">ValueError</a></span>；
   而在 PHP 8.0.0 之前的版本里，会产生一个 <strong><code>E_WARNING</code></strong>。
  </p>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.mb-convert-encoding-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>8.0.0</td>
      <td>
       现在，当 <code class="parameter">to_encoding</code> 为无效编码时，
       <span class="function"><strong>mb_convert_encoding()</strong></span> 会抛出 <span class="classname"><a href="class.valueerror.html" class="classname">ValueError</a></span>。
      </td>
     </tr>

     <tr>
      <td>8.0.0</td>
      <td>
       现在，当 <code class="parameter">from_encoding</code> 为无效编码时，
       <span class="function"><strong>mb_convert_encoding()</strong></span> 会抛出 <span class="classname"><a href="class.valueerror.html" class="classname">ValueError</a></span>。
      </td>
     </tr>

     <tr>
      <td>8.0.0</td>
      <td>
       现在 <code class="parameter">from_encoding</code> 可以传入 null。
      </td>
     </tr>

     <tr>
      <td>7.2.0</td>
      <td>
       现在该函数的 <code class="parameter">string</code> 参数同时能接受 <span class="type">array</span> 类型。
       在此之前，仅支持 <span class="type">string</span>。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.mb-convert-encoding-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-2492">
    <p><strong>Example #1 <span class="function"><strong>mb_convert_encoding()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;转换内部编码为&nbsp;SJIS&nbsp;*/<br /></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mb_convert_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"SJIS"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;将&nbsp;EUC-JP&nbsp;转换成&nbsp;UTF-7&nbsp;*/<br /></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mb_convert_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"UTF-7"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"EUC-JP"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;从&nbsp;JIS,&nbsp;eucjp-win,&nbsp;sjis-win&nbsp;中自动检测编码，并转换&nbsp;str&nbsp;到&nbsp;UCS-2LE&nbsp;*/<br /></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mb_convert_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"UCS-2LE"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"JIS,&nbsp;eucjp-win,&nbsp;sjis-win"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;"auto"&nbsp;扩展成&nbsp;"ASCII,JIS,UTF-8,EUC-JP,SJIS"&nbsp;*/<br /></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mb_convert_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"EUC-JP"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"auto"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

  
 <div class="refsect1 seealso" id="refsect1-function.mb-convert-encoding-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mb-detect-order.html" class="function" rel="rdfs-seeAlso">mb_detect_order()</a> - 设置/获取 字符编码的检测顺序</span></li>
   </ul>
  </p>
 </div>

 
</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="122952""></a>
  <div class="note">
   <strong class="user">vasiliauskas dot agnius at gmail dot com</strong>
   <a href="#122952" class="date">17-Jul-2018 08:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you need to convert from HTML-ENTITIES, but your UTF-8 string is partially broken (not all chars in UTF-8) - in this case passing string to mb_convert_encoding($string, 'UTF-8', 'HTML-ENTITIES'); - corrupts chars in string even more. In this case you need to replace html entities gradually to preserve character good encoding. I wrote such closure for this job :<br />
<span class="default">&lt;?php<br />
$decode_entities </span><span class="keyword">= function(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">"/&amp;#?\w+;/"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$entities</span><span class="keyword">, </span><span class="default">PREG_SET_ORDER</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$entities </span><span class="keyword">= </span><span class="default">array_unique</span><span class="keyword">(</span><span class="default">array_column</span><span class="keyword">(</span><span class="default">$entities</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$entities </span><span class="keyword">as </span><span class="default">$entity</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$decoded </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$entity</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'HTML-ENTITIES'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$entity</span><span class="keyword">, </span><span class="default">$decoded</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; };<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118560""></a>
  <div class="note">
   <strong class="user">nicole</strong>
   <a href="#118560" class="date">28-Dec-2015 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// convert UTF8 to DOS = CP850 <br />
//<br />
// $utf8_text=UTF8-Formatted text;<br />
// $dos=CP850-Formatted text;<br />
<br />
// have fun<br />
<br />
$dos = mb_convert_encoding($utf8_text, "CP850", mb_detect_encoding($utf8_text, "UTF-8, CP850, ISO-8859-15", true));</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118324""></a>
  <div class="note">
   <strong class="user">Daniel</strong>
   <a href="#118324" class="date">17-Nov-2015 04:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are attempting to convert "UTF-8" text to "ISO-8859-1" and the result is always returning in "ASCII", place the following line of code before the mb_convert_encoding:<br />
<br />
mb_detect_order(array('UTF-8', 'ISO-8859-1'));<br />
<br />
It is necessary to force a specific search order for the conversion to work</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115406""></a>
  <div class="note">
   <strong class="user">jackycms at outlook dot com</strong>
   <a href="#115406" class="date">19-Jul-2014 02:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
// mb_convert_encoding($input,'UTF-8','windows-874');&nbsp; error : Illegal character encoding specified<br />
// so convert Thai to UTF-8 is better use iconv instead<br />
<br />
<span class="default">&lt;?php<br />
<br />
iconv</span><span class="keyword">(</span><span class="string">"windows-874"</span><span class="keyword">,</span><span class="string">"UTF-8"</span><span class="keyword">,</span><span class="default">$input</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114549""></a>
  <div class="note">
   <strong class="user">DanielAbbey at Hotmail dot co dot uk</strong>
   <a href="#114549" class="date">05-Mar-2014 04:30</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When using the Windows Notepad text editor, it is important to note that when you select 'Save As' there is an Encoding selection dropdown. The default encoding is set to ANSI, with the other two options being Unicode and UTF-8. Since most text on the web is in UTF-8 format it could prove vital to save the .txt file with this encoding, since this function does not work on ANSI-encoded text.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112547""></a>
  <div class="note">
   <strong class="user">josip at cubrad dot com</strong>
   <a href="#112547" class="date">27-Jun-2013 11:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For my last project I needed to convert several CSV files from Windows-1250 to UTF-8, and after several days of searching around I found a function that is partially solved my problem, but it still has not transformed all the characters. So I made ??this:<br />
<br />
function w1250_to_utf8($text) {<br />
&nbsp;&nbsp;&nbsp; // map based on:<br />
&nbsp;&nbsp;&nbsp; // <a href="http://konfiguracja.c0.pl/iso02vscp1250en.html" rel="nofollow" target="_blank">http://konfiguracja.c0.pl/iso02vscp1250en.html</a><br />
&nbsp;&nbsp;&nbsp; // <a href="http://konfiguracja.c0.pl/webpl/index_en.html#examp" rel="nofollow" target="_blank">http://konfiguracja.c0.pl/webpl/index_en.html#examp</a><br />
&nbsp;&nbsp;&nbsp; // <a href="http://www.htmlentities.com/html/entities/" rel="nofollow" target="_blank">http://www.htmlentities.com/html/entities/</a><br />
&nbsp;&nbsp;&nbsp; $map = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x8A) =&gt; chr(0xA9),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x8C) =&gt; chr(0xA6),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x8D) =&gt; chr(0xAB),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x8E) =&gt; chr(0xAE),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x8F) =&gt; chr(0xAC),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x9C) =&gt; chr(0xB6),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x9D) =&gt; chr(0xBB),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xA1) =&gt; chr(0xB7),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xA5) =&gt; chr(0xA1),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xBC) =&gt; chr(0xA5),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x9F) =&gt; chr(0xBC),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xB9) =&gt; chr(0xB1),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x9A) =&gt; chr(0xB9),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xBE) =&gt; chr(0xB5),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x9E) =&gt; chr(0xBE),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x80) =&gt; '&amp;euro;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x82) =&gt; '&amp;sbquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x84) =&gt; '&amp;bdquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x85) =&gt; '&amp;hellip;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x86) =&gt; '&amp;dagger;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x87) =&gt; '&amp;Dagger;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x89) =&gt; '&amp;permil;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x8B) =&gt; '&amp;lsaquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x91) =&gt; '&amp;lsquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x92) =&gt; '&amp;rsquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x93) =&gt; '&amp;ldquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x94) =&gt; '&amp;rdquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x95) =&gt; '&amp;bull;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x96) =&gt; '&amp;ndash;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x97) =&gt; '&amp;mdash;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x99) =&gt; '&amp;trade;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0x9B) =&gt; '&amp;rsquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xA6) =&gt; '&amp;brvbar;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xA9) =&gt; '&amp;copy;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xAB) =&gt; '&amp;laquo;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xAE) =&gt; '&amp;reg;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xB1) =&gt; '&amp;plusmn;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xB5) =&gt; '&amp;micro;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xB6) =&gt; '&amp;para;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xB7) =&gt; '&amp;middot;',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; chr(0xBB) =&gt; '&amp;raquo;',<br />
&nbsp;&nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; return html_entity_decode(mb_convert_encoding(strtr($text, $map), 'UTF-8', 'ISO-8859-2'), ENT_QUOTES, 'UTF-8');<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="110010""></a>
  <div class="note">
   <strong class="user">urko at wegetit dot eu</strong>
   <a href="#110010" class="date">11-Sep-2012 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are trying to generate a CSV (with extended chars) to be opened at Exel for Mac, the only that worked for me was:
<br />
<span class="default">&lt;?php mb_convert_encoding</span><span class="keyword">( </span><span class="default">$CSV</span><span class="keyword">, </span><span class="string">'Windows-1252'</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
I also tried this:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">//Separado OK, chars MAL
<br />
</span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'MACINTOSH'</span><span class="keyword">, </span><span class="string">'UTF8'</span><span class="keyword">, </span><span class="default">$CSV</span><span class="keyword">);
<br />
</span><span class="comment">//Separado MAL, chars OK
<br />
</span><span class="default">chr</span><span class="keyword">(</span><span class="default">255</span><span class="keyword">).</span><span class="default">chr</span><span class="keyword">(</span><span class="default">254</span><span class="keyword">).</span><span class="default">mb_convert_encoding</span><span class="keyword">( </span><span class="default">$CSV</span><span class="keyword">, </span><span class="string">'UCS-2LE'</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
But the first one didn't show extended chars correctly, and the second one, did't separe fields correctly</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106404""></a>
  <div class="note">
   <strong class="user">qdb at kukmara dot ru</strong>
   <a href="#106404" class="date">07-Nov-2011 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
mb_substr and probably several other functions works faster in ucs-2 than in utf-8. and utf-16 works slower than utf-8. here is test, ucs-2 is near 50 times faster than utf-8, and utf-16 is near 6 times slower than utf-8 here:<br />
<span class="default">&lt;?php<br />
header</span><span class="keyword">(</span><span class="string">'Content-Type: text/html; CHARSET=gb2312'</span><span class="keyword">);<br />
</span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="string">'utf-8'</span><span class="keyword">);<br />
<br />
</span><span class="default">$s</span><span class="keyword">=</span><span class="string">'укгез??ш?хз?х?шк2049??лдябчсячмииюсит.июб?рарэ'<br />
</span><span class="keyword">.</span><span class="string">'лдэфв??у?й?уй??у034928348539857?шаыдларораш??рлоавы'</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">.=</span><span class="default">$s</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">.=</span><span class="default">$s</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">.=</span><span class="default">$s</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">.=</span><span class="default">$s</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">.=</span><span class="default">$s</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">.=</span><span class="default">$s</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">.=</span><span class="default">$s</span><span class="keyword">;<br />
<br />
</span><span class="default">$t1</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
while(</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">=</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">+=</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$i</span><span class="keyword">==</span><span class="default">10</span><span class="keyword">)echo</span><span class="default">$a</span><span class="keyword">.</span><span class="string">'. '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo$a.'. ';<br />
</span><span class="keyword">}<br />
echo</span><span class="default">$i</span><span class="keyword">.</span><span class="string">'. '</span><span class="keyword">;<br />
echo(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)-</span><span class="default">$t1</span><span class="keyword">);<br />
<br />
echo</span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">=</span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="string">'UCS-2'</span><span class="keyword">,</span><span class="string">'utf8'</span><span class="keyword">);<br />
</span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="string">'UCS-2'</span><span class="keyword">);<br />
</span><span class="default">$t1</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
while(</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">=</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">+=</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$i</span><span class="keyword">==</span><span class="default">10</span><span class="keyword">)echo </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="string">'utf8'</span><span class="keyword">,</span><span class="string">'ucs2'</span><span class="keyword">).</span><span class="string">'. '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo$a.'. ';<br />
</span><span class="keyword">}<br />
echo</span><span class="default">$i</span><span class="keyword">.</span><span class="string">'. '</span><span class="keyword">;<br />
echo(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)-</span><span class="default">$t1</span><span class="keyword">);<br />
<br />
echo</span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
</span><span class="default">$s</span><span class="keyword">=</span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="string">'utf-16'</span><span class="keyword">,</span><span class="string">'ucs-2'</span><span class="keyword">);<br />
</span><span class="default">mb_internal_encoding</span><span class="keyword">(</span><span class="string">'utf-16'</span><span class="keyword">);<br />
</span><span class="default">$t1</span><span class="keyword">=</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
while(</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a</span><span class="keyword">=</span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">+=</span><span class="default">2</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$i</span><span class="keyword">==</span><span class="default">10</span><span class="keyword">)echo </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="string">'utf8'</span><span class="keyword">,</span><span class="string">'utf-16'</span><span class="keyword">).</span><span class="string">'. '</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//echo$a.'. ';<br />
</span><span class="keyword">}<br />
echo</span><span class="default">$i</span><span class="keyword">.</span><span class="string">'. '</span><span class="keyword">;<br />
echo(</span><span class="default">microtime</span><span class="keyword">(</span><span class="default">true</span><span class="keyword">)-</span><span class="default">$t1</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span>output:<br />
?х. 12416. 1.71738100052<br />
?х. 12416. 0.0211279392242<br />
?х. 12416. 11.2330229282</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99571""></a>
  <div class="note">
   <strong class="user">gullevek at gullevek dot org</strong>
   <a href="#99571" class="date">25-Aug-2010 12:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want to convert japanese to ISO-2022-JP it is highly recommended to use ISO-2022-JP-MS as the target encoding instead. This includes the extended character set and avoids ? in the text. For example the often used "1 in a circle" ① will be correctly converted then.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="97902""></a>
  <div class="note">
   <strong class="user">regrunge at hotmail dot it</strong>
   <a href="#97902" class="date">14-May-2010 08:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've been trying to find the charset of a norwegian (with a lot of ?, ?, ?) txt file written on a Mac, i've found it in this way:
<br />

<br />
<span class="default">&lt;?php
<br />
$text </span><span class="keyword">= </span><span class="string">"A strange string to pass, maybe with some ?, ?, ? characters."</span><span class="keyword">;
<br />

<br />
foreach(</span><span class="default">mb_list_encodings</span><span class="keyword">() as </span><span class="default">$chr</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="default">$chr</span><span class="keyword">).</span><span class="string">" : "</span><span class="keyword">.</span><span class="default">$chr</span><span class="keyword">.</span><span class="string">"&lt;br&gt;"</span><span class="keyword">;&nbsp; &nbsp; 
<br />
&nbsp;} 
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
The line that looks good, gives you the encoding it was written in.
<br />

<br />
Hope can help someone</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92426""></a>
  <div class="note">
   <strong class="user">Daniel Trebbien</strong>
   <a href="#92426" class="date">23-Jul-2009 11:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that `mb_convert_encoding($val, 'HTML-ENTITIES')` does not escape '\'', '"', '&lt;', '&gt;', or '&amp;'.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="91601""></a>
  <div class="note">
   <strong class="user">me at gsnedders dot com</strong>
   <a href="#91601" class="date">18-Jun-2009 03:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It appears that when dealing with an unknown "from encoding" the function will both throw an E_WARNING and proceed to convert the string from ISO-8859-1 to the "to encoding".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87991""></a>
  <div class="note">
   <strong class="user">chzhang at gmail dot com</strong>
   <a href="#87991" class="date">05-Jan-2009 12:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
instead of ini_set(), you can try this<br />
<br />
mb_substitute_character("none");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86927""></a>
  <div class="note">
   <strong class="user">francois at bonzon point com</strong>
   <a href="#86927" class="date">10-Nov-2008 05:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
aaron, to discard unsupported characters instead of printing a ?, you might as well simply set the configuration directive:<br />
<br />
mbstring.substitute_character = "none"<br />
<br />
in your php.ini. Be sure to include the quotes around none. Or at run-time with<br />
<br />
<span class="default">&lt;?php<br />
ini_set</span><span class="keyword">(</span><span class="string">'mbstring.substitute_character'</span><span class="keyword">, </span><span class="string">"none"</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86878""></a>
  <div class="note">
   <strong class="user">aaron at aarongough dot com</strong>
   <a href="#86878" class="date">07-Nov-2008 08:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My solution below was slightly incorrect, so here is the correct version (I posted at the end of a long day, never a good idea!)<br />
<br />
Again, this is a quick and dirty solution to stop mb_convert_encoding from filling your string with question marks whenever it encounters an illegal character for the target encoding. <br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">convert_to </span><span class="keyword">( </span><span class="default">$source</span><span class="keyword">, </span><span class="default">$target_encoding </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// detect the character encoding of the incoming file<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$encoding </span><span class="keyword">= </span><span class="default">mb_detect_encoding</span><span class="keyword">( </span><span class="default">$source</span><span class="keyword">, </span><span class="string">"auto" </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// escape all of the question marks so we can remove artifacts from<br />
&nbsp;&nbsp;&nbsp; // the unicode conversion process<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$target </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">"?"</span><span class="keyword">, </span><span class="string">"[question_mark]"</span><span class="keyword">, </span><span class="default">$source </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// convert the string to the target encoding<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$target </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">( </span><span class="default">$target</span><span class="keyword">, </span><span class="default">$target_encoding</span><span class="keyword">, </span><span class="default">$encoding</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// remove any question marks that have been introduced because of illegal characters<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$target </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">"?"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$target </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// replace the token string "[question_mark]" with the symbol "?"<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$target </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">( </span><span class="string">"[question_mark]"</span><span class="keyword">, </span><span class="string">"?"</span><span class="keyword">, </span><span class="default">$target </span><span class="keyword">);<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$target</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Hope this helps someone! (Admins should feel free to delete my previous, incorrect, post for clarity)<br />
-A</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85752""></a>
  <div class="note">
   <strong class="user">Edward</strong>
   <a href="#85752" class="date">16-Sep-2008 03:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If mb_convert_encoding doesn't work for you, and iconv gives you a headache, you might be interested in this free class I found. It can convert almost any charset to almost any other charset. I think it's wonderful and I wish I had found it earlier. It would have saved me tons of headache.<br />
<br />
I use it as a fail-safe, in case mb_convert_encoding is not installed. Download it from <a href="http://mikolajj.republika.pl/" rel="nofollow" target="_blank">http://mikolajj.republika.pl/</a><br />
<br />
This is not my own library, so technically it's not spamming, right? ;)<br />
<br />
Hope this helps.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85079""></a>
  <div class="note">
   <strong class="user">StigC</strong>
   <a href="#85079" class="date">13-Aug-2008 03:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For the php-noobs (like me) - working with flash and php.<br />
<br />
Here's a simple snippet of code that worked great for me, getting php to show special Danish characters, from a Flash email form:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Name Escape<br />
</span><span class="default">$escName </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">"Name"</span><span class="keyword">], </span><span class="string">"ISO-8859-1"</span><span class="keyword">, </span><span class="string">"UTF-8"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// message escape<br />
</span><span class="default">$escMessage </span><span class="keyword">= </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">"Message"</span><span class="keyword">], </span><span class="string">"ISO-8859-1"</span><span class="keyword">, </span><span class="string">"UTF-8"</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Headers.. and so on...<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83228""></a>
  <div class="note">
   <strong class="user">nospam at nihonbunka dot com</strong>
   <a href="#83228" class="date">15-May-2008 06:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
rodrigo at bb2 dot co dot jp wrote that inconv works better than mb_convert_encoding, I find that when converting from uft8 to shift_jis <br />
$conv_str = mb_convert_encoding($str,$toCS,$fromCS); <br />
works while<br />
$conv_str = iconv($fromCS,$toCS.'//IGNORE',$str); <br />
removes tildes from $str.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80620""></a>
  <div class="note">
   <strong class="user">katzlbtjunk at hotmail dot com</strong>
   <a href="#80620" class="date">25-Jan-2008 04:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Clean a string for use as filename by simply replacing all unwanted characters with underscore (ASCII converts to 7bit). It removes slightly more chars than necessary. Hope its useful. <br />
<br />
$fileName = 'Test:!"$%&amp;/()=??ü??ü&lt;&lt;';<br />
echo strtr(mb_convert_encoding($fileName,'ASCII'), <br />
&nbsp;&nbsp;&nbsp; ' ,;:?*#!§$%&amp;/(){}&lt;&gt;=`′|\\\'"', <br />
&nbsp;&nbsp;&nbsp; '____________________________');</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80424""></a>
  <div class="note">
   <strong class="user">rodrigo at bb2 dot co dot jp</strong>
   <a href="#80424" class="date">15-Jan-2008 03:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those who can′t use mb_convert_encoding() to convert from one charset to another as a metter of lower version of php, try iconv().<br />
<br />
I had this problem converting to japanese charset:<br />
<br />
$txt=mb_convert_encoding($txt,'SJIS',$this-&gt;encode);<br />
<br />
And I could fix it by using this:<br />
<br />
$txt = iconv('UTF-8', 'SJIS', $txt);<br />
<br />
Maybe it′s helpfull for someone else! ;)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79143""></a>
  <div class="note">
   <strong class="user">mightye at gmail dot com</strong>
   <a href="#79143" class="date">13-Nov-2007 09:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To petruzanauticoyahoo?com!ar<br />
<br />
If you don't specify a source encoding, then it assumes the internal (default) encoding.&nbsp; ? is a multi-byte character whose bytes in your configuration default (often iso-8859-1) would actually mean ?±.&nbsp; mb_convert_encoding() is upgrading those characters to their multi-byte equivalents within UTF-8.<br />
<br />
Try this instead:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">print </span><span class="default">mb_convert_encoding</span><span class="keyword">( </span><span class="string">"?"</span><span class="keyword">, </span><span class="string">"UTF-8"</span><span class="keyword">, </span><span class="string">"UTF-8" </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>Of course this function does no work (for the most part - it can actually be used to strip characters which are not valid for UTF-8).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78033""></a>
  <div class="note">
   <strong class="user">volker at machon dot biz</strong>
   <a href="#78033" class="date">24-Sep-2007 09:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hey guys. For everybody who's looking for a function that is converting an iso-string to utf8 or an utf8-string to iso, here's your solution:<br />
<br />
public function encodeToUtf8($string) {<br />
&nbsp;&nbsp; &nbsp; return mb_convert_encoding($string, "UTF-8", mb_detect_encoding($string, "UTF-8, ISO-8859-1, ISO-8859-15", true));<br />
}<br />
<br />
public function encodeToIso($string) {<br />
&nbsp;&nbsp; &nbsp; return mb_convert_encoding($string, "ISO-8859-1", mb_detect_encoding($string, "UTF-8, ISO-8859-1, ISO-8859-15", true));<br />
}<br />
<br />
For me these functions are working fine. Give it a try</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77262""></a>
  <div class="note">
   <strong class="user">aofg</strong>
   <a href="#77262" class="date">21-Aug-2007 06:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When converting Japanese strings to ISO-2022-JP or JIS on PHP &gt;= 5.2.1, you can use "ISO-2022-JP-MS" instead of them.<br />
Kishu-Izon (platform dependent) characters are converted correctly with the encoding, as same as with eucJP-win or with SJIS-win.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="71872""></a>
  <div class="note">
   <strong class="user">David Hull</strong>
   <a href="#71872" class="date">20-Dec-2006 10:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As an alternative to Johannes's suggestion for converting strings from other character sets to a 7bit representation while not just deleting latin diacritics, you might try this:<br />
<br />
<span class="default">&lt;?php<br />
$text </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="default">$from_enc</span><span class="keyword">, </span><span class="string">'US-ASCII//TRANSLIT'</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
The only disadvantage is that it does not convert "?" to "ae", but it handles punctuation and other special characters better.<br />
-- <br />
David</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69412""></a>
  <div class="note">
   <strong class="user">phpdoc at jeudi dot de</strong>
   <a href="#69412" class="date">05-Sep-2006 06:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I\&amp;#039;d like to share some code to convert latin diacritics to their
<br />
traditional 7bit representation, like, for example,
<br />

<br />
- &amp;agrave;,&amp;ccedil;,&amp;eacute;,&amp;icirc;,... to a,c,e,i,...
<br />
- &amp;szlig; to ss
<br />
- &amp;auml;,&amp;Auml;,... to ae,Ae,...
<br />
- &amp;euml;,... to e,...
<br />

<br />
(mb_convert \&amp;quot;7bit\&amp;quot; would simply delete any offending characters). 
<br />

<br />
I might have missed on your country\&amp;#039;s typographic 
<br />
conventions--correct me then. 
<br />
&amp;lt;?php
<br />
/**
<br />
&nbsp;* @args string $text line of encoded text
<br />
&nbsp;*&nbsp; &nbsp; &nbsp;&nbsp; string $from_enc (encoding type of $text, e.g. UTF-8, ISO-8859-1)
<br />
&nbsp;*
<br />
&nbsp;* @returns 7bit representation
<br />
&nbsp;*/
<br />
function to7bit($text,$from_enc) {
<br />
&nbsp;&nbsp;&nbsp; $text = mb_convert_encoding($text,\&amp;#039;HTML-ENTITIES\&amp;#039;,$from_enc);
<br />
&nbsp;&nbsp;&nbsp; $text = preg_replace(
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(\&amp;#039;/&amp;szlig;/\&amp;#039;,\&amp;#039;/&amp;amp;(..)lig;/\&amp;#039;,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \&amp;#039;/&amp;amp;([aouAOU])uml;/\&amp;#039;,\&amp;#039;/&amp;amp;(.)[^;]*;/\&amp;#039;),
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(\&amp;#039;ss\&amp;#039;,\&amp;quot;$1\&amp;quot;,\&amp;quot;$1\&amp;quot;.\&amp;#039;e\&amp;#039;,\&amp;quot;$1\&amp;quot;),
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $text);
<br />
&nbsp;&nbsp;&nbsp; return $text;
<br />
}&nbsp;&nbsp; 
<br />
?&amp;gt;
<br />

<br />
Enjoy :-)
<br />
Johannes
<br />

<br />
==
<br />
[EDIT BY danbrown AT php DOT net: Author provided the following update on 27-FEB-2012.]
<br />
==
<br />

<br />
An addendum to my &amp;quot;to7bit&amp;quot; function referenced below in the notes. 
<br />
The function is supposed to solve the problem that some languages require a different 7bit rendering of special (umlauted) characters for sorting or other applications. For example, the German &amp;szlig; ligature is usually written &amp;quot;ss&amp;quot; in 7bit context. Dutch &amp;yuml; is typically rendered &amp;quot;ij&amp;quot; (not &amp;quot;y&amp;quot;). 
<br />

<br />
The original function works well with word (alphabet) character entities and I&amp;#039;ve seen it used in many places. But non-word entities cause funny results:
<br />
E.g., &amp;quot;&amp;copy;&amp;quot; is rendered as &amp;quot;c&amp;quot;, &amp;quot;&amp;shy;&amp;quot; as &amp;quot;s&amp;quot; and &amp;quot;&amp;amp;rquo;&amp;quot; as &amp;quot;r&amp;quot;. 
<br />
The following version fixes this by converting non-alphanumeric characters (also chains thereof) to &amp;#039;_&amp;#039;.
<br />

<br />
&amp;lt;?php
<br />
/**
<br />
&nbsp;* @args string $text line of encoded text
<br />
&nbsp;*&nbsp; &nbsp; &nbsp;&nbsp; string $from_enc (encoding type of $text, e.g. UTF-8, ISO-8859-1)
<br />
&nbsp;*
<br />
&nbsp;* @returns 7bit representation
<br />
&nbsp;*/
<br />
function to7bit($text,$from_enc) {
<br />
&nbsp;&nbsp;&nbsp; $text = preg_replace(/W+/,&amp;#039;_&amp;#039;,$text);
<br />
&nbsp;&nbsp;&nbsp; $text = mb_convert_encoding($text,&amp;#039;HTML-ENTITIES&amp;#039;,$from_enc);
<br />
&nbsp;&nbsp;&nbsp; $text = preg_replace(
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(&amp;#039;/&amp;szlig;/&amp;#039;,&amp;#039;/&amp;amp;(..)lig;/&amp;#039;,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;#039;/&amp;amp;([aouAOU])uml;/&amp;#039;,&amp;#039;/&amp;yuml;/&amp;#039;,&amp;#039;/&amp;amp;(.)[^;]*;/&amp;#039;),
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array(&amp;#039;ss&amp;#039;,&amp;quot;$1&amp;quot;,&amp;quot;$1&amp;quot;.&amp;#039;e&amp;#039;,&amp;#039;ij&amp;#039;,&amp;quot;$1&amp;quot;),
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $text);
<br />
&nbsp;&nbsp;&nbsp; return $text;
<br />
}&nbsp; 
<br />
?&amp;gt;
<br />

<br />
Enjoy again,
<br />
Johannes</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="67981""></a>
  <div class="note">
   <strong class="user">mac.com@nemo</strong>
   <a href="#67981" class="date">08-Jul-2006 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those wanting to convert from $set to MacRoman, use iconv():<br />
<br />
<span class="default">&lt;?php<br />
<br />
$string </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'macintosh'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
('macintosh' is the IANA name for the MacRoman character set.)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62131""></a>
  <div class="note">
   <strong class="user">eion at bigfoot dot com</strong>
   <a href="#62131" class="date">20-Feb-2006 04:54</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
many people below talk about using 
<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; mb_convert_encode</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="string">'HTML-ENTITIES'</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>to convert non-ascii code into html-readable stuff.&nbsp; Due to my webserver being out of my control, I was unable to set the database character set, and whenever PHP made a copy of my $s variable that it had pulled out of the database, it would convert it to nasty latin1 automatically and not leave it in it's beautiful UTF-8 glory.
<br />

<br />
So [insert korean characters here] turned into ?????.
<br />

<br />
I found myself needing to pass by reference (which of course is deprecated/nonexistent in recent versions of PHP)
<br />
so instead of
<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; mb_convert_encode</span><span class="keyword">(&amp;</span><span class="default">$s</span><span class="keyword">,</span><span class="string">'HTML-ENTITIES'</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">);
<br />
</span><span class="default">?&gt;
<br />
</span>which worked perfectly until I upgraded, so I had to use
<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; call_user_func_array</span><span class="keyword">(</span><span class="string">'mb_convert_encoding'</span><span class="keyword">, array(&amp;</span><span class="default">$s</span><span class="keyword">,</span><span class="string">'HTML-ENTITIES'</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">));
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Hope it helps someone else out</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="58677""></a>
  <div class="note">
   <strong class="user">Tom Class</strong>
   <a href="#58677" class="date">11-Nov-2005 07:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Why did you use the php html encode functions? mbstring has it's own Encoding which is (as far as I tested it) much more usefull:<br />
<br />
HTML-ENTITIES<br />
<br />
Example:<br />
<br />
$text = mb_convert_encoding($text, 'HTML-ENTITIES', "UTF-8");</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56618""></a>
  <div class="note">
   <strong class="user">Stephan van der Feest</strong>
   <a href="#56618" class="date">09-Sep-2005 04:47</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To add to the Flash conversion comment below, here's how I convert back from what I've stored in a database after converting from Flash HTML text field output, in order to load it back into a Flash HTML text field:<br />
<br />
function htmltoflash($htmlstr)<br />
{<br />
&nbsp; return str_replace("&amp;lt;br /&amp;gt;","\n",<br />
&nbsp;&nbsp;&nbsp; str_replace("&lt;","&amp;lt;",<br />
&nbsp;&nbsp; &nbsp;&nbsp; str_replace("&gt;","&amp;gt;",<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; mb_convert_encoding(html_entity_decode($htmlstr),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; "UTF-8","ISO-8859-1"))));<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56616""></a>
  <div class="note">
   <strong class="user">Stephan van der Feest</strong>
   <a href="#56616" class="date">09-Sep-2005 03:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here's a tip for anyone using Flash and PHP for storing HTML output submitted from a Flash text field in a database or whatever.<br />
<br />
Flash submits its HTML special characters in UTF-8, so you can use the following function to convert those into HTML entity characters:<br />
<br />
function utf8html($utf8str)<br />
{<br />
&nbsp; return htmlentities(mb_convert_encoding($utf8str,"ISO-8859-1","UTF-8"));<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="39549""></a>
  <div class="note">
   <strong class="user">jamespilcher1 - hotmail</strong>
   <a href="#39549" class="date">01-Feb-2004 07:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
be careful when converting from iso-8859-1 to utf-8.<br />
<br />
even if you explicitly specify the character encoding of a page as iso-8859-1(via headers and strict xml defs), windows 2000 will ignore that and interpret it as whatever character set it has natively installed. <br />
<br />
for example, i wrote char #128 into a page, with char encoding iso-8859-1, and it displayed in internet explorer (&amp; mozilla) as a euro symbol.<br />
<br />
it should have displayed a box, denoting that char #128 is undefined in iso-8859-1. The problem was it was displaying in "Windows: western europe" (my native character set).<br />
<br />
this led to confusion when i tried to convert this euro to UTF-8 via mb_convert_encoding()&nbsp; <br />
<br />
IE displays UTF-8 correctly- and because PHP correctly converted #128 into a box in UTF-8, IE would show a box.<br />
<br />
so all i saw was mb_convert_encoding() converting a euro symbol into a box. It took me a long time to figure out what was going on.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29256""></a>
  <div class="note">
   <strong class="user">lanka at eurocom dot od dot ua</strong>
   <a href="#29256" class="date">07-Feb-2003 08:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Another sample of recoding without MultiByte enabling.<br />
(Russian koi-&gt;win, if input in win-encoding already, function recode() returns unchanged string)<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="comment">// 0 - win<br />
&nbsp; // 1 - koi<br />
&nbsp; </span><span class="keyword">function </span><span class="default">detect_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$win </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$koi </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; if( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) &gt;</span><span class="default">224 </span><span class="keyword">&amp;&amp; </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) &lt; </span><span class="default">255</span><span class="keyword">) </span><span class="default">$win</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp;&nbsp; if( </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) &gt;</span><span class="default">192 </span><span class="keyword">&amp;&amp; </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) &lt; </span><span class="default">223</span><span class="keyword">) </span><span class="default">$koi</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$win </span><span class="keyword">&lt; </span><span class="default">$koi </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else return </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp; }<br />
<br />
&nbsp; </span><span class="comment">// recodes koi to win<br />
&nbsp; </span><span class="keyword">function </span><span class="default">koi_to_win</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$kw </span><span class="keyword">= array(</span><span class="default">128</span><span class="keyword">, </span><span class="default">129</span><span class="keyword">, </span><span class="default">130</span><span class="keyword">, </span><span class="default">131</span><span class="keyword">, </span><span class="default">132</span><span class="keyword">, </span><span class="default">133</span><span class="keyword">, </span><span class="default">134</span><span class="keyword">, </span><span class="default">135</span><span class="keyword">, </span><span class="default">136</span><span class="keyword">, </span><span class="default">137</span><span class="keyword">, </span><span class="default">138</span><span class="keyword">, </span><span class="default">139</span><span class="keyword">, </span><span class="default">140</span><span class="keyword">, </span><span class="default">141</span><span class="keyword">, </span><span class="default">142</span><span class="keyword">, </span><span class="default">143</span><span class="keyword">, </span><span class="default">144</span><span class="keyword">, </span><span class="default">145</span><span class="keyword">, </span><span class="default">146</span><span class="keyword">, </span><span class="default">147</span><span class="keyword">, </span><span class="default">148</span><span class="keyword">, </span><span class="default">149</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">151</span><span class="keyword">, </span><span class="default">152</span><span class="keyword">, </span><span class="default">153</span><span class="keyword">, </span><span class="default">154</span><span class="keyword">, </span><span class="default">155</span><span class="keyword">, </span><span class="default">156</span><span class="keyword">, </span><span class="default">157</span><span class="keyword">, </span><span class="default">158</span><span class="keyword">, </span><span class="default">159</span><span class="keyword">, </span><span class="default">160</span><span class="keyword">, </span><span class="default">161</span><span class="keyword">, </span><span class="default">162</span><span class="keyword">, </span><span class="default">163</span><span class="keyword">, </span><span class="default">164</span><span class="keyword">, </span><span class="default">165</span><span class="keyword">, </span><span class="default">166</span><span class="keyword">, </span><span class="default">167</span><span class="keyword">, </span><span class="default">168</span><span class="keyword">, </span><span class="default">169</span><span class="keyword">, </span><span class="default">170</span><span class="keyword">, </span><span class="default">171</span><span class="keyword">, </span><span class="default">172</span><span class="keyword">, </span><span class="default">173</span><span class="keyword">, </span><span class="default">174</span><span class="keyword">, </span><span class="default">175</span><span class="keyword">, </span><span class="default">176</span><span class="keyword">, </span><span class="default">177</span><span class="keyword">, </span><span class="default">178</span><span class="keyword">, </span><span class="default">179</span><span class="keyword">, </span><span class="default">180</span><span class="keyword">, </span><span class="default">181</span><span class="keyword">, </span><span class="default">182</span><span class="keyword">, </span><span class="default">183</span><span class="keyword">,&nbsp; </span><span class="default">184</span><span class="keyword">, </span><span class="default">185</span><span class="keyword">, </span><span class="default">186</span><span class="keyword">, </span><span class="default">187</span><span class="keyword">, </span><span class="default">188</span><span class="keyword">, </span><span class="default">189</span><span class="keyword">, </span><span class="default">190</span><span class="keyword">, </span><span class="default">191</span><span class="keyword">, </span><span class="default">254</span><span class="keyword">, </span><span class="default">224</span><span class="keyword">, </span><span class="default">225</span><span class="keyword">, </span><span class="default">246</span><span class="keyword">, </span><span class="default">228</span><span class="keyword">, </span><span class="default">229</span><span class="keyword">, </span><span class="default">244</span><span class="keyword">, </span><span class="default">227</span><span class="keyword">, </span><span class="default">245</span><span class="keyword">, </span><span class="default">232</span><span class="keyword">, </span><span class="default">233</span><span class="keyword">, </span><span class="default">234</span><span class="keyword">, </span><span class="default">235</span><span class="keyword">, </span><span class="default">236</span><span class="keyword">, </span><span class="default">237</span><span class="keyword">, </span><span class="default">238</span><span class="keyword">, </span><span class="default">239</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">240</span><span class="keyword">, </span><span class="default">241</span><span class="keyword">, </span><span class="default">242</span><span class="keyword">, </span><span class="default">243</span><span class="keyword">, </span><span class="default">230</span><span class="keyword">, </span><span class="default">226</span><span class="keyword">, </span><span class="default">252</span><span class="keyword">, </span><span class="default">251</span><span class="keyword">, </span><span class="default">231</span><span class="keyword">, </span><span class="default">248</span><span class="keyword">, </span><span class="default">253</span><span class="keyword">, </span><span class="default">249</span><span class="keyword">, </span><span class="default">247</span><span class="keyword">, </span><span class="default">250</span><span class="keyword">, </span><span class="default">222</span><span class="keyword">, </span><span class="default">192</span><span class="keyword">, </span><span class="default">193</span><span class="keyword">, </span><span class="default">214</span><span class="keyword">, </span><span class="default">196</span><span class="keyword">, </span><span class="default">197</span><span class="keyword">, </span><span class="default">212</span><span class="keyword">, </span><span class="default">195</span><span class="keyword">, </span><span class="default">213</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">, </span><span class="default">201</span><span class="keyword">, </span><span class="default">202</span><span class="keyword">, </span><span class="default">203</span><span class="keyword">, </span><span class="default">204</span><span class="keyword">, </span><span class="default">205</span><span class="keyword">, </span><span class="default">206</span><span class="keyword">, </span><span class="default">207</span><span class="keyword">, </span><span class="default">223</span><span class="keyword">, </span><span class="default">208</span><span class="keyword">, </span><span class="default">209</span><span class="keyword">, </span><span class="default">210</span><span class="keyword">, </span><span class="default">211</span><span class="keyword">, </span><span class="default">198</span><span class="keyword">, </span><span class="default">194</span><span class="keyword">, </span><span class="default">220</span><span class="keyword">, </span><span class="default">219</span><span class="keyword">, </span><span class="default">199</span><span class="keyword">, </span><span class="default">216</span><span class="keyword">, </span><span class="default">221</span><span class="keyword">, </span><span class="default">217</span><span class="keyword">, </span><span class="default">215</span><span class="keyword">, </span><span class="default">218</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$wk </span><span class="keyword">= array(</span><span class="default">128</span><span class="keyword">, </span><span class="default">129</span><span class="keyword">, </span><span class="default">130</span><span class="keyword">, </span><span class="default">131</span><span class="keyword">, </span><span class="default">132</span><span class="keyword">, </span><span class="default">133</span><span class="keyword">, </span><span class="default">134</span><span class="keyword">, </span><span class="default">135</span><span class="keyword">, </span><span class="default">136</span><span class="keyword">, </span><span class="default">137</span><span class="keyword">, </span><span class="default">138</span><span class="keyword">, </span><span class="default">139</span><span class="keyword">, </span><span class="default">140</span><span class="keyword">, </span><span class="default">141</span><span class="keyword">, </span><span class="default">142</span><span class="keyword">, </span><span class="default">143</span><span class="keyword">, </span><span class="default">144</span><span class="keyword">, </span><span class="default">145</span><span class="keyword">, </span><span class="default">146</span><span class="keyword">, </span><span class="default">147</span><span class="keyword">, </span><span class="default">148</span><span class="keyword">, </span><span class="default">149</span><span class="keyword">, </span><span class="default">150</span><span class="keyword">, </span><span class="default">151</span><span class="keyword">, </span><span class="default">152</span><span class="keyword">, </span><span class="default">153</span><span class="keyword">, </span><span class="default">154</span><span class="keyword">, </span><span class="default">155</span><span class="keyword">, </span><span class="default">156</span><span class="keyword">, </span><span class="default">157</span><span class="keyword">, </span><span class="default">158</span><span class="keyword">, </span><span class="default">159</span><span class="keyword">, </span><span class="default">160</span><span class="keyword">, </span><span class="default">161</span><span class="keyword">, </span><span class="default">162</span><span class="keyword">, </span><span class="default">163</span><span class="keyword">, </span><span class="default">164</span><span class="keyword">, </span><span class="default">165</span><span class="keyword">, </span><span class="default">166</span><span class="keyword">, </span><span class="default">167</span><span class="keyword">, </span><span class="default">168</span><span class="keyword">, </span><span class="default">169</span><span class="keyword">, </span><span class="default">170</span><span class="keyword">, </span><span class="default">171</span><span class="keyword">, </span><span class="default">172</span><span class="keyword">, </span><span class="default">173</span><span class="keyword">, </span><span class="default">174</span><span class="keyword">, </span><span class="default">175</span><span class="keyword">, </span><span class="default">176</span><span class="keyword">, </span><span class="default">177</span><span class="keyword">, </span><span class="default">178</span><span class="keyword">, </span><span class="default">179</span><span class="keyword">, </span><span class="default">180</span><span class="keyword">, </span><span class="default">181</span><span class="keyword">, </span><span class="default">182</span><span class="keyword">, </span><span class="default">183</span><span class="keyword">,&nbsp; </span><span class="default">184</span><span class="keyword">, </span><span class="default">185</span><span class="keyword">, </span><span class="default">186</span><span class="keyword">, </span><span class="default">187</span><span class="keyword">, </span><span class="default">188</span><span class="keyword">, </span><span class="default">189</span><span class="keyword">, </span><span class="default">190</span><span class="keyword">, </span><span class="default">191</span><span class="keyword">, </span><span class="default">225</span><span class="keyword">, </span><span class="default">226</span><span class="keyword">, </span><span class="default">247</span><span class="keyword">, </span><span class="default">231</span><span class="keyword">, </span><span class="default">228</span><span class="keyword">, </span><span class="default">229</span><span class="keyword">, </span><span class="default">246</span><span class="keyword">, </span><span class="default">250</span><span class="keyword">, </span><span class="default">233</span><span class="keyword">, </span><span class="default">234</span><span class="keyword">, </span><span class="default">235</span><span class="keyword">, </span><span class="default">236</span><span class="keyword">, </span><span class="default">237</span><span class="keyword">, </span><span class="default">238</span><span class="keyword">, </span><span class="default">239</span><span class="keyword">, </span><span class="default">240</span><span class="keyword">, </span><span class="default">242</span><span class="keyword">,&nbsp; </span><span class="default">243</span><span class="keyword">, </span><span class="default">244</span><span class="keyword">, </span><span class="default">245</span><span class="keyword">, </span><span class="default">230</span><span class="keyword">, </span><span class="default">232</span><span class="keyword">, </span><span class="default">227</span><span class="keyword">, </span><span class="default">254</span><span class="keyword">, </span><span class="default">251</span><span class="keyword">, </span><span class="default">253</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">, </span><span class="default">249</span><span class="keyword">, </span><span class="default">248</span><span class="keyword">, </span><span class="default">252</span><span class="keyword">, </span><span class="default">224</span><span class="keyword">, </span><span class="default">241</span><span class="keyword">, </span><span class="default">193</span><span class="keyword">, </span><span class="default">194</span><span class="keyword">, </span><span class="default">215</span><span class="keyword">, </span><span class="default">199</span><span class="keyword">, </span><span class="default">196</span><span class="keyword">, </span><span class="default">197</span><span class="keyword">, </span><span class="default">214</span><span class="keyword">, </span><span class="default">218</span><span class="keyword">, </span><span class="default">201</span><span class="keyword">, </span><span class="default">202</span><span class="keyword">, </span><span class="default">203</span><span class="keyword">, </span><span class="default">204</span><span class="keyword">, </span><span class="default">205</span><span class="keyword">, </span><span class="default">206</span><span class="keyword">, </span><span class="default">207</span><span class="keyword">, </span><span class="default">208</span><span class="keyword">, </span><span class="default">210</span><span class="keyword">, </span><span class="default">211</span><span class="keyword">, </span><span class="default">212</span><span class="keyword">, </span><span class="default">213</span><span class="keyword">, </span><span class="default">198</span><span class="keyword">, </span><span class="default">200</span><span class="keyword">, </span><span class="default">195</span><span class="keyword">, </span><span class="default">222</span><span class="keyword">, </span><span class="default">219</span><span class="keyword">, </span><span class="default">221</span><span class="keyword">, </span><span class="default">223</span><span class="keyword">, </span><span class="default">217</span><span class="keyword">, </span><span class="default">216</span><span class="keyword">, </span><span class="default">220</span><span class="keyword">, </span><span class="default">192</span><span class="keyword">, </span><span class="default">209</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$end </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">[</span><span class="default">$pos</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$c</span><span class="keyword">&gt;</span><span class="default">128</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$string</span><span class="keyword">[</span><span class="default">$pos</span><span class="keyword">] = </span><span class="default">chr</span><span class="keyword">(</span><span class="default">$kw</span><span class="keyword">[</span><span class="default">$c</span><span class="keyword">-</span><span class="default">128</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; } while (++</span><span class="default">$pos </span><span class="keyword">&lt; </span><span class="default">$end</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;<br />
&nbsp; }<br />
<br />
&nbsp; function </span><span class="default">recode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$enc </span><span class="keyword">= </span><span class="default">detect_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$enc</span><span class="keyword">==</span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">koi_to_win</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
