<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>返回数组中的当前值</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.count.html">? count</a></li>
      <li style="float: right;"><a href="function.each.html">each ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.array.html">数组 函数</a></li>
    <li>返回数组中的当前值</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.current" class="refentry">
   <div class="refnamediv">
    <h1 class="refname">current</h1>
    <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">current</span> &mdash; <span class="dc-title">返回数组中的当前值</span></p>

   </div>
 <div class="refsect1 description" id="refsect1-function.current-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>current</strong></span>
    ( <span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">object</span></span> <code class="parameter">$array</code></span>
   ) : <span class="type"><a href="language.types.declarations.html#language.types.declarations.mixed" class="type mixed">mixed</a></span></div>

    <p class="para rdfs-comment">
     每个数组中都有一个内部的指针指向它"当前的"单元，初始化时会指向该数组中的第一个值。
    </p>
   </div>

 <div class="refsect1 parameters" id="refsect1-function.current-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">array</code></dt>

     <dd>

      <p class="para">
       要操作的数组。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="refsect1 returnvalues" id="refsect1-function.current-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   <span class="function"><strong>current()</strong></span>
   函数返回当前被内部指针指向的数组单元的值，并不移动指针。如果内部指针指向超出了单元列表的末端，<span class="function"><strong>current()</strong></span>
   将返回 <strong><code>false</code></strong>。
  </p>
  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">此函数可能返回布尔值
<strong><code>false</code></strong>，但也可能返回等同于 <strong><code>false</code></strong> 的非布尔值。请阅读 <a href="language.types.boolean.html" class="link">布尔类型</a>章节以获取更多信息。应使用
<a href="language.operators.comparison.html" class="link">===
运算符</a>来测试此函数的返回值。</p></div>
 </div>

 <div class="refsect1 changelog" id="refsect1-function.current-changelog">
  <h3 class="title">更新日志</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>版本</th>
       <th>说明</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>7.0.0</td>
       <td>
        <code class="parameter">array</code> 参数始终通过赋值来传递。之前的版本中，默认通过引用来传值。
       </td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>

 <div class="refsect1 examples" id="refsect1-function.current-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-5322">
    <p><strong>Example #1  <span class="function"><strong>current()</strong></span> 函数使用示例</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$transport&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'foot'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bike'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'car'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'plane'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">current</span><span style="color: #007700">(</span><span style="color: #0000BB">$transport</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;$mode&nbsp;=&nbsp;'foot';<br /></span><span style="color: #0000BB">$mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">next</span><span style="color: #007700">(</span><span style="color: #0000BB">$transport</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;$mode&nbsp;=&nbsp;'bike';<br /></span><span style="color: #0000BB">$mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">current</span><span style="color: #007700">(</span><span style="color: #0000BB">$transport</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;$mode&nbsp;=&nbsp;'bike';<br /></span><span style="color: #0000BB">$mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">prev</span><span style="color: #007700">(</span><span style="color: #0000BB">$transport</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;$mode&nbsp;=&nbsp;'foot';<br /></span><span style="color: #0000BB">$mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">end</span><span style="color: #007700">(</span><span style="color: #0000BB">$transport</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;$mode&nbsp;=&nbsp;'plane';<br /></span><span style="color: #0000BB">$mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">current</span><span style="color: #007700">(</span><span style="color: #0000BB">$transport</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;$mode&nbsp;=&nbsp;'plane';<br /><br /></span><span style="color: #0000BB">$arr&nbsp;</span><span style="color: #007700">=&nbsp;array();<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">current</span><span style="color: #007700">(</span><span style="color: #0000BB">$arr</span><span style="color: #007700">));&nbsp;</span><span style="color: #FF8000">//&nbsp;bool(false)<br /><br /></span><span style="color: #0000BB">$arr&nbsp;</span><span style="color: #007700">=&nbsp;array(array());<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">current</span><span style="color: #007700">(</span><span style="color: #0000BB">$arr</span><span style="color: #007700">));&nbsp;</span><span style="color: #FF8000">//&nbsp;array(0)&nbsp;{&nbsp;}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 <div class="refsect1 notes" id="refsect1-function.current-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    在一个空数组上使用 <span class="function"><strong>current()</strong></span>
    函数，和在一个内部指针指向单元末端以外的数组上使用此函数，结果是相同的，同样都会返回
    <span class="type">bool</span> <strong><code>false</code></strong>。如果希望正确遍历一个包含 <strong><code>false</code></strong> 的数组，请参阅
    <span class="function"><strong>foreach()</strong></span> 函数。
   </span>
   <span class="simpara">
    如果仍然希望使用 <span class="function"><strong>current()</strong></span> 来判断数组单元真实的值，应该同时使用
    <span class="function"><a href="function.key.html" class="function">key()</a></span> 和 <span class="function"><strong>current()</strong></span>
    来检查当前元素是否为 <strong><code>null</code></strong>。
   </span>
  </p></blockquote>
 </div>

 <div class="refsect1 seealso" id="refsect1-function.current-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.end.html" class="function" rel="rdfs-seeAlso">end()</a> - 将数组的内部指针指向最后一个单元</span></li>
    <li class="member"><span class="function"><a href="function.key.html" class="function" rel="rdfs-seeAlso">key()</a> - 从关联数组中取得键名</span></li>
    <li class="member"><span class="function"><a href="function.each.html" class="function" rel="rdfs-seeAlso">each()</a> - 返回数组中当前的键／值对并将数组指针向前移动一步</span></li>
    <li class="member"><span class="function"><a href="function.prev.html" class="function" rel="rdfs-seeAlso">prev()</a> - 将数组的内部指针倒回一位</span></li>
    <li class="member"><span class="function"><a href="function.reset.html" class="function" rel="rdfs-seeAlso">reset()</a> - 将数组的内部指针指向第一个单元</span></li>
    <li class="member"><span class="function"><a href="function.next.html" class="function" rel="rdfs-seeAlso">next()</a> - 将数组中的内部指针向前移动一位</span></li>
   </ul>
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="124228""></a>
  <div class="note">
   <strong class="user">leozmm at outlook dot com</strong>
   <a href="#124228" class="date">24-Sep-2019 08:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Array can be passed by both REFERENCE and EXPRESSION on `current`, because current doesn't move array's internal pointer,<br />
this is not true for other functions like: `end`, `next`, `prev` etc.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">foo</span><span class="keyword">() {return array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">);}<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">current</span><span class="keyword">(</span><span class="default">foo</span><span class="keyword">());&nbsp; </span><span class="comment">// this print '1'<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">echo </span><span class="default">end</span><span class="keyword">(</span><span class="default">foo</span><span class="keyword">());&nbsp; &nbsp; &nbsp; </span><span class="comment">// this print error: Only variables should be passed by reference<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122924""></a>
  <div class="note">
   <strong class="user">xedin dot unknown at gmail dot com</strong>
   <a href="#122924" class="date">10-Jul-2018 01:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Array functions, such as `current()` and `rewind()` will work on `Traversable` as well, PHP 5.0 - 7.3, but not in HHVM:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$queue </span><span class="keyword">= new </span><span class="default">ArrayIterator</span><span class="keyword">(array(</span><span class="string">'adasdasd'</span><span class="keyword">));<br />
</span><span class="default">reset</span><span class="keyword">(</span><span class="default">$queue</span><span class="keyword">);<br />
</span><span class="default">$current </span><span class="keyword">= </span><span class="default">current</span><span class="keyword">(</span><span class="default">$queue</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$current</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
See https://3v4l.org/VjCHR</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121483""></a>
  <div class="note">
   <strong class="user">pdarmis at gmail dot com</strong>
   <a href="#121483" class="date">06-Aug-2017 06:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Based on this example <a href="http://php.net/manual/en/function.current.php#116128 i would like to add the following.&nbsp; As Vasily points out in his example " rel="nofollow" target="_blank">http://php.net/manual/en/function.current.php#116128 i would like to add the following.&nbsp; As Vasily points out in his example </a><br />
<span class="default">&lt;?php<br />
$prices </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; </span><span class="string">'1300990'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">'500'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; </span><span class="string">'600'<br />
</span><span class="keyword">);<br />
foreach(</span><span class="default">$prices </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$price</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$price </span><span class="keyword">&lt; </span><span class="default">1000</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$prices</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$prices</span><span class="keyword">)); </span><span class="comment">// bool(false)<br />
</span><span class="default">?&gt;<br />
</span>The above example will not work and return false for version of PHP between 5.2.4 and 5.6.29. The issue is not present on PHP versions &gt;= 7.0.1<br />
A different workaround (at least from Vasily's example) would be to use reset() before using current() in order to reset the array pointer to start.<br />
<span class="default">&lt;?php<br />
$prices </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; </span><span class="string">'1300990'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">'500'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; </span><span class="string">'600'<br />
</span><span class="keyword">);<br />
foreach(</span><span class="default">$prices </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$price</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$price </span><span class="keyword">&lt; </span><span class="default">1000</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$prices</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">reset</span><span class="keyword">(</span><span class="default">$prices</span><span class="keyword">);<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$prices</span><span class="keyword">)); </span><span class="comment">// string(7) "1300990"<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119897""></a>
  <div class="note">
   <strong class="user">jodevweb at gmail dot com</strong>
   <a href="#119897" class="date">16-Sep-2016 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As Sergey stated a long time ago in this notes, when adding to the array using the brackets syntax, current won't return the last added value. Instead of moving the pointer with end(), you simply can get the last value with <span class="default">&lt;?php $my_array</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">] </span><span class="default">?&gt;</span> (only applies to a non-associative array).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116128""></a>
  <div class="note">
   <strong class="user">Vasily Yudin (st-2 at mail dot ru)</strong>
   <a href="#116128" class="date">12-Nov-2014 08:51</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you do current() after using uset() on foreach statement, you can get FALSE in PHP version 5.2.4 and above.<br />
There is example:<br />
<span class="default">&lt;?php<br />
$prices </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; </span><span class="string">'1300990'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">'500'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; </span><span class="string">'600'<br />
</span><span class="keyword">);<br />
foreach(</span><span class="default">$prices </span><span class="keyword">as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$price</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$price </span><span class="keyword">&lt; </span><span class="default">1000</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; unset(</span><span class="default">$prices</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$prices</span><span class="keyword">)); </span><span class="comment">// bool(false)<br />
</span><span class="default">?&gt;<br />
</span>If you do unset() without foreach? all will be fine.<br />
<span class="default">&lt;?php<br />
$prices </span><span class="keyword">= array(<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; </span><span class="string">'1300990'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; </span><span class="string">'500'</span><span class="keyword">,<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; </span><span class="string">'600'<br />
</span><span class="keyword">);<br />
unset(</span><span class="default">$prices</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]);<br />
unset(</span><span class="default">$prices</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$prices</span><span class="keyword">));<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115026""></a>
  <div class="note">
   <strong class="user">Pratip Ghosh</strong>
   <a href="#115026" class="date">14-May-2014 05:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If we unset any element from an array, and then try the current function, I noted it returned FALSE. To overcome this limitation, you can use array_values function to re-order the tree.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113561""></a>
  <div class="note">
   <strong class="user">strate at yandex dot com</strong>
   <a href="#113561" class="date">30-Oct-2013 07:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note, that you can pass array by expression, not only by reference (as described in doc).<br />
<br />
<span class="default">&lt;?php<br />
var_dump</span><span class="keyword">( </span><span class="default">current</span><span class="keyword">( array(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="keyword">) ) ); </span><span class="comment">// (int) 1<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107147""></a>
  <div class="note">
   <strong class="user">michael at squiloople dot com</strong>
   <a href="#107147" class="date">10-Jan-2012 07:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
current() also works on objects:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
&nbsp; </span><span class="keyword">echo </span><span class="default">current</span><span class="keyword">((object) array(</span><span class="string">'one'</span><span class="keyword">, </span><span class="string">'two'</span><span class="keyword">)); </span><span class="comment">// Outputs: one
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83212""></a>
  <div class="note">
   <strong class="user">aefxx</strong>
   <a href="#83212" class="date">15-May-2008 08:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A simple copy function that not only copies the given array but ensures the copy's pointer is set to the exact same position:
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">array_copy</span><span class="keyword">(&amp;array)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">key</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$copy </span><span class="keyword">= </span><span class="default">$array</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; while ((</span><span class="default">$copy_key </span><span class="keyword">= </span><span class="default">key</span><span class="keyword">(</span><span class="default">$copy</span><span class="keyword">)) !== </span><span class="default">NULL</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$copy_key </span><span class="keyword">== </span><span class="default">$key</span><span class="keyword">) break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">next</span><span class="keyword">(</span><span class="default">$copy</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$copy</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
That's all ... bye.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81431""></a>
  <div class="note">
   <strong class="user">gregory at gregory dot net</strong>
   <a href="#81431" class="date">27-Feb-2008 09:07</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It took me a while to figure this out, but there is a more consistent way to figure out whether you really went past the end of the array, than using each().<br />
<br />
You see, each() gets the value BEFORE advancing the pointer, and next() gets the value AFTER advancing the pointer. When you are implementing the Iterator interface, therefore, it's a real pain in the behind to use each().<br />
<br />
And thus, I give you the solution:<br />
To see if you've blown past the end of the array, use key($array) and see if it returns NULL. If it does, you're past the end of the array -- keys can't be null in arrays.<br />
<br />
Nifty, huh? Here's how I implemented the Iterator interface in one of my classes:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* DbRow file<br />
&nbsp;* @package PalDb<br />
&nbsp;*/<br />
<br />
/**<br />
&nbsp;* This class lets you use Db rows and object-relational mapping functionality.<br />
&nbsp;*/<br />
&nbsp;<br />
</span><span class="keyword">class </span><span class="default">DbRow </span><span class="keyword">implements </span><span class="default">Iterator<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * The DbResult object that gave us this row through fetchDbRows<br />
&nbsp;&nbsp; &nbsp; * @var DbResult<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * The fields of the row<br />
&nbsp;&nbsp; &nbsp; * @var $fields<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">protected </span><span class="default">$fields</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Constructor<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @param PDOStatement $stmt<br />
&nbsp;&nbsp; &nbsp; *&nbsp; The PDO statement object that this result uses<br />
&nbsp;&nbsp; &nbsp; * @param DbResult $result<br />
&nbsp;&nbsp; &nbsp; *&nbsp; The result that produced this row through fetchDbRows <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$result</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">result </span><span class="keyword">= </span><span class="default">$result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Get the DbResult object that gave us this row through fetchDbRows<br />
&nbsp;&nbsp; &nbsp; * @return DbResult<br />
&nbsp;&nbsp; &nbsp; *<br />
&nbsp;&nbsp; &nbsp; * @return unknown<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">getResult</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">result</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__set</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name</span><span class="keyword">, <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">] = </span><span class="default">$value</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">__get</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$name</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">])) <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">[</span><span class="default">$name</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Iterator implementation - rewind<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">rewind</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">beyondLastField </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">reset</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">valid</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return !</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">beyondLastField</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">current</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">current</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">key</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">key</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">next</span><span class="keyword">()<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$next </span><span class="keyword">= </span><span class="default">next</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key </span><span class="keyword">= </span><span class="default">key</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fields</span><span class="keyword">);&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (isset(</span><span class="default">$key</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$next</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">beyondLastField </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; </span><span class="comment">// doesn't matter what we return here, see valid()<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; private </span><span class="default">$beyondLastField </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
};<br />
<br />
</span><span class="default">Hope this helps someone</span><span class="keyword">.</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77064""></a>
  <div class="note">
   <strong class="user">vaclav dot sir at gmail dot com</strong>
   <a href="#77064" class="date">13-Aug-2007 09:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To that "note": You won't be able to distinguish the end of an array from a boolean FALSE element, BUT you can distinguish the end from a NULL value of the key() function.<br />
<br />
Example:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">key</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) === </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"You are in the end of the array."</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Current element: " </span><span class="keyword">. </span><span class="default">current</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41864""></a>
  <div class="note">
   <strong class="user">mdeng at kabenresearch dot com</strong>
   <a href="#41864" class="date">23-Apr-2004 11:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For large array(my sample was 80000+ elements), if you want to traverse the array in sequence, using array index $a[$i] could be very inefficient(very slow). I had to switch to use current($a).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37917""></a>
  <div class="note">
   <strong class="user">vitalib at 012 dot net dot il</strong>
   <a href="#37917" class="date">02-Dec-2003 02:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that by copying an array its internal pointer is lost:<br />
<br />
<span class="default">&lt;?php<br />
$myarray </span><span class="keyword">= array(</span><span class="default">0</span><span class="keyword">=&gt;</span><span class="string">'a'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">=&gt;</span><span class="string">'b'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">=&gt;</span><span class="string">'c'</span><span class="keyword">);<br />
</span><span class="default">next</span><span class="keyword">(</span><span class="default">$myarray</span><span class="keyword">);<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$myarray</span><span class="keyword">));<br />
echo </span><span class="string">'&lt;br&gt;'</span><span class="keyword">;<br />
</span><span class="default">$a </span><span class="keyword">= </span><span class="default">$myarray</span><span class="keyword">;<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">current</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
Would output 'b' and then 'a' since the internal pointer wasn't copied. You can cope with that problem using references instead, like that:<br />
<br />
<span class="default">&lt;?php<br />
$a </span><span class="keyword">=&amp; </span><span class="default">$myarray</span><span class="keyword">;<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="29950""></a>
  <div class="note">
   <strong class="user">retestro_REMOVE at SPAM_esperanto dot org dot il</strong>
   <a href="#29950" class="date">01-Mar-2003 06:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The docs do not specify this, but adding to the array using the brackets syntax:
<br />
&nbsp;&nbsp; &nbsp; <span class="default">&lt;?php $my_array</span><span class="keyword">[] = </span><span class="default">$new_value</span><span class="keyword">; </span><span class="default">?&gt;
<br />
</span>will not advance the internal pointer of the array. therefore, you cannot use current() to get the last value added or key() to get the key of the most recently added element.
<br />

<br />
You should do an end($my_array) to advance the internal pointer to the end ( as stated in one of the notes on end() ), then
<br />

<br />
&nbsp;&nbsp;&nbsp; <span class="default">&lt;?php
<br />
&nbsp;&nbsp; &nbsp; $last_key </span><span class="keyword">= </span><span class="default">key</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">);&nbsp; </span><span class="comment">// will return the key
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$last_value </span><span class="keyword">= </span><span class="default">current</span><span class="keyword">(</span><span class="default">$my_array</span><span class="keyword">);&nbsp; </span><span class="comment">// will return the value
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">?&gt;
<br />
</span>
<br />
If you have no need in the key, $last_value = end($my_array) will also do the job.
<br />

<br />
- Sergey.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
