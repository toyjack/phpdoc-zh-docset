<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>查找字符串首次出现的位置</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.strpbrk.html">? strpbrk</a></li>
      <li style="float: right;"><a href="function.strrchr.html">strrchr ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.strings.html">字符串 函数</a></li>
    <li>查找字符串首次出现的位置</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.strpos" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">strpos</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">strpos</span> &mdash; <span class="dc-title">查找字符串首次出现的位置</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.strpos-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>strpos</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$haystack</code></span>, <span class="methodparam"><span class="type"><a href="language.types.declarations.html#language.types.declarations.mixed" class="type mixed">mixed</a></span> <code class="parameter">$needle</code></span>, <span class="methodparam"><span class="type">int</span> <code class="parameter">$offset</code><span class="initializer"> = 0</span></span>): <span class="type">int</span></div>

  <p class="para rdfs-comment">
   返回 <code class="parameter">needle</code> 在 <code class="parameter">haystack</code> 中首次出现的数字位置。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.strpos-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">haystack</code></dt>

     <dd>

      <p class="para">
       在该字符串中进行查找。
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">needle</code></dt>

     <dd>

      
 <p class="para">
  Prior to PHP 8.0.0, if <code class="parameter">needle</code> is not a string, it is converted
  to an integer and applied as the ordinal value of a character.
  This behavior is deprecated as of PHP 7.3.0, and relying on it is highly
  discouraged. Depending on the intended behavior, the
  <code class="parameter">needle</code> should either be explicitly cast to string,
  or an explicit call to <span class="function"><a href="function.chr.html" class="function">chr()</a></span> should be performed.
 </p>

     </dd>

    
    
     <dt>
<code class="parameter">offset</code></dt>

     <dd>

      <p class="para">    
       如果提供了此参数，搜索会从字符串该字符数的起始位置开始统计。
       如果是负数，搜索会从字符串结尾指定字符数开始。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.strpos-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   返回 needle 存在于 <code class="parameter">haystack</code> 字符串起始的位置(独立于 offset)。同时注意字符串位置是从0开始，而不是从1开始的。
  </p>
  <p class="para">
   如果没找到 needle，将返回 <strong><code>false</code></strong>。
  </p>
  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">此函数可能返回布尔值
<strong><code>false</code></strong>，但也可能返回等同于 <strong><code>false</code></strong> 的非布尔值。请阅读 <a href="language.types.boolean.html" class="link">布尔类型</a>章节以获取更多信息。应使用
<a href="language.operators.comparison.html" class="link">===
运算符</a>来测试此函数的返回值。</p></div>
 </div>


 <div class="refsect1 changelog" id="refsect1-function.strpos-changelog">
  <h3 class="title">更新日志</h3>
  <table class="doctable informaltable">
   
    <thead>
     <tr>
      <th>版本</th>
      <th>说明</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>7.1.0</td>
      <td>
       开始支持负数的 <code class="parameter">offset</code>。
      </td>
     </tr>

    </tbody>
   
  </table>

 </div>


 <div class="refsect1 examples" id="refsect1-function.strpos-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-4742">
    <p><strong>Example #1 使用 <code class="literal">===</code></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mystring&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'abc'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$findme&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'a'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$pos&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$mystring</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$findme</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;注意这里使用的是&nbsp;===。简单的&nbsp;==&nbsp;不能像我们期待的那样工作，<br />//&nbsp;因为&nbsp;'a'&nbsp;是第&nbsp;0&nbsp;位置上的（第一个）字符。<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$pos&nbsp;</span><span style="color: #007700">===&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"The&nbsp;string&nbsp;'</span><span style="color: #0000BB">$findme</span><span style="color: #DD0000">'&nbsp;was&nbsp;not&nbsp;found&nbsp;in&nbsp;the&nbsp;string&nbsp;'</span><span style="color: #0000BB">$mystring</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"The&nbsp;string&nbsp;'</span><span style="color: #0000BB">$findme</span><span style="color: #DD0000">'&nbsp;was&nbsp;found&nbsp;in&nbsp;the&nbsp;string&nbsp;'</span><span style="color: #0000BB">$mystring</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&nbsp;and&nbsp;exists&nbsp;at&nbsp;position&nbsp;</span><span style="color: #0000BB">$pos</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>

   <div class="example" id="example-4743">
    <p><strong>Example #2 使用 !==</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$mystring&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'abc'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$findme&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'a'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$pos&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$mystring</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$findme</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;使用&nbsp;!==&nbsp;操作符。使用&nbsp;!=&nbsp;不能像我们期待的那样工作，<br />//&nbsp;因为&nbsp;'a'&nbsp;的位置是&nbsp;0。语句&nbsp;(0&nbsp;!=&nbsp;false)&nbsp;的结果是&nbsp;false。<br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$pos&nbsp;</span><span style="color: #007700">!==&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"The&nbsp;string&nbsp;'</span><span style="color: #0000BB">$findme</span><span style="color: #DD0000">'&nbsp;was&nbsp;found&nbsp;in&nbsp;the&nbsp;string&nbsp;'</span><span style="color: #0000BB">$mystring</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"&nbsp;and&nbsp;exists&nbsp;at&nbsp;position&nbsp;</span><span style="color: #0000BB">$pos</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"The&nbsp;string&nbsp;'</span><span style="color: #0000BB">$findme</span><span style="color: #DD0000">'&nbsp;was&nbsp;not&nbsp;found&nbsp;in&nbsp;the&nbsp;string&nbsp;'</span><span style="color: #0000BB">$mystring</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>

   <div class="example" id="example-4744">
    <p><strong>Example #3 使用位置偏移量</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;忽视位置偏移量之前的字符进行查找<br /></span><span style="color: #0000BB">$newstring&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'abcdef&nbsp;abcdef'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$pos&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$newstring</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'a'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;$pos&nbsp;=&nbsp;7,&nbsp;不是&nbsp;0<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.strpos-notes">
  <h3 class="title">注释</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">此函数可安全用于二进制对象。</span></p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.strpos-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.stripos.html" class="function" rel="rdfs-seeAlso">stripos()</a> - 查找字符串首次出现的位置（不区分大小写）</span></li>
    <li class="member"><span class="function"><a href="function.strrpos.html" class="function" rel="rdfs-seeAlso">strrpos()</a> - 计算指定字符串在目标字符串中最后一次出现的位置</span></li>
    <li class="member"><span class="function"><a href="function.strripos.html" class="function" rel="rdfs-seeAlso">strripos()</a> - 计算指定字符串在目标字符串中最后一次出现的位置（不区分大小写）</span></li>
    <li class="member"><span class="function"><a href="function.strstr.html" class="function" rel="rdfs-seeAlso">strstr()</a> - 查找字符串的首次出现</span></li>
    <li class="member"><span class="function"><a href="function.strpbrk.html" class="function" rel="rdfs-seeAlso">strpbrk()</a> - 在字符串中查找一组字符的任何一个字符</span></li>
    <li class="member"><span class="function"><a href="function.substr.html" class="function" rel="rdfs-seeAlso">substr()</a> - 返回字符串的子串</span></li>
    <li class="member"><span class="function"><a href="function.preg-match.html" class="function" rel="rdfs-seeAlso">preg_match()</a> - 执行匹配正则表达式</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="125535""></a>
  <div class="note">
   <strong class="user">sunmacet at gmail dot com</strong>
   <a href="#125535" class="date">23-Nov-2020 10:14</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To check that a substring is present.<br />
<br />
Confusing check if position is not false:<br />
<br />
if ( strpos ( $haystack , $needle ) !== FALSE )<br />
<br />
Logical check if there is position:<br />
<br />
if ( is_int ( strpos ( $haystack , $needle ) ) )</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="124562""></a>
  <div class="note">
   <strong class="user">ds at kala-it dot de</strong>
   <a href="#124562" class="date">03-Jan-2020 09:35</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note this code example below in PHP 7.3<br />
<span class="default">&lt;?php<br />
$str </span><span class="keyword">= </span><span class="string">"17,25"</span><span class="keyword">;<br />
<br />
if(</span><span class="default">FALSE </span><span class="keyword">!== </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">25</span><span class="keyword">)){<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"25 is inside of str"</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"25 is NOT inside of str"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Will output "25 is NOT inside of str" and will throw out a deprication message, that non string needles will be interpreted as strings in the future.<br />
<br />
This just gave me some headache since the value I am checking against comes from the database as an integer.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123918""></a>
  <div class="note">
   <strong class="user">hu60 dot cn at gmail dot com</strong>
   <a href="#123918" class="date">09-Jun-2019 01:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A more accurate imitation of the PHP function session_start().<br />
<br />
Function my_session_start() does something similar to session_start() that has the default configure, and the session files generated by the two are binary compatible.<br />
<br />
The code may help people increase their understanding of the principles of the PHP session.<br />
<br />
<span class="default">&lt;?php<br />
error_reporting</span><span class="keyword">(</span><span class="default">E_ALL</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'display_errors'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
</span><span class="default">ini_set</span><span class="keyword">(</span><span class="string">'session.save_path'</span><span class="keyword">, </span><span class="default">__DIR__</span><span class="keyword">);<br />
<br />
</span><span class="default">my_session_start</span><span class="keyword">();<br />
<br />
echo </span><span class="string">'&lt;p&gt;session id: '</span><span class="keyword">.</span><span class="default">my_session_id</span><span class="keyword">().</span><span class="string">'&lt;/p&gt;'</span><span class="keyword">;<br />
<br />
echo </span><span class="string">'&lt;code&gt;&lt;pre&gt;'</span><span class="keyword">;<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">);<br />
echo </span><span class="string">'&lt;/pre&gt;&lt;/code&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="default">$now </span><span class="keyword">= </span><span class="default">date</span><span class="keyword">(</span><span class="string">'H:i:s'</span><span class="keyword">);<br />
if (isset(</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'last_visit_time'</span><span class="keyword">])) {<br />
&nbsp; echo </span><span class="string">'&lt;p&gt;Last Visit Time: '</span><span class="keyword">.</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'last_visit_time'</span><span class="keyword">].</span><span class="string">'&lt;/p&gt;'</span><span class="keyword">;<br />
}<br />
echo </span><span class="string">'&lt;p&gt;Current Time: '</span><span class="keyword">.</span><span class="default">$now</span><span class="keyword">.</span><span class="string">'&lt;/p&gt;'</span><span class="keyword">;<br />
<br />
</span><span class="default">$_SESSION</span><span class="keyword">[</span><span class="string">'last_visit_time'</span><span class="keyword">] = </span><span class="default">$now</span><span class="keyword">;<br />
<br />
function </span><span class="default">my_session_start</span><span class="keyword">() {<br />
&nbsp; global </span><span class="default">$phpsessid</span><span class="keyword">, </span><span class="default">$sessfile</span><span class="keyword">;<br />
&nbsp;<br />
&nbsp; if (!isset(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">]) || empty(</span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">])) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$phpsessid </span><span class="keyword">= </span><span class="default">my_base32_encode</span><span class="keyword">(</span><span class="default">my_random_bytes</span><span class="keyword">(</span><span class="default">16</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">setcookie</span><span class="keyword">(</span><span class="string">'PHPSESSID'</span><span class="keyword">, </span><span class="default">$phpsessid</span><span class="keyword">, </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.cookie_lifetime'</span><span class="keyword">), </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.cookie_path'</span><span class="keyword">), </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.cookie_domain'</span><span class="keyword">), </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.cookie_secure'</span><span class="keyword">), </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.cookie_httponly'</span><span class="keyword">));<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$phpsessid </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/[^a-z0-9]/'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">, </span><span class="default">$_COOKIE</span><span class="keyword">[</span><span class="string">'PHPSESSID'</span><span class="keyword">]), </span><span class="default">0</span><span class="keyword">, </span><span class="default">26</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp;<br />
&nbsp; </span><span class="default">$sessfile </span><span class="keyword">= </span><span class="default">ini_get</span><span class="keyword">(</span><span class="string">'session.save_path'</span><span class="keyword">).</span><span class="string">'/sess_'</span><span class="keyword">.</span><span class="default">$phpsessid</span><span class="keyword">;<br />
&nbsp; if (</span><span class="default">is_file</span><span class="keyword">(</span><span class="default">$sessfile</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= </span><span class="default">my_unserialize</span><span class="keyword">(</span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$sessfile</span><span class="keyword">));<br />
&nbsp; } else {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$_SESSION </span><span class="keyword">= array();<br />
&nbsp; }<br />
&nbsp; </span><span class="default">register_shutdown_function</span><span class="keyword">(</span><span class="string">'my_session_save'</span><span class="keyword">);<br />
}<br />
<br />
function </span><span class="default">my_session_save</span><span class="keyword">() {<br />
&nbsp; global </span><span class="default">$sessfile</span><span class="keyword">;<br />
&nbsp;<br />
&nbsp; </span><span class="default">file_put_contents</span><span class="keyword">(</span><span class="default">$sessfile</span><span class="keyword">, </span><span class="default">my_serialize</span><span class="keyword">(</span><span class="default">$_SESSION</span><span class="keyword">));<br />
}<br />
<br />
function </span><span class="default">my_session_id</span><span class="keyword">() {<br />
&nbsp; global </span><span class="default">$phpsessid</span><span class="keyword">;<br />
&nbsp; return </span><span class="default">$phpsessid</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">my_serialize</span><span class="keyword">(</span><span class="default">$data</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp; foreach (</span><span class="default">$data </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">=&gt;</span><span class="default">$v</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// key cannot contains '|'<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$k</span><span class="keyword">, </span><span class="string">'|'</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text</span><span class="keyword">.=</span><span class="default">$k</span><span class="keyword">.</span><span class="string">'|'</span><span class="keyword">.</span><span class="default">serialize</span><span class="keyword">(</span><span class="default">$v</span><span class="keyword">).</span><span class="string">"\n"</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$text</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">my_unserialize</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$data </span><span class="keyword">= [];<br />
&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
&nbsp; foreach (</span><span class="default">$text </span><span class="keyword">as </span><span class="default">$line</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="string">'|'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$pos </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$data</span><span class="keyword">[</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">)] = </span><span class="default">unserialize</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">));<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$data</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">my_random_bytes</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">) {<br />
&nbsp; if (</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'random_bytes'</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">random_bytes</span><span class="keyword">(</span><span class="default">$length</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$randomString </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$length</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) { <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$randomString </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">rand</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">255</span><span class="keyword">));<br />
&nbsp; } <br />
&nbsp; return </span><span class="default">$randomString</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">my_base32_encode</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">) {<br />
&nbsp; </span><span class="default">$BASE32_ALPHABET </span><span class="keyword">= </span><span class="string">'abcdefghijklmnopqrstuvwxyz234567'</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$output </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$vbits </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$j </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$j</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">&lt;&lt;= </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">+= </span><span class="default">ord</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$vbits </span><span class="keyword">+= </span><span class="default">8</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">$vbits </span><span class="keyword">&gt;= </span><span class="default">5</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$vbits </span><span class="keyword">-= </span><span class="default">5</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$BASE32_ALPHABET</span><span class="keyword">[</span><span class="default">$v </span><span class="keyword">&gt;&gt; </span><span class="default">$vbits</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">&amp;= ((</span><span class="default">1 </span><span class="keyword">&lt;&lt; </span><span class="default">$vbits</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; if (</span><span class="default">$vbits </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">&lt;&lt;= (</span><span class="default">5 </span><span class="keyword">- </span><span class="default">$vbits</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$output </span><span class="keyword">.= </span><span class="default">$BASE32_ALPHABET</span><span class="keyword">[</span><span class="default">$v</span><span class="keyword">];<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$output</span><span class="keyword">;<br />
}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123659""></a>
  <div class="note">
   <strong class="user">Jean</strong>
   <a href="#123659" class="date">05-Mar-2019 05:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When a value can be of "unknow" type, I find this conversion trick usefull and more readable than a formal casting (for php7.3+):<br />
<br />
<span class="default">&lt;?php<br />
$time </span><span class="keyword">= </span><span class="default">time</span><span class="keyword">();<br />
</span><span class="default">$string </span><span class="keyword">= </span><span class="string">'This is a test: ' </span><span class="keyword">. </span><span class="default">$time</span><span class="keyword">;<br />
echo (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$time</span><span class="keyword">) !== </span><span class="default">false </span><span class="keyword">? </span><span class="string">'found' </span><span class="keyword">: </span><span class="string">'not found'</span><span class="keyword">);<br />
echo (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="string">"</span><span class="default">$time</span><span class="string">"</span><span class="keyword">) !== </span><span class="default">false </span><span class="keyword">? </span><span class="string">'found' </span><span class="keyword">: </span><span class="string">'not found'</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="123115""></a>
  <div class="note">
   <strong class="user">amolocaleb at gmail dot com</strong>
   <a href="#123115" class="date">06-Sep-2018 03:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that strpos() is case sensitive,so when doing a case insensitive search,use stripos() instead..If the latter is not available,subject the string to strlower() first,otherwise you may end up in this situation..<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//say we are matching url routes and calling access control middleware depending on the route<br />
<br />
</span><span class="default">$registered_route </span><span class="keyword">= </span><span class="string">'/admin' </span><span class="keyword">;<br />
</span><span class="comment">//now suppose we want to call the authorization middleware before accessing the admin route <br />
</span><span class="keyword">if(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">(),</span><span class="default">$registered_route</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$middleware</span><span class="keyword">-&gt;</span><span class="default">call</span><span class="keyword">(</span><span class="string">'Auth'</span><span class="keyword">,</span><span class="string">'login'</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span>and the auth middleware is as follows<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Auth</span><span class="keyword">{<br />
<br />
function </span><span class="default">login</span><span class="keyword">(){<br />
&nbsp;&nbsp; if(!</span><span class="default">loggedIn</span><span class="keyword">()){<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">redirect</span><span class="keyword">(</span><span class="string">"path/to/login.php"</span><span class="keyword">);<br />
}<br />
return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
}<br />
<br />
</span><span class="comment">//Now suppose:<br />
</span><span class="default">$user_url </span><span class="keyword">= </span><span class="string">'/admin'</span><span class="keyword">;<br />
</span><span class="comment">//this will go to the Auth middleware for checks and redirect accordingly<br />
<br />
//But:<br />
</span><span class="default">$user_url </span><span class="keyword">= </span><span class="string">'/Admin'</span><span class="keyword">;<br />
</span><span class="comment">//this will make the strpos function return false since the 'A' in admin is upper case and user will be taken directly to admin dashboard authentication and authorization notwithstanding<br />
</span><span class="default">?&gt;<br />
</span>Simple fixes:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">//use stripos() as from php 5<br />
</span><span class="keyword">if(</span><span class="default">stripos</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">(),</span><span class="default">$registered_route</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$middleware</span><span class="keyword">-&gt;</span><span class="default">call</span><span class="keyword">(</span><span class="string">'Auth'</span><span class="keyword">,</span><span class="string">'login'</span><span class="keyword">);<br />
}<br />
</span><span class="comment">//for those with php 4<br />
</span><span class="keyword">if(</span><span class="default">stripos</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$path</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">()),</span><span class="default">$registered_route</span><span class="keyword">) === </span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$middleware</span><span class="keyword">-&gt;</span><span class="default">call</span><span class="keyword">(</span><span class="string">'Auth'</span><span class="keyword">,</span><span class="string">'login'</span><span class="keyword">);<br />
}<br />
</span><span class="comment">//make sure the $registered_route is also lowercase.Or JUST UPGRADE to PHP 5&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122956""></a>
  <div class="note">
   <strong class="user">msegit post pl</strong>
   <a href="#122956" class="date">18-Jul-2018 12:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might be useful, I often use for parsing file paths etc.<br />
(Some examples inside https://gist.github.com/msegu/bf7160257037ec3e301e7e9c8b05b00a )<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
* Function 'strpos_' finds the position of the first or last occurrence of a substring in a string, ignoring number of characters<br />
*<br />
* Function 'strpos_' is similar to 'str[r]pos()', except:<br />
* 1. fourth (last, optional) param tells, what to return if str[r]pos()===false<br />
* 2. third (optional) param $offset tells as of str[r]pos(), BUT if negative (&lt;0) search starts -$offset characters counted from the end AND skips (ignore!, not as 'strpos' and 'strrpos') -$offset-1 characters from the end AND search backwards<br />
*<br />
* @param string $haystack Where to search<br />
* @param string $needle What to find<br />
* @param int $offset (optional) Number of characters to skip from the beginning (if 0, &gt;0) or from the end (if &lt;0) of $haystack<br />
* @param mixed $resultIfFalse (optional) Result, if not found<br />
*&nbsp; &nbsp; Example:<br />
*&nbsp; &nbsp; positive $offset - like strpos:<br />
*&nbsp; &nbsp; &nbsp; &nbsp; strpos_('abcaba','ab',1)==strpos('abcaba','ab',1)==3, strpos('abcaba','ab',4)===false, strpos_('abcaba','ab',4,'Not found')==='Not found'<br />
*&nbsp; &nbsp; negative $offset - similar to strrpos:<br />
*&nbsp; &nbsp; &nbsp; &nbsp; strpos_('abcaba','ab',-1)==strpos('abcaba','ab',-1)==3, strrpos('abcaba','ab',-3)==3 BUT strpos_('abcaba','ab',-3)===0 (omits 2 characters from the end, because -2-1=-3, means search in 'abca'!)<br />
*<br />
* @result int $offset Returns offset (or false), or $resultIfFalse<br />
*/<br />
</span><span class="keyword">function </span><span class="default">strpos_</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$resultIfFalse </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$haystack</span><span class="keyword">=((string)</span><span class="default">$haystack</span><span class="keyword">);&nbsp; &nbsp; </span><span class="comment">// (string) to avoid errors with int, float...<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$needle</span><span class="keyword">=((string)</span><span class="default">$needle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$offset</span><span class="keyword">&gt;=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ((</span><span class="default">$offset</span><span class="keyword">===</span><span class="default">false</span><span class="keyword">)? </span><span class="default">$resultIfFalse </span><span class="keyword">: </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack</span><span class="keyword">=</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$needle</span><span class="keyword">=</span><span class="default">strrev</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,-</span><span class="default">$offset</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ((</span><span class="default">$offset</span><span class="keyword">===</span><span class="default">false</span><span class="keyword">)? </span><span class="default">$resultIfFalse </span><span class="keyword">: </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">)-</span><span class="default">$offset</span><span class="keyword">-</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="122639""></a>
  <div class="note">
   <strong class="user">marvin_elia at web dot de</strong>
   <a href="#122639" class="date">19-Apr-2018 09:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Find position of nth occurrence of a string:<br />
<br />
&nbsp;&nbsp;&nbsp; function strpos_occurrence(string $string, string $needle, int $occurrence, int $offset = null) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if((0 &lt; $occurrence) &amp;&amp; ($length = strlen($needle))) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } while ((false !== $offset = strpos($string, $needle, $offset)) &amp;&amp; --$occurrence &amp;&amp; ($offset += $length));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return $offset;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return false;<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121915""></a>
  <div class="note">
   <strong class="user">greg at spotx dot net</strong>
   <a href="#121915" class="date">27-Nov-2017 12:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Warning:<br />
this is not unicode safe<br />
<br />
strpos($word,'?') in e?ez-&gt; 1 <br />
strpos($word,'?') in è?ent-&gt; 2</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121715""></a>
  <div class="note">
   <strong class="user">Lhenry</strong>
   <a href="#121715" class="date">03-Oct-2017 09:34</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
note that strpos( "8 june 1970"&nbsp; ,&nbsp; 1970 ) returns FALSE.. <br />
<br />
add quotes to the needle</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="121006""></a>
  <div class="note">
   <strong class="user">eef dot vreeland at gmail dot com</strong>
   <a href="#121006" class="date">22-Apr-2017 01:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To prevent others from staring at the text, note that the wording of the 'Return Values' section is ambiguous.<br />
<br />
Let's say you have a string $myString containing 50 'a's except on position 3 and 43, they contain 'b'.<br />
And for this moment, forget that counting starts from 0.<br />
<br />
strpos($myString, 'b', 40) returns 43, great.<br />
<br />
And now the text: "Returns the position of where the needle exists relative to the beginning of the haystack string (independent of offset)."<br />
<br />
So it doesn't really matter what offset I specify; I'll get the REAL position of the first occurrence in return, which is 3?<br />
<br />
... no ...<br />
<br />
"independent of offset" means, you will get the REAL positions, thus, not relative to your starting point (offset).<br />
<br />
Substract your offset from strpos()'s answer, then you have the position relative to YOUR offset.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120505""></a>
  <div class="note">
   <strong class="user">jexy dot ru at gmail dot com</strong>
   <a href="#120505" class="date">23-Jan-2017 08:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Docs are missing that WARNING is issued if needle is '' (empty string).<br />
<br />
In case of empty haystack it just return false:<br />
<br />
For example:<br />
<br />
<span class="default">&lt;?php<br />
var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">));<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">'foo'</span><span class="keyword">));<br />
<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">''</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
will output:<br />
<br />
Warning: strpos(): Empty needle in /in/lADCh on line 3 <br />
bool(false) <br />
<br />
bool(false) <br />
<br />
Warning: strpos(): Empty needle in /in/lADCh on line 7 <br />
bool(false)<br />
<br />
Note also that warning text may differ depending on php version, see https://3v4l.org/lADCh</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119853""></a>
  <div class="note">
   <strong class="user">m.m.j.kronenburg</strong>
   <a href="#119853" class="date">06-Sep-2016 10:56</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Find the position of the first occurrence of one or more substrings in a <br />
&nbsp;* string.<br />
&nbsp;* <br />
&nbsp;* This function is simulair to function strpos() except that it allows to <br />
&nbsp;* search for multiple needles at once.<br />
&nbsp;*<br />
&nbsp;* @param string $haystack&nbsp; &nbsp; The string to search in.<br />
&nbsp;* @param mixed $needles&nbsp; &nbsp; &nbsp; Array containing needles or string containing <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; needle.<br />
&nbsp;* @param integer $offset&nbsp; &nbsp;&nbsp; If specified, search will start this number of <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; characters counted from the beginning of the <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string.<br />
&nbsp;* @param boolean $last&nbsp; &nbsp; &nbsp;&nbsp; If TRUE then the farthest position from the start <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of one of the needles is returned.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If FALSE then the smallest position from start of <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; one of the needles is returned.<br />
&nbsp;**/<br />
</span><span class="keyword">function </span><span class="default">mstrpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$last </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$needles</span><span class="keyword">)) { </span><span class="default">$needles </span><span class="keyword">= array(</span><span class="default">$needles</span><span class="keyword">); }<br />
&nbsp; </span><span class="default">$found </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; foreach(</span><span class="default">$needles </span><span class="keyword">as </span><span class="default">$needle</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$position </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, (string)</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$position </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) { continue; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exp </span><span class="keyword">= </span><span class="default">$last </span><span class="keyword">? (</span><span class="default">$found </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">|| </span><span class="default">$position </span><span class="keyword">&gt; </span><span class="default">$found</span><span class="keyword">) : <br />
&nbsp;&nbsp; &nbsp;&nbsp; (</span><span class="default">$found </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">|| </span><span class="default">$position </span><span class="keyword">&lt; </span><span class="default">$found</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$exp</span><span class="keyword">) { </span><span class="default">$found </span><span class="keyword">= </span><span class="default">$position</span><span class="keyword">; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$found</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Find the position of the first (partially) occurrence of a substring in a <br />
&nbsp;* string.<br />
&nbsp;* <br />
&nbsp;* This function is simulair to function strpos() except that it wil return a <br />
&nbsp;* position when the substring is partially located at the end of the string.<br />
&nbsp;*<br />
&nbsp;* @param string $haystack&nbsp; &nbsp; The string to search in.<br />
&nbsp;* @param mixed $needle&nbsp; &nbsp; &nbsp;&nbsp; The needle to search for.<br />
&nbsp;* @param integer $offset&nbsp; &nbsp;&nbsp; If specified, search will start this number of <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; characters counted from the beginning of the <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string.<br />
&nbsp;**/<br />
</span><span class="keyword">function </span><span class="default">pstrpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$position </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp; if(</span><span class="default">$position </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) { return </span><span class="default">$position</span><span class="keyword">; }<br />
&nbsp; <br />
&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">--)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">) == </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, -</span><span class="default">$i</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; { return </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">) - </span><span class="default">$i</span><span class="keyword">; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Find the position of the first (partially) occurrence of one or more <br />
&nbsp;* substrings in a string.<br />
&nbsp;* <br />
&nbsp;* This function is simulair to function strpos() except that it allows to <br />
&nbsp;* search for multiple needles at once and it wil return a position when one of<br />
&nbsp;* the substrings is partially located at the end of the string.<br />
&nbsp;*<br />
&nbsp;* @param string $haystack&nbsp; &nbsp; The string to search in.<br />
&nbsp;* @param mixed $needles&nbsp; &nbsp; &nbsp; Array containing needles or string containing <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; needle.<br />
&nbsp;* @param integer $offset&nbsp; &nbsp;&nbsp; If specified, search will start this number of <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; characters counted from the beginning of the <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string.<br />
&nbsp;* @param boolean $last&nbsp; &nbsp; &nbsp;&nbsp; If TRUE then the farthest position from the start <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; of one of the needles is returned.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If FALSE then the smallest position from start of <br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; one of the needles is returned.<br />
&nbsp;**/<br />
</span><span class="keyword">function </span><span class="default">mpstrpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$last </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$needles</span><span class="keyword">)) { </span><span class="default">$needles </span><span class="keyword">= array(</span><span class="default">$needles</span><span class="keyword">); }<br />
&nbsp; </span><span class="default">$found </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp; foreach(</span><span class="default">$needles </span><span class="keyword">as </span><span class="default">$needle</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$position </span><span class="keyword">= </span><span class="default">pstrpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, (string)</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$position </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) { continue; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$exp </span><span class="keyword">= </span><span class="default">$last </span><span class="keyword">? (</span><span class="default">$found </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">|| </span><span class="default">$position </span><span class="keyword">&gt; </span><span class="default">$found</span><span class="keyword">) : <br />
&nbsp;&nbsp; &nbsp;&nbsp; (</span><span class="default">$found </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">|| </span><span class="default">$position </span><span class="keyword">&lt; </span><span class="default">$found</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$exp</span><span class="keyword">) { </span><span class="default">$found </span><span class="keyword">= </span><span class="default">$position</span><span class="keyword">; }<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$found</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118905""></a>
  <div class="note">
   <strong class="user">fabio at naoimporta dot com</strong>
   <a href="#118905" class="date">25-Feb-2016 04:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It is interesting to be aware of the behavior when the treatment of strings with characters using different encodings.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment"># Works like expected. There is no accent<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">"Fabio"</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">));<br />
</span><span class="comment">#int(2)<br />
<br />
# The "á" letter is occupying two positions<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">"Fábio"</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">)) ;<br />
</span><span class="comment">#int(3)<br />
<br />
# Now, encoding the string "Fábio" to utf8, we get some "unexpected" outputs. Every letter that is no in regular ASCII table, will use 4 positions(bytes). The starting point remains like before.<br />
# We cant find the characted, because the haystack string is now encoded.<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="string">"Fábio"</span><span class="keyword">), </span><span class="string">'á'</span><span class="keyword">));<br />
</span><span class="comment">#bool(false)<br />
<br />
# To get the expected result, we need to encode the needle too<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="string">"Fábio"</span><span class="keyword">), </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="string">'á'</span><span class="keyword">)));<br />
</span><span class="comment">#int(1) <br />
<br />
# And, like said before, "á" occupies 4 positions(bytes)<br />
</span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="string">"Fábio"</span><span class="keyword">), </span><span class="string">'b'</span><span class="keyword">));<br />
</span><span class="comment">#int(5)</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117028""></a>
  <div class="note">
   <strong class="user">lairdshaw at yahoo dot com dot au</strong>
   <a href="#117028" class="date">03-Apr-2015 06:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
&nbsp;* A strpos variant that accepts an array of $needles - or just a string,<br />
&nbsp;* so that it can be used as a drop-in replacement for the standard strpos,<br />
&nbsp;* and in which case it simply wraps around strpos and stripos so as not<br />
&nbsp;* to reduce performance.<br />
&nbsp;*<br />
&nbsp;* The "m" in "strposm" indicates that it accepts *m*ultiple needles.<br />
&nbsp;*<br />
&nbsp;* Finds the earliest match of *all* needles. Returns the position of this match<br />
&nbsp;* or false if none found, as does the standard strpos. Optionally also returns<br />
&nbsp;* via $match either the matching needle as a string (by default) or the index<br />
&nbsp;* into $needles of the matching needle (if the STRPOSM_MATCH_AS_INDEX flag is<br />
&nbsp;* set).<br />
&nbsp;*<br />
&nbsp;* Case-insensitive searching can be specified via the STRPOSM_CI flag.<br />
&nbsp;* Note that for case-insensitive searches, if the STRPOSM_MATCH_AS_INDEX is<br />
&nbsp;* not set, then $match will be in the haystack's case, not the needle's case,<br />
&nbsp;* unless the STRPOSM_NC flag is also set.<br />
&nbsp;*<br />
&nbsp;* Flags can be combined using the bitwise or operator,<br />
&nbsp;* e.g. $flags = STRPOSM_CI|STRPOSM_NC<br />
&nbsp;*/<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'STRPOSM_CI'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">, </span><span class="default">1</span><span class="keyword">); </span><span class="comment">// CI =&gt; "case insensitive".<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'STRPOSM_NC'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">, </span><span class="default">2</span><span class="keyword">); </span><span class="comment">// NC =&gt; "needle case".<br />
</span><span class="default">define</span><span class="keyword">(</span><span class="string">'STRPOSM_MATCH_AS_INDEX'</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">);<br />
function </span><span class="default">strposm</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, &amp;</span><span class="default">$match </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$flags </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// In the special case where $needles is not an array, simply wrap<br />
&nbsp;&nbsp;&nbsp; // strpos and stripos for performance reasons.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$needles</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$func </span><span class="keyword">= </span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_CI </span><span class="keyword">? </span><span class="string">'stripos' </span><span class="keyword">: </span><span class="string">'strpos'</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">$func</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$pos </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$match </span><span class="keyword">= ((</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_MATCH_AS_INDEX</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ? </span><span class="default">0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">: ((</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_NC</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? </span><span class="default">$needles<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">: </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needles</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$pos</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else&nbsp; &nbsp; goto </span><span class="default">strposm_no_match</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// $needles is an array. Proceed appropriately, initially by...<br />
&nbsp;&nbsp;&nbsp; // ...escaping regular expression meta characters in the needles.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$needles_esc </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'preg_quote'</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// If either of the "needle case" or "match as index" flags are set,<br />
&nbsp;&nbsp;&nbsp; // then create a sub-match for each escaped needle by enclosing it in<br />
&nbsp;&nbsp;&nbsp; // parentheses. We use these later to find the index of the matching<br />
&nbsp;&nbsp;&nbsp; // needle.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if ((</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_NC</span><span class="keyword">) || (</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_MATCH_AS_INDEX</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$needles_esc </span><span class="keyword">= </span><span class="default">array_map</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; function(</span><span class="default">$needle</span><span class="keyword">) {return </span><span class="string">'('</span><span class="keyword">.</span><span class="default">$needle</span><span class="keyword">.</span><span class="string">')'</span><span class="keyword">;},<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$needles_esc<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Create the regular expression pattern to search for all needles.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pattern </span><span class="keyword">= </span><span class="string">'('</span><span class="keyword">.</span><span class="default">implode</span><span class="keyword">(</span><span class="string">'|'</span><span class="keyword">, </span><span class="default">$needles_esc</span><span class="keyword">).</span><span class="string">')'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// If the "case insensitive" flag is set, then modify the regular<br />
&nbsp;&nbsp;&nbsp; // expression with "i", meaning that the match is "caseless".<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_CI</span><span class="keyword">) </span><span class="default">$pattern </span><span class="keyword">.= </span><span class="string">'i'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Find the first match, including its offset.<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">, </span><span class="default">PREG_OFFSET_CAPTURE</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Pull the first entry, the overall match, out of the matches array.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$found </span><span class="keyword">= </span><span class="default">array_shift</span><span class="keyword">(</span><span class="default">$matches</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// If we need the index of the matching needle, then...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if ((</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_NC</span><span class="keyword">) || (</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_MATCH_AS_INDEX</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ...find the index of the sub-match that is identical<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // to the overall match that we just pulled out.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // Because sub-matches are in the same order as needles,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // this is also the index into $needles of the matching<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // needle.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$index </span><span class="keyword">= </span><span class="default">array_search</span><span class="keyword">(</span><span class="default">$found</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// If the "match as index" flag is set, then return in $match<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // the matching needle's index, otherwise...<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$match </span><span class="keyword">= ((</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_MATCH_AS_INDEX</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ? </span><span class="default">$index<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// ...if the "needle case" flag is set, then index into<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // $needles using the previously-determined index to return<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; // in $match the matching needle in needle case, otherwise...<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">: ((</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_NC</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? </span><span class="default">$needles</span><span class="keyword">[</span><span class="default">$index</span><span class="keyword">]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// ...by default, return in $match the matching needle in<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // haystack case.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">: </span><span class="default">$found</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; )<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Return the captured offset.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$found</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
</span><span class="default">strposm_no_match</span><span class="keyword">:<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Nothing matched. Set appropriate return values.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$match </span><span class="keyword">= (</span><span class="default">$flags </span><span class="keyword">&amp; </span><span class="default">STRPOSM_MATCH_AS_INDEX</span><span class="keyword">) ? </span><span class="default">false </span><span class="keyword">: </span><span class="default">null</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116062""></a>
  <div class="note">
   <strong class="user">qrworld.net</strong>
   <a href="#116062" class="date">04-Nov-2014 04:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I found a function in this post <a href="http://softontherocks.blogspot.com/2014/11/buscar-multiples-textos-en-un-texto-con.html " rel="nofollow" target="_blank">http://softontherocks.blogspot.com/2014/11/buscar-multiples-textos-en-un-texto-con.html </a><br />
that implements the search in both ways, case sensitive or case insensitive, depending on an input parameter.<br />
<br />
The function is:<br />
<br />
function getMultiPos($haystack, $needles, $sensitive=true, $offset=0){<br />
&nbsp;&nbsp;&nbsp; foreach($needles as $needle) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $result[$needle] = ($sensitive) ? strpos($haystack, $needle, $offset) : stripos($haystack, $needle, $offset);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $result;<br />
}<br />
<br />
It was very useful for me.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115284""></a>
  <div class="note">
   <strong class="user">ohcc at 163 dot com</strong>
   <a href="#115284" class="date">27-Jun-2014 10:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful when the $haystack or $needle parameter is an integer.<br />
If you are not sure of its type, you should&nbsp; convert it into a string.<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">12345</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">));</span><span class="comment">//false<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">12345</span><span class="keyword">,</span><span class="string">'1'</span><span class="keyword">));</span><span class="comment">//0<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">'12345'</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">));</span><span class="comment">//false<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">'12345'</span><span class="keyword">,</span><span class="string">'1'</span><span class="keyword">));</span><span class="comment">//0<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$a </span><span class="keyword">= </span><span class="default">12345</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$b </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">strval</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">),</span><span class="default">strval</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">)));</span><span class="comment">//0<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">var_dump</span><span class="keyword">(</span><span class="default">strpos</span><span class="keyword">((string)</span><span class="default">$a</span><span class="keyword">,(string)</span><span class="default">$b</span><span class="keyword">));</span><span class="comment">//0&nbsp; &nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114716""></a>
  <div class="note">
   <strong class="user">binodluitel at hotmail dot com</strong>
   <a href="#114716" class="date">27-Mar-2014 04:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function will return 0 if the string that you are searching matches i.e. needle matches the haystack<br />
<br />
{code}<br />
echo strpos('bla', 'bla');<br />
{code}<br />
<br />
Output: 0</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113911""></a>
  <div class="note">
   <strong class="user">Lurvik</strong>
   <a href="#113911" class="date">16-Dec-2013 07:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Don't know if already posted this, but if I did this is an improvement.<br />
<br />
This function will check if a string contains&nbsp; a needle. It _will_ work with arrays and multidimensional arrays (I've tried with a &gt; 16 dimensional array and had no problem).<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">str_contains</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//If needles is an array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$needles</span><span class="keyword">))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//go trough all the elements<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">foreach(</span><span class="default">$needles </span><span class="keyword">as </span><span class="default">$needle</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//if the needle is also an array (ie needles is a multidimensional array)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//call this function again<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">str_contains</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//Will break out of loop and function.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//when the needle is NOT an array:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; //Check if haystack contains the needle, will ignore case and check for whole words only<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">elseif(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/\b</span><span class="default">$needle</span><span class="string">\b/i"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">) !== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//if $needles is not an array...<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"/\b</span><span class="default">$needles</span><span class="string">\b/i"</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">) !== </span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="111422""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#111422" class="date">18-Feb-2013 09:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The most straightforward way to prevent this function from returning 0 is:<br />
<br />
&nbsp; strpos('x'.$haystack, $needle, 1)<br />
<br />
The 'x' is simply a garbage character which is only there to move everything 1 position.<br />
The number 1 is there to make sure that this 'x' is ignored in the search.<br />
This way, if $haystack starts with $needle, then the function returns 1 (rather than 0).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="108426""></a>
  <div class="note">
   <strong class="user">mtroy dot student at gmail dot com</strong>
   <a href="#108426" class="date">25-Apr-2012 04:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
when you want to know how much of substring occurrences, you'll use "substr_count".<br />
But, retrieve their positions, will be harder.<br />
So, you can do it by starting with the last occurrence :<br />
<br />
function strpos_r($haystack, $needle)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(strlen($needle) &gt; strlen($haystack))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; trigger_error(sprintf("%s: length of argument 2 must be &lt;= argument 1", __FUNCTION__), E_USER_WARNING);<br />
<br />
&nbsp;&nbsp;&nbsp; $seeks = array();<br />
&nbsp;&nbsp;&nbsp; while($seek = strrpos($haystack, $needle))<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; array_push($seeks, $seek);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $haystack = substr($haystack, 0, $seek);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $seeks;<br />
}<br />
<br />
it will return an array of all occurrences a the substring in the string<br />
<br />
Example : <br />
<br />
$test = "this is a test for testing a test function... blah blah";<br />
var_dump(strpos_r($test, "test"));<br />
<br />
// output <br />
<br />
array(3) {<br />
&nbsp; [0]=&gt;<br />
&nbsp; int(29)<br />
&nbsp; [1]=&gt;<br />
&nbsp; int(19)<br />
&nbsp; [2]=&gt;<br />
&nbsp; int(10)<br />
}<br />
<br />
Paul-antoine<br />
Malézieux.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107678""></a>
  <div class="note">
   <strong class="user">martijn at martijnfrazer dot nl</strong>
   <a href="#107678" class="date">25-Feb-2012 03:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a function I wrote to find all occurrences of a string, using strpos recursively.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">strpos_recursive</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, &amp;</span><span class="default">$results </span><span class="keyword">= array()) {&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$offset </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$results</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$results</span><span class="keyword">[] = </span><span class="default">$offset</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">strpos_recursive</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, (</span><span class="default">$offset </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">), </span><span class="default">$results</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
This is how you use it:<br />
<br />
<span class="default">&lt;?php<br />
$string </span><span class="keyword">= </span><span class="string">'This is some string'</span><span class="keyword">;<br />
</span><span class="default">$search </span><span class="keyword">= </span><span class="string">'a'</span><span class="keyword">;<br />
</span><span class="default">$found </span><span class="keyword">= </span><span class="default">strpos_recursive</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$search</span><span class="keyword">);<br />
<br />
if(</span><span class="default">$found</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$found </span><span class="keyword">as </span><span class="default">$pos</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">'Found "'</span><span class="keyword">.</span><span class="default">$search</span><span class="keyword">.</span><span class="string">'" in string "'</span><span class="keyword">.</span><span class="default">$string</span><span class="keyword">.</span><span class="string">'" at position &lt;b&gt;'</span><span class="keyword">.</span><span class="default">$pos</span><span class="keyword">.</span><span class="string">'&lt;/b&gt;&lt;br /&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }&nbsp; &nbsp; <br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'"'</span><span class="keyword">.</span><span class="default">$search</span><span class="keyword">.</span><span class="string">'" not found in "'</span><span class="keyword">.</span><span class="default">$string</span><span class="keyword">.</span><span class="string">'"'</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107240""></a>
  <div class="note">
   <strong class="user">rjeggens at ijskoud dot org</strong>
   <a href="#107240" class="date">24-Jan-2012 07:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I lost an hour before I noticed that strpos only returns FALSE as a boolean, never TRUE.. This means that<br />
<br />
strpos() !== false <br />
<br />
is a different beast then:<br />
<br />
strpos() === true<br />
<br />
since the latter will never be true. After I found out, The warning in the documentation made a lot more sense.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106407""></a>
  <div class="note">
   <strong class="user">gjh42 - simonokewode at hotmail dot com</strong>
   <a href="#106407" class="date">07-Nov-2011 07:59</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A pair of functions to replace every nth occurrence of a string with another string, starting at any position in the haystack. The first works on a string and the second works on a single-level array of strings, treating it as a single string for replacement purposes (any needles split over two array elements are ignored).<br />
<br />
Can be used for formatting dynamically-generated HTML output without touching the original generator: e.g. add a newLine class tag to every third item in a floated list, starting with the fourth item.<br />
&nbsp;<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/* String Replace at Intervals&nbsp;&nbsp; by Glenn Herbert (gjh42)&nbsp; &nbsp; 2010-12-17<br />
&nbsp;*/<br />
&nbsp;<br />
//(basic locator by someone else - name unknown)<br />
//strnposr() - Find the position of nth needle in haystack.<br />
</span><span class="keyword">function </span><span class="default">strnposr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$occurrence</span><span class="keyword">, </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$occurrence</span><span class="keyword">&lt;</span><span class="default">2</span><span class="keyword">)?</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">):</span><span class="default">strnposr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,</span><span class="default">$occurrence</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">,</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">//gjh42<br />
//replace every nth occurrence of $needle with $repl, starting from any position<br />
</span><span class="keyword">function </span><span class="default">str_replace_int</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$repl</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$interval</span><span class="keyword">, </span><span class="default">$first</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp; if (</span><span class="default">$pos </span><span class="keyword">&gt;= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">) or </span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">) &lt; </span><span class="default">$first</span><span class="keyword">) return </span><span class="default">$haystack</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$firstpos </span><span class="keyword">= </span><span class="default">strnposr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$first</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$nl </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$qty </span><span class="keyword">= </span><span class="default">floor</span><span class="keyword">(</span><span class="default">substr_count</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$firstpos </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">)/</span><span class="default">$interval</span><span class="keyword">);<br />
&nbsp; do { </span><span class="comment">//in reverse order<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nextpos </span><span class="keyword">= </span><span class="default">strnposr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, (</span><span class="default">$qty </span><span class="keyword">* </span><span class="default">$interval</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">, </span><span class="default">$firstpos</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$qty</span><span class="keyword">--;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">substr_replace</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$repl</span><span class="keyword">, </span><span class="default">$nextpos</span><span class="keyword">, </span><span class="default">$nl</span><span class="keyword">);<br />
&nbsp; } while (</span><span class="default">$nextpos </span><span class="keyword">&gt; </span><span class="default">$firstpos</span><span class="keyword">);<br />
&nbsp; return </span><span class="default">$haystack</span><span class="keyword">;<br />
}<br />
&nbsp; </span><span class="comment">//$needle = string to find<br />
&nbsp; //$repl = string to replace needle<br />
&nbsp; //$haystack = string to do replacing in<br />
&nbsp; //$interval = number of needles in loop<br />
&nbsp; //$first=1 = first occurrence of needle to replace (defaults to first) <br />
&nbsp; //$pos=0 = position in haystack string to start from (defaults to first) <br />
&nbsp;<br />
//replace every nth occurrence of $needle with $repl, starting from any position, in a single-level array<br />
</span><span class="keyword">function </span><span class="default">arr_replace_int</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$repl</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">, </span><span class="default">$interval</span><span class="keyword">, </span><span class="default">$first</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">, </span><span class="default">$glue</span><span class="keyword">=</span><span class="string">'|+|'</span><span class="keyword">) {<br />
&nbsp; if (!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">))&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
&nbsp; foreach(</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">])) return </span><span class="default">$arr</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="default">$glue</span><span class="keyword">, </span><span class="default">$arr</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">str_replace_int</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$repl</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$interval</span><span class="keyword">, </span><span class="default">$first</span><span class="keyword">, </span><span class="default">$pos</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$tarr </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$glue</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; foreach(</span><span class="default">$arr </span><span class="keyword">as </span><span class="default">$key</span><span class="keyword">=&gt;</span><span class="default">$value</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$arr</span><span class="keyword">[</span><span class="default">$key</span><span class="keyword">] = </span><span class="default">$tarr</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">++;<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$arr</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span>If $arr is not an array, or a multilevel array, it is returned unchanged.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="102773""></a>
  <div class="note">
   <strong class="user">akarmenia at gmail dot com</strong>
   <a href="#102773" class="date">05-Mar-2011 04:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
My version of strpos with needles as an array. Also allows for a string, or an array inside an array.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">strpos_array</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$needles</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$needles </span><span class="keyword">as </span><span class="default">$str</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos_array</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$pos </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$pos</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needles</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="comment">// Test<br />
</span><span class="keyword">echo </span><span class="default">strpos_array</span><span class="keyword">(</span><span class="string">'This is a test'</span><span class="keyword">, array(</span><span class="string">'test'</span><span class="keyword">, </span><span class="string">'drive'</span><span class="keyword">)); </span><span class="comment">// Output is 10<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99440""></a>
  <div class="note">
   <strong class="user">gambajaja at yahoo dot com</strong>
   <a href="#99440" class="date">17-Aug-2010 03:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
$my_array </span><span class="keyword">= array (</span><span class="string">'100,101'</span><span class="keyword">, </span><span class="string">'200,201'</span><span class="keyword">, </span><span class="string">'300,301'</span><span class="keyword">);<br />
</span><span class="default">$check_me_in </span><span class="keyword">= array (</span><span class="string">'100'</span><span class="keyword">,</span><span class="string">'200'</span><span class="keyword">,</span><span class="string">'300'</span><span class="keyword">,</span><span class="string">'400'</span><span class="keyword">);<br />
foreach (</span><span class="default">$check_me_in </span><span class="keyword">as </span><span class="default">$value_cmi</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$is_in</span><span class="keyword">=</span><span class="default">FALSE</span><span class="keyword">; </span><span class="comment">#asume that $check_me_in isn't in $my_array<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$my_array </span><span class="keyword">as </span><span class="default">$value_my</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$value_my</span><span class="keyword">, </span><span class="default">$value_cmi</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$pos</span><span class="keyword">===</span><span class="default">0</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$pos</span><span class="keyword">==</span><span class="default">TRUE</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$is_in</span><span class="keyword">=</span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value_my2</span><span class="keyword">=</span><span class="default">$value_my</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$is_in</span><span class="keyword">) echo </span><span class="string">"ID </span><span class="default">$value_cmi</span><span class="string"> in \$check_me_in I found in value '</span><span class="default">$value_my2</span><span class="string">' \n"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
The above example will output<br />
ID 100 in $check_me_in I found in value '100,101' <br />
ID 200 in $check_me_in I found in value '200,201' <br />
ID 300 in $check_me_in I found in value '300,301'</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="99332""></a>
  <div class="note">
   <strong class="user">usulaco at gmail dot com</strong>
   <a href="#99332" class="date">11-Aug-2010 05:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Parse strings between two others in to array.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">g</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$start</span><span class="keyword">,</span><span class="default">$end</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/' </span><span class="keyword">. </span><span class="default">preg_quote</span><span class="keyword">(</span><span class="default">$start</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">) . </span><span class="string">'(.*?)'</span><span class="keyword">. </span><span class="default">preg_quote</span><span class="keyword">(</span><span class="default">$end</span><span class="keyword">, </span><span class="string">'/'</span><span class="keyword">).</span><span class="string">'/i'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">, </span><span class="default">$m</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; </span><span class="default">$out </span><span class="keyword">= array();
<br />

<br />
&nbsp;&nbsp; &nbsp; foreach(</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] as </span><span class="default">$key </span><span class="keyword">=&gt; </span><span class="default">$value</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$type </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'::'</span><span class="keyword">,</span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; if(</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$type</span><span class="keyword">)&gt;</span><span class="default">1</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(!</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$out</span><span class="keyword">[</span><span class="default">$type</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]]))
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$out</span><span class="keyword">[</span><span class="default">$type</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]] = array();
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[</span><span class="default">$type</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]][] = </span><span class="default">$type</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$out</span><span class="keyword">[] = </span><span class="default">$value</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; }
<br />
&nbsp;&nbsp; &nbsp; }
<br />
&nbsp; return </span><span class="default">$out</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">g</span><span class="keyword">(</span><span class="string">'Sample text, [/text to extract/] Rest of sample text [/WEB::<a href="http://google.com/] bla bla bla. " rel="nofollow" target="_blank">http://google.com/] bla bla bla. </a>'</span><span class="keyword">,</span><span class="string">'[/'</span><span class="keyword">,</span><span class="string">'/]'</span><span class="keyword">));
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
results:
<br />
Array
<br />
(
<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; text to extract
<br />
&nbsp;&nbsp;&nbsp; [WEB] =&gt; Array
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; (
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [0] =&gt; <a href="http://google.com" rel="nofollow" target="_blank">http://google.com</a>
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; )
<br />

<br />
)
<br />

<br />
Can be helpfull to custom parsing :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="94469""></a>
  <div class="note">
   <strong class="user">Achintya</strong>
   <a href="#94469" class="date">06-Nov-2009 02:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A function I made to find the first occurrence of a particular needle not enclosed in quotes(single or double). Works for simple nesting (no backslashed nesting allowed).
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">strposq</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$charlen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$flag1 </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$flag2 </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$offset</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">"'"</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$flag1 </span><span class="keyword">= !</span><span class="default">$flag1 </span><span class="keyword">&amp;&amp; !</span><span class="default">$flag2 </span><span class="keyword">? </span><span class="default">true </span><span class="keyword">: </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">) == </span><span class="string">'"'</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$flag2 </span><span class="keyword">= !</span><span class="default">$flag1 </span><span class="keyword">&amp;&amp; !</span><span class="default">$flag2 </span><span class="keyword">? </span><span class="default">true </span><span class="keyword">: </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$charlen</span><span class="keyword">) == </span><span class="default">$needle </span><span class="keyword">&amp;&amp; !</span><span class="default">$flag1 </span><span class="keyword">&amp;&amp; !</span><span class="default">$flag2</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$i</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;
<br />
}
<br />

<br />
echo </span><span class="default">strposq</span><span class="keyword">(</span><span class="string">"he'llo'character;\"'som\"e;crap"</span><span class="keyword">, </span><span class="string">";"</span><span class="keyword">); </span><span class="comment">//16
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93887""></a>
  <div class="note">
   <strong class="user">yasindagli at gmail dot com</strong>
   <a href="#93887" class="date">05-Oct-2009 09:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function finds postion of nth occurence of a letter starting from offset.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">nth_position</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$letter</span><span class="keyword">, </span><span class="default">$n</span><span class="keyword">, </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$str_arr </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$letter_size </span><span class="keyword">= </span><span class="default">array_count_values</span><span class="keyword">(</span><span class="default">str_split</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">)));<br />
&nbsp;&nbsp;&nbsp; if( !isset(</span><span class="default">$letter_size</span><span class="keyword">[</span><span class="default">$letter</span><span class="keyword">])){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'letter "' </span><span class="keyword">. </span><span class="default">$letter </span><span class="keyword">. </span><span class="string">'" does not exist in ' </span><span class="keyword">. </span><span class="default">$str </span><span class="keyword">. </span><span class="string">' after ' </span><span class="keyword">. </span><span class="default">$offset </span><span class="keyword">. </span><span class="string">'. position'</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else if(</span><span class="default">$letter_size</span><span class="keyword">[</span><span class="default">$letter</span><span class="keyword">] &lt; </span><span class="default">$n</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="string">'letter "' </span><span class="keyword">. </span><span class="default">$letter </span><span class="keyword">. </span><span class="string">'" does not exist ' </span><span class="keyword">. </span><span class="default">$n </span><span class="keyword">.</span><span class="string">' times in ' </span><span class="keyword">. </span><span class="default">$str </span><span class="keyword">. </span><span class="string">' after ' </span><span class="keyword">. </span><span class="default">$offset </span><span class="keyword">. </span><span class="string">'. position'</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$offset</span><span class="keyword">, </span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">, </span><span class="default">$count </span><span class="keyword">= (</span><span class="default">count</span><span class="keyword">(</span><span class="default">$str_arr</span><span class="keyword">) - </span><span class="default">$offset</span><span class="keyword">); </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$count</span><span class="keyword">, </span><span class="default">$x </span><span class="keyword">!= </span><span class="default">$n</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$str_arr</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] == </span><span class="default">$letter</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">;<br />
}<br />
<br />
echo </span><span class="default">nth_position</span><span class="keyword">(</span><span class="string">'foobarbaz'</span><span class="keyword">, </span><span class="string">'a'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">); </span><span class="comment">//7<br />
</span><span class="keyword">echo </span><span class="default">nth_position</span><span class="keyword">(</span><span class="string">'foobarbaz'</span><span class="keyword">, </span><span class="string">'b'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">4</span><span class="keyword">); </span><span class="comment">//6<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="93816""></a>
  <div class="note">
   <strong class="user">digitalpbk [at] gmail.com</strong>
   <a href="#93816" class="date">30-Sep-2009 08:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function raises a warning if the offset is not between 0 and the length of string:
<br />

<br />
Warning: strpos(): Offset not contained in string in %s on line %d</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="92849""></a>
  <div class="note">
   <strong class="user">ah dot d at hotmail dot com</strong>
   <a href="#92849" class="date">11-Aug-2009 01:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
A strpos modification to return an array of all the positions of a needle in the haystack 
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">strallpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,</span><span class="default">$offset </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= array();
<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i </span><span class="keyword">= </span><span class="default">$offset</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,</span><span class="default">$i</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$pos </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">=&nbsp; </span><span class="default">$pos</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$offset </span><span class="keyword">&gt;= </span><span class="default">$i</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">$offset</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[] = </span><span class="default">$offset</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
example:-
<br />

<br />
<span class="default">&lt;?php
<br />
$haystack </span><span class="keyword">= </span><span class="string">"ASD is trying to get out of the ASDs cube but the other ASDs told him that his behavior will destroy the ASDs world"</span><span class="keyword">;
<br />

<br />
</span><span class="default">$needle </span><span class="keyword">= </span><span class="string">"ASD"</span><span class="keyword">;
<br />

<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">strallpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">));
<br />

<br />
</span><span class="comment">//getting all the positions starting from a specified position
<br />

<br />
</span><span class="default">print_r</span><span class="keyword">(</span><span class="default">strallpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,</span><span class="default">34</span><span class="keyword">));
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89788""></a>
  <div class="note">
   <strong class="user">teddanzig at yahoo dot com</strong>
   <a href="#89788" class="date">23-Mar-2009 09:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
routine to return -1 if there is no match for strpos
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">//instr function to mimic vb instr fucntion
<br />
</span><span class="keyword">function </span><span class="default">InStr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$pos</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$pos </span><span class="keyword">!== </span><span class="default">false</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$pos</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return -</span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87061""></a>
  <div class="note">
   <strong class="user">Tim</strong>
   <a href="#87061" class="date">17-Nov-2008 05:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you would like to find all occurences of a needle inside a haystack you could use this function strposall($haystack,$needle);. It will return an array with all the strpos's.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/**
<br />
&nbsp;* strposall
<br />
&nbsp;* 
<br />
&nbsp;* Find all occurrences of a needle in a haystack
<br />
&nbsp;*
<br />
&nbsp;* @param string $haystack
<br />
&nbsp;* @param string $needle
<br />
&nbsp;* @return array or false
<br />
&nbsp;*/
<br />
</span><span class="keyword">function </span><span class="default">strposall</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$s</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">is_integer</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">)){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">,</span><span class="default">$needle</span><span class="keyword">,</span><span class="default">$s</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">is_integer</span><span class="keyword">(</span><span class="default">$i</span><span class="keyword">)) { 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$aStrPos</span><span class="keyword">[] = </span><span class="default">$i</span><span class="keyword">; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$s </span><span class="keyword">= </span><span class="default">$i</span><span class="keyword">+</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">); 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; if (isset(</span><span class="default">$aStrPos</span><span class="keyword">)) { 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$aStrPos</span><span class="keyword">; 
<br />
&nbsp;&nbsp;&nbsp; } 
<br />
&nbsp;&nbsp;&nbsp; else { 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">; 
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82229""></a>
  <div class="note">
   <strong class="user">ilaymyhat-rem0ve at yahoo dot com</strong>
   <a href="#82229" class="date">01-Apr-2008 04:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This might be useful.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">class </span><span class="default">String</span><span class="keyword">{
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Look for a $needle in $haystack in any position
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">contains</span><span class="keyword">(&amp;</span><span class="default">$haystack</span><span class="keyword">, &amp;</span><span class="default">$needle</span><span class="keyword">, &amp;</span><span class="default">$offset</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$result </span><span class="keyword">!== </span><span class="default">FALSE</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//intuitive implementation .. if not found returns -1.
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public static function </span><span class="default">strpos</span><span class="keyword">(&amp;</span><span class="default">$haystack</span><span class="keyword">, &amp;</span><span class="default">$needle</span><span class="keyword">, &amp;</span><span class="default">$offset</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$offset</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$result </span><span class="keyword">=== </span><span class="default">FALSE </span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return -</span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
}</span><span class="comment">//String
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80363""></a>
  <div class="note">
   <strong class="user">Suggested re-write for pink WARNING box</strong>
   <a href="#80363" class="date">11-Jan-2008 03:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
WARNING<br />
<br />
As strpos may return either FALSE (substring absent) or 0 (substring at start of string), strict versus loose equivalency operators must be used very carefully.<br />
<br />
To know that a substring is absent, you must use:&nbsp; <br />
<br />
=== FALSE<br />
<br />
To know that a substring is present (in any position including 0), you can use either of:<br />
<br />
!== FALSE&nbsp; (recommended)<br />
&nbsp;&gt; -1&nbsp; (note: or greater than any negative number)<br />
<br />
To know that a substring is at the start of the string, you must use:&nbsp; <br />
<br />
=== 0<br />
<br />
To know that a substring is in any position other than the start, you can use any of: <br />
<br />
&nbsp;&gt; 0&nbsp; (recommended)<br />
!= 0&nbsp; (note: but not !== 0 which also equates to FALSE)<br />
!= FALSE&nbsp; (disrecommended as highly confusing)<br />
<br />
Also note that you cannot compare a value of "" to the returned value of strpos. With a loose equivalence operator (== or !=) it will return results which don't distinguish between the substring's presence versus position. With a strict equivalence operator (=== or !==) it will always return false.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75146""></a>
  <div class="note">
   <strong class="user">user at nomail dot com</strong>
   <a href="#75146" class="date">15-May-2007 02:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a bit more useful when scanning a large string for all occurances between 'tags'.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">getStrsBetween</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="default">$s1</span><span class="keyword">,</span><span class="default">$s2</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">,</span><span class="default">$offset</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/*====================================================================<br />
&nbsp;&nbsp;&nbsp; Function to scan a string for items encapsulated within a pair of tags<br />
<br />
&nbsp;&nbsp;&nbsp; getStrsBetween(string, tag1, &lt;tag2&gt;, &lt;offset&gt;<br />
<br />
&nbsp;&nbsp;&nbsp; If no second tag is specified, then match between identical tags<br />
<br />
&nbsp;&nbsp;&nbsp; Returns an array indexed with the encapsulated text, which is in turn<br />
&nbsp;&nbsp;&nbsp; a sub-array, containing the position of each item.<br />
<br />
&nbsp;&nbsp;&nbsp; Notes:<br />
&nbsp;&nbsp;&nbsp; strpos($needle,$haystack,$offset)<br />
&nbsp;&nbsp;&nbsp; substr($string,$start,$length)<br />
<br />
&nbsp;&nbsp;&nbsp; ====================================================================*/<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if( </span><span class="default">$s2 </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">) { </span><span class="default">$s2 </span><span class="keyword">= </span><span class="default">$s1</span><span class="keyword">; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$L1 </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$L2 </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; if( </span><span class="default">$L1</span><span class="keyword">==</span><span class="default">0 </span><span class="keyword">|| </span><span class="default">$L2</span><span class="keyword">==</span><span class="default">0 </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; do {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos1 </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="default">$s1</span><span class="keyword">,</span><span class="default">$offset</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$pos1 </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos1 </span><span class="keyword">+= </span><span class="default">$L1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos2 </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="default">$s2</span><span class="keyword">,</span><span class="default">$pos1</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( </span><span class="default">$pos2 </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$key_len </span><span class="keyword">= </span><span class="default">$pos2 </span><span class="keyword">- </span><span class="default">$pos1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$this_key </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$s</span><span class="keyword">,</span><span class="default">$pos1</span><span class="keyword">,</span><span class="default">$key_len</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if( !</span><span class="default">array_key_exists</span><span class="keyword">(</span><span class="default">$this_key</span><span class="keyword">,</span><span class="default">$result</span><span class="keyword">) ) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$this_key</span><span class="keyword">] = array();<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$result</span><span class="keyword">[</span><span class="default">$this_key</span><span class="keyword">][] = </span><span class="default">$pos1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$offset </span><span class="keyword">= </span><span class="default">$pos2 </span><span class="keyword">+ </span><span class="default">$L2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pos1 </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; } while(</span><span class="default">$pos1 </span><span class="keyword">!== </span><span class="default">false </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$result</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70394""></a>
  <div class="note">
   <strong class="user">spinicrus at gmail dot com</strong>
   <a href="#70394" class="date">14-Oct-2006 10:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
if you want to get the position of a substring relative to a substring of your string, BUT in REVERSE way:<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">strpos_reverse_way</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$charToFind</span><span class="keyword">,</span><span class="default">$relativeChar</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$relativePos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$relativeChar</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$searchPos </span><span class="keyword">= </span><span class="default">$relativePos</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$searchChar </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">while (</span><span class="default">$searchChar </span><span class="keyword">!= </span><span class="default">$charToFind</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$newPos </span><span class="keyword">= </span><span class="default">$searchPos</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$searchChar </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">,</span><span class="default">$newPos</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$charToFind</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$searchPos </span><span class="keyword">= </span><span class="default">$newPos</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (!empty(</span><span class="default">$searchChar</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$searchPos</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">TRUE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//<br />
</span><span class="keyword">}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="45088""></a>
  <div class="note">
   <strong class="user">philip</strong>
   <a href="#45088" class="date">25-Aug-2004 03:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Many people look for in_string which does not exist in PHP, so, here's the most efficient form of in_string() (that works in both PHP 4/5) that I can think of:
<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">in_string</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$insensitive </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$insensitive</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false </span><span class="keyword">!== </span><span class="default">stristr</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false </span><span class="keyword">!== </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41762""></a>
  <div class="note">
   <strong class="user">bishop</strong>
   <a href="#41762" class="date">21-Apr-2004 03:38</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Code like this:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">if (</span><span class="default">strpos</span><span class="keyword">(</span><span class="string">'this is a test'</span><span class="keyword">, </span><span class="string">'is'</span><span class="keyword">) !== </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"found it"</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
gets repetitive, is not very self-explanatory, and most people handle it incorrectly anyway. Make your life easier:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">str_contains</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">, </span><span class="default">$ignoreCase </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$ignoreCase</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$haystack </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$needle&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$needle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$needlePos </span><span class="keyword">= </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$haystack</span><span class="keyword">, </span><span class="default">$needle</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return (</span><span class="default">$needlePos </span><span class="keyword">=== </span><span class="default">false </span><span class="keyword">? </span><span class="default">false </span><span class="keyword">: (</span><span class="default">$needlePos</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">));<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Then, you may do:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// simplest use<br />
</span><span class="keyword">if (</span><span class="default">str_contains</span><span class="keyword">(</span><span class="string">'this is a test'</span><span class="keyword">, </span><span class="string">'is'</span><span class="keyword">)) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Found it"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">// when you need the position, as well whether it's present<br />
</span><span class="default">$needlePos </span><span class="keyword">= </span><span class="default">str_contains</span><span class="keyword">(</span><span class="string">'this is a test'</span><span class="keyword">, </span><span class="string">'is'</span><span class="keyword">);<br />
if (</span><span class="default">$needlePos</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Found it at position ' </span><span class="keyword">. (</span><span class="default">$needlePos</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// you may also ignore case<br />
</span><span class="default">$needlePos </span><span class="keyword">= </span><span class="default">str_contains</span><span class="keyword">(</span><span class="string">'this is a test'</span><span class="keyword">, </span><span class="string">'IS'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br />
if (</span><span class="default">$needlePos</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">'Found it at position ' </span><span class="keyword">. (</span><span class="default">$needlePos</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
