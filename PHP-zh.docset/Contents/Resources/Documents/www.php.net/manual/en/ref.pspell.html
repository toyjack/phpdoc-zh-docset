<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>Pspell 函数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="pspell.constants.html">? 预定义常量</a></li>
      <li style="float: right;"><a href="function.pspell-add-to-personal.html">pspell_add_to_personal ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.pspell.html">Pspell</a></li>
    <li>Pspell 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.pspell" class="reference">
 <h1 class="title">Pspell 函数</h1>

 



















































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.pspell-add-to-personal.html">pspell_add_to_personal</a> &mdash; Add the word to a personal wordlist</li><li><a href="function.pspell-add-to-session.html">pspell_add_to_session</a> &mdash; Add the word to the wordlist in the current session</li><li><a href="function.pspell-check.html">pspell_check</a> &mdash; Check a word</li><li><a href="function.pspell-clear-session.html">pspell_clear_session</a> &mdash; Clear the current session</li><li><a href="function.pspell-config-create.html">pspell_config_create</a> &mdash; Create a config used to open a dictionary</li><li><a href="function.pspell-config-data-dir.html">pspell_config_data_dir</a> &mdash; Location of language data files</li><li><a href="function.pspell-config-dict-dir.html">pspell_config_dict_dir</a> &mdash; Location of the main word list</li><li><a href="function.pspell-config-ignore.html">pspell_config_ignore</a> &mdash; Ignore words less than N characters long</li><li><a href="function.pspell-config-mode.html">pspell_config_mode</a> &mdash; Change the mode number of suggestions returned</li><li><a href="function.pspell-config-personal.html">pspell_config_personal</a> &mdash; Set a file that contains personal wordlist</li><li><a href="function.pspell-config-repl.html">pspell_config_repl</a> &mdash; Set a file that contains replacement pairs</li><li><a href="function.pspell-config-runtogether.html">pspell_config_runtogether</a> &mdash; Consider run-together words as valid compounds</li><li><a href="function.pspell-config-save-repl.html">pspell_config_save_repl</a> &mdash; Determine whether to save a replacement pairs list
  along with the wordlist</li><li><a href="function.pspell-new-config.html">pspell_new_config</a> &mdash; Load a new dictionary with settings based on a given config</li><li><a href="function.pspell-new-personal.html">pspell_new_personal</a> &mdash; Load a new dictionary with personal wordlist</li><li><a href="function.pspell-new.html">pspell_new</a> &mdash; Load a new dictionary</li><li><a href="function.pspell-save-wordlist.html">pspell_save_wordlist</a> &mdash; Save the personal wordlist to a file</li><li><a href="function.pspell-store-replacement.html">pspell_store_replacement</a> &mdash; Store a replacement pair for a word</li><li><a href="function.pspell-suggest.html">pspell_suggest</a> &mdash; Suggest spellings of a word</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="95298""></a>
  <div class="note">
   <strong class="user">golotyuk at gmail dot com</strong>
   <a href="#95298" class="date">24-Dec-2009 01:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Manuall php installation on Debian/Ubuntu will require you to:<br />
<br />
apt-get install libpspell-dev</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78609""></a>
  <div class="note">
   <strong class="user">dylan at wedefy dot com</strong>
   <a href="#78609" class="date">18-Oct-2007 05:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
preg_replace_callback() is the best way I found to check words in a large text and change the HTML color of words that are not found.&nbsp; Here is a script I wrote which does just that, and optionally uses pspell_suggest() to auto-correct. I would love to write a better regex to ignore &lt;text inside xml tags&gt;, but that really isn't as easy as it sounds...<br />
<span class="default">&lt;?php<br />
$pspell </span><span class="keyword">= </span><span class="default">pspell_new</span><span class="keyword">(</span><span class="string">'en'</span><span class="keyword">,</span><span class="string">'canadian'</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="string">'utf-8'</span><span class="keyword">,</span><span class="default">PSPELL_FAST</span><span class="keyword">);<br />
<br />
function </span><span class="default">spellCheckWord</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; global </span><span class="default">$pspell</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$autocorrect </span><span class="keyword">= </span><span class="default">TRUE</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Take the string match from preg_replace_callback's array<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Ignore ALL CAPS<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/^[A-Z]*$/'</span><span class="keyword">,</span><span class="default">$word</span><span class="keyword">)) return </span><span class="default">$word</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Return dictionary words<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">pspell_check</span><span class="keyword">(</span><span class="default">$pspell</span><span class="keyword">,</span><span class="default">$word</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$word</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Auto-correct with the first suggestion, color green<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$autocorrect </span><span class="keyword">&amp;&amp; </span><span class="default">$suggestions </span><span class="keyword">= </span><span class="default">pspell_suggest</span><span class="keyword">(</span><span class="default">$pspell</span><span class="keyword">,</span><span class="default">$word</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'&lt;span style="color:#00FF00;"&gt;'</span><span class="keyword">.</span><span class="default">current</span><span class="keyword">(</span><span class="default">$suggestions</span><span class="keyword">).</span><span class="string">'&lt;/span&gt;'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// No suggestions, color red<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="string">'&lt;span style="color:#FF0000;"&gt;'</span><span class="keyword">.</span><span class="default">$word</span><span class="keyword">.</span><span class="string">'&lt;/span&gt;'</span><span class="keyword">;<br />
}<br />
<br />
function </span><span class="default">spellCheck</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">preg_replace_callback</span><span class="keyword">(</span><span class="string">'/\b\w+\b/'</span><span class="keyword">,</span><span class="string">'spellCheckWord'</span><span class="keyword">,</span><span class="default">$string</span><span class="keyword">);<br />
}<br />
<br />
echo </span><span class="default">spellCheck</span><span class="keyword">(</span><span class="string">'PHP is a reflecktive proegramming langwage origenaly dezigned for prodewcing dinamic waieb pagges.'</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span>OUTPUT: PHP is a reflective programming language originally designed for producing dynamic Web pages.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74450""></a>
  <div class="note">
   <strong class="user">fragment</strong>
   <a href="#74450" class="date">11-Apr-2007 10:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To get round the error on Windows where the word list can't be found inside functions, take the call to pspell_new() out of the function and pass the return value to your function, i.e.<br />
<br />
&lt;?<br />
function testSpell($pspell_link) {<br />
&nbsp;&nbsp;&nbsp; echo pspell_check($pspell_link, "test") ? 'OK' : 'Not OK';<br />
}<br />
$pspell_link = pspell_new("en");<br />
testSpell($pspell_link);<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="73877""></a>
  <div class="note">
   <strong class="user">Alan Dunsmuir&lt;alan at moonrake dot demon dot co dot uk&gt;</strong>
   <a href="#73877" class="date">14-Mar-2007 01:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
There appears to be a problem currently affecting PSpell functionality on Windows machines.<br />
<br />
Currently, the compiled build of PHP5 for Windows does not by default include PSpell, and to activate these functions the Windows user has to (a) install GNU ASpell; (b) copy the file aspell-15.dll to a directory in the Windows "Path" statement (typically C:\Windows\System32); (c) install one or more ASpell dictionaries; (d) enable the PSpell extension to PHP by adding a reference to php_pspell.dll in the php.ini file, and moving the file itself to the main PHP directory.<br />
<br />
However, when this has all been done and PSpell appears to have been fully activated, there remains a problem. While all the PSpell functions work as specified when referenced from the "main" body of PHP code, if they are placed within a PHP function, the system reports that it is unable to find any word lists for the specified dictionary (whichever one is chosen).<br />
<br />
I have a sample of PSpell-using code (taken from the SAMS book PHP 5 In Practice) which works perfectly on a Unix-based Web Server, but which fails with the indicated error message on a range of Windows machines.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70798""></a>
  <div class="note">
   <strong class="user">sholland at napervillegi dot com</strong>
   <a href="#70798" class="date">28-Oct-2006 11:48</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Back in 10/2002 csnyder at chxo dot com wrote the first comment about the spell functions, and wrote a very sophisticated spell check with a direct call to aspell.&nbsp; In a similar vein, I wrote a simplified a PHP function that will spell check a string and insert tags before and after the misspelled words. Auto-correction is not offered. <br />
<br />
&lt;?<br />
function spellcheck($string) { <br />
// Entry:&nbsp; &nbsp; $string: Text to spellcheck.<br />
// Returns: string with '&lt;strong&gt;' and '&lt;/strong&gt;' inserted before and <br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; after misspellings.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $pre='&lt;strong&gt;'; // Inserted before each mis-spelling.<br />
&nbsp;&nbsp;&nbsp; $post='&lt;/strong&gt;'; // Inserted after each mis-spelling.<br />
&nbsp;&nbsp;&nbsp; $string=strtr($string,"\n"," "); <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Drop newlines in string. (It bothers aspell in this context.)<br />
&nbsp;&nbsp;&nbsp; $mistakes = `echo $string | /usr/local/bin/aspell list`; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Get list or errors.<br />
&nbsp;&nbsp;&nbsp; $offset=0;<br />
&nbsp;&nbsp;&nbsp; foreach (explode("\n",$mistakes) as $word) <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // Walk list, inserting $pre and $post strings.&nbsp; I move along and<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // do the insertions, keeping track of the location.&nbsp; A global replace<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // with str_replace($string,$pre.$work.$post) is problematic if the<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // same misspelling is found more than once.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($word&lt;&gt;"") {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $offset=strpos($string,$word,$offset);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $string=substr_replace($string, $post, $offset+strlen($word), 0);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $string=substr_replace($string, $pre, $offset, 0);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $offset=$offset+strlen($word)+strlen("$pre $post");&nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; };<br />
&nbsp;&nbsp;&nbsp; return $string;};<br />
?&gt;<br />
<br />
For this to work on your system, see if /usr/local/bin/aspell list runs from the shell.&nbsp; It needs to get input from standard input.&nbsp; You may not be able to run apell without the path for PHP because the PATH variable may be different in the PHP invocation from a shell invocation.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="65556""></a>
  <div class="note">
   <strong class="user">andrew at bluerhinos dot co dot uk</strong>
   <a href="#65556" class="date">03-May-2006 03:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you use red hat or fedora, you may need to is use <br />
<br />
&nbsp; yum install pspell-devel&nbsp; <br />
<br />
(fixes: configure: error: Cannot find pspell)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63743""></a>
  <div class="note">
   <strong class="user">jeremy hepler</strong>
   <a href="#63743" class="date">29-Mar-2006 12:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
compiling php with pspell on debian sarge:<br />
<br />
apt-get install aspell libaspell15 libaspell-dev libpspell-dev<br />
<br />
configure php:<br />
<br />
./configure &lt;your other options&gt; --with-pspell=/usr<br />
<br />
make &amp; install<br />
<br />
if previous tries have failed or it is not functioning properly, unpack the php source again and configure / compile in a fresh tree</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="52832""></a>
  <div class="note">
   <strong class="user">Gregory Boshoff</strong>
   <a href="#52832" class="date">13-May-2005 04:23</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you are receiving the error message:<br />
PSPELL couldn't open the dictionary. reason:<br />
No word lists can be found for the language "en".<br />
<br />
Add following lines prior to calling pspell_check:<br />
$pspell_config = pspell_config_create("en");<br />
$pspell_link = pspell_new_config($pspell_config);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="48566""></a>
  <div class="note">
   <strong class="user">flint at modulusgroup dot com</strong>
   <a href="#48566" class="date">29-Dec-2004 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For those will problems installing on Win32 with IIS:<br />
<br />
Symptom: browser just hangs when calling pspell function. Running PHP.exe from command line causes pspell to claim that there is a corrupt file. Running Aspell works just fine on the command line.<br />
<br />
You need new data files: <br />
<br />
You can download and get more information about it here:<br />
<a href="http://wiki.wordpress.org/SpellCheck" rel="nofollow" target="_blank">http://wiki.wordpress.org/SpellCheck</a><br />
<br />
Just replace the data directory in C:\Programs Files\Aspell\ with the new data directory you downloaded.<br />
<br />
No more problems.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="46078""></a>
  <div class="note">
   <strong class="user">tidd</strong>
   <a href="#46078" class="date">28-Sep-2004 10:31</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to csnyder's comment about calling aspell instead of using the aspell or pspell libs:<br />
<br />
If you are running a low traffic site this will work fine and it's a good idea. <br />
<br />
If, however, you have many customers using your spell checking script, this method does not scale well and you should consider spending the time to make the libs work properly.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41477""></a>
  <div class="note">
   <strong class="user">webmaster at script-tease dot net</strong>
   <a href="#41477" class="date">11-Apr-2004 07:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Easy way to make a spellchecker:<br />
<br />
&lt;?<br />
<br />
function spellcheck ( $string ) {<br />
&nbsp;&nbsp;&nbsp; $words = preg_split('/[\W]+?/',$string);<br />
&nbsp;&nbsp;&nbsp; $misspelled = $return = array();<br />
&nbsp;&nbsp;&nbsp; $int = pspell_new('en');<br />
&nbsp;&nbsp;&nbsp; foreach ($words as $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!pspell_check($int, $value)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $misspelled[] = $value;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; foreach ($misspelled as $value) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $return[$value] = pspell_suggest($int, $value);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $return;<br />
}<br />
<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="41097""></a>
  <div class="note">
   <strong class="user">jrweir _a_t_ yahoo</strong>
   <a href="#41097" class="date">29-Mar-2004 11:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I had the same problems after following the detailed instructions for installing on windows but was able to solve them by doing the following:<br />
<br />
first, I copied all the files in the data directory of the aspell install (ie. C:\Program Files\Aspell\data) to a unix machine and ran dos2unix on all of the files and then copied them back.<br />
<br />
second, added this line before the pspell_new("en") call<br />
pspell_config_create("en");<br />
<br />
hope this works for you too.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="28409""></a>
  <div class="note">
   <strong class="user">kevina at gnu dot org</strong>
   <a href="#28409" class="date">12-Jan-2003 02:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Aspell Author Here.<br />
<br />
Since Aspell 0.50, Pspell is no longer used.&nbsp; It is not necessary to download and install the Pspell package, only Aspell 0.50 (or better) is required.&nbsp; Aspell now provided a backwards compatibility interface for programs expecting the old Pspell interface (such as PHP).<br />
<br />
Even though Aspell now provided a new "Aspell" interface this, the PHP Pspell interface is the one you want to use.&nbsp; The Aspell PHP interface is the one used with a *very* old version of Aspell as the manual says.<br />
<br />
Sorry if this is confusing, but it is not really my fought as I have no control over PHP development.&nbsp; Eventually a new Aspell interface should be provided for PHP which uses the new Aspell interface provided with Aspell 0.50 but for now the Pspell interface will work just fine.<br />
<br />
Note: If you wish to use an older version of Aspell (_before_ 0.50) than both Aspell and Pspell are required.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="25921""></a>
  <div class="note">
   <strong class="user">csnyder at chxo dot com</strong>
   <a href="#25921" class="date">11-Oct-2002 12:37</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As an alternative to mucking about with the compiled-in aspell/pspell functions, which only check word by word, one could write a script that calls aspell as a shell exec to check a whole block of text: <br />
<br />
<a href="http://chxo.com/scripts/spellcheck.php" rel="nofollow" target="_blank">http://chxo.com/scripts/spellcheck.php</a><br />
(there is a view-source option)<br />
<br />
Not sure about Linux or Windows, but installing aspell on FreeBSD was trivially easy from the ports collection. No doubt such a script could be easily modified to use ispell instead if you'd rather.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
