<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>正则表达式替换</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="ref.regex.html">? POSIX 正则表达式函数</a></li>
      <li style="float: right;"><a href="function.ereg.html">ereg ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.regex.html">POSIX 正则表达式函数</a></li>
    <li>正则表达式替换</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.ereg-replace" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">ereg_replace</h1>
  <p class="verinfo">(PHP 4, PHP 5)</p><p class="refpurpose"><span class="refname">ereg_replace</span> &mdash; <span class="dc-title">正则表达式替换</span></p>

 </div>
 <div class="refsect1 unknown-seealsp" id="refsect1-function.ereg-replace-unknown-seealsp">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>ereg_replace</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$pattern</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$replacement</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>
   ) : <span class="type">string</span></div>

  <p class="simpara">
   本函数在 <code class="parameter">string</code> 中扫描与
   <code class="parameter">pattern</code> 匹配的部分，并将其替换为
   <code class="parameter">replacement</code>。
  </p>
  <p class="simpara">
   返回替换后的字符串。（如果没有可供替换的匹配项则会返回原字符串。）
  </p>
  <p class="simpara">
   如果 <code class="parameter">pattern</code>
   包含有括号内的子串，则 <code class="parameter">replacement</code>
   可以包含形如
   <code class="literal">\\<span class="replaceable">digit</span></code>
   的子串，这些子串将被替换为数字表示的的第几个括号内的子串；<code class="literal">\\0</code>
   则包含了字符串的整个内容。最多可以用九个子串。括号可以嵌套，此情形下以左圆括号来计算顺序。
  </p>
  <p class="simpara">
   如果未在 <code class="parameter">string</code>
   中找到匹配项，则
   <code class="parameter">string</code> 将原样返回。
  </p>
  <p class="para">
   例如，下面的代码片断输出
   &quot;This was a test&quot; 三次：
  </p>
  <p class="para">
   <div class="example" id="example-5105">
    <p><strong>Example #1 <span class="function"><strong>ereg_replace()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"This&nbsp;is&nbsp;a&nbsp;test"</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;is"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"&nbsp;was"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">ereg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"(&nbsp;)is"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"\\1was"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">ereg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"((&nbsp;)is)"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"\\2was"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   要注意的一点是如果在 <code class="parameter">replacement</code>
   参数中使用了整数值，则可能得不到所期望的结果。这是因为
   <span class="function"><strong>ereg_replace()</strong></span> 将把数字作为字符的序列值来解释并应用之。例如：
  </p>
  <p class="para">
   <div class="example" id="example-5106">
    <p><strong>Example #2 <span class="function"><strong>ereg_replace()</strong></span> 例子</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">/*&nbsp;不能产生出期望的结果&nbsp;*/<br /></span><span style="color: #0000BB">$num&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"This&nbsp;string&nbsp;has&nbsp;four&nbsp;words."</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ereg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'four'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$num</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Output:&nbsp;'This&nbsp;string&nbsp;has&nbsp;&nbsp;&nbsp;words.'&nbsp;*/<br /><br />/*&nbsp;本例工作正常&nbsp;*/<br /></span><span style="color: #0000BB">$num&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'4'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"This&nbsp;string&nbsp;has&nbsp;four&nbsp;words."</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ereg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'four'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$num</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Output:&nbsp;'This&nbsp;string&nbsp;has&nbsp;4&nbsp;words.'&nbsp;*/<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-5107">
    <p><strong>Example #3 将 URL 替换为超连接</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$text&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ereg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"[[:alpha:]]+://[^&lt;&gt;[:space:]]+[[:alnum:]/]"</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">"&lt;a&nbsp;href=\"\\0\"&gt;\\0&lt;/a&gt;"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$text</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <div class="tip"><strong class="tip">Tip</strong>
   <p class="para">
    <span class="function"><a href="function.preg-replace.html" class="function">preg_replace()</a></span> 函数使用了
    Perl 兼容正则表达式语法，通常是比
    <span class="function"><strong>ereg_replace()</strong></span> 更快的替代方案。
   </p>
  </div>
  <p class="para">
   参见 <span class="function"><a href="function.ereg.html" class="function">ereg()</a></span>，<span class="function"><a href="function.eregi.html" class="function">eregi()</a></span>，<span class="function"><a href="function.eregi-replace.html" class="function">eregi_replace()</a></span>，<span class="function"><a href="function.str-replace.html" class="function">str_replace()</a></span>
   和 <span class="function"><a href="function.preg-match.html" class="function">preg_match()</a></span>。
  </p>
 </div>

</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="100463""></a>
  <div class="note">
   <strong class="user">lvt</strong>
   <a href="#100463" class="date">17-Oct-2010 07:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful, don't replace all ereg_replace() with str_replace() as many people will likely to recommend if there is regular expression stuffs, or your script will stop running !!!<br />
<br />
Example : replace the (.) at the end of the text with (...)<br />
<br />
<span class="default">&lt;?php<br />
<br />
$text </span><span class="keyword">= </span><span class="string">"This is a simple text."</span><span class="keyword">;<br />
<br />
print( </span><span class="default">ereg_replace</span><span class="keyword">( </span><span class="string">"\.$"</span><span class="keyword">, </span><span class="string">"..."</span><span class="keyword">, </span><span class="default">$text </span><span class="keyword">) );<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Test with str_replace() you will find it's not working.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98602""></a>
  <div class="note">
   <strong class="user">Joe</strong>
   <a href="#98602" class="date">25-Jun-2010 11:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Since ereg_replace is now deprecated, many users will be coming to this page, in an attempt to troubleshoot and fix broken scripts after a PHP upgrade.
<br />

<br />
ereg_replace is essentially a search and replace function and it follows a pattern like this:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$input </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"find this"</span><span class="keyword">, </span><span class="string">"replace it with"</span><span class="keyword">, </span><span class="default">$output</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
You start out by defining the input variable ($input), then the = ereg_replace portion tells php to do a search and replace action on the value of $input, then once the value has been modified with your 'find this' and 'replace with' section, the resulting value is defined as a variable $output which you can then use in other parts of your script or page.
<br />

<br />
Lets take a real world example.
<br />

<br />
There is a e-comm site - <a href="http://www.example.com - that has millions of item records.&nbsp; Each item has a name, that is defined as a variable called $title.&nbsp; Each $title value has spaces, i.e. " rel="nofollow" target="_blank">http://www.example.com - that has millions of item records.&nbsp; Each item has a name, that is defined as a variable called $title.&nbsp; Each $title value has spaces, i.e. </a>"Range Cookers" or "Bosch Dishwashers", but we want to convert these into a page url that does not contain spaces, but uses the plus character '+' instead of a space (you can use hyphens '-' or other characters).
<br />

<br />
If using the deprecated ereg_replace function, it might look something like this:
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$title</span><span class="keyword">=</span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">" "</span><span class="keyword">, </span><span class="string">"+"</span><span class="keyword">, </span><span class="default">$itemurl</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
But to avoid those deprecated errors, we change the function name to preg_replace and add a set of delimiters, in this case the 2 forward slashes / / where the contents inside that are matched as the 'find this' portion.
<br />

<br />
<span class="default">&lt;?php
<br />

<br />
$title</span><span class="keyword">=</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/ /"</span><span class="keyword">, </span><span class="string">"+"</span><span class="keyword">, </span><span class="default">$itemurl</span><span class="keyword">);
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
It is not absolutely necessary to use / / as the delimiters, if you are modifying directory names which may naturally contain forward slashes, it could cause it to break because the slashes in the url or directory would be interpreted as the delimiter, so you could use other obscure characters i.e.&nbsp; ("# #", "+", $itemurl);&nbsp; instead.&nbsp; This would give an output like:
<br />

<br />
<a href="http://www.example.com/-Range+Cooker" rel="nofollow" target="_blank">http://www.example.com/-Range+Cooker</a>
<br />

<br />
<a href="http://www.example.com/-Bosch+Dishwasher" rel="nofollow" target="_blank">http://www.example.com/-Bosch+Dishwasher</a>
<br />

<br />
This would strip out the spaces from the value of $title and give you a variable called $itemurl where all the spaces were replaced with the plus character, so you could potentially use it as a url like above.
<br />

<br />
So to summarize:&nbsp; ereg_replace is a deprecated search and replace action where preg_replace can be used instead, and it follows a pattern as described earlier where it takes the input data, finds a match based on what you are looking for, replaces it with something else you define, and then gives you an output data variable that you can use in your script or page.&nbsp; Hopefully by understanding the process, the php code functions wont seem like voodoo and you could troubleshoot and fix many of the deprecated errors yourself.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89407""></a>
  <div class="note">
   <strong class="user">Anonymous</strong>
   <a href="#89407" class="date">06-Mar-2009 07:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php
<br />
</span><span class="comment">// highlights the recognized patterns (a good tool for experiments)
<br />

<br />
</span><span class="default">$output </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"your regexp here"</span><span class="keyword">, </span><span class="string">"&lt;font color=red&gt;\\0&lt;/font&gt;"</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">)
<br />
print </span><span class="default">$output</span><span class="keyword">;
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="88622""></a>
  <div class="note">
   <strong class="user">Real PHP Geek</strong>
   <a href="#88622" class="date">01-Feb-2009 03:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function makes links unclickable, read the comments:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">strip_urls</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">$repPat</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$repPat</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$repPat </span><span class="keyword">= </span><span class="string">"text [url]"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aimpstr </span><span class="keyword">= </span><span class="string">'PHP_STRIP_URLS_FUNCTION_BY_REAL-PHP-GEEK'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//change $aimpstr to anything you want.<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$impstr </span><span class="keyword">= </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$aimpstr</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">'&lt;/a&gt;'</span><span class="keyword">, </span><span class="string">'&lt;/a&gt;' </span><span class="keyword">. </span><span class="default">$impstr</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="default">$impstr</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$texta </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$repPat </span><span class="keyword">= </span><span class="default">str_ireplace</span><span class="keyword">(array(</span><span class="string">'text'</span><span class="keyword">, </span><span class="string">'url'</span><span class="keyword">), array(</span><span class="string">'\\4'</span><span class="keyword">, </span><span class="string">'\\2'</span><span class="keyword">), </span><span class="default">$repPat</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$text </span><span class="keyword">as </span><span class="default">$text</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$texta</span><span class="keyword">[</span><span class="default">$n</span><span class="keyword">] = </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"&lt;a(.*)href=\"(.*)\"(.*)&gt;(.*)&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$repPat</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">++;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$textb </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">"&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$texta</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$textb</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">//EXAMPLES:<br />
</span><span class="default">$string_of_text </span><span class="keyword">= </span><span class="string">'&lt;a href="<a href="http://www.php.net/" rel="nofollow" target="_blank">http://www.php.net/</a>"&gt;PHP&lt;/a&gt; rocks. &lt;a href="<a href="http://www.apache.org/" rel="nofollow" target="_blank">http://www.apache.org/</a>"&gt;Apache&lt;/a&gt; also!'</span><span class="keyword">;<br />
echo </span><span class="default">strip_urls</span><span class="keyword">(</span><span class="default">$string_of_text</span><span class="keyword">, </span><span class="string">"text"</span><span class="keyword">);<br />
echo </span><span class="default">strip_urls</span><span class="keyword">(</span><span class="default">$string_of_text</span><span class="keyword">, </span><span class="string">"url"</span><span class="keyword">);<br />
echo </span><span class="default">strip_urls</span><span class="keyword">(</span><span class="default">$string_of_text</span><span class="keyword">, </span><span class="string">"text [url]"</span><span class="keyword">);<br />
echo </span><span class="default">strip_urls</span><span class="keyword">(</span><span class="default">$string_of_text</span><span class="keyword">, </span><span class="default">NULL</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84951""></a>
  <div class="note">
   <strong class="user">computer_guru</strong>
   <a href="#84951" class="date">06-Aug-2008 04:39</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is the code I use to make links clickable. The code only works on xxxx:// (i.e. <a href="ftp://, http://, etc..." rel="nofollow" target="_blank">ftp://, http://, etc...</a>). It does not work on www. because that is how I want it. The reason my code has an if condition is that it ignores html links and only modifies non-html urls. (see below)
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">make_clickable</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">ereg</span><span class="keyword">(</span><span class="string">"[\"|'][[:alpha:]]+://"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">) == </span><span class="default">false</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">'([[:alpha:]]+://[^&lt;&gt;[:space:]]+[[:alnum:]/])'</span><span class="keyword">, </span><span class="string">'&lt;a target=\"_new\" href="\\1"&gt;\\1&lt;/a&gt;'</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return(</span><span class="default">$text</span><span class="keyword">); 
<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
My function ignores code like this:
<br />

<br />
&lt;a href="<a href="http://php.net" rel="nofollow" target="_blank">http://php.net</a>"&gt; php.net &lt;/a&gt;
<br />

<br />
But it would make this one click able:
<br />

<br />
<a href="http://php.net" rel="nofollow" target="_blank">http://php.net</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84202""></a>
  <div class="note">
   <strong class="user">jammin320</strong>
   <a href="#84202" class="date">03-Jul-2008 12:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Just a quick addition to the last post - <br />
<br />
modifying the regular expression for the www clause to include a newline at the begining will allow it to catch URLs that are the first in a line but not the first in a string. The previous version would only catch them if a space preceded the value...<br />
<br />
&nbsp;&nbsp;&nbsp; // match www.something<br />
&nbsp;&nbsp;&nbsp; $text = ereg_replace("(^| |\n)(www([.]?[a-zA-Z0-9_/-])*)", "\\1&lt;a href=\"<a href="http://" rel="nofollow" target="_blank">http://</a>\\2\"&gt;\\2&lt;/a&gt;", $text);</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82970""></a>
  <div class="note">
   <strong class="user">http://www.bbgames.co.nr</strong>
   <a href="#82970" class="date">04-May-2008 07:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to a post above, his coding was a bit wrong.&nbsp; The correct coding should be :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">hyperlink</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// match protocol://address/path/<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"[a-zA-Z]+://([.]?[a-zA-Z0-9_/-])*"</span><span class="keyword">, </span><span class="string">"&lt;a href=\"\\0\"&gt;\\0&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// match www.something<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"(^| )(www([.]?[a-zA-Z0-9_/-])*)"</span><span class="keyword">, </span><span class="string">"\\1&lt;a href=\"<a href="http://" rel="nofollow" target="_blank">http://</a>\\2\"&gt;\\2&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// return $text<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$text</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
You can use this function like this:<br />
<span class="default">&lt;?php<br />
$line </span><span class="keyword">= </span><span class="string">"Check the links: www.yahoo.com <a href="http://www.php.net" rel="nofollow" target="_blank">http://www.php.net</a>"</span><span class="keyword">;<br />
</span><span class="default">hyperlink</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">);<br />
</span><span class="comment">// Now, all text that looks like a link becomes a link<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81476""></a>
  <div class="note">
   <strong class="user">tugla</strong>
   <a href="#81476" class="date">29-Feb-2008 09:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you're not relying on regular expressions, str_replace() can be far faster.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="80526""></a>
  <div class="note">
   <strong class="user">Renjith</strong>
   <a href="#80526" class="date">20-Jan-2008 10:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Code:<br />
<br />
<span class="default">&lt;?php<br />
<br />
$s </span><span class="keyword">= </span><span class="string">"Coding PHP is fun."</span><span class="keyword">;<br />
<br />
</span><span class="default">$pattern </span><span class="keyword">= </span><span class="string">"(.*)PHP(.*)"</span><span class="keyword">;<br />
</span><span class="default">$replacement </span><span class="keyword">= </span><span class="string">" They say \\1other languages\\2"</span><span class="keyword">;<br />
<br />
print </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="default">$pattern</span><span class="keyword">, </span><span class="default">$replacement</span><span class="keyword">, </span><span class="default">$s</span><span class="keyword">);<br />
<br />
</span><span class="default">?&gt;<br />
</span><br />
Output:<br />
They say Coding other languages is fun.<br />
Explanation:<br />
<br />
"PHP" is replaced with "other languages", and the sentence is changed a little, using \1 and \2 to access the parts within parentheses.<br />
<a href="http://php-regex.blogspot.com/" rel="nofollow" target="_blank">http://php-regex.blogspot.com/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78145""></a>
  <div class="note">
   <strong class="user">bjwarshaw2 at yahoo dot com</strong>
   <a href="#78145" class="date">29-Sep-2007 06:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's worth mentioning for ultimate clarity that you're safest using double quotes when matching a pattern, since without them, metacharacters will be interpreted as a backslash plus another character. <br />
<br />
Granted, this is part of the language syntax for the string type, but it might not be quite so obvious when dealing with patterns in this function, which is taking the pattern as a parameter.<br />
<br />
So if you find that '[\n]' is taking the 'n' out of your string and leaving the new lines alone, switch to doubles before changing anything else.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77359""></a>
  <div class="note">
   <strong class="user">jarfil at jarfil dot net</strong>
   <a href="#77359" class="date">26-Aug-2007 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For simple patterns like "[a-z]", preg_replace is up to 6 times faster than ereg_replace.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75448""></a>
  <div class="note">
   <strong class="user">mephissto at gmail dot com</strong>
   <a href="#75448" class="date">30-May-2007 06:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Your right but you just need to replace by :<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">hyperlink</span><span class="keyword">(&amp;</span><span class="default">$text</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// match protocol://address/path/<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"[a-zA-Z]+://([.]?[a-zA-Z0-9_/-])*"</span><span class="keyword">, </span><span class="string">"&lt;a href=\"\\0\"&gt;\\0&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// match www.something<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"(^| |.)(www([.]?[a-zA-Z0-9_/-])*)"</span><span class="keyword">, </span><span class="string">"\\1&lt;a href=\"<a href="http://" rel="nofollow" target="_blank">http://</a>\\2\"&gt;\\2&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="75167""></a>
  <div class="note">
   <strong class="user">hoffaboffa (at) hotmail dott com</strong>
   <a href="#75167" class="date">15-May-2007 06:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
cristiklein's hyperlink function is nice but works incorrect with a www-string like this<br />
<br />
\r\nwww.google.se<br />
<br />
then it does not become a hyperlink</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="74347""></a>
  <div class="note">
   <strong class="user">bmcswee at gmail dot com dot invalid</strong>
   <a href="#74347" class="date">06-Apr-2007 09:33</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Function to strip an HTML tag out of a string. I use this in part for parsing XML documents.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">stripTags</span><span class="keyword">(</span><span class="default">$tag</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Regular expressions only work with strings if the regexp has been pre-concocted<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regExp </span><span class="keyword">= </span><span class="string">"&lt;" </span><span class="keyword">. </span><span class="string">"</span><span class="default">$tag</span><span class="string">" </span><span class="keyword">. </span><span class="string">"[^&gt;]*&gt;"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"&lt;/</span><span class="default">$tag</span><span class="string">&gt;"</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="default">$regExp</span><span class="keyword">, </span><span class="string">""</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$string</span><span class="keyword">;&nbsp; &nbsp; <br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="61818""></a>
  <div class="note">
   <strong class="user">chrish at shield dot on dot ca</strong>
   <a href="#61818" class="date">12-Feb-2006 05:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was having problems with Microsoft Outlook viewing forms within email.&nbsp; I was only able to see the first word of the text box after I used the following code.<br />
<br />
If I entered words into the text box and used the enter key to give me a CRLF I could see in the returned data the %0D%0A string, so I assumed if I just used the ereg-replace as below it would just replace the %0D%0A with a single space... <br />
<br />
function remove_extra_linebreaks($string) {<br />
&nbsp;&nbsp; $new_string=ereg_replace("%0D%0A", " ", $string);<br />
&nbsp; return $new_string;<br />
}<br />
<br />
But the form as displayed by Outlook only showed the text upto the first replaced string, then it was blank!<br />
I could view the source of the email and it would show all of the text I expected.<br />
<br />
The following will show the correct data in the form <br />
<br />
function remove_extra_linebreaks($string) {<br />
&nbsp;&nbsp; $new_string=ereg_replace("%0D%0A", '+', $string);<br />
&nbsp; return $new_string;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="60941""></a>
  <div class="note">
   <strong class="user">Chris</strong>
   <a href="#60941" class="date">20-Jan-2006 11:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I've updated the function a little that was posted below.&nbsp; I use it to make database field names readable when making a header row.&nbsp; I needed it to quit putting a space in "GPA" and to put a space in between numbers and letters.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/**<br />
*&nbsp; Converts "fieldcontainingGPAInMyDatabaseFrom2005"<br />
*&nbsp; To&nbsp; &nbsp; &nbsp;&nbsp; "Field Containing GPA In My Database From 2005"<br />
*/<br />
</span><span class="keyword">function </span><span class="default">innerCapsToReadableText</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"([A-Z]) "</span><span class="keyword">, </span><span class="string">"\\1"</span><span class="keyword">,</span><span class="default">ucwords</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"[A-Z]"</span><span class="keyword">,</span><span class="string">" \\0"</span><span class="keyword">,</span><span class="default">$text</span><span class="keyword">))));<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"([A-Za-z])([0-9])"</span><span class="keyword">, </span><span class="string">"\\1 \\2"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="59975""></a>
  <div class="note">
   <strong class="user">codergeek42 at users dot sourceforge.net</strong>
   <a href="#59975" class="date">21-Dec-2005 09:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In response to "php dot net at lenix dot de," a cleaner (easier to read) method would be to type-cast the integer as a string by quoting it. For example:<br />
<br />
<span class="default">&lt;?php<br />
$foo </span><span class="keyword">= </span><span class="default">42</span><span class="keyword">;<br />
echo </span><span class="default">ereg_replace </span><span class="keyword">( </span><span class="string">"bar"</span><span class="keyword">, </span><span class="string">"</span><span class="default">$foo</span><span class="string">" </span><span class="keyword">, </span><span class="string">"foobar" </span><span class="keyword">); </span><span class="comment">/* Would output "foo42". */<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="56080""></a>
  <div class="note">
   <strong class="user">benlanc at ster dot me dot uk</strong>
   <a href="#56080" class="date">22-Aug-2005 03:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Quite how I managed to get my previous post so wrong, I don't know. Correction follows:<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/* function to turn InterCaps style strings (i.e. CSS Properties in Javascript) to human readable ones */<br />
</span><span class="keyword">function </span><span class="default">deInterCaps</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">){<br />
&nbsp;&nbsp; return </span><span class="default">ucfirst</span><span class="keyword">(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"[A-Z]"</span><span class="keyword">,</span><span class="string">" \\0"</span><span class="keyword">,</span><span class="default">$var</span><span class="keyword">)));<br />
}<br />
<br />
</span><span class="default">$interCapsString </span><span class="keyword">= </span><span class="string">"aLoadOfNonsenseToDemonstrateTheFunction"</span><span class="keyword">;<br />
<br />
echo </span><span class="default">deInterCaps</span><span class="keyword">(</span><span class="default">$interCapsString</span><span class="keyword">);<br />
<br />
</span><span class="comment">// output: A load of nonsense to demonstrate the function<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54539""></a>
  <div class="note">
   <strong class="user">php dot net at lenix dot de</strong>
   <a href="#54539" class="date">07-Jul-2005 03:26</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One thing to take note of is that if you use an integer value as the replacement parameter, you may not get the results you expect. This is because ereg_replace() will interpret the number as the ordinal value of a character, and apply that.<br />
<br />
If you're ever having trouble with this one there's an easy workarround:<br />
<br />
instead of <br />
<span class="default">&lt;?php <br />
$foo </span><span class="keyword">= </span><span class="default">23</span><span class="keyword">;<br />
echo </span><span class="default">ereg_replace </span><span class="keyword">( </span><span class="string">"bar"</span><span class="keyword">, </span><span class="default">$foo </span><span class="keyword">, </span><span class="string">"foobar" </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
just do<br />
<br />
<span class="default">&lt;?php <br />
$foo </span><span class="keyword">= </span><span class="default">23</span><span class="keyword">;<br />
echo </span><span class="default">ereg_replace </span><span class="keyword">( </span><span class="string">"bar"</span><span class="keyword">, </span><span class="string">"" </span><span class="keyword">. </span><span class="default">$foo </span><span class="keyword">, </span><span class="string">"foobar" </span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
to replace "bar" inside "foobar" with the string "23".</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="54463""></a>
  <div class="note">
   <strong class="user">zaczek at gmail dot com</strong>
   <a href="#54463" class="date">05-Jul-2005 04:09</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you want the function to process query strings, such as:<br />
<br />
<a href="http://www.php.net/index.php?id=10%32&amp;wp=test" rel="nofollow" target="_blank">http://www.php.net/index.php?id=10%32&amp;wp=test</a><br />
<br />
modify the function as follows:<br />
<br />
function hyperlink(&amp;$text)<br />
{<br />
&nbsp;&nbsp; // match protocol://address/path/<br />
&nbsp;&nbsp; $text = ereg_replace("[a-zA-Z]+://([-]*[.]?[a-zA-Z0-9_/-?&amp;%])*", "&lt;a href=\"\\0\"&gt;\\0&lt;/a&gt;", $text);<br />
<br />
&nbsp;&nbsp; // match www.something<br />
&nbsp;&nbsp; $text = ereg_replace("(^| )(www([-]*[.]?[a-zA-Z0-9_/-?&amp;%])*)", "\\1&lt;a href=\"<a href="http://" rel="nofollow" target="_blank">http://</a>\\2\"&gt;\\2&lt;/a&gt;", $text);<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51753""></a>
  <div class="note">
   <strong class="user">cristiklein at yahoo dot com</strong>
   <a href="#51753" class="date">09-Apr-2005 02:50</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Sometimes, you would like to match both styles of URL links that are common in chat windows:<br />
<br />
<a href="http://www.yahoo.com" rel="nofollow" target="_blank">http://www.yahoo.com</a><br />
www.yahoo.com<br />
<br />
You can do this by using the following code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">hyperlink</span><span class="keyword">(&amp;</span><span class="default">$text</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// match protocol://address/path/<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"[a-zA-Z]+://([.]?[a-zA-Z0-9_/-])*"</span><span class="keyword">, </span><span class="string">"&lt;a href=\"\\0\"&gt;\\0&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// match www.something<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"(^| )(www([.]?[a-zA-Z0-9_/-])*)"</span><span class="keyword">, </span><span class="string">"\\1&lt;a href=\"<a href="http://" rel="nofollow" target="_blank">http://</a>\\2\"&gt;\\2&lt;/a&gt;"</span><span class="keyword">, </span><span class="default">$text</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
You can use this function like this:<br />
<span class="default">&lt;?php<br />
$line </span><span class="keyword">= </span><span class="string">"Check the links: www.yahoo.com <a href="http://www.php.net" rel="nofollow" target="_blank">http://www.php.net</a>"</span><span class="keyword">;<br />
</span><span class="default">hyperlink</span><span class="keyword">(</span><span class="default">$line</span><span class="keyword">);<br />
</span><span class="comment">// Now, all text that looks like a link becomes a link<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50539""></a>
  <div class="note">
   <strong class="user">bgoodman at osogrande dot com</strong>
   <a href="#50539" class="date">02-Mar-2005 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
When you are dealing with databases you can end up with quite a few \" to deal with.&nbsp; To ereg_replace all these with something else it requires you to \ the \ and \ the " so you end up with:<br />
<br />
$var1 = '\"';<br />
$var2 = ereg_replace('\\\"','1234',$var1);<br />
<br />
print $var2;&nbsp; //this should print 1234</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50413""></a>
  <div class="note">
   <strong class="user">eerie at gmx dot net</strong>
   <a href="#50413" class="date">27-Feb-2005 11:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php $path </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"\\"</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span>as posted from mmtach at yahoo dot com causes an error because you have to escape the backslash twice, once for the quotation marks and a second time due the posix syntax.<br />
<span class="default">&lt;?php $path </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">"\\\\"</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span>or<br />
<span class="default">&lt;?php $path </span><span class="keyword">= </span><span class="default">ereg_replace</span><span class="keyword">(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">"/"</span><span class="keyword">, </span><span class="default">$path</span><span class="keyword">); </span><span class="default">?&gt;<br />
</span>should both work as expected. since you don't have to escape the backslash in brackets (posix syntax) his alternative works also.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
