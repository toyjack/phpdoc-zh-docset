<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>计算两个字符串之间的编辑距离</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.lcfirst.html">? lcfirst</a></li>
      <li style="float: right;"><a href="function.localeconv.html">localeconv ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.strings.html">字符串 函数</a></li>
    <li>计算两个字符串之间的编辑距离</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.levenshtein" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">levenshtein</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.1, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">levenshtein</span> &mdash; <span class="dc-title">计算两个字符串之间的编辑距离</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.levenshtein-description">
  <h3 class="title">说明</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>levenshtein</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$str1</code></span>, <span class="methodparam"><span class="type">string</span> <code class="parameter">$str2</code></span>): <span class="type">int</span></div>

  <div class="methodsynopsis dc-description"><span class="methodname"><strong>levenshtein</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$str1</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">string</span> <code class="parameter">$str2</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$cost_ins</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$cost_rep</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type">int</span> <code class="parameter">$cost_del</code></span><br>): <span class="type">int</span></div>

  <p class="para rdfs-comment">
   编辑距离，是指两个字串之间，通过替换、插入、删除等操作将字符串<code class="parameter">str1</code>转换成<code class="parameter">str2</code>所需要操作的最少字符数量。
   该算法的复杂度是 <code class="literal">O(m*n)</code>，其中 <code class="literal">n</code> 和 <code class="literal">m</code> 分别是<code class="parameter">str1</code> 和<code class="parameter">str2</code>的长度 （当和算法复杂度为O(max(n,m)**3)的<span class="function"><a href="function.similar-text.html" class="function">similar_text()</a></span>相比时，此函数还是相当不错的，尽管仍然很耗时。）。
  </p>
  <p class="para">
   在最简单的形式中，该函数只以两个字符串作为参数，并计算通过插入、替换和删除等操作将<code class="parameter">str1</code>转换成<code class="parameter">str2</code>所需要的操作次数。
  </p>
  <p class="para">
   第二种变体将采用三个额外的参数来定义插入、替换和删除操作的次数。此变体比第一种更加通用和适应，但效率不高。
  </p>
 </div>


<div class="refsect1 parameters" id="refsect1-function.levenshtein-parameters">
  <h3 class="title">参数</h3>
  <p class="para">
   <dl>
    
     <dt>
<code class="parameter">str1</code></dt>

     <dd>

      <p class="para">
       求编辑距离中的其中一个字符串
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">str2</code></dt>

     <dd>

      <p class="para">
       求编辑距离中的另一个字符串
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">cost_ins</code></dt>

     <dd>

      <p class="para">
       定义插入次数
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">cost_rep</code></dt>

     <dd>

      <p class="para">
       定义替换次数
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">cost_del</code></dt>

     <dd>

      <p class="para">
       定义删除次数
      </p>
     </dd>

    
   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.levenshtein-returnvalues">
  <h3 class="title">返回值</h3>
  <p class="para">
   此函数返回两个字符串参数之间的编辑距离，如果其中一个字符串参数长度大于限制的255个字符时，返回-1。
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.levenshtein-examples">
  <h3 class="title">范例</h3>
  <p class="para">
   <div class="example" id="example-4683">
    <p><strong>Example #1 <span class="function"><strong>levenshtein()</strong></span> 例子：</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;输入拼写错误的单词<br /></span><span style="color: #0000BB">$input&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'carrrot'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;要检查的单词数组<br /></span><span style="color: #0000BB">$words&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'apple'</span><span style="color: #007700">,</span><span style="color: #DD0000">'pineapple'</span><span style="color: #007700">,</span><span style="color: #DD0000">'banana'</span><span style="color: #007700">,</span><span style="color: #DD0000">'orange'</span><span style="color: #007700">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'radish'</span><span style="color: #007700">,</span><span style="color: #DD0000">'carrot'</span><span style="color: #007700">,</span><span style="color: #DD0000">'pea'</span><span style="color: #007700">,</span><span style="color: #DD0000">'bean'</span><span style="color: #007700">,</span><span style="color: #DD0000">'potato'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;目前没有找到最短距离<br /></span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;遍历单词来找到最接近的<br /></span><span style="color: #007700">foreach&nbsp;(</span><span style="color: #0000BB">$words&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;计算输入单词与当前单词的距离<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$lev&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">levenshtein</span><span style="color: #007700">(</span><span style="color: #0000BB">$input</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;检查完全的匹配<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$lev&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;最接近的单词是这个（完全匹配）<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$closest&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;退出循环；我们已经找到一个完全的匹配<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">break;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;如果此次距离比上次找到的要短<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;或者还没找到接近的单词<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$lev&nbsp;</span><span style="color: #007700">&lt;=&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">||&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;设置最接近的匹配以及它的最短距离<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$closest&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$word</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$lev</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br />echo&nbsp;</span><span style="color: #DD0000">"Input&nbsp;word:&nbsp;</span><span style="color: #0000BB">$input</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />if&nbsp;(</span><span style="color: #0000BB">$shortest&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Exact&nbsp;match&nbsp;found:&nbsp;</span><span style="color: #0000BB">$closest</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br />}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"Did&nbsp;you&nbsp;mean:&nbsp;</span><span style="color: #0000BB">$closest</span><span style="color: #DD0000">?\n"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>以上例程会输出：</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
Input word: carrrot
Did you mean: carrot?
</pre></div>
    </div>
   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.levenshtein-seealso">
  <h3 class="title">参见</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.soundex.html" class="function" rel="rdfs-seeAlso">soundex()</a> - Calculate the soundex key of a string</span></li>
    <li class="member"><span class="function"><a href="function.similar-text.html" class="function" rel="rdfs-seeAlso">similar_text()</a> - 计算两个字符串的相似度</span></li>
    <li class="member"><span class="function"><a href="function.metaphone.html" class="function" rel="rdfs-seeAlso">metaphone()</a> - Calculate the metaphone key of a string</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121644""></a>
  <div class="note">
   <strong class="user">peratik at gmail dot com</strong>
   <a href="#121644" class="date">16-Sep-2017 12:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
python get_close_matches equivalent:<br />
<br />
function get_close_matches($str, $arr) {<br />
&nbsp;&nbsp;&nbsp; $closest = 1000;<br />
&nbsp;&nbsp;&nbsp; $word = false;<br />
&nbsp;&nbsp;&nbsp; foreach($arr as $w) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $po = levenshtein($str, $w);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($po&lt;$closest) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $closest = $po;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $word = $w;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return $word;<br />
}</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119859""></a>
  <div class="note">
   <strong class="user">Johan Gennesson php at genjo dot fr</strong>
   <a href="#119859" class="date">07-Sep-2016 12:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Please, be aware that:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Levenshtein Apostrophe (U+0027 &amp;#39;) and Right Single Quotation Mark (U+2019 &amp;#8217;)<br />
</span><span class="keyword">echo </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="string">"'"</span><span class="keyword">, </span><span class="string">"'"</span><span class="keyword">);<br />
</span><span class="default">?&gt;<br />
</span><br />
will output 3!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="118906""></a>
  <div class="note">
   <strong class="user">yhoko at yhoko dot com</strong>
   <a href="#118906" class="date">25-Feb-2016 05:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Note that this function might cause problems when working with multibyte charactes like in UTF-8. Example:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">print( </span><span class="default">similar_text</span><span class="keyword">( </span><span class="string">'h?'</span><span class="keyword">, </span><span class="string">'hà' </span><span class="keyword">) ); </span><span class="comment">// Returns 2 where only 1 character matches<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117767""></a>
  <div class="note">
   <strong class="user">qbolec</strong>
   <a href="#117767" class="date">05-Aug-2015 08:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For the rare occassions,&nbsp; where you want:<br />
1. multibyte UTF-8 characters<br />
2. linear memory consumption (that is O(n+m) , not O(n*m)) <br />
3. learn the string which is the longest common subsequence<br />
4. reasonable (that is O(n*m)) time complexity<br />
Consider this implementation:<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">class </span><span class="default">Strings<br />
</span><span class="keyword">{<br />
&nbsp; public static function </span><span class="default">len</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">mb_strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; public static function </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$y</span><span class="keyword">===</span><span class="default">NULL</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$y</span><span class="keyword">=</span><span class="default">self</span><span class="keyword">::</span><span class="default">len</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">mb_substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,</span><span class="string">'UTF-8'</span><span class="keyword">);<br />
&nbsp; }<br />
&nbsp; public static function </span><span class="default">letters</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$len </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">len</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$len</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; return array();<br />
&nbsp;&nbsp;&nbsp; }else if(</span><span class="default">$len </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; return array(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">Arrays</span><span class="keyword">::</span><span class="default">concat</span><span class="keyword">(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">letters</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">)),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">letters</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$len</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp; }<br />
&nbsp; private static function </span><span class="default">lcs_last_column</span><span class="keyword">(array </span><span class="default">$A</span><span class="keyword">,array </span><span class="default">$B</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$al</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$A</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bl</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$B</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$last_column </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">&lt;=</span><span class="default">$al</span><span class="keyword">;++</span><span class="default">$i</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$current_row </span><span class="keyword">= array();<br />
&nbsp;&nbsp; &nbsp;&nbsp; for(</span><span class="default">$j</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$j</span><span class="keyword">&lt;=</span><span class="default">$bl</span><span class="keyword">;++</span><span class="default">$j</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//$a[0,$i) vs $b[0,$j)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">$i</span><span class="keyword">==</span><span class="default">0 </span><span class="keyword">|| </span><span class="default">$j </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else if(</span><span class="default">$A</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]===</span><span class="default">$B</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">+ </span><span class="default">$last_row</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }else{<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$v </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">(</span><span class="default">$last_row</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">],</span><span class="default">$current_row</span><span class="keyword">[</span><span class="default">$j</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$current_row</span><span class="keyword">[] = </span><span class="default">$v</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$last_column</span><span class="keyword">[] = </span><span class="default">$current_row</span><span class="keyword">[</span><span class="default">$bl</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$last_row </span><span class="keyword">= </span><span class="default">$current_row</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$last_column</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; public static function </span><span class="default">lcs</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">){<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$A </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">letters</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$B </span><span class="keyword">= </span><span class="default">self</span><span class="keyword">::</span><span class="default">letters</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bl</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$B</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$bl</span><span class="keyword">==</span><span class="default">0</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="string">''</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }else if(</span><span class="default">$bl</span><span class="keyword">==</span><span class="default">1</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; return </span><span class="default">FALSE</span><span class="keyword">===</span><span class="default">array_search</span><span class="keyword">(</span><span class="default">$B</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">],</span><span class="default">$A</span><span class="keyword">,</span><span class="default">true</span><span class="keyword">)?</span><span class="string">''</span><span class="keyword">:</span><span class="default">$B</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$left</span><span class="keyword">=</span><span class="default">self</span><span class="keyword">::</span><span class="default">lcs_last_column</span><span class="keyword">(</span><span class="default">$A</span><span class="keyword">,</span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$B</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$bl</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$right</span><span class="keyword">=</span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">lcs_last_column</span><span class="keyword">(</span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">$A</span><span class="keyword">),</span><span class="default">array_reverse</span><span class="keyword">(</span><span class="default">array_slice</span><span class="keyword">(</span><span class="default">$B</span><span class="keyword">,</span><span class="default">$bl</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">))));<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$best_i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$best_lcs </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach(</span><span class="default">$left </span><span class="keyword">as </span><span class="default">$i </span><span class="keyword">=&gt; </span><span class="default">$lcs_left</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$option </span><span class="keyword">= </span><span class="default">$lcs_left </span><span class="keyword">+ </span><span class="default">$right</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp;&nbsp; if(</span><span class="default">$best_lcs </span><span class="keyword">&lt; </span><span class="default">$option</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$best_lcs </span><span class="keyword">= </span><span class="default">$option</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$best_i </span><span class="keyword">= </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return <br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">lcs</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$best_i</span><span class="keyword">), </span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$bl</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">)).<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">self</span><span class="keyword">::</span><span class="default">lcs</span><span class="keyword">(</span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$best_i</span><span class="keyword">), </span><span class="default">self</span><span class="keyword">::</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$bl</span><span class="keyword">&gt;&gt;</span><span class="default">1</span><span class="keyword">));<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>This is a classic implentation in which several tricks are used:<br />
1. the strings are exploded into multi-byte characters in O(n lg n) time<br />
2. instead of searching for the longest path in a precomputed two-dimensional array, we search for the best point which lays in the middle column. This is achieved by spliting the second string in half, and recursively calling the algorithm twice. The only thing we need from the recursive call are the values in the middle column. The trick is to return the last column from each recursive call, which is what we need for the left part, but requires one more trick for the right part - we simply mirror the strings and the array so that the last column is the first column. Then we just find the row which maximizes the sum of lenghts in each part.<br />
3. one can prove that the time consumed by the algorithm is proportional to the area of the (imaginary) two-dimensional array, thus it is O(n*m).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="117651""></a>
  <div class="note">
   <strong class="user">WiLDRAGoN</strong>
   <a href="#117651" class="date">15-Jul-2015 08:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some small changes allow you to calculate multiple words.<br />
<br />
<span class="default">&lt;?php<br />
<br />
$input </span><span class="keyword">= array();<br />
</span><span class="default">$dictionary&nbsp; </span><span class="keyword">= array();<br />
foreach (</span><span class="default">$input </span><span class="keyword">as </span><span class="default">$output</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$dictionary </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev </span><span class="keyword">= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">&lt;= </span><span class="default">$shortest </span><span class="keyword">|| </span><span class="default">$shortest </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest&nbsp; </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">$lev</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Input word: </span><span class="default">$output</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$shortest </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Exact match found: </span><span class="default">$closest</span><span class="string">\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; echo </span><span class="string">"Did you mean: </span><span class="default">$closest</span><span class="string">?\n"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="113702""></a>
  <div class="note">
   <strong class="user">luciole75w at no dot spam dot gmail dot com</strong>
   <a href="#113702" class="date">18-Nov-2013 02:25</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The levenshtein function processes each byte of the input string individually. Then for multibyte encodings, such as UTF-8, it may give misleading results.<br />
<br />
Example with a french accented word :<br />
- levenshtein('notre', 'votre') = 1<br />
- levenshtein('notre', 'n?tre') = 2 (huh ?!)<br />
<br />
You can easily find a multibyte compliant PHP implementation of the levenshtein function but it will be of course much slower than the C implementation.<br />
<br />
Another option is to convert the strings to a single-byte (lossless) encoding so that they can feed the fast core levenshtein function.<br />
<br />
Here is the conversion function I used with a search engine storing UTF-8 strings, and a quick benchmark. I hope it will help.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Convert an UTF-8 encoded string to a single-byte string suitable for<br />
// functions such as levenshtein.<br />
// <br />
// The function simply uses (and updates) a tailored dynamic encoding<br />
// (in/out map parameter) where non-ascii characters are remapped to<br />
// the range [128-255] in order of appearance.<br />
//<br />
// Thus it supports up to 128 different multibyte code points max over<br />
// the whole set of strings sharing this encoding.<br />
//<br />
</span><span class="keyword">function </span><span class="default">utf8_to_extended_ascii</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, &amp;</span><span class="default">$map</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// find all multibyte characters (cf. utf-8 encoding specs)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$matches </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="string">'/[\xC0-\xF7][\x80-\xBF]+/'</span><span class="keyword">, </span><span class="default">$str</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">))<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$str</span><span class="keyword">; </span><span class="comment">// plain ascii string<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; // update the encoding map with the characters not already met<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">foreach (</span><span class="default">$matches</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] as </span><span class="default">$mbc</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!isset(</span><span class="default">$map</span><span class="keyword">[</span><span class="default">$mbc</span><span class="keyword">]))<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$map</span><span class="keyword">[</span><span class="default">$mbc</span><span class="keyword">] = </span><span class="default">chr</span><span class="keyword">(</span><span class="default">128 </span><span class="keyword">+ </span><span class="default">count</span><span class="keyword">(</span><span class="default">$map</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// finally remap non-ascii characters<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">strtr</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="default">$map</span><span class="keyword">);<br />
}<br />
<br />
</span><span class="comment">// Didactic example showing the usage of the previous conversion function but,<br />
// for better performance, in a real application with a single input string<br />
// matched against many strings from a database, you will probably want to<br />
// pre-encode the input only once.<br />
//<br />
</span><span class="keyword">function </span><span class="default">levenshtein_utf8</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">, </span><span class="default">$s2</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$charMap </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$s1 </span><span class="keyword">= </span><span class="default">utf8_to_extended_ascii</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">, </span><span class="default">$charMap</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$s2 </span><span class="keyword">= </span><span class="default">utf8_to_extended_ascii</span><span class="keyword">(</span><span class="default">$s2</span><span class="keyword">, </span><span class="default">$charMap</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">, </span><span class="default">$s2</span><span class="keyword">);<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
Results (for about 6000 calls)<br />
- reference time core C function (single-byte) : 30 ms<br />
- utf8 to ext-ascii conversion + core function : 90 ms<br />
- full php implementation : 3000 ms</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="107114""></a>
  <div class="note">
   <strong class="user">engineglue at gmail dot com</strong>
   <a href="#107114" class="date">08-Jan-2012 08:05</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I really like [the manual's] example for the use of the levenshtein function to match against an array. I ran into the need to specify the sensitivity of the result. There are circumstances when you want it to return false if the match is way out of line. I wouldn't want "marry had a little lamb" to match with "saw viii" simply because it was the best match in the array. Hence the need for sensitivity:
<br />

<br />
<span class="default">&lt;?php
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">wordMatch</span><span class="keyword">(</span><span class="default">$words</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">, </span><span class="default">$sensitivity</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach (</span><span class="default">$words </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev </span><span class="keyword">= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">&lt;= </span><span class="default">$shortest </span><span class="keyword">|| </span><span class="default">$shortest </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest&nbsp; </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">$lev</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$shortest </span><span class="keyword">&lt;= </span><span class="default">$sensitivity</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$closest</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$word </span><span class="keyword">= </span><span class="string">'PINEEEEAPPLE'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$words&nbsp; </span><span class="keyword">= array(</span><span class="string">'apple'</span><span class="keyword">,</span><span class="string">'pineapple'</span><span class="keyword">,</span><span class="string">'banana'</span><span class="keyword">,</span><span class="string">'orange'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'radish'</span><span class="keyword">,</span><span class="string">'carrot'</span><span class="keyword">,</span><span class="string">'pea'</span><span class="keyword">,</span><span class="string">'bean'</span><span class="keyword">,</span><span class="string">'potato'</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="default">wordMatch</span><span class="keyword">(</span><span class="default">$words</span><span class="keyword">, </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$word</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">);
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106381""></a>
  <div class="note">
   <strong class="user">Chaim Chaikin</strong>
   <a href="#106381" class="date">02-Nov-2011 11:40</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
As regards to Example #1 above, would it not be more efficient to first use a simple php == comparison to check if the strings are equal even before testing the word with levenshtein().<br />
<br />
Something like this:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// input misspelled word<br />
</span><span class="default">$input </span><span class="keyword">= </span><span class="string">'carrrot'</span><span class="keyword">;<br />
<br />
</span><span class="comment">// array of words to check against<br />
</span><span class="default">$words&nbsp; </span><span class="keyword">= array(</span><span class="string">'apple'</span><span class="keyword">,</span><span class="string">'pineapple'</span><span class="keyword">,</span><span class="string">'banana'</span><span class="keyword">,</span><span class="string">'orange'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'radish'</span><span class="keyword">,</span><span class="string">'carrot'</span><span class="keyword">,</span><span class="string">'pea'</span><span class="keyword">,</span><span class="string">'bean'</span><span class="keyword">,</span><span class="string">'potato'</span><span class="keyword">);<br />
<br />
</span><span class="comment">// no shortest distance found, yet<br />
</span><span class="default">$shortest </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
<br />
</span><span class="comment">// loop through words to find the closest<br />
</span><span class="keyword">foreach (</span><span class="default">$words </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// check for an exact match<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$input </span><span class="keyword">== </span><span class="default">$word</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// closest word is this one (exact match)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// break out of the loop; we've found an exact match<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">break;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// calculate the distance between the input word,<br />
&nbsp;&nbsp;&nbsp; // and the current word<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lev </span><span class="keyword">= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// if this distance is less than the next found shortest<br />
&nbsp;&nbsp;&nbsp; // distance, OR if a next shortest word has not yet been found<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$lev </span><span class="keyword">&lt;= </span><span class="default">$shortest </span><span class="keyword">|| </span><span class="default">$shortest </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// set the closest match, and shortest distance<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest&nbsp; </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">$lev</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
}<br />
<br />
echo </span><span class="string">"Input word: </span><span class="default">$input</span><span class="string">\n"</span><span class="keyword">;<br />
if (</span><span class="default">$shortest </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Exact match found: </span><span class="default">$closest</span><span class="string">\n"</span><span class="keyword">;<br />
} else {<br />
&nbsp;&nbsp;&nbsp; echo </span><span class="string">"Did you mean: </span><span class="default">$closest</span><span class="string">?\n"</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="85387""></a>
  <div class="note">
   <strong class="user">paulrowe at iname dot com</strong>
   <a href="#85387" class="date">27-Aug-2008 05:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
[EDITOR'S NOTE: original post and 2 corrections combined into 1 -- mgf]
<br />

<br />
Here is an implementation of the Levenshtein Distance calculation that only uses a one-dimensional array and doesn't have a limit to the string length. This implementation was inspired by maze generation algorithms that also use only one-dimensional arrays.
<br />

<br />
I have tested this function with two 532-character strings and it completed in 0.6-0.8 seconds. 
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/*
<br />
* This function starts out with several checks in an attempt to save time.
<br />
*&nbsp;&nbsp; 1.&nbsp; The shorter string is always used as the "right-hand" string (as the size of the array is based on its length).&nbsp; 
<br />
*&nbsp;&nbsp; 2.&nbsp; If the left string is empty, the length of the right is returned.
<br />
*&nbsp;&nbsp; 3.&nbsp; If the right string is empty, the length of the left is returned.
<br />
*&nbsp;&nbsp; 4.&nbsp; If the strings are equal, a zero-distance is returned.
<br />
*&nbsp;&nbsp; 5.&nbsp; If the left string is contained within the right string, the difference in length is returned.
<br />
*&nbsp;&nbsp; 6.&nbsp; If the right string is contained within the left string, the difference in length is returned.
<br />
* If none of the above conditions were met, the Levenshtein algorithm is used.
<br />
*/
<br />
</span><span class="keyword">function </span><span class="default">LevenshteinDistance</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">, </span><span class="default">$s2</span><span class="keyword">)
<br />
{
<br />
&nbsp; </span><span class="default">$sLeft </span><span class="keyword">= (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">) &gt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s2</span><span class="keyword">)) ? </span><span class="default">$s1 </span><span class="keyword">: </span><span class="default">$s2</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$sRight </span><span class="keyword">= (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s1</span><span class="keyword">) &gt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$s2</span><span class="keyword">)) ? </span><span class="default">$s2 </span><span class="keyword">: </span><span class="default">$s1</span><span class="keyword">;
<br />
&nbsp; </span><span class="default">$nLeftLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sLeft</span><span class="keyword">);
<br />
&nbsp; </span><span class="default">$nRightLength </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$sRight</span><span class="keyword">);
<br />
&nbsp; if (</span><span class="default">$nLeftLength </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nRightLength</span><span class="keyword">;
<br />
&nbsp; else if (</span><span class="default">$nRightLength </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nLeftLength</span><span class="keyword">;
<br />
&nbsp; else if (</span><span class="default">$sLeft </span><span class="keyword">=== </span><span class="default">$sRight</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp; else if ((</span><span class="default">$nLeftLength </span><span class="keyword">&lt; </span><span class="default">$nRightLength</span><span class="keyword">) &amp;&amp; (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$sRight</span><span class="keyword">, </span><span class="default">$sLeft</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nRightLength </span><span class="keyword">- </span><span class="default">$nLeftLength</span><span class="keyword">;
<br />
&nbsp; else if ((</span><span class="default">$nRightLength </span><span class="keyword">&lt; </span><span class="default">$nLeftLength</span><span class="keyword">) &amp;&amp; (</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$sLeft</span><span class="keyword">, </span><span class="default">$sRight</span><span class="keyword">) !== </span><span class="default">FALSE</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nLeftLength </span><span class="keyword">- </span><span class="default">$nRightLength</span><span class="keyword">;
<br />
&nbsp; else {
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$nsDistance </span><span class="keyword">= </span><span class="default">range</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">, </span><span class="default">$nRightLength </span><span class="keyword">+ </span><span class="default">1</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$nLeftPos </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$nLeftPos </span><span class="keyword">&lt;= </span><span class="default">$nLeftLength</span><span class="keyword">; ++</span><span class="default">$nLeftPos</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$cLeft </span><span class="keyword">= </span><span class="default">$sLeft</span><span class="keyword">[</span><span class="default">$nLeftPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">= </span><span class="default">$nLeftPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$nLeftPos</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; for (</span><span class="default">$nRightPos </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$nRightPos </span><span class="keyword">&lt;= </span><span class="default">$nRightLength</span><span class="keyword">; ++</span><span class="default">$nRightPos</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cRight </span><span class="keyword">= </span><span class="default">$sRight</span><span class="keyword">[</span><span class="default">$nRightPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nCost </span><span class="keyword">= (</span><span class="default">$cRight </span><span class="keyword">== </span><span class="default">$cLeft</span><span class="keyword">) ? </span><span class="default">0 </span><span class="keyword">: </span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nNewDiagonal </span><span class="keyword">= </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">] = 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">min</span><span class="keyword">(</span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightPos </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, 
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">+ </span><span class="default">$nCost</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nDiagonal </span><span class="keyword">= </span><span class="default">$nNewDiagonal</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$nsDistance</span><span class="keyword">[</span><span class="default">$nRightLength</span><span class="keyword">];
<br />
&nbsp; }
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="83501""></a>
  <div class="note">
   <strong class="user">luka8088 at gmail dot com</strong>
   <a href="#83501" class="date">28-May-2008 01:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Simple levenshtein function without string length limit ...<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="keyword">function </span><span class="default">levenshtein2</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">, </span><span class="default">$cost_ins </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$cost_rep </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$cost_del </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">array_fill</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">, </span><span class="default">array_fill</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">] = </span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$j </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">$j</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$j </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">) + </span><span class="default">1</span><span class="keyword">; </span><span class="default">$j</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$str1</span><span class="keyword">{</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">} == </span><span class="default">$str2</span><span class="keyword">{</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">})<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$c </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] = </span><span class="default">min</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">1</span><span class="keyword">, </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">][</span><span class="default">$j </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">] + </span><span class="default">$c</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ret </span><span class="keyword">= </span><span class="default">$d</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">$j</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$ret</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="82605""></a>
  <div class="note">
   <strong class="user">atx dot antrax at gmail dot com</strong>
   <a href="#82605" class="date">17-Apr-2008 02:42</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have made a function that removes the length-limit of levenshtein function and ajust the result with similar_text:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">_similar</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$strlen1</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$strlen2</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$max</span><span class="keyword">=</span><span class="default">max</span><span class="keyword">(</span><span class="default">$strlen1</span><span class="keyword">, </span><span class="default">$strlen2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$splitSize</span><span class="keyword">=</span><span class="default">250</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$max</span><span class="keyword">&gt;</span><span class="default">$splitSize</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$cont</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;</span><span class="default">$cont</span><span class="keyword">&lt;</span><span class="default">$max</span><span class="keyword">;</span><span class="default">$cont</span><span class="keyword">+=</span><span class="default">$splitSize</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$strlen1</span><span class="keyword">&lt;=</span><span class="default">$cont </span><span class="keyword">|| </span><span class="default">$strlen2</span><span class="keyword">&lt;=</span><span class="default">$cont</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">=</span><span class="default">$lev</span><span class="keyword">/(</span><span class="default">$max</span><span class="keyword">/</span><span class="default">min</span><span class="keyword">(</span><span class="default">$strlen1</span><span class="keyword">,</span><span class="default">$strlen2</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">+=</span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">,</span><span class="default">$cont</span><span class="keyword">,</span><span class="default">$splitSize</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$cont</span><span class="keyword">,</span><span class="default">$splitSize</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$lev</span><span class="keyword">=</span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">, </span><span class="default">$str2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$porcentage</span><span class="keyword">= -</span><span class="default">100</span><span class="keyword">*</span><span class="default">$lev</span><span class="keyword">/</span><span class="default">$max</span><span class="keyword">+</span><span class="default">100</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$porcentage</span><span class="keyword">&gt;</span><span class="default">75</span><span class="keyword">)</span><span class="comment">//Ajustar con similar_text<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">similar_text</span><span class="keyword">(</span><span class="default">$str1</span><span class="keyword">,</span><span class="default">$str2</span><span class="keyword">,</span><span class="default">$porcentage</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$porcentage</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="81046""></a>
  <div class="note">
   <strong class="user">dale3h</strong>
   <a href="#81046" class="date">12-Feb-2008 08:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using PHP's example along with Patrick's comparison percentage function, I have come up with a function that returns the closest word from an array, and assigns the percentage to a referenced variable:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp; </span><span class="keyword">function </span><span class="default">closest_word</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$words</span><span class="keyword">, &amp;</span><span class="default">$percent </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= -</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$words </span><span class="keyword">as </span><span class="default">$word</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$lev </span><span class="keyword">= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$word</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp;&nbsp; if (</span><span class="default">$lev </span><span class="keyword">&lt;= </span><span class="default">$shortest </span><span class="keyword">|| </span><span class="default">$shortest </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$closest&nbsp; </span><span class="keyword">= </span><span class="default">$word</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$shortest </span><span class="keyword">= </span><span class="default">$lev</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$percent </span><span class="keyword">= </span><span class="default">1 </span><span class="keyword">- </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$closest</span><span class="keyword">) / </span><span class="default">max</span><span class="keyword">(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">), </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$closest</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$closest</span><span class="keyword">;<br />
&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span><br />
Usage:<br />
<span class="default">&lt;?php<br />
&nbsp; $input </span><span class="keyword">= </span><span class="string">'carrrot'</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$words </span><span class="keyword">= array(</span><span class="string">'apple'</span><span class="keyword">,</span><span class="string">'pineapple'</span><span class="keyword">,</span><span class="string">'banana'</span><span class="keyword">,</span><span class="string">'orange'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'radish'</span><span class="keyword">,</span><span class="string">'carrot'</span><span class="keyword">,</span><span class="string">'pea'</span><span class="keyword">,</span><span class="string">'bean'</span><span class="keyword">,</span><span class="string">'potato'</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">$percent </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$found </span><span class="keyword">= </span><span class="default">closest_word</span><span class="keyword">(</span><span class="default">$input</span><span class="keyword">, </span><span class="default">$words</span><span class="keyword">, </span><span class="default">$percent</span><span class="keyword">);<br />
<br />
&nbsp; </span><span class="default">printf</span><span class="keyword">(</span><span class="string">'Closest word to "%s": %s (%s%% match)'</span><span class="keyword">, </span><span class="default">$input</span><span class="keyword">, </span><span class="default">$found</span><span class="keyword">, </span><span class="default">round</span><span class="keyword">(</span><span class="default">$percent </span><span class="keyword">* </span><span class="default">100</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">));<br />
</span><span class="default">?&gt;<br />
</span><br />
I found that lowercasing the array prior to comparing yields a better comparison when the case is not of importance, for example: comparing a user-inputted category to a list of existing categories.<br />
<br />
I also found that when the percentage was above 75%, it was usually the match that I was looking for.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="70796""></a>
  <div class="note">
   <strong class="user">carey at NOSPAM dot internode dot net dot au</strong>
   <a href="#70796" class="date">28-Oct-2006 07:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I have found that levenshtein is actually case-sensitive (in PHP 4.4.2 at least).<br />
<br />
<span class="default">&lt;?php<br />
$distance</span><span class="keyword">=</span><span class="default">levenshtein</span><span class="keyword">(</span><span class="string">'hello'</span><span class="keyword">,</span><span class="string">'ELLO'</span><span class="keyword">);<br />
echo </span><span class="string">"</span><span class="default">$distance</span><span class="string">"</span><span class="keyword">;<br />
</span><span class="default">?&gt;<br />
</span><br />
Outputs: "5", instead of "1". If you are implementing a fuzzy search feature that makes use of levenshtein, you will probably need to find a way to work around this.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63274""></a>
  <div class="note">
   <strong class="user">dinesh AT dinsoft DOT net</strong>
   <a href="#63274" class="date">17-Mar-2006 03:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Here is a string resynch function:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// Trouve les operations a effectuer pour modifier $b en $a en exploitant leurs similitudes (Finds the operations required to change $b to $a)<br />
// Identique a la fonction Resynch Compare de Hex Workshop<br />
//<br />
// Parametres:<br />
//&nbsp; &nbsp; &nbsp; $a Premiere chaine (cible, target)<br />
//&nbsp; &nbsp; &nbsp; $b Seconde chaine (source)<br />
//&nbsp; &nbsp; &nbsp; $l Nombre d'octets devant correspondre pour etre consides comme un bloc similaire (number of matching bytes required)<br />
//&nbsp; &nbsp; &nbsp; $s Distance maximale dans laquelle les blocs similaires sont cherches (search window)<br />
//<br />
// Retourne:<br />
//&nbsp; &nbsp; &nbsp; Array<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Array<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [0] Operation: + Add , - Del , / Replace, = Match<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [1] Source offset<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [2] Source count<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [3] Target offset<br />
//&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [4] Target count<br />
//<br />
</span><span class="keyword">function </span><span class="default">str_resynch</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$l</span><span class="keyword">=</span><span class="default">32</span><span class="keyword">,</span><span class="default">$s</span><span class="keyword">=</span><span class="default">2048</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">),</span><span class="default">$cc</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">),</span><span class="default">$ii</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$z</span><span class="keyword">=</span><span class="default">$s</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">,</span><span class="default">$z2</span><span class="keyword">=(</span><span class="default">$z</span><span class="keyword">&lt;&lt;</span><span class="default">1</span><span class="keyword">)+</span><span class="default">1</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$c</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">=</span><span class="default">$i</span><span class="keyword">-</span><span class="default">$z</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$d</span><span class="keyword">=(</span><span class="default">$d</span><span class="keyword">&lt;</span><span class="default">$ii</span><span class="keyword">)?</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$ii</span><span class="keyword">,</span><span class="default">$z2</span><span class="keyword">-</span><span class="default">$ii</span><span class="keyword">+</span><span class="default">$d</span><span class="keyword">):</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">,</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$z2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p</span><span class="keyword">=</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">});<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$p</span><span class="keyword">!==</span><span class="default">FALSE</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m</span><span class="keyword">=</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">$i</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">$p</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p</span><span class="keyword">+=</span><span class="default">$ii</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while ((++</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$c</span><span class="keyword">) &amp;&amp; (++</span><span class="default">$p</span><span class="keyword">&lt;</span><span class="default">$cc</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$a</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">}!=</span><span class="default">$b</span><span class="keyword">{</span><span class="default">$p</span><span class="keyword">}) break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$m</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$m</span><span class="keyword">&lt;</span><span class="default">$l</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">=</span><span class="default">$bi</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n</span><span class="keyword">=</span><span class="default">$bp</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$p</span><span class="keyword">=@</span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$d</span><span class="keyword">,</span><span class="default">$a</span><span class="keyword">{</span><span class="default">$i</span><span class="keyword">},</span><span class="default">$n</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$i</span><span class="keyword">--;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$r</span><span class="keyword">[]=array(</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">+</span><span class="default">$ii</span><span class="keyword">,</span><span class="default">$m</span><span class="keyword">); </span><span class="comment">// offset a, offset b, Count<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ii</span><span class="keyword">=</span><span class="default">$p</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">count</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">)) return (</span><span class="default">$cc</span><span class="keyword">)?array(</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$cc</span><span class="keyword">):array(array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">=array();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">,</span><span class="default">$m</span><span class="keyword">=</span><span class="default">count</span><span class="keyword">(</span><span class="default">$r</span><span class="keyword">);</span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$m</span><span class="keyword">;</span><span class="default">$i</span><span class="keyword">++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]!=</span><span class="default">$bi</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]!=</span><span class="default">$bp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Replace<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]-</span><span class="default">$bp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Insertion<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">]-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]!=</span><span class="default">$bp</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Delete<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'-'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">]-</span><span class="default">$bp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Match<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'='</span><span class="keyword">,</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">0</span><span class="keyword">],</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">],</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">1</span><span class="keyword">],</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bi</span><span class="keyword">+=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bp</span><span class="keyword">+=</span><span class="default">$r</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">][</span><span class="default">2</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$c</span><span class="keyword">!=</span><span class="default">$bi</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$cc</span><span class="keyword">!=</span><span class="default">$bp</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'/'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$cc</span><span class="keyword">-</span><span class="default">$bp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; else </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'+'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$c</span><span class="keyword">-</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; elseif (</span><span class="default">$cc</span><span class="keyword">!=</span><span class="default">$bp</span><span class="keyword">) </span><span class="default">$o</span><span class="keyword">[]=array(</span><span class="string">'-'</span><span class="keyword">,</span><span class="default">$bi</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$bp</span><span class="keyword">,</span><span class="default">$cc</span><span class="keyword">-</span><span class="default">$bp</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$o</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="53562""></a>
  <div class="note">
   <strong class="user">june05 at tilo-hauke dot de</strong>
   <a href="#53562" class="date">06-Jun-2005 12:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
//levenshtein for arrays<br />
function array_levenshtein($array1,$array2)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; {&nbsp;&nbsp; $aliases= array_flip(array_values(array_unique(array_merge($array1,$array2))));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(count($aliases)&gt;255) return -1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $stringA=''; $stringB='';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($array1 as $entry) $stringA.=chr($aliases[$entry]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; foreach($array2 as $entry) $stringB.=chr($aliases[$entry]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return levenshtein($stringA,$stringB);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
// e.g. use array_levenshtein to detect special expressions in unser-inputs<br />
<br />
echo array_levenshtein(split(" ", "my name is xxx"), split(" ","my name is levenshtein")); <br />
<br />
//output: 1</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="51600""></a>
  <div class="note">
   <strong class="user">justin at visunet dot ie</strong>
   <a href="#51600" class="date">05-Apr-2005 07:46</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/*********************************************************************<br />
&nbsp;&nbsp;&nbsp; * The below func, btlfsa, (better than levenstien for spelling apps)<br />
&nbsp;&nbsp;&nbsp; * produces better results when comparing words like haert against<br />
&nbsp;&nbsp;&nbsp; * haart and heart.<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * For example here is the output of levenshtein compared to btlfsa<br />
&nbsp;&nbsp;&nbsp; * when comparing 'haert' to 'herat, haart, heart, harte'<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','herat'); output is.. 3<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','haart'); output is.. 3<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','harte'); output is.. 3<br />
&nbsp;&nbsp;&nbsp; * btlfsa('haert','heart'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','herat'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','haart'); output is.. 1<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','harte'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; * levenshtein('haert','heart'); output is.. 2<br />
&nbsp;&nbsp;&nbsp; *<br />
&nbsp;&nbsp;&nbsp; * In other words, if you used levenshtein, 'haart' would be the<br />
&nbsp;&nbsp;&nbsp; * closest match to 'haert'. Where as, btlfsa sees that it should be<br />
&nbsp;&nbsp;&nbsp; * 'heart'<br />
&nbsp;&nbsp;&nbsp; */<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">btlfsa</span><span class="keyword">(</span><span class="default">$word1</span><span class="keyword">,</span><span class="default">$word2</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// For each char that is different add 2 to the score<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // as this is a BIG difference<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$remainder&nbsp; </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/["</span><span class="keyword">.</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/[^A-Za-z0-9\']/"</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$word1</span><span class="keyword">).</span><span class="string">"]/i"</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$word2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$remainder </span><span class="keyword">.= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/["</span><span class="keyword">.</span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">"/[^A-Za-z0-9\']/"</span><span class="keyword">,</span><span class="string">' '</span><span class="keyword">,</span><span class="default">$word2</span><span class="keyword">).</span><span class="string">"]/i"</span><span class="keyword">,</span><span class="string">''</span><span class="keyword">,</span><span class="default">$word1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$remainder</span><span class="keyword">)*</span><span class="default">2</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Take the difference in string length and add it to the score<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w1_len&nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$word1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w2_len&nbsp; </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$word2</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score&nbsp; </span><span class="keyword">+= </span><span class="default">$w1_len </span><span class="keyword">&gt; </span><span class="default">$w2_len </span><span class="keyword">? </span><span class="default">$w1_len </span><span class="keyword">- </span><span class="default">$w2_len </span><span class="keyword">: </span><span class="default">$w2_len </span><span class="keyword">- </span><span class="default">$w1_len</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Calculate how many letters are in different locations<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // And add it to the score i.e.<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // h e a r t<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // 1 2 3 4 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // h a e r t&nbsp; &nbsp;&nbsp; a e&nbsp; &nbsp; &nbsp; &nbsp; = 2<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // 1 2 3 4 5&nbsp;&nbsp; 1 2 3 4 5<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w1 </span><span class="keyword">= </span><span class="default">$w1_len </span><span class="keyword">&gt; </span><span class="default">$w2_len </span><span class="keyword">? </span><span class="default">$word1 </span><span class="keyword">: </span><span class="default">$word2</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$w2 </span><span class="keyword">= </span><span class="default">$w1_len </span><span class="keyword">&gt; </span><span class="default">$w2_len </span><span class="keyword">? </span><span class="default">$word2 </span><span class="keyword">: </span><span class="default">$word1</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$w1</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ( !isset(</span><span class="default">$w2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]) || </span><span class="default">$w1</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] != </span><span class="default">$w2</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">] )<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$score</span><span class="keyword">++;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$score</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// *************************************************************<br />
&nbsp;&nbsp;&nbsp; // Here is a full code example showing the difference<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$misspelled </span><span class="keyword">= </span><span class="string">'haert'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Imagine that these are sample suggestions thrown back by soundex or metaphone..<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$suggestions </span><span class="keyword">= array(</span><span class="string">'herat'</span><span class="keyword">, </span><span class="string">'haart'</span><span class="keyword">, </span><span class="string">'heart'</span><span class="keyword">, </span><span class="string">'harte'</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Firstly order an array based on levenshtein<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$levenshtein_ordered </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$suggestions </span><span class="keyword">as </span><span class="default">$suggestion </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$levenshtein_ordered</span><span class="keyword">[</span><span class="default">$suggestion</span><span class="keyword">] = </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$misspelled</span><span class="keyword">,</span><span class="default">$suggestion</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">asort</span><span class="keyword">(</span><span class="default">$levenshtein_ordered</span><span class="keyword">, </span><span class="default">SORT_NUMERIC </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;b&gt;Suggestions as ordered by levenshtein...&lt;/b&gt;&lt;ul&gt;&lt;pre&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$levenshtein_ordered</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;/pre&gt;&lt;/ul&gt;"</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Secondly order an array based on btlfsa<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$btlfsa_ordered </span><span class="keyword">= array();<br />
&nbsp;&nbsp;&nbsp; foreach ( </span><span class="default">$suggestions </span><span class="keyword">as </span><span class="default">$suggestion </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$btlfsa_ordered</span><span class="keyword">[</span><span class="default">$suggestion</span><span class="keyword">] = </span><span class="default">btlfsa</span><span class="keyword">(</span><span class="default">$misspelled</span><span class="keyword">,</span><span class="default">$suggestion</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">asort</span><span class="keyword">(</span><span class="default">$btlfsa_ordered</span><span class="keyword">, </span><span class="default">SORT_NUMERIC </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;b&gt;Suggestions as ordered by btlfsa...&lt;/b&gt;&lt;ul&gt;&lt;pre&gt;"</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">$btlfsa_ordered</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; print </span><span class="string">"&lt;/pre&gt;&lt;/ul&gt;"</span><span class="keyword">;<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="50699""></a>
  <div class="note">
   <strong class="user">mcreuzer at r-world dot com</strong>
   <a href="#50699" class="date">07-Mar-2005 09:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am using the Levenshtein distance to SORT my search results.<br />
<br />
I have a search page for peoples names. I do a SOUNDEX() search on the name in mysql. MySQL SOUNDEX() will perform the "fuzzy" search for me.<br />
<br />
I then calculate the Levenshtein distance between the search term and the actual name found by the SOUNDEX() search. This will give me a score on how close my results are to the search string.<br />
<br />
I can the sort my results for display listing the closest results first.<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// PHP CODE INCLUDING DB LOOKUPS HERE<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">usort</span><span class="keyword">(</span><span class="default">$searchresults</span><span class="keyword">, </span><span class="string">"finallevenshteinsortfunction"</span><span class="keyword">);<br />
<br />
function </span><span class="default">finallevenshteinsortfunction</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if((</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] &gt; </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">]) || ( </span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] == </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] &amp;&amp; </span><span class="default">strnatcasecmp</span><span class="keyword">( </span><span class="default">$a</span><span class="keyword">[</span><span class="string">'Last_Name'</span><span class="keyword">], </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'Last_Name'</span><span class="keyword">]) &gt;= </span><span class="default">1</span><span class="keyword">) ){ return </span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">];} </span><span class="comment">// Ok... The levenstein is greater OR with the same levenshtein, the last name is alphanumerically first<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">elseif(</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] == </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">]){ return </span><span class="string">'0'</span><span class="keyword">;} </span><span class="comment">// The levenstein matches <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">elseif(</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">] &lt; </span><span class="default">$b</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">]){ return -</span><span class="default">$a</span><span class="keyword">[</span><span class="string">'levenshtein'</span><span class="keyword">];}<br />
&nbsp;&nbsp;&nbsp; else{die(</span><span class="string">"&lt;!-- a horrable death --&gt;"</span><span class="keyword">);}<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37953""></a>
  <div class="note">
   <strong class="user">gzink at zinkconsulting dot com</strong>
   <a href="#37953" class="date">03-Dec-2003 03:03</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Try combining this with metaphone() for a truly amazing fuzzy search function. Play with it a bit, the results can be plain scary (users thinking the computer is almost telepathic) when implemented properly. I wish spell checkers worked as well as the code I've written.
<br />

<br />
I would release my complete code if reasonable, but it's not, due to copyright issues. I just hope that somebody can learn from this little tip!</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36900""></a>
  <div class="note">
   <strong class="user">genialbrainmachine at  dot IHATESPAM dot tiscali dot it</strong>
   <a href="#36900" class="date">26-Oct-2003 11:55</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote this function to have an "intelligent" comparison between data to be written in a DB<br />
and already existent data. Not ony calculating distances but also balancing distances for<br />
each field.<br />
<span class="default">&lt;?php<br />
</span><span class="comment">/*<br />
This function calculate a balanced percentage distance between an array of strings<br />
"$record" and a compared array "$compared", balanced through an array of<br />
weights "$weight". The three arrays must have the same indices.<br />
For an unbalanced distance, set all weights to 1.<br />
The used formula is:<br />
percentage distance = sum(field_levenshtein_distance * field_weight) / sum(record_field_length * field_weight) * 100<br />
*/<br />
</span><span class="keyword">function </span><span class="default">search_similar</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">, </span><span class="default">$weights</span><span class="keyword">, </span><span class="default">$compared</span><span class="keyword">, </span><span class="default">$precision</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$field_names </span><span class="keyword">= </span><span class="default">array_keys</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># "Weighted length" of $record and "weighted distance".<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">foreach (</span><span class="default">$field_names </span><span class="keyword">as </span><span class="default">$field_key</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$record_weight </span><span class="keyword">+= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">]) * </span><span class="default">$weights</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$weighted_distance </span><span class="keyword">+= </span><span class="default">levenshtein</span><span class="keyword">(</span><span class="default">$record</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">],</span><span class="default">$compared</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">]) * </span><span class="default">$weights</span><span class="keyword">[</span><span class="default">$field_key</span><span class="keyword">];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment"># Building the result..<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">if (</span><span class="default">$record_weight</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">round</span><span class="keyword">((</span><span class="default">$weighted_distance </span><span class="keyword">/ </span><span class="default">$record_weight </span><span class="keyword">* </span><span class="default">100</span><span class="keyword">),</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif ((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$record</span><span class="keyword">)) == </span><span class="default">0</span><span class="keyword">) &amp;&amp; (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">implode</span><span class="keyword">(</span><span class="string">""</span><span class="keyword">,</span><span class="default">$compared</span><span class="keyword">)) == </span><span class="default">0</span><span class="keyword">)) { </span><span class="comment">// empty records<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">round</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif (</span><span class="default">array_sum</span><span class="keyword">(</span><span class="default">$weights</span><span class="keyword">) == </span><span class="default">0</span><span class="keyword">) { </span><span class="comment">// all weights == 0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">round</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">$precision</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; Be very careful distinguising 0 result and false result.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; The function results 0 ('0.00' if $precision is 2 and so on) if:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; - $record and $compared are equals (even if $record and $compared are empty);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; - all weights are 0 (the meaning could be "no care about any field").<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; Conversely, the function results false if $record is empty, but the weights<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; are not all 0 and $compared is not empty. That cause a "division by 0" error.<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; I wrote this kind of check:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; if ($rel_dist = search_similar(...)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print $rel_dist;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } elseif ($rel_dist == "0.00") { // supposing that $precision is 2<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print $rel_dist;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; print "infinite";<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; */<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="36877""></a>
  <div class="note">
   <strong class="user">jlsalinas at gmx dot net</strong>
   <a href="#36877" class="date">25-Oct-2003 07:28</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Regarding the post by fgilles on April 26th 2001, I suggest not to use levenshtein() function to test for over-uppercasing unless you've got plenty of time to waste in your host. ;) Anyhow, I think it's a useful feature, as I get really annoyed when reading whole messages in uppercase.<br />
<br />
PHP's levenshtein() function can only handle up to 255 characters, which is not realistic for user input (only the first paragraph oh this post has 285 characters). If you choose to use a custom function able to handle more than 255 characters, efficiency is an important issue.<br />
<br />
I use this function, specific for this case, but much faster:<br />
<br />
function ucase_percent ($str) {<br />
&nbsp;&nbsp;&nbsp; $str2 = strtolower ($str);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; $l = strlen ($str);<br />
&nbsp;&nbsp;&nbsp; $ucase = 0;<br />
<br />
&nbsp;&nbsp;&nbsp; for ($i = 0; $i &lt; $l; $i++) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ($str{$i} != $str2{$i}) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $ucase++;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; return $ucase / $l * 100.0;<br />
}<br />
<br />
I think 10% is enough for written English (maybe other languages like German, which use more capital letters, need more). With some sentencies in uppercase (everybody has the right to shout occasionally), 20% would be enough; so I use a threshold of 30%. When exceeded, I lowercase the whole message.<br />
<br />
Hope you find it useful and it helps keeping the web free of ill-mannered people.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="33940""></a>
  <div class="note">
   <strong class="user">inerte is my hotmail.com username</strong>
   <a href="#33940" class="date">11-Jul-2003 10:22</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I am using this function to avoid duplicate information on my client's database.<br />
<br />
After retrieving a series of rows and assigning the results to an array values, I loop it with foreach comparing its levenshtein() with the user supplied string.<br />
<br />
It helps to avoid people re-registering "John Smith", "Jon Smith" or "Jon Smit".<br />
<br />
Of course, I can't block the operation if the user really wants to, but a suggestion is displayed along the lines of: "There's a similar client with this name.", followed by the list of the similar strings.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="24289""></a>
  <div class="note">
   <strong class="user">bisqwit at iki dot fi</strong>
   <a href="#24289" class="date">12-Aug-2002 07:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
At the time of this manual note the user defined thing&nbsp; <br />
in levenshtein() is not implemented yet. I wanted something<br />
like that, so I wrote my own function. Note that this<br />
doesn't return levenshtein() difference, but instead <br />
an array of operations to transform a string to another.<br />
<br />
Please note that the difference finding part (resync)<br />
may be extremely slow on long strings.<br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/* matchlen(): returns the length of matching<br />
&nbsp;* substrings at beginning of $a and $b<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">matchlen</span><span class="keyword">(&amp;</span><span class="default">$a</span><span class="keyword">, &amp;</span><span class="default">$b</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$c</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$alen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$blen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$d </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">(</span><span class="default">$alen</span><span class="keyword">, </span><span class="default">$blen</span><span class="keyword">);<br />
&nbsp; while(</span><span class="default">$a</span><span class="keyword">[</span><span class="default">$c</span><span class="keyword">] == </span><span class="default">$b</span><span class="keyword">[</span><span class="default">$c</span><span class="keyword">] &amp;&amp; </span><span class="default">$c </span><span class="keyword">&lt; </span><span class="default">$d</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$c</span><span class="keyword">++;&nbsp;&nbsp; <br />
&nbsp; return </span><span class="default">$c</span><span class="keyword">;<br />
}<br />
<br />
</span><span class="comment">/* Returns a table describing<br />
&nbsp;* the differences of $a and $b */<br />
</span><span class="keyword">function </span><span class="default">calcdiffer</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$b</span><span class="keyword">)<br />
{<br />
&nbsp; </span><span class="default">$alen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$blen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">);<br />
&nbsp; </span><span class="default">$aptr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; </span><span class="default">$bptr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp; <br />
&nbsp; </span><span class="default">$ops </span><span class="keyword">= array();<br />
&nbsp; <br />
&nbsp; while(</span><span class="default">$aptr </span><span class="keyword">&lt; </span><span class="default">$alen </span><span class="keyword">&amp;&amp; </span><span class="default">$bptr </span><span class="keyword">&lt; </span><span class="default">$blen</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$matchlen </span><span class="keyword">= </span><span class="default">matchlen</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$bptr</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$matchlen</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">, </span><span class="default">$matchlen</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$aptr </span><span class="keyword">+= </span><span class="default">$matchlen</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$bptr </span><span class="keyword">+= </span><span class="default">$matchlen</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp;&nbsp; continue;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* Difference found */<br />
&nbsp;&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bestlen</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bestpos</span><span class="keyword">=array(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">); <br />
&nbsp;&nbsp;&nbsp; for(</span><span class="default">$atmp </span><span class="keyword">= </span><span class="default">$aptr</span><span class="keyword">; </span><span class="default">$atmp </span><span class="keyword">&lt; </span><span class="default">$alen</span><span class="keyword">; </span><span class="default">$atmp</span><span class="keyword">++)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; for(</span><span class="default">$btmp </span><span class="keyword">= </span><span class="default">$bptr</span><span class="keyword">; </span><span class="default">$btmp </span><span class="keyword">&lt; </span><span class="default">$blen</span><span class="keyword">; </span><span class="default">$btmp</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$matchlen </span><span class="keyword">= </span><span class="default">matchlen</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$atmp</span><span class="keyword">), </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$btmp</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$matchlen</span><span class="keyword">&gt;</span><span class="default">$bestlen</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bestlen</span><span class="keyword">=</span><span class="default">$matchlen</span><span class="keyword">; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bestpos</span><span class="keyword">=array(</span><span class="default">$atmp</span><span class="keyword">,</span><span class="default">$btmp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$matchlen </span><span class="keyword">&gt;= </span><span class="default">$blen</span><span class="keyword">-</span><span class="default">$btmp</span><span class="keyword">)break;<br />
&nbsp;&nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(!</span><span class="default">$bestlen</span><span class="keyword">)break;<br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$adifflen </span><span class="keyword">= </span><span class="default">$bestpos</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] - </span><span class="default">$aptr</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bdifflen </span><span class="keyword">= </span><span class="default">$bestpos</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] - </span><span class="default">$bptr</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$adifflen</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'-'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">, </span><span class="default">$adifflen</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$aptr </span><span class="keyword">+= </span><span class="default">$adifflen</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">$bdifflen</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'+'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$bptr</span><span class="keyword">, </span><span class="default">$bdifflen</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp;&nbsp; </span><span class="default">$bptr </span><span class="keyword">+= </span><span class="default">$bdifflen</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'='</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">, </span><span class="default">$bestlen</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$aptr </span><span class="keyword">+= </span><span class="default">$bestlen</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bptr </span><span class="keyword">+= </span><span class="default">$bestlen</span><span class="keyword">;<br />
&nbsp; }<br />
&nbsp; if(</span><span class="default">$aptr </span><span class="keyword">&lt; </span><span class="default">$alen</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* b has too much stuff */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'-'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">, </span><span class="default">$aptr</span><span class="keyword">));<br />
&nbsp; }<br />
&nbsp; if(</span><span class="default">$bptr </span><span class="keyword">&lt; </span><span class="default">$blen</span><span class="keyword">)<br />
&nbsp; {<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/* a has too little stuff */<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$ops</span><span class="keyword">[] = array(</span><span class="string">'+'</span><span class="keyword">, </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$b</span><span class="keyword">, </span><span class="default">$bptr</span><span class="keyword">));<br />
&nbsp; }<br />
&nbsp; return </span><span class="default">$ops</span><span class="keyword">;<br />
}<br />
&nbsp;<br />
<br />
</span><span class="default">Example</span><span class="keyword">:<br />
<br />
</span><span class="default">$tab </span><span class="keyword">= </span><span class="default">calcdiffer</span><span class="keyword">(</span><span class="string">'T?m? on jonkinlainen testi'</span><span class="keyword">,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'T?m? ei ole mink??nlainen testi.'</span><span class="keyword">);&nbsp; <br />
</span><span class="default">$ops </span><span class="keyword">= array(</span><span class="string">'='</span><span class="keyword">=&gt;</span><span class="string">'Ok'</span><span class="keyword">, </span><span class="string">'-'</span><span class="keyword">=&gt;</span><span class="string">'Remove'</span><span class="keyword">, </span><span class="string">'+'</span><span class="keyword">=&gt;</span><span class="string">'Add'</span><span class="keyword">);<br />
foreach(</span><span class="default">$tab </span><span class="keyword">as </span><span class="default">$k</span><span class="keyword">)<br />
&nbsp; echo </span><span class="default">$ops</span><span class="keyword">[</span><span class="default">$k</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]], </span><span class="string">" '"</span><span class="keyword">, </span><span class="default">$k</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="string">"'\n"</span><span class="keyword">;<br />
<br />
</span><span class="default">Example output</span><span class="keyword">:<br />
<br />
</span><span class="default">Ok </span><span class="string">'T?m? '<br />
</span><span class="default">Remove </span><span class="string">'on jonki'<br />
</span><span class="default">Add </span><span class="string">'ei ole mink??'<br />
</span><span class="default">Ok </span><span class="string">'nlainen testi'<br />
</span><span class="default">Add </span><span class="string">'.'</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="20670""></a>
  <div class="note">
   
   <a href="#20670" class="date">11-Apr-2002 06:57</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For spell checking applications, delay could be tolerable if you assume the typist got the first two or three chars of each word right.&nbsp; Then you'd only need to calc distances for a small segment of the dictionary.&nbsp; This is a compromise but one I think a lot of spell checkers make.<br />
For an example of site search using this function look at the PHP manual search button on this page.&nbsp; It appears to be doing this for the PHP function list.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="12645""></a>
  <div class="note">
   <strong class="user">fgilles at free dot fr</strong>
   <a href="#12645" class="date">26-Apr-2001 01:32</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Exempla of use for a forum: users can't post messages too much uppercased
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">if ((</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">)&gt;</span><span class="default">10</span><span class="keyword">) and ( ( </span><span class="default">levenshtein </span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">, </span><span class="default">strtolower </span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">) / </span><span class="default">strlen </span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">) ) &gt; </span><span class="default">.3 </span><span class="keyword">) ){
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$subject </span><span class="keyword">= </span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$subject</span><span class="keyword">);
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7658""></a>
  <div class="note">
   <strong class="user">dschultz at protonic dot com</strong>
   <a href="#7658" class="date">10-Aug-2000 09:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
It's also useful if you want to make some sort of registration page and you want to make sure that people who register don't pick usernames that are very similar to their passwords.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="7486""></a>
  <div class="note">
   <strong class="user">ad1n at dc dot uba dot ar</strong>
   <a href="#7486" class="date">04-Aug-2000 05:01</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
One application of this is when you want to look for a similar match instead of an exact one. You can sort the results of checking the distances of a word to a dictionary and sort them to see which were the more similar ones. Of course it will be a quite resourse consuming task anyway.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
