<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=gb2312">
  <title>SSH2 函数</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs" class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="ssh2.constants.html">? 预定义常量</a></li>
      <li style="float: right;"><a href="function.ssh2-auth-agent.html">ssh2_auth_agent ?</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="book.ssh2.html">SSH2</a></li>
    <li>SSH2 函数</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="ref.ssh2" class="reference">
 <h1 class="title">SSH2 函数</h1>

 






















































































































































































<h2>Table of Contents</h2><ul class="chunklist chunklist_reference"><li><a href="function.ssh2-auth-agent.html">ssh2_auth_agent</a> &mdash; Authenticate over SSH using the ssh agent</li><li><a href="function.ssh2-auth-hostbased-file.html">ssh2_auth_hostbased_file</a> &mdash; Authenticate using a public hostkey</li><li><a href="function.ssh2-auth-none.html">ssh2_auth_none</a> &mdash; Authenticate as &quot;none&quot;</li><li><a href="function.ssh2-auth-password.html">ssh2_auth_password</a> &mdash; Authenticate over SSH using a plain password</li><li><a href="function.ssh2-auth-pubkey-file.html">ssh2_auth_pubkey_file</a> &mdash; Authenticate using a public key</li><li><a href="function.ssh2-connect.html">ssh2_connect</a> &mdash; Connect to an SSH server</li><li><a href="function.ssh2-disconnect.html">ssh2_disconnect</a> &mdash; Close a connection to a remote SSH server</li><li><a href="function.ssh2-exec.html">ssh2_exec</a> &mdash; Execute a command on a remote server</li><li><a href="function.ssh2-fetch-stream.html">ssh2_fetch_stream</a> &mdash; Fetch an extended data stream</li><li><a href="function.ssh2-fingerprint.html">ssh2_fingerprint</a> &mdash; Retrieve fingerprint of remote server</li><li><a href="function.ssh2-methods-negotiated.html">ssh2_methods_negotiated</a> &mdash; Return list of negotiated methods</li><li><a href="function.ssh2-publickey-add.html">ssh2_publickey_add</a> &mdash; Add an authorized publickey</li><li><a href="function.ssh2-publickey-init.html">ssh2_publickey_init</a> &mdash; Initialize Publickey subsystem</li><li><a href="function.ssh2-publickey-list.html">ssh2_publickey_list</a> &mdash; List currently authorized publickeys</li><li><a href="function.ssh2-publickey-remove.html">ssh2_publickey_remove</a> &mdash; Remove an authorized publickey</li><li><a href="function.ssh2-scp-recv.html">ssh2_scp_recv</a> &mdash; Request a file via SCP</li><li><a href="function.ssh2-scp-send.html">ssh2_scp_send</a> &mdash; Send a file via SCP</li><li><a href="function.ssh2-sftp-chmod.html">ssh2_sftp_chmod</a> &mdash; Changes file mode</li><li><a href="function.ssh2-sftp-lstat.html">ssh2_sftp_lstat</a> &mdash; Stat a symbolic link</li><li><a href="function.ssh2-sftp-mkdir.html">ssh2_sftp_mkdir</a> &mdash; Create a directory</li><li><a href="function.ssh2-sftp-readlink.html">ssh2_sftp_readlink</a> &mdash; Return the target of a symbolic link</li><li><a href="function.ssh2-sftp-realpath.html">ssh2_sftp_realpath</a> &mdash; Resolve the realpath of a provided path string</li><li><a href="function.ssh2-sftp-rename.html">ssh2_sftp_rename</a> &mdash; Rename a remote file</li><li><a href="function.ssh2-sftp-rmdir.html">ssh2_sftp_rmdir</a> &mdash; Remove a directory</li><li><a href="function.ssh2-sftp-stat.html">ssh2_sftp_stat</a> &mdash; Stat a file on a remote filesystem</li><li><a href="function.ssh2-sftp-symlink.html">ssh2_sftp_symlink</a> &mdash; Create a symlink</li><li><a href="function.ssh2-sftp-unlink.html">ssh2_sftp_unlink</a> &mdash; Delete a file</li><li><a href="function.ssh2-sftp.html">ssh2_sftp</a> &mdash; Initialize SFTP subsystem</li><li><a href="function.ssh2-shell.html">ssh2_shell</a> &mdash; Request an interactive shell</li><li><a href="function.ssh2-tunnel.html">ssh2_tunnel</a> &mdash; Open a tunnel through a remote server</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121929""></a>
  <div class="note">
   <strong class="user">shred</strong>
   <a href="#121929" class="date">28-Nov-2017 12:36</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Getting strange "Unable to open ssh2.s<a href="ftp://Resource id #3/example.txt" rel="nofollow" target="_blank">ftp://Resource id #3/example.txt</a>" errors? This is a bug in PHP &gt; 5.6.27. Use intval() as a workaround to make ssh2 work again:<br />
<br />
$sftp = ssh2_sftp($connection);<br />
fopen("ssh2.s<a href="ftp://" rel="nofollow" target="_blank">ftp://</a>" . intval($sftp) . "/example.txt", 'r');<br />
<br />
https://bugs.php.net/bug.php?id=73597</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78756""></a>
  <div class="note">
   <strong class="user">dan at novapulsar dot com</strong>
   <a href="#78756" class="date">25-Oct-2007 11:06</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
you will have an issue transferring any file using ssh2_scp_send unless you send a dummy file after your real file, or preferably issue an <br />
<br />
ssh2_exec ($connection, 'exit'); <br />
<br />
I was transferring hundreds of thousands of files in my prototype across multiple servers, and noticed that each file had a mismatched md5 hash and bytelength.<br />
<br />
after a bit of research i learnt that this was a bug, and added the code above as suggested at pecl.php.net in the bugs section.<br />
<br />
hopefully this helps someone who is getting partial file transfer that could ruin your whole app.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="77170""></a>
  <div class="note">
   <strong class="user">aeolianmeson at blitzeclipse dot com</strong>
   <a href="#77170" class="date">17-Aug-2007 12:00</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Some installations of PHP 5 may have a problem starting the SSH2 extension as a Windows' service. It just started happening to me today, spontaneously. I have PHP 5.2.2 (and have tried 5.2.3), on Apache 2.0.59 .<br />
<br />
It turns out that it's an Apache problem. Even though I was given an error message when starting it, it still worked perfectly from the CLI. So, I commented it out in the<br />
INI file again, and am just loading it using extension_loaded('ssh2') and dl('php_ssh2.dll') from within the script.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="69324""></a>
  <div class="note">
   <strong class="user">astribuncio at gmail dot com</strong>
   <a href="#69324" class="date">31-Aug-2006 10:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Installing on HPUX 11.11 cookbook<br />
<br />
Just follow the install instructions on the man page and solved the problems as they appear<br />
<br />
- when making libssh2<br />
Problem related with /lib/pa20_64 and 64 bits library in 32 bits link<br />
Edited the configure file&nbsp; and changed<br />
SHLIB_LDFLAGS="-b +vnocompatwarnings -L/lib/pa20_64"<br />
to<br />
SHLIB_LDFLAGS="-b +vnocompatwarnings -L/lib"<br />
<br />
-when executing phpize<br />
Problems with aclocal, autom4ke and m4<br />
Installed automake, autoconf and m4<br />
<br />
-when ./configuring the ssh2 <br />
Configure: error: libssh2 version &gt;= 0.4 not found<br />
Edited the configure.m4 and removed the -ldl switch from line (as posted before)<br />
39&nbsp; &nbsp; &nbsp; -L$SSH2_DIR/lib -lm -ldl<br />
runned phpize again and ./configure --with-ssh2</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="68806""></a>
  <div class="note">
   <strong class="user">chris dot britton at cingular dot com</strong>
   <a href="#68806" class="date">11-Aug-2006 06:11</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I was building out the ssh2 extension (0.10) under OpenBSD 3.9 on sparc64 and I got this error when running configure:<br />
<br />
checking for libssh2_banner_set in -lssh2... no<br />
configure: error: libssh2 version &gt;= 0.4 not found<br />
<br />
I did some poking around in the configure file and traced the problem down.&nbsp; The reason for the failure is that configure is trying to compile a test program with -ldl.&nbsp; libdl is not installed on OpenBSD 3.9. The OpenBSD folks purged libdl years ago and I could not find a package that contains it. <br />
<br />
(The error message above is misleading because the problem is not with libssh2.)<br />
<br />
I looked at the ssh2 extension code and could not see a reason for using libdl, so I removed the -ldl from the config.m4 file.&nbsp; Re-ran phpize and configure. No errors.&nbsp; Did make and installed ssh2.so.&nbsp; Works fine.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63641""></a>
  <div class="note">
   <strong class="user">Mike &lt;esnik8202 at sneakemail dot com&gt;</strong>
   <a href="#63641" class="date">26-Mar-2006 09:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To list directory contents:
<br />

<br />
<span class="default">&lt;?php
<br />
$connection </span><span class="keyword">= </span><span class="default">ssh2_connect</span><span class="keyword">(\</span><span class="string">"hostname\", 22);
<br />
ssh2_auth_password(</span><span class="default">$connection</span><span class="string">,\"username\", \"password\");&nbsp; // or use any of the ssh2_auth_* methods
<br />
</span><span class="default">$sftp</span><span class="string"> = ssh2_sftp(</span><span class="default">$connection</span><span class="string">);
<br />

<br />
</span><span class="default">$dh</span><span class="string"> = opendir(\"ssh2.s<a href="ftp://" rel="nofollow" target="_blank">ftp://</a></span><span class="default">$sftp</span><span class="string">/path/to/dir/\");
<br />

<br />
while ((</span><span class="default">$file</span><span class="string"> = readdir(</span><span class="default">$dh</span><span class="string">)) !== false) {
<br />
&nbsp; echo \"</span><span class="default">$file</span><span class="string"> is in hostname:/path/to/dir\\n\";
<br />
}
<br />

<br />
closedir(</span><span class="default">$dh</span><span class="string">);
<br />
?&gt;
<br />

<br />
(thanks to Sara for assisting)</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57462""></a>
  <div class="note">
   <strong class="user">dotwho at NSPM dot mac dot com</strong>
   <a href="#57462" class="date">04-Oct-2005 03:15</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Trying to compile this ssh PECL extension for Mac OS X (10.4.2) <br />
with entropy.ch's php5 distribution? Read on: PART 2:<br />
<br />
11) Check your shell's path variable by SHELL$ "echo $PATH". <br />
If your php5 binary directory is not listed before the standard OS X binary directory, <br />
update your $PATH variable to list it first. Mine reads: <br />
/usr/local/mysql/bin/: /usr/local/php5/bin/: /bin:/sbin: /usr/bin:/usr/sbin <br />
11a) if you do not do this step, the PECL extension will link against the old <br />
php4 version that ships with Mac OS X. You will know this by the fact that the <br />
next step lists a server API that is different than the output of phpinfo(): <br />
My version was 20041030, Apples version was 20020429.<br />
12) Run: phpize &amp;&amp; ./configure --with-ssh2 &amp;&amp; make<br />
This will produce a lot of output and probably some warnings. If you get a note <br />
at the end that says "Build Complete", then the process has completed <br />
(probably successfully). The command has produced the output file ssh2.so within <br />
the ssh2-0.9 (or whatever version) directory.<br />
13) Check where the extension directory is located at by running the following command:<br />
SHELL$/usr/local/php5/bin/php-config --extension-dir<br />
If it lists some directory that actually exists, copy the ssh2.so file to this directory.<br />
If it doesn't list a location that exists, you can either create the location, or <br />
choose a different location and update the line in your php.ini file:<br />
extension_dir = "./"<br />
to point to the directory you would like to use. I chose:<br />
extension_dir = "/usr/local/php5/extensions/"?&gt;<br />
14) Add the line<br />
extension=ssh2.so<br />
to the Dynamic Extensions area of your php.ini file.<br />
15) Restart your web server for the extensioin to be loaded. If there are any problems, they will be written to the webserver log.<br />
16) Check if your new ssh based streams are available by running:<br />
SHELL$ /usr/local/php5/bin/php -r "print_r(stream_get_wrappers());"<br />
You should get something similar to this output:<br />
Array<br />
(<br />
&nbsp;&nbsp;&nbsp; [0] =&gt; php<br />
&nbsp;&nbsp;&nbsp; [1] =&gt; file<br />
&nbsp;&nbsp;&nbsp; [2] =&gt; http<br />
&nbsp;&nbsp;&nbsp; [3] =&gt; ftp<br />
&nbsp;&nbsp;&nbsp; [4] =&gt; compress.bzip2<br />
&nbsp;&nbsp;&nbsp; [5] =&gt; compress.zlib<br />
&nbsp;&nbsp;&nbsp; [6] =&gt; https<br />
&nbsp;&nbsp;&nbsp; [7] =&gt; ftps<br />
&nbsp;&nbsp;&nbsp; [8] =&gt; ssh2.shell<br />
&nbsp;&nbsp;&nbsp; [9] =&gt; ssh2.exec<br />
&nbsp;&nbsp;&nbsp; [10] =&gt; ssh2.tunnel<br />
&nbsp;&nbsp;&nbsp; [11] =&gt; ssh2.scp<br />
&nbsp;&nbsp;&nbsp; [12] =&gt; ssh2.sftp<br />
)<br />
You should now be able to do all the cool things you need to do with ssh <br />
(like sftp scp ssh execution)! Take a look at some of the comment here for some <br />
example scripts to test things out:<br />
<a href="http://us2.php.net/manual/en/ref.ssh2.php" rel="nofollow" target="_blank">http://us2.php.net/manual/en/ref.ssh2.php</a><br />
<br />
Good luck... hope that saves you my headache! :)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57461""></a>
  <div class="note">
   <strong class="user">dotwho at NSPM dot mac dot com</strong>
   <a href="#57461" class="date">04-Oct-2005 03:12</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Trying to compile this ssh PECL extension for Mac OS X (10.4.2) <br />
with entropy.ch's php5 distribution? Read on: PART 1:<br />
1) Download libssh (I used version 0.11)<br />
<a href="http://sourceforge.net/project/showfiles.php?group_id=125852" rel="nofollow" target="_blank">http://sourceforge.net/project/showfiles.php?group_id=125852</a><br />
2) Unzip the directory and cd to the upacked directory in the terminal.<br />
3) run: ./configure; make all install;<br />
libssh should compile and place the output file in src/*.o<br />
4) copy all headers from the include folder within the libssh2 directory to<br />
/usr/local/include/<br />
5) copy all compiled files (*.o) from the src folder within the libssh2 <br />
directory to /usr/local/lib/<br />
6) Download ssh2 <br />
(I used version 0.9 with additional changes from cvs - explained below)<br />
<a href="http://pecl.php.net/package/ssh2" rel="nofollow" target="_blank">http://pecl.php.net/package/ssh2</a><br />
7) unzip the downloaded archive.<br />
8) version 0.9 has a conflict with an existing symbol used in some of the ZEND headers... <br />
a change is available in cvs which renames the symbol in ssh2 to avoid the conflict<br />
<a href="http://cvs.php.net/diff.php/pecl/ssh2/ssh2.c?r1=1.9&amp;r2=1.10&amp;ty=h" rel="nofollow" target="_blank">http://cvs.php.net/diff.php/pecl/ssh2/ssh2.c?r1=1.9&amp;r2=1.10&amp;ty=h</a><br />
down load at least the 1.10 version of ssh2.c<br />
if you decide to download a newer version, download any of the corresponding related files, <br />
such as the php_ssh2.h header file.<br />
9) replace the old version of ssh2.c with the new version of ssh2.c <br />
(and any other files you downloaded).<br />
10) From the terminal: <br />
cd to the source directory (for me ssh2-0.9/ssh2-0.9/).<br />
<br />
(Continued in a PART 2 comment)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
</div></div></body></html>
